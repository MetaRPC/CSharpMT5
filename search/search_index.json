{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"CSharpMT5 SDK Documentation","text":"<p>Complete C# SDK for MetaTrader 5 trading automation via gRPC</p> rocket_launch Quick Start <p>Your first project from scratch in 10 minutes</p> bolt Getting Started <p>New here? Start with setup and overview</p> map Project Map <p>Architecture overview</p> menu_book Glossary <p>MT5 terms and API concepts</p> build MT5Service <p>Wrapper methods layer</p> settings MT5Account <p>Low-level gRPC protocol layer</p> auto_awesome MT5Sugar <p>High-level convenience API</p>"},{"location":"GRPC_STREAM_MANAGEMENT/","title":"gRPC Stream Management &amp; Subscription Guide","text":"<p>Complete guide to working with real-time subscriptions in C# MT5</p> <p>This document covers:</p> <ul> <li>\u2705 How to properly subscribe to market data streams</li> <li>\u2705 How to stop subscriptions without memory leaks</li> <li>\u2705 Common patterns from simple to advanced</li> <li>\u2705 Architecture and built-in safety mechanisms</li> <li>\u2705 Troubleshooting and best practices</li> </ul>"},{"location":"GRPC_STREAM_MANAGEMENT/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Quick Start - Simple Subscription</li> <li>Available Streaming Methods</li> <li>Complete Patterns (Simple \u2192 Advanced)</li> <li>Problem: Why Streams Need Management</li> <li>Solutions &amp; Best Practices</li> <li>Architecture &amp; Safety</li> <li>Troubleshooting</li> </ol>"},{"location":"GRPC_STREAM_MANAGEMENT/#quick-start-simple-subscription","title":"Quick Start - Simple Subscription","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#1-simplest-pattern-bounded-streaming","title":"1\ufe0f\u20e3 Simplest Pattern (Bounded Streaming) \u2b50","text":"<p>Use MT5Sugar helpers - automatically stops after N events or timeout:</p> <pre><code>using mt5_term_api;\n\nvar account = new MT5Account(user, password, grpcServer, null);\nawait account.ConnectByServerNameAsync(serverName, \"EURUSD\", 30);\n\nvar svc = new MT5Service(account);\n\n// \u2705 Read 20 ticks, max 10 seconds - automatically stops!\nawait foreach (var tick in svc.ReadTicks(\n    symbols: new[] { \"EURUSD\", \"GBPUSD\" },\n    maxEvents: 20,\n    durationSec: 10))\n{\n    Console.WriteLine($\"{tick.Symbol}: Bid={tick.Bid}, Ask={tick.Ask}\");\n}\n// Done! No cleanup needed - stream auto-stopped \u2705\n</code></pre> <p>When to use: Quick samples, testing, short monitoring sessions</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#2-manual-control-pattern","title":"2\ufe0f\u20e3 Manual Control Pattern","text":"<p>For full control - you manage when to stop:</p> <pre><code>using var cts = new CancellationTokenSource();\n\n// Start monitoring\nvar monitorTask = Task.Run(async () =&gt;\n{\n    try\n    {\n        await foreach (var tick in account.OnSymbolTickAsync(\n            new[] { \"EURUSD\" }, cts.Token))\n        {\n            Console.WriteLine($\"Price: {tick.Bid}\");\n        }\n    }\n    catch (OperationCanceledException)\n    {\n        Console.WriteLine(\"Monitoring stopped\");\n    }\n});\n\n// ... do other work ...\n\n// Stop when needed\ncts.Cancel();\nawait monitorTask;\n</code></pre> <p>When to use: Long-running monitoring, background services, production apps</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#available-streaming-methods","title":"Available Streaming Methods","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#mt5account-low-level-streams","title":"MT5Account (Low-Level Streams)","text":"Method Description Returns <code>OnSymbolTickAsync()</code> Real-time price ticks for symbols <code>IAsyncEnumerable&lt;OnSymbolTickData&gt;</code> <code>OnTradeAsync()</code> Trade events (orders filled, modified, etc.) <code>IAsyncEnumerable&lt;OnTradeData&gt;</code> <code>OnBookEventAsync()</code> Market depth (DOM) events <code>IAsyncEnumerable&lt;OnBookEventData&gt;</code> <code>OnPositionProfitAsync()</code> Position P&amp;L updates <code>IAsyncEnumerable&lt;OnPositionProfitData&gt;</code> <code>OnPositionsAndPendingOrdersTicketsAsync()</code> Order/position tickets <code>IAsyncEnumerable&lt;OnPositionsAndPendingOrdersTicketsData&gt;</code> <p>All require <code>CancellationToken</code> for stopping!</p> <p>See: MT5Account Streaming Overview</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#mt5sugar-bounded-helpers","title":"MT5Sugar (Bounded Helpers) \u2b50","text":"Method Description Auto-Stops After <code>ReadTicks()</code> Limited tick streaming N events OR timeout <code>ReadTrades()</code> Limited trade event streaming N events OR timeout <code>SubscribeToMarketBookAsync()</code> DOM subscription (IDisposable) <code>using</code> block exits <p>Recommended for most use cases!</p> <p>See: ReadTicks | ReadTrades</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#complete-patterns-simple-advanced","title":"Complete Patterns (Simple \u2192 Advanced)","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-1-quick-sample-5-10-seconds","title":"Pattern 1: Quick Sample (5-10 seconds)","text":"<pre><code>// \u2705 Automatic timeout - perfect for testing\nusing var cts = new CancellationTokenSource(TimeSpan.FromSeconds(10));\n\nawait foreach (var tick in account.OnSymbolTickAsync(\n    new[] { \"EURUSD\" }, cts.Token))\n{\n    Console.WriteLine($\"Tick: {tick.Bid}\");\n}\n// Stops after 10 seconds automatically \u2705\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-2-event-limited-streaming","title":"Pattern 2: Event-Limited Streaming","text":"<pre><code>// \u2705 Stop after processing N events\nusing var cts = new CancellationTokenSource();\nint count = 0;\nconst int MAX_EVENTS = 100;\n\nawait foreach (var tick in account.OnSymbolTickAsync(\n    new[] { \"EURUSD\" }, cts.Token))\n{\n    Console.WriteLine($\"[{++count}] {tick.Symbol}: {tick.Bid}\");\n\n    if (count &gt;= MAX_EVENTS)\n    {\n        cts.Cancel();\n        break;\n    }\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-3-condition-based-stopping","title":"Pattern 3: Condition-Based Stopping","text":"<pre><code>// \u2705 Stop when specific condition met\nusing var cts = new CancellationTokenSource();\n\nawait foreach (var tick in account.OnSymbolTickAsync(\n    new[] { \"EURUSD\" }, cts.Token))\n{\n    Console.WriteLine($\"Price: {tick.Bid}\");\n\n    // Stop if price crosses threshold\n    if (tick.Bid &gt; 1.10000)\n    {\n        Console.WriteLine(\"Target price reached!\");\n        cts.Cancel();\n        break;\n    }\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-4-background-service-with-manual-control","title":"Pattern 4: Background Service with Manual Control","text":"<pre><code>public class PriceMonitor : IDisposable\n{\n    private CancellationTokenSource? _cts;\n    private Task? _monitorTask;\n\n    public void Start(MT5Account account, string[] symbols)\n    {\n        _cts = new CancellationTokenSource();\n        _monitorTask = MonitorPricesAsync(account, symbols, _cts.Token);\n    }\n\n    private async Task MonitorPricesAsync(\n        MT5Account account,\n        string[] symbols,\n        CancellationToken ct)\n    {\n        try\n        {\n            await foreach (var tick in account.OnSymbolTickAsync(symbols, ct))\n            {\n                ProcessTick(tick);\n            }\n        }\n        catch (OperationCanceledException)\n        {\n            Console.WriteLine(\"Monitoring stopped gracefully\");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine($\"Error: {ex.Message}\");\n        }\n    }\n\n    private void ProcessTick(OnSymbolTickData tick)\n    {\n        Console.WriteLine($\"{tick.Symbol}: {tick.Bid} / {tick.Ask}\");\n        // Your logic here...\n    }\n\n    public void Stop()\n    {\n        _cts?.Cancel();\n        _monitorTask?.Wait(TimeSpan.FromSeconds(5));\n    }\n\n    public void Dispose()\n    {\n        Stop();\n        _cts?.Dispose();\n    }\n}\n\n// Usage:\nusing var monitor = new PriceMonitor();\nmonitor.Start(account, new[] { \"EURUSD\", \"GBPUSD\" });\n\nConsole.WriteLine(\"Press any key to stop monitoring...\");\nConsole.ReadKey();\n\nmonitor.Stop();\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-5-multiple-concurrent-streams","title":"Pattern 5: Multiple Concurrent Streams","text":"<pre><code>using var cts = new CancellationTokenSource();\n\n// Start multiple streams concurrently\nvar tickTask = Task.Run(async () =&gt;\n{\n    await foreach (var tick in account.OnSymbolTickAsync(\n        new[] { \"EURUSD\" }, cts.Token))\n    {\n        Console.WriteLine($\"Tick: {tick.Bid}\");\n    }\n});\n\nvar tradeTask = Task.Run(async () =&gt;\n{\n    await foreach (var trade in account.OnTradeAsync(cts.Token))\n    {\n        Console.WriteLine($\"Trade: {trade.Type}\");\n    }\n});\n\n// Wait for both or timeout\nawait Task.WhenAny(\n    Task.WhenAll(tickTask, tradeTask),\n    Task.Delay(TimeSpan.FromSeconds(30)));\n\n// Stop all streams\ncts.Cancel();\n\n// Ensure all tasks completed\nawait Task.WhenAll(tickTask, tradeTask);\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-6-dom-market-depth-subscription","title":"Pattern 6: DOM (Market Depth) Subscription","text":"<pre><code>// \u2705 IDisposable pattern - auto-cleanup with 'using'\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    // While inside 'using' block, subscription is active\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    Console.WriteLine(\"Order Book:\");\n    foreach (var item in book.MqlBookInfo)\n    {\n        Console.WriteLine($\"  {item.Type}: {item.Price} x {item.Volume}\");\n    }\n\n    var (bestBid, bestAsk) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n    Console.WriteLine($\"Best: {bestBid} / {bestAsk}\");\n\n} // \u2705 Automatically unsubscribes here!\n\n// Subscription is now inactive - clean exit\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-7-error-handling-reconnection","title":"Pattern 7: Error Handling &amp; Reconnection","text":"<pre><code>using var cts = new CancellationTokenSource();\nint reconnectCount = 0;\nconst int MAX_RECONNECTS = 3;\n\nwhile (reconnectCount &lt; MAX_RECONNECTS &amp;&amp; !cts.Token.IsCancellationRequested)\n{\n    try\n    {\n        await foreach (var tick in account.OnSymbolTickAsync(\n            new[] { \"EURUSD\" }, cts.Token))\n        {\n            Console.WriteLine($\"Price: {tick.Bid}\");\n            reconnectCount = 0; // Reset on successful stream\n        }\n        break; // Normal exit\n    }\n    catch (RpcException ex) when (ex.StatusCode == StatusCode.Unavailable)\n    {\n        reconnectCount++;\n        Console.WriteLine($\"Connection lost. Reconnecting... ({reconnectCount}/{MAX_RECONNECTS})\");\n        await Task.Delay(2000, cts.Token);\n\n        // MT5Account.ExecuteStreamWithReconnect handles this automatically!\n        // This pattern is for demonstration - usually not needed\n    }\n    catch (OperationCanceledException)\n    {\n        Console.WriteLine(\"Cancelled by user\");\n        break;\n    }\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#problem-why-streams-need-management","title":"Problem: Why Streams Need Management","text":"<p>When working with gRPC streaming in CSharpMT5, understanding stream lifecycle is critical:</p> <p>Stream subscriptions (<code>OnSymbolTickAsync</code>, <code>OnTradeAsync</code>, etc.) are active network connections that continue running even after exiting the method or losing the reference.</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#the-problem-explained","title":"The Problem Explained","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#current-implementation","title":"Current Implementation","text":"<pre><code>public IAsyncEnumerable&lt;OnSymbolTickData&gt; OnSymbolTickAsync(\n    IEnumerable&lt;string&gt; symbolNames,\n    CancellationToken ct = default)\n{\n    // Stream starts...\n    // \u274c No way to stop it except CancellationToken\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#what-happens-without-proper-cleanup","title":"What Happens Without Proper Cleanup","text":"<pre><code>// \u274c BAD: Stream continues running forever\nawait foreach (var tick in account.OnSymbolTickAsync(symbols))\n{\n    Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n\n    if (someCondition)\n        break;  // \u274c PROBLEM: Stream still running in background!\n}\n</code></pre> <p>Result:</p> <ul> <li>Background gRPC call continues consuming resources</li> <li>MT5 terminal keeps sending updates</li> <li>Memory gradually accumulates</li> <li>Multiple abandoned streams = memory leak</li> </ul>"},{"location":"GRPC_STREAM_MANAGEMENT/#solution-1-always-use-cancellationtoken","title":"Solution 1: Always Use CancellationToken \u2705","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-1-cancellationtokensource","title":"Pattern 1: CancellationTokenSource","text":"<pre><code>using var cts = new CancellationTokenSource();\n\ntry\n{\n    await foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n    {\n        Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n\n        if (someCondition)\n        {\n            cts.Cancel();  // \u2705 CORRECT: Stops stream\n            break;\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    // Expected when we cancel\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-2-timeout-with-cancellationtoken","title":"Pattern 2: Timeout with CancellationToken","text":"<pre><code>using var cts = new CancellationTokenSource(TimeSpan.FromSeconds(30));\n\ntry\n{\n    await foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n    {\n        Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream timed out or was cancelled\");\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#pattern-3-manual-cancellation","title":"Pattern 3: Manual Cancellation","text":"<pre><code>private CancellationTokenSource? _streamCts;\n\npublic async Task StartMonitoring(MT5Account account, string[] symbols)\n{\n    _streamCts = new CancellationTokenSource();\n\n    try\n    {\n        await foreach (var tick in account.OnSymbolTickAsync(symbols, _streamCts.Token))\n        {\n            ProcessTick(tick);\n        }\n    }\n    catch (OperationCanceledException)\n    {\n        Console.WriteLine(\"Monitoring stopped\");\n    }\n}\n\npublic void StopMonitoring()\n{\n    _streamCts?.Cancel();  // \u2705 Stops the stream\n    _streamCts?.Dispose();\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#solution-2-mt5sugar-bounded-streaming-helpers","title":"Solution 2: MT5Sugar Bounded Streaming Helpers \u2b50","text":"<p>MT5Sugar provides bounded streaming methods that automatically limit execution:</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#readticks-limited-tick-streaming","title":"ReadTicks - Limited Tick Streaming","text":"<pre><code>// \u2705 Automatically stops after 50 events OR 5 seconds\nawait foreach (var tick in svc.ReadTicks(\n    symbols: new[] { \"EURUSD\", \"GBPUSD\" },\n    maxEvents: 50,\n    durationSec: 5))\n{\n    Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n}\n// Stream automatically terminates - no leak!\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#readtrades-limited-trade-streaming","title":"ReadTrades - Limited Trade Streaming","text":"<pre><code>// \u2705 Automatically stops after 10 events OR 30 seconds\nawait foreach (var trade in svc.ReadTrades(\n    maxEvents: 10,\n    durationSec: 30))\n{\n    Console.WriteLine($\"Trade: {trade.Type}\");\n}\n// Stream automatically terminates - no leak!\n</code></pre> <p>See documentation: - ReadTicks.md - ReadTrades.md</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#choosing-the-right-pattern","title":"Choosing the Right Pattern","text":"Your Use Case Recommended Pattern Why Quick test/demo Pattern 1 (Quick Sample) Simple, automatic timeout Sample N events Pattern 2 (Event-Limited) Clear exit condition Monitor until condition Pattern 3 (Condition-Based) Business logic controls lifetime Background service Pattern 4 (Service Class) Clean OOP design, reusable Multiple streams Pattern 5 (Concurrent) Coordinated shutdown Market depth (DOM) Pattern 6 (IDisposable) Built-in cleanup Production app Pattern 4 or 7 Error handling + graceful shutdown <p>For most cases: Use MT5Sugar bounded helpers (<code>ReadTicks</code>, <code>ReadTrades</code>) - they handle everything!</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#solutions-best-practices","title":"Solutions &amp; Best Practices","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#solution-3-idisposable-pattern-for-dom-subscription","title":"Solution 3: IDisposable Pattern for DOM Subscription","text":"<p>Market Book (DOM) subscription uses IDisposable for automatic cleanup:</p> <pre><code>// \u2705 CORRECT: using statement ensures cleanup\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n    // Process order book...\n}  // \u2705 Automatically unsubscribes here\n</code></pre> <p>Without <code>using</code> - memory leak: <pre><code>// \u274c BAD: Subscription never cleaned up\nawait svc.SubscribeToMarketBookAsync(\"EURUSD\");\nvar book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n// \u274c Subscription still active in background!\n</code></pre></p>"},{"location":"GRPC_STREAM_MANAGEMENT/#common-streaming-pitfalls","title":"Common Streaming Pitfalls","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#pitfall-1-no-cancellation-token","title":"\u274c Pitfall 1: No Cancellation Token","text":"<pre><code>// \u274c WRONG: Infinite loop, no way to stop\nawait foreach (var tick in account.OnSymbolTickAsync(symbols))\n{\n    Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n    // If exception occurs or program exits, stream keeps running!\n}\n</code></pre> <p>Fix: <pre><code>// \u2705 CORRECT: Can cancel anytime\nusing var cts = new CancellationTokenSource();\nawait foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n{\n    Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n}\n</code></pre></p>"},{"location":"GRPC_STREAM_MANAGEMENT/#pitfall-2-breaking-without-cancellation","title":"\u274c Pitfall 2: Breaking Without Cancellation","text":"<pre><code>// \u274c WRONG: Break doesn't stop the stream\nawait foreach (var tick in account.OnSymbolTickAsync(symbols))\n{\n    if (tick.Symbol == \"EURUSD\")\n        break;  // \u274c Stream still running!\n}\n</code></pre> <p>Fix: <pre><code>// \u2705 CORRECT: Cancel before breaking\nusing var cts = new CancellationTokenSource();\nawait foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n{\n    if (tick.Symbol == \"EURUSD\")\n    {\n        cts.Cancel();  // \u2705 Stop stream\n        break;\n    }\n}\n</code></pre></p>"},{"location":"GRPC_STREAM_MANAGEMENT/#pitfall-3-exception-without-cleanup","title":"\u274c Pitfall 3: Exception Without Cleanup","text":"<pre><code>// \u274c WRONG: Exception leaves stream running\nawait foreach (var tick in account.OnSymbolTickAsync(symbols))\n{\n    ProcessTick(tick);  // If this throws, stream keeps running!\n}\n</code></pre> <p>Fix: <pre><code>// \u2705 CORRECT: try-finally ensures cleanup\nusing var cts = new CancellationTokenSource();\ntry\n{\n    await foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n    {\n        ProcessTick(tick);\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"Error: {ex.Message}\");\n}\nfinally\n{\n    cts.Cancel();  // \u2705 Ensure stream stops\n}\n</code></pre></p>"},{"location":"GRPC_STREAM_MANAGEMENT/#complete-example-proper-stream-management","title":"Complete Example: Proper Stream Management","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#example-1-simple-tick-monitoring-with-timeout","title":"Example 1: Simple Tick Monitoring with Timeout","text":"<pre><code>public async Task MonitorTicksAsync(MT5Account account, string[] symbols)\n{\n    using var cts = new CancellationTokenSource(TimeSpan.FromSeconds(30));\n    int tickCount = 0;\n    const int MAX_TICKS = 100;\n\n    try\n    {\n        Console.WriteLine($\"Starting tick monitoring (max {MAX_TICKS} ticks or 30 seconds)...\");\n\n        await foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n        {\n            Console.WriteLine($\"[{++tickCount}] {tick.Symbol}: Bid={tick.Bid}, Ask={tick.Ask}\");\n\n            if (tickCount &gt;= MAX_TICKS)\n            {\n                Console.WriteLine(\"Max ticks reached - stopping\");\n                cts.Cancel();\n                break;\n            }\n        }\n    }\n    catch (OperationCanceledException)\n    {\n        Console.WriteLine($\"Monitoring stopped ({tickCount} ticks processed)\");\n    }\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#example-2-trade-event-monitoring-with-manual-stop","title":"Example 2: Trade Event Monitoring with Manual Stop","text":"<pre><code>public class TradeMonitor : IDisposable\n{\n    private CancellationTokenSource? _cts;\n    private Task? _monitoringTask;\n\n    public void Start(MT5Account account)\n    {\n        _cts = new CancellationTokenSource();\n        _monitoringTask = MonitorTradesAsync(account, _cts.Token);\n    }\n\n    public void Stop()\n    {\n        _cts?.Cancel();\n    }\n\n    private async Task MonitorTradesAsync(MT5Account account, CancellationToken ct)\n    {\n        try\n        {\n            await foreach (var trade in account.OnTradeAsync(ct))\n            {\n                Console.WriteLine($\"Trade event: {trade.Type}\");\n                // Process trade...\n            }\n        }\n        catch (OperationCanceledException)\n        {\n            Console.WriteLine(\"Trade monitoring stopped\");\n        }\n    }\n\n    public void Dispose()\n    {\n        Stop();\n        _cts?.Dispose();\n        _monitoringTask?.Wait(TimeSpan.FromSeconds(5));\n    }\n}\n\n// Usage:\nusing var monitor = new TradeMonitor();\nmonitor.Start(account);\n\n// ... do other work ...\n\nmonitor.Stop();  // \u2705 Gracefully stops monitoring\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#example-3-using-mt5sugar-bounded-helpers-recommended","title":"Example 3: Using MT5Sugar Bounded Helpers (Recommended)","text":"<pre><code>public async Task QuickTickSampleAsync(MT5Service svc)\n{\n    Console.WriteLine(\"Reading 20 tick updates (max 10 seconds)...\");\n\n    // \u2705 No CancellationToken needed - automatically bounded\n    await foreach (var tick in svc.ReadTicks(\n        symbols: new[] { \"EURUSD\", \"GBPUSD\" },\n        maxEvents: 20,\n        durationSec: 10))\n    {\n        Console.WriteLine($\"{tick.Symbol}: {tick.Bid}\");\n    }\n\n    Console.WriteLine(\"Done - stream automatically stopped\");\n    // \u2705 No memory leak - stream properly terminated\n}\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#recommendations","title":"Recommendations","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#do","title":"\u2705 DO:","text":"<ol> <li>Always use <code>CancellationToken</code> with streaming methods</li> <li>Use <code>using</code> statement for <code>CancellationTokenSource</code></li> <li>Set timeout via <code>CancellationTokenSource(TimeSpan)</code></li> <li>Use MT5Sugar bounded helpers (<code>ReadTicks</code>, <code>ReadTrades</code>) when possible</li> <li>Use <code>using</code> with IDisposable (e.g., DOM subscription)</li> <li>Wrap in try-catch to handle <code>OperationCanceledException</code></li> </ol>"},{"location":"GRPC_STREAM_MANAGEMENT/#dont","title":"\u274c DON'T:","text":"<ol> <li>Never start streaming without CancellationToken</li> <li>Never break from loop without calling <code>Cancel()</code></li> <li>Never ignore <code>OperationCanceledException</code></li> <li>Never forget to dispose <code>CancellationTokenSource</code></li> <li>Never assume stream stops automatically on exception</li> </ol>"},{"location":"GRPC_STREAM_MANAGEMENT/#testing-for-memory-leaks","title":"Testing for Memory Leaks","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#check-for-abandoned-streams","title":"Check for Abandoned Streams","text":"<pre><code>// Monitor active gRPC calls before/after streaming\nvar initialCalls = Process.GetCurrentProcess().Threads.Count;\n\n// Your streaming code here...\n\nvar finalCalls = Process.GetCurrentProcess().Threads.Count;\nConsole.WriteLine($\"Thread delta: {finalCalls - initialCalls}\");\n// Should be ~0 if properly cleaned up\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#use-diagnostic-tools","title":"Use Diagnostic Tools","text":"<ul> <li>Visual Studio Diagnostic Tools - Monitor live objects</li> <li>dotMemory - Track memory growth over time</li> <li>PerfView - Analyze thread activity</li> </ul>"},{"location":"GRPC_STREAM_MANAGEMENT/#architecture-notes","title":"Architecture Notes","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#how-c-streaming-works-in-mt5account","title":"How C# Streaming Works in MT5Account","text":"<p>Data flow:</p> <pre><code>User Code (await foreach)\n    \u2193\nIAsyncEnumerable&lt;T&gt; (MT5Account.OnSymbolTickAsync)\n    \u2193\nExecuteStreamWithReconnect (try-finally with stream.Dispose) \u2190 \u2705 Auto-cleanup here!\n    \u2193\ngRPC AsyncServerStreamingCall (Protobuf streaming)\n    \u2193\nNetwork (to MT5 terminal)\n</code></pre> <p>CancellationToken propagates: <pre><code>User Code \u2192 IAsyncEnumerable \u2192 gRPC Call \u2192 Network\n</code></pre></p> <p>When you cancel (or break):</p> <ol> <li><code>CancellationToken</code> triggers OR iterator exits</li> <li><code>IAsyncEnumerable</code> stops yielding</li> <li><code>finally { stream?.Dispose() }</code> executes \u2705 \u2190 BUILT-IN CLEANUP!</li> <li>gRPC call is cancelled</li> <li>Network connection closes</li> <li>Resources freed \u2705</li> </ol> <p>MT5Account has built-in cleanup - safer than raw gRPC!</p>"},{"location":"GRPC_STREAM_MANAGEMENT/#mt5account-cleanup-mechanism","title":"MT5Account Cleanup Mechanism","text":"<p>The <code>ExecuteStreamWithReconnect</code> method ensures proper cleanup:</p> <pre><code>// In MT5Account class (package/Helpers/MT5Account.cs)\nprivate async IAsyncEnumerable&lt;TData&gt; ExecuteStreamWithReconnect&lt;TRequest, TReply, TData&gt;(\n    TRequest request,\n    Func&lt;TRequest, Metadata, CancellationToken, AsyncServerStreamingCall&lt;TReply&gt;&gt; streamInvoker,\n    Func&lt;TReply, Mt5TermApi.Error?&gt; getError,\n    Func&lt;TReply, TData?&gt; getData,\n    [EnumeratorCancellation] CancellationToken cancellationToken = default)\n{\n    while (!cancellationToken.IsCancellationRequested)\n    {\n        AsyncServerStreamingCall&lt;TReply&gt;? stream = null;\n        try\n        {\n            stream = streamInvoker(request, GetHeaders(), cancellationToken);\n            // ... streaming logic ...\n        }\n        finally\n        {\n            stream?.Dispose();  // \u2705 ALWAYS executes - no leaks!\n        }\n    }\n}\n</code></pre> <p>This means:</p> <ul> <li>\u2705 Even if you <code>break</code> without calling <code>Cancel()</code>, cleanup still happens</li> <li>\u2705 Even if exception occurs, <code>finally</code> ensures cleanup</li> <li>\u2705 The implementation is safer than raw gRPC streaming</li> <li>\u2705 You still should use <code>CancellationToken</code> for clean shutdown, but forgetting won't cause a leak</li> </ul>"},{"location":"GRPC_STREAM_MANAGEMENT/#summary","title":"Summary","text":""},{"location":"GRPC_STREAM_MANAGEMENT/#quick-decision-tree","title":"Quick Decision Tree","text":"<pre><code>Need streaming?\n\u251c\u2500 Yes \u2192 Short sample (&lt; 1 minute)?\n\u2502  \u251c\u2500 Yes \u2192 Use ReadTicks() or ReadTrades() \u2705 EASIEST\n\u2502  \u2514\u2500 No \u2192 Need background service?\n\u2502     \u251c\u2500 Yes \u2192 Use Pattern 4 (Service Class) \u2705 PRODUCTION\n\u2502     \u2514\u2500 No \u2192 Use Pattern 1-3 with CancellationToken \u2705 SIMPLE\n\u2514\u2500 No \u2192 Use regular async methods\n</code></pre>"},{"location":"GRPC_STREAM_MANAGEMENT/#golden-rules-for-streaming","title":"Golden Rules for Streaming","text":"<ol> <li>Prefer MT5Sugar bounded helpers (<code>ReadTicks</code>, <code>ReadTrades</code>) - handles everything automatically</li> <li>Always pass <code>CancellationToken</code> when using low-level <code>OnSymbolTickAsync</code> etc.</li> <li>Use <code>using</code> for <code>CancellationTokenSource</code> - ensures disposal</li> <li>Call <code>Cancel()</code> before exiting - graceful shutdown</li> <li>Wrap in try-catch for <code>OperationCanceledException</code></li> <li>Test for leaks during development</li> </ol>"},{"location":"GRPC_STREAM_MANAGEMENT/#key-takeaways","title":"Key Takeaways","text":"<p>\u2705 MT5Account has built-in safety:</p> <ul> <li><code>finally { stream?.Dispose() }</code> prevents leaks even if you forget to cancel</li> <li>Still recommend using <code>CancellationToken</code> for clean shutdown</li> </ul> <p>\u2705 Best practices:</p> <ul> <li>Quick tests: <code>ReadTicks()</code> / <code>ReadTrades()</code></li> <li>Production: Pattern 4 (Service class with IDisposable)</li> <li>Custom logic: Patterns 1-3 with <code>CancellationToken</code></li> </ul> <p>\u2705 What to avoid:</p> <ul> <li>\u274c Streaming without <code>CancellationToken</code> (works but not clean)</li> <li>\u274c Breaking loop without calling <code>Cancel()</code> first</li> <li>\u274c Ignoring <code>OperationCanceledException</code></li> <li>\u274c DOM subscription without <code>using</code> statement</li> </ul> <p>Remember:</p> <ul> <li>gRPC streams are active network connections</li> <li>MT5Account's <code>finally</code> block prevents memory leaks</li> <li>But <code>CancellationToken</code> provides graceful shutdown</li> <li>Use MT5Sugar bounded helpers whenever possible!</li> </ul>"},{"location":"GRPC_STREAM_MANAGEMENT/#see-also","title":"See Also","text":"<ul> <li>MT5Sugar ReadTicks - Bounded tick streaming</li> <li>MT5Sugar ReadTrades - Bounded trade streaming</li> <li>GRPC Best Practices - Official gRPC guidance</li> </ul> <p>\ud83c\udfaf Bottom line: Always use <code>CancellationToken</code> with streaming, or use MT5Sugar bounded helpers!</p>"},{"location":"Getting_Started/","title":"Getting Started with CSharpMT5","text":"<p>Welcome to CSharpMT5 - a comprehensive educational project for learning MT5 trading automation from the ground up using C# and .NET.</p>"},{"location":"Getting_Started/#prerequisites-and-setup","title":"\ud83d\ude80 Prerequisites and Setup","text":"<p>Before you start working with CSharpMT5, you need to set up your development environment.</p>"},{"location":"Getting_Started/#step-1-install-net-8-sdk","title":"Step 1: Install .NET 8 SDK","text":"<p>CSharpMT5 requires .NET 8 SDK or higher.</p> <p>Download and Install:</p> <ul> <li>Official: .NET 8 SDK Download</li> <li>Choose the installer for your platform (Windows, macOS, Linux)</li> </ul> <p>Verify installation:</p> <pre><code>dotnet --version\n# Should show: 8.0.x or higher\n</code></pre>"},{"location":"Getting_Started/#step-2-install-a-code-editor","title":"Step 2: Install a Code Editor","text":"<p>Visual Studio Code (Recommended):</p> <ul> <li> <p>Download: VS Code</p> </li> <li> <p>Extensions to install:</p> </li> <li> <p>C# Dev Kit (official Microsoft extension)</p> </li> <li>C# (OmniSharp)</li> </ul> <p>Visual Studio 2022 (Alternative):</p> <ul> <li> <p>Download: Visual Studio 2022</p> </li> <li> <p>Choose \"Community\" edition (free)</p> </li> <li> <p>Select \".NET desktop development\" workload during installation</p> </li> </ul> <p>You can also use:</p> <ul> <li>JetBrains Rider</li> <li>Visual Studio for Mac</li> <li>Any text editor + command line</li> </ul>"},{"location":"Getting_Started/#step-3-clone-the-repository","title":"Step 3: Clone the Repository","text":"<p>Clone the CSharpMT5 project from GitHub:</p> <pre><code>git clone https://github.com/MetaRPC/CSharpMT5.git\ncd CSharpMT5\n</code></pre> <p>If you don't have Git installed:</p> <ul> <li>Download from git-scm.com</li> <li>Or download the project as ZIP from GitHub and extract it</li> </ul>"},{"location":"Getting_Started/#step-4-understanding-the-connection-flow","title":"Step 4: Understanding the Connection Flow","text":"<p>CSharpMT5 connects to MT5 terminal via gRPC gateway.</p> <p>Connection flow: <pre><code>CSharpMT5 \u2192 gRPC \u2192 mt5term Gateway \u2192 MT5 Terminal\n</code></pre></p> <p>What is mt5term Gateway?</p> <ul> <li>External gateway process that bridges CSharpMT5 to MT5 terminal</li> <li>Handles connection pooling and session management</li> <li>Gateway must be running before connecting</li> <li>You'll configure connection details in <code>Config\\appsettings.json</code></li> </ul>"},{"location":"Getting_Started/#configuration-file-appsettingsjson","title":"Configuration File: appsettings.json","text":"<p>Before running the project, you need to configure your connection settings in <code>Config\\appsettings.json</code>:</p> <pre><code>{\n  \"MT5\": {\n    \"User\": 591129415,\n    \"Password\": \"IpoHj17tYu67@\",\n    \"ServerName\": \"FxPro-MT5 Demo\",\n    \"Host\": \"mt5.mrpc.pro\",\n    \"Port\": 443,\n    \"GrpcServer\": \"https://mt5.mrpc.pro:443\",\n    \"BaseChartSymbol\": \"EURUSD\",\n    \"InstanceId\": null,\n    \"ConnectTimeoutSeconds\": 120\n  }\n}\n</code></pre> <p>Configuration parameters explained:</p> Parameter Description Example User Your MT5 account login number <code>591129415</code> Password Your MT5 account password (master password) <code>\"IpoHj17tYu67@\"</code> ServerName MT5 server name from your broker <code>\"FxPro-MT5 Demo\"</code> Host Gateway host address (provided by MetaRPC) <code>\"mt5.mrpc.pro\"</code> Port Gateway port number <code>443</code> (HTTPS) or <code>5555</code> GrpcServer Full gRPC server URL (combines Host + Port) <code>\"https://mt5.mrpc.pro:443\"</code> BaseChartSymbol Default trading symbol for examples <code>\"EURUSD\"</code> InstanceId Optional instance identifier (leave <code>null</code> for auto) <code>null</code> ConnectTimeoutSeconds Connection timeout in seconds <code>120</code> <p>Important notes:</p> <ul> <li>User, Password, ServerName - These are your MT5 account credentials</li> <li>Host, Port - Provided by MetaRPC team (gateway connection details)</li> <li>GrpcServer - Should match <code>https://Host:Port</code> format</li> <li>BaseChartSymbol - Change to your preferred trading symbol</li> <li>ConnectTimeoutSeconds - Increase if you have slow connection</li> </ul>"},{"location":"Getting_Started/#mt5-account-setup","title":"\ud83d\udccb MT5 Account Setup","text":"<p>If you don't have an MT5 demo account yet or need help creating one, please refer to our beginner's guide:</p> <p>\ud83d\udc49 MT5 for Beginners - Creating a Demo Account</p> <p>This guide covers:</p> <ul> <li>Downloading and installing MT5 terminal</li> <li>Creating a demo account step-by-step</li> <li>Understanding master and investor passwords</li> <li>Choosing a broker (optional)</li> </ul>"},{"location":"Getting_Started/#about-this-project","title":"\ud83c\udfaf About This Project","text":"<p>This project is a demonstration of the capabilities of our team's gateway for reproducing methods and functionalities. It's designed to help you build your own trading logic system in the future.</p> <p>We'll walk you through all the major aspects - from basic manual trading to a fully customizable algorithmic trading system. This journey will unlock the full potential of your acquired knowledge and fundamental understanding of trading and markets.</p> <p>What you'll learn:</p> <ul> <li>What gRPC methods do and how to use them directly</li> <li>How methods can be modified to fit your needs</li> <li>How to optimize your code for performance</li> <li>How to create convenient input/output systems</li> <li>How to monitor positions by symbols effectively</li> <li>How to build intelligent risk management systems</li> </ul> <p>All we ask from you is:</p> <p>A desire to learn, learn, and learn some more. In the end, this will lead to significant results and, most importantly, a solid foundation of knowledge in algorithmic trading.</p>"},{"location":"Getting_Started/#project-architecture-three-layer-system","title":"\ud83c\udfd7\ufe0f Project Architecture: Three-Layer System","text":"<p>The project consists of three interconnected files in the root directory, each building upon the previous one. Understanding this chain is key to mastering CSharpMT5.</p>"},{"location":"Getting_Started/#layer-1-mt5account-low-level-grpc-foundation","title":"Layer 1: MT5Account - Low-Level gRPC Foundation","text":"<p>What it is: Direct gRPC calls to the MT5 terminal - the absolute foundation of everything.</p> <p>\ud83d\udcd6 MT5Account Overview</p> <ul> <li>Raw protocol buffer messages and gRPC communication</li> <li>Maximum control and flexibility over every request/response</li> <li>All other layers use this internally</li> <li>Best for: Advanced users who need fine-grained control</li> </ul>"},{"location":"Getting_Started/#layer-2-mt5servicecs-convenient-wrappers","title":"Layer 2: MT5Service.cs - Convenient Wrappers","text":"<p>What it is: Wrapper methods that simplify working with MT5Account's gRPC calls.</p> <p>\ud83d\udcd6 MT5Service Overview</p> <ul> <li>Simplified error handling and response parsing</li> <li>Pre-configured common operations</li> <li>Easier to work with than raw gRPC</li> <li>Best for: Most common trading scenarios</li> </ul>"},{"location":"Getting_Started/#layer-3-mt5sugarcs-high-level-helpers","title":"Layer 3: MT5Sugar.cs - High-Level Helpers","text":"<p>What it is: Syntactic sugar and convenience methods for maximum productivity.</p> <p>\ud83d\udcd6 MT5Sugar API Overview</p> <ul> <li>Chainable operations and fluent interfaces</li> <li>Smart defaults and parameter inference</li> <li>Most intuitive and beginner-friendly</li> <li>Best for: Quick prototyping and simple strategies</li> </ul>"},{"location":"Getting_Started/#understanding-the-chain","title":"\ud83d\udcda Understanding the Chain","text":"<p>This three-file chain represents the evolution from low-level control to high-level convenience:</p> <pre><code>MT5Sugar.cs (easiest, highest abstraction)\n    \u2193 uses\nMT5Service.cs (convenient wrappers)\n    \u2193 uses\nMT5Account (raw gRPC, foundation)\n    \u2193 communicates with\nMT5 Terminal (via gateway)\n</code></pre> <p>Each Overview document includes:</p> <ul> <li>Detailed method descriptions with parameters</li> <li>Return types and error handling</li> <li>Usage examples and best practices</li> <li>Common patterns and pitfalls to avoid</li> </ul>"},{"location":"Getting_Started/#recommended-learning-paths","title":"\ud83c\udf93 Recommended Learning Paths","text":"<p>Path A: For Developers (Bottom-Up Approach)</p> <p>If you have programming experience and want to understand everything deeply:</p> <ol> <li>Start with MT5Account - Learn the gRPC foundation</li> <li>Move to MT5Service - Understand convenient wrappers</li> <li>Finish with MT5Sugar - Appreciate the high-level abstractions</li> </ol> <p>\u2705 This path gives you complete control and deep understanding.</p> <p>Path B: For Traders (Top-Down Approach)</p> <p>If you're new to trading automation and want to get results quickly:</p> <ol> <li>Start with MT5Sugar - Easy, intuitive methods to trade fast</li> <li>Move to MT5Service - Learn more advanced patterns when needed</li> <li>Deep dive into MT5Account - Understand the foundation for full control</li> </ol> <p>\u2705 This path gets you trading quickly while leaving room to grow.</p>"},{"location":"Getting_Started/#demonstration-examples","title":"\ud83d\udcc2 Demonstration Examples","text":"<p>You can explore demonstration files that showcase different aspects of the SDK. These files are organized by complexity level and are located in the <code>Examples/</code> folder.</p> <p>Each file includes internal code comments explaining what each operation does.</p>"},{"location":"Getting_Started/#exampleslowlevel","title":"Examples/LowLevel/","text":"<p>Low-level gRPC demonstrations using MT5Account:</p> <ul> <li> <p>Program.LowLevel.cs - Basic low-level gRPC operations</p> </li> <li> <p>Program.Streaming.cs - Real-time streaming (ticks, events)</p> </li> <li> <p>Program.Trading.cs - Trading operations at protocol level</p> </li> </ul>"},{"location":"Getting_Started/#examplesservices","title":"Examples/Services/","text":"<p>Wrapper layer demonstrations using MT5Service:</p> <ul> <li>Program.Service.cs - Common trading scenarios with wrappers</li> </ul>"},{"location":"Getting_Started/#examplessugar","title":"Examples/Sugar/","text":"<p>High-level convenience methods using MT5Sugar:</p> <ul> <li>Program.Sugar.cs - Basic Sugar API usage</li> <li>Program.Sugar.Monitor.cs - Position monitoring and management</li> <li>Program.Sugar.PendingOrders.cs - Pending orders with retry logic</li> <li>Program.Sugar.Scalper.cs - Quick scalping example</li> </ul>"},{"location":"Getting_Started/#examplesorchestrators","title":"Examples/Orchestrators/","text":"<p>Complete trading strategy implementations:</p> <ul> <li> <p>GridTradingOrchestrator.cs - Grid trading for range-bound markets</p> </li> <li> <p>SimpleScalpingOrchestrator.cs - Quick scalping with tight stops</p> </li> <li> <p>QuickHedgeOrchestrator.cs - Hedging strategy for high volatility</p> </li> <li> <p>NewsStraddleOrchestrator.cs - Breakout trading around news events</p> </li> <li> <p>PendingBreakoutOrchestrator.cs - Pending orders for breakouts</p> </li> </ul>"},{"location":"Getting_Started/#examplespresets","title":"Examples/Presets/","text":"<p>Multi-strategy adaptive systems:</p> <ul> <li>AdaptiveMarketModePreset.cs - Intelligent system that analyzes market conditions and selects optimal orchestrator</li> </ul>"},{"location":"Getting_Started/#examplesusercode","title":"Examples/UserCode/","text":"<p>Sandbox for your custom code:</p> <ul> <li>ProgramUserCode.cs - Template file for your own trading logic after learning the basics</li> </ul>"},{"location":"Getting_Started/#running-examples-with-programcs","title":"\ud83c\udfae Running Examples with Program.cs","text":"<p>All demonstration files are launched from <code>Program.cs</code>, which acts as the heart of the project. It allows you to run any example or orchestrator with simple commands.</p> <p>Program.cs features:</p> <ul> <li>Launches demonstration files by command</li> <li>Manages orchestrator lifecycle and configuration</li> <li>Handles user input and strategy parameters</li> </ul> <p>How to run examples:</p> <pre><code># Run Sugar API examples\ndotnet run market              # Market orders demonstration\ndotnet run positions           # Position monitoring\ndotnet run pendingorders       # Pending orders with retry\n\n# Run Orchestrators (strategies)\ndotnet run grid                # Grid trading orchestrator\ndotnet run scalping            # Scalping orchestrator\ndotnet run hedge               # Hedge orchestrator\n\n# Run Presets\ndotnet run preset              # Adaptive market mode preset\n</code></pre> <p>Note: You can find the complete list of available commands in the header comments of <code>Program.cs</code>.</p>"},{"location":"Getting_Started/#learning-advanced-features","title":"\ud83c\udfaf Learning Advanced Features","text":"<p>After you've mastered the three-layer chain (MT5Account \u2192 MT5Service \u2192 MT5Sugar), you can explore advanced features:</p>"},{"location":"Getting_Started/#orchestrators-trading-strategies","title":"Orchestrators (Trading Strategies)","text":"<p>Orchestrators are complete trading strategy implementations that show you how to:</p> <ul> <li>Structure automated trading logic</li> <li>Manage risk and position sizing</li> <li>Handle entry and exit automation</li> <li>Monitor performance in real-time</li> </ul> <p>\ud83d\udcd6 Orchestrators Overview</p>"},{"location":"Getting_Started/#presets-multi-strategy-systems","title":"Presets (Multi-Strategy Systems)","text":"<p>Presets combine multiple orchestrators with adaptive logic to create intelligent trading systems:</p> <p>\ud83d\udcd6 Adaptive Market Mode Preset</p>"},{"location":"Getting_Started/#building-your-own-system","title":"\ud83d\udee0\ufe0f Building Your Own System","text":"<p>After studying all the examples and understanding the architecture, you can start building your own trading system:</p> <p>Sandbox location: <code>Examples/UserCode/ProgramUserCode.cs</code></p> <p>This file is prepared as a starting template for your custom code. Before you start coding here, make sure you've studied:</p> <ol> <li>The three-layer API (MT5Account \u2192 MT5Service \u2192 MT5Sugar)</li> <li>At least one orchestrator to understand strategy structure</li> <li>Risk management patterns from the examples</li> </ol> <p>\ud83d\udcd6 User Code Sandbox Guide</p>"},{"location":"Getting_Started/#helpful-tools-and-references","title":"\ud83d\udd0d Helpful Tools and References","text":""},{"location":"Getting_Started/#protobuf-inspector","title":"Protobuf Inspector","text":"<p>If you're having trouble finding properties or don't want to dig through documentation:</p> <p>Tool location: <code>Examples/Helpers/ProtobufInspector.cs</code></p> <p>\ud83d\udcd6 Protobuf Inspector Guide</p> <p>This tool helps you explore protobuf message structures and available properties interactively.</p>"},{"location":"Getting_Started/#sync-vs-async-methods","title":"Sync vs Async Methods","text":"<p>All methods in MT5Account are available in both synchronous and asynchronous versions. Learn when to use each:</p> <p>\ud83d\udcd6 Sync vs Async Guide</p>"},{"location":"Getting_Started/#grpc-stream-management","title":"gRPC Stream Management","text":"<p>If you're working with real-time streaming (ticks, events):</p> <p>\ud83d\udcd6 gRPC Stream Management</p>"},{"location":"Getting_Started/#return-codes-reference","title":"Return Codes Reference","text":"<p>Understanding what return codes mean when trading operations execute:</p> <p>\ud83d\udcd6 Return Codes Reference</p>"},{"location":"Getting_Started/#support-and-community","title":"\ud83d\udcac Support and Community","text":"<p>If you encounter issues with the code or have questions about the gateway:</p> <p>Support Repository: https://github.com/Moongoord/MetaRPC-Gateway-Support</p> <p>This is a discussion repository where you can:</p> <ul> <li>Ask questions about the gateway</li> <li>Report issues</li> <li>Share your experiences</li> <li>Get help from the community</li> </ul> <p>Note: This repository is currently in development and will be available to everyone soon.</p>"},{"location":"Getting_Started/#conclusion","title":"\ud83c\udf93 Conclusion","text":"<p>The MetaRPC team is committed to creating favorable conditions for learning the fundamental principles of trading and building algorithmic trading systems.</p> <p>We believe that with dedication and a desire to learn, you can master everything from low-level protocol communication to sophisticated multi-strategy trading systems.</p> <p>Your journey starts here:</p> <ol> <li>Set up your environment (above)</li> <li>Create or configure your MT5 demo account (MT5 for Beginners)</li> <li>Choose your learning path (bottom-up or top-down)</li> <li>Run your first example: <code>dotnet run market</code></li> <li>Study the code, experiment, and build</li> </ol> <p>Good luck on your algorithmic trading journey!</p> <p>\"The foundation of success in algorithmic trading is not just understanding markets, but understanding the code that interacts with them. Master both, and you'll have unlimited possibilities.\"</p> <p>\u2014 MetaRPC Team</p> <p>Next steps:</p> <ul> <li> <p>\ud83d\udcd6 MT5 for Beginners - If you need MT5 account setup.</p> </li> <li> <p>\ud83d\udcd6 MT5Account Overview - Start learning the foundation.</p> </li> <li> <p>\ud83d\udcd6 MT5Sugar Overview - Start trading quickly.</p> </li> <li> <p>\ud83c\udfaf Orchestrators Overview - Learn strategy implementation.</p> </li> </ul>"},{"location":"Glossary/","title":"CSharpMT5 Glossary","text":"<p>Project-specific terms and concepts. This glossary covers CSharpMT5 architecture, components, and trading automation terminology used throughout the codebase.</p>"},{"location":"Glossary/#architecture-terms","title":"\ud83c\udfd7\ufe0f Architecture Terms","text":""},{"location":"Glossary/#three-layer-architecture","title":"Three-Layer Architecture","text":"<p>The core design pattern of CSharpMT5 with three abstraction layers:</p> <ul> <li>Layer 1 (MT5Account): Low-level gRPC communication with MT5 terminal</li> <li>Layer 2 (MT5Service): Wrapper methods with simplified signatures</li> <li>Layer 3 (MT5Sugar): High-level convenience methods with auto-normalization</li> </ul> <p>Usage: Start with Layer 3 (MT5Sugar), drop down only when needed.</p>"},{"location":"Glossary/#mt5account","title":"MT5Account","text":"<p>Layer 1 - Low-level API</p> <p>The foundational layer providing direct access to MT5 terminal via gRPC protocol.</p> <p>Key characteristics:</p> <ul> <li>Raw gRPC calls to MT5 terminal</li> <li>Built-in connection resilience with automatic reconnection</li> <li>Works with proto-generated Request/Response objects</li> <li>Full control, maximum complexity</li> <li>Async/Sync method variants</li> </ul> <p>When to use: Custom integrations, proto-level control needed, building custom wrappers.</p> <p>Location: <code>package/Helpers/MT5Account.cs</code> (NuGet package source)</p> <p>Documentation: MT5Account.Master.Overview.md</p>"},{"location":"Glossary/#mt5service","title":"MT5Service","text":"<p>Layer 2 - Wrapper API</p> <p>Middle layer providing simplified method signatures without proto complexity.</p> <p>Key characteristics:</p> <ul> <li>Direct data returns (no proto objects in signatures)</li> <li>Type conversions (proto \u2192 C# primitives/objects)</li> <li>Simplified method names</li> <li>No auto-normalization (you control precision)</li> <li>Extension methods for convenience</li> </ul> <p>When to use: Need wrappers but not auto-normalization, building custom strategies.</p> <p>Location: <code>MT5Service.cs</code></p> <p>Documentation: MT5Service.Overview.md</p>"},{"location":"Glossary/#mt5sugar","title":"MT5Sugar","text":"<p>Layer 3 - Convenience API \u2b50</p> <p>Highest-level API with ~50 convenience methods for common trading operations.</p> <p>Key characteristics:</p> <ul> <li>Auto-normalization of volumes and prices</li> <li>Risk management helpers</li> <li>Batch operations (CloseAll, CancelAll)</li> <li>Points-based helpers (BuyLimitPoints, SellStopPoints, etc.)</li> <li>Snapshots (GetAccountSnapshot, GetSymbolSnapshot)</li> <li>Simplest API, handles edge cases</li> </ul> <p>When to use: 95% of cases - easiest starting point.</p> <p>Location: <code>MT5Sugar.cs</code></p> <p>Documentation: MT5Sugar documentation</p>"},{"location":"Glossary/#strategy-components","title":"\ud83c\udfaf Strategy Components","text":""},{"location":"Glossary/#orchestrator","title":"Orchestrator","text":"<p>Pre-built trading strategy implementation that automates complete trading workflow.</p> <p>Key characteristics:</p> <ul> <li>Single strategy focus (grid trading, scalping, hedging, etc.)</li> <li>Risk-based position sizing where applicable</li> <li>Position monitoring loops with progress bars</li> <li>Automatic exits and cleanup on Ctrl+C</li> <li>Performance tracking (balance, equity, P/L)</li> <li>Configurable parameters via properties</li> </ul> <p>Examples:</p> <ul> <li><code>GridTradingOrchestrator</code> - Grid trading for range-bound markets</li> <li><code>SimpleScalpingOrchestrator</code> - Quick scalping with tight stops</li> <li><code>QuickHedgeOrchestrator</code> - Hedging strategy for high volatility</li> <li><code>NewsStraddleOrchestrator</code> - Breakout trading around news events</li> <li><code>PendingBreakoutOrchestrator</code> - Pending orders for breakout trading</li> </ul> <p>Location: <code>Examples\\Orchestrators\\</code></p> <p>Documentation: Strategies.Master.Overview.md</p> <p>Command: <code>dotnet run &lt;orchestrator-name&gt;</code> (e.g., <code>dotnet run grid</code>)</p>"},{"location":"Glossary/#preset","title":"Preset","text":"<p>Multi-orchestrator combination with adaptive decision-making logic based on market analysis.</p> <p>Key characteristics:</p> <ul> <li>Combines multiple orchestrators (2-5 strategies)</li> <li>Adaptive logic based on market conditions (volatility, time, news)</li> <li>Multi-phase trading sessions</li> <li>Performance tracking across phases</li> <li>Automatic strategy selection and execution</li> </ul> <p>Examples:</p> <ul> <li><code>AdaptiveMarketModePreset</code> - Intelligent system that analyzes market and selects optimal orchestrator</li> </ul> <p>Location: <code>Examples\\Presets\\</code></p> <p>Documentation: AdaptiveMarketModePreset.md</p> <p>Command: <code>dotnet run preset</code></p>"},{"location":"Glossary/#technical-concepts","title":"\ud83d\udd27 Technical Concepts","text":""},{"location":"Glossary/#auto-normalization","title":"Auto-Normalization","text":"<p>Automatic adjustment of trading parameters to broker requirements.</p> <p>What gets normalized:</p> <ul> <li>Volumes: Rounded to broker's volume step (e.g., 0.01 lots)</li> <li>Prices: Rounded to symbol's tick size/digits (e.g., 5 decimal places for EURUSD)</li> <li>Stop Loss / Take Profit: Adjusted to symbol precision</li> </ul> <p>Where: MT5Sugar layer only (MT5Service doesn't auto-normalize)</p> <p>Example: <pre><code>// You pass: volume=0.0234, price=1.09876543\n// Sugar normalizes to: volume=0.02, price=1.09877\nawait sugar.BuyMarket(\"EURUSD\", 0.0234, sl: 1.09876543, tp: 1.10000);\n</code></pre></p> <p>Methods:</p> <ul> <li><code>NormalizePriceAsync(symbol, price)</code> - Normalize price to symbol digits</li> <li><code>NormalizeVolumeAsync(symbol, volume)</code> - Normalize volume to broker step</li> </ul>"},{"location":"Glossary/#risk-based-volume-calculation","title":"Risk-Based Volume Calculation","text":"<p>Position sizing based on dollar risk rather than fixed lot size.</p> <p>Formula: <code>volume = riskAmount / (stopLossPoints \u00d7 pointValue)</code></p> <p>Parameters:</p> <ul> <li><code>riskAmount</code> - Dollar amount willing to risk (e.g., $50)</li> <li><code>stopLossPoints</code> - Distance to SL in points (e.g., 50 points)</li> <li>Result: Lot size that risks exactly $50 if SL hit</li> </ul> <p>Methods (MT5Sugar): <pre><code>// Calculate volume for given risk\ndouble volume = await sugar.CalculateVolume(symbol, slPoints, riskAmount);\n\n// Buy with risk-based sizing\nvar result = await sugar.BuyByRisk(symbol, slPoints, riskAmount, tpPrice);\n\n// Sell with risk-based sizing\nvar result = await sugar.SellByRisk(symbol, slPoints, riskAmount, tpPrice);\n</code></pre></p> <p>Used in: <code>SimpleScalpingOrchestrator</code></p>"},{"location":"Glossary/#points-vs-pips","title":"Points vs Pips","text":"<p>Point: Smallest price movement for a symbol (1 tick).</p> <p>Pip: Traditional forex unit (0.0001 for most pairs).</p> <p>Relationship:</p> <ul> <li>5-digit brokers: 1 pip = 10 points (EURUSD: 1.10000 \u2192 1.10010 = 1 pip)</li> <li>3-digit brokers: 1 pip = 1 point (USDJPY: 110.00 \u2192 110.01 = 1 pip)</li> </ul> <p>In CSharpMT5: All APIs use points for consistency.</p> <p>Conversion: <pre><code>double point = await service.GetPointAsync(\"EURUSD\");  // 0.00001\ndouble pips = points / 10.0;  // For 5-digit pairs\n</code></pre></p> <p>Why points? Universal across all instruments (forex, metals, indices, crypto).</p>"},{"location":"Glossary/#points-based-methods","title":"Points-Based Methods","text":"<p>Convenience methods that calculate prices using point offsets from current market price.</p> <p>Methods:</p> <ul> <li><code>BuyLimitPoints(symbol, volume, pointsOffset, slPoints, tpPoints)</code> - Buy Limit below Ask</li> <li><code>SellLimitPoints(symbol, volume, pointsOffset, slPoints, tpPoints)</code> - Sell Limit above Bid</li> <li><code>BuyStopPoints(symbol, volume, pointsOffset, slPoints, tpPoints)</code> - Buy Stop above Ask</li> <li><code>SellStopPoints(symbol, volume, pointsOffset, slPoints, tpPoints)</code> - Sell Stop below Bid</li> </ul> <p>Example: <pre><code>// Place Buy Limit 20 points below current Ask\n// with 50-point SL and 30-point TP\nvar result = await sugar.BuyLimitPoints(\"EURUSD\", 0.01,\n    priceOffsetPoints: 20,\n    slPoints: 50,\n    tpPoints: 30);\n</code></pre></p> <p>Benefits:</p> <ul> <li>No manual price calculations needed</li> <li>Automatic normalization</li> <li>Clearer intent in code</li> <li>Less error-prone than absolute prices</li> </ul> <p>Used in: All orchestrators, pending order operations</p>"},{"location":"Glossary/#trailing-stop","title":"Trailing Stop","text":"<p>Dynamic Stop Loss that follows price in profit direction.</p> <p>How it works:</p> <ol> <li>Position opens with initial SL</li> <li>When profit reaches threshold (e.g., +40 points)</li> <li>SL moves to breakeven or better</li> <li>SL continues to trail price at fixed distance</li> <li>Locks in profits as price moves favorably</li> </ol> <p>Implementation: <pre><code>// In monitoring loop\nif (currentProfit &gt;= trailingThreshold)\n{\n    double newSL = currentPrice - trailingDistance * point;\n    if (newSL &gt; currentSL)\n    {\n        await service.ModifyPosition(ticket, newSL, tp);\n    }\n}\n</code></pre></p> <p>Used in: Custom trend-following strategies</p>"},{"location":"Glossary/#hedging","title":"Hedging","text":"<p>Opening opposite position to lock in current profit/loss level.</p> <p>How it works:</p> <ol> <li>Primary position opened (e.g., BUY EURUSD 0.1 lots)</li> <li>Price moves against you (-50 points)</li> <li>Hedge triggered: SELL EURUSD 0.1 lots</li> <li>Net position = 0 (locked loss at -50 points level)</li> </ol> <p>Purpose:</p> <ul> <li>Lock losses instead of closing at stop loss</li> <li>Protect position during volatility/news</li> <li>Wait for better exit opportunity</li> </ul> <p>Used in: <code>QuickHedgeOrchestrator</code></p> <p>\u26a0\ufe0f Note: Not all brokers/regulations allow hedging. US brokers typically don't support hedging.</p>"},{"location":"Glossary/#pending-order","title":"Pending Order","text":"<p>Order that executes automatically when price reaches specified level.</p> <p>Types:</p> <ul> <li>BUY LIMIT: Buy at price BELOW current (expecting pullback then up)</li> <li>SELL LIMIT: Sell at price ABOVE current (expecting rally then down)</li> <li>BUY STOP: Buy at price ABOVE current (breakout up)</li> <li>SELL STOP: Sell at price BELOW current (breakout down)</li> </ul> <p>Methods (absolute price): <pre><code>await service.BuyLimit(symbol, volume, price, sl, tp);\nawait service.SellLimit(symbol, volume, price, sl, tp);\n</code></pre></p> <p>Methods (points-based): <pre><code>await sugar.BuyLimitPoints(symbol, volume, pointsOffset, slPoints, tpPoints);\nawait sugar.SellStopPoints(symbol, volume, pointsOffset, slPoints, tpPoints);\n</code></pre></p> <p>Used in: <code>GridTradingOrchestrator</code>, <code>PendingBreakoutOrchestrator</code>, <code>NewsStraddleOrchestrator</code></p>"},{"location":"Glossary/#retry-logic-with-exponential-backoff","title":"Retry Logic with Exponential Backoff","text":"<p>Automatic retry mechanism for handling intermittent connection errors.</p> <p>How it works:</p> <ol> <li>Operation fails with connection error (TRADE_RETCODE_CONNECTION = 10031)</li> <li>Wait 1 second, retry</li> <li>If fails again, wait 2 seconds, retry</li> <li>If fails again, wait 4 seconds, retry</li> <li>After 3 attempts, throw exception</li> </ol> <p>Implementation: <pre><code>private static async Task&lt;T&gt; PlaceOrderWithRetry&lt;T&gt;(\n    Func&lt;Task&lt;T&gt;&gt; orderFunc,\n    string orderName,\n    int maxRetries = 3)\n{\n    int delayMs = 1000;\n    for (int attempt = 1; attempt &lt;= maxRetries; attempt++)\n    {\n        var result = await orderFunc();\n        if (result.RetCode == 10031 &amp;&amp; attempt &lt; maxRetries)\n        {\n            Console.WriteLine($\"\u26a0 Retry in {delayMs}ms...\");\n            await Task.Delay(delayMs);\n            delayMs *= 2;  // Exponential backoff\n            continue;\n        }\n        return result;\n    }\n}\n</code></pre></p> <p>Used in: <code>Program.Sugar.PendingOrders.cs</code> (demo file with retry logic)</p> <p>Benefits:</p> <ul> <li>Handles temporary network issues</li> <li>Reduces failed operations</li> <li>Prevents cascading failures</li> </ul>"},{"location":"Glossary/#grpc-protocol-terms","title":"\ud83d\udd0c gRPC &amp; Protocol Terms","text":""},{"location":"Glossary/#grpc","title":"gRPC","text":"<p>High-performance RPC (Remote Procedure Call) framework using HTTP/2.</p> <p>In CSharpMT5:</p> <ul> <li>MT5Account layer sends gRPC requests to MT5 terminal</li> <li>Terminal runs gRPC server (configured via gateway or terminal plugin)</li> <li>Request/Response pattern for all operations</li> <li>Async/await throughout the stack</li> </ul> <p>Connection setup: <pre><code>var config = ConnectionHelper.BuildConfiguration();\nvar account = await ConnectionHelper.CreateAndConnectAccountAsync(config);\n</code></pre></p> <p>Configuration: <code>Config\\appsettings.json</code></p>"},{"location":"Glossary/#mt5-gateway-mt5term","title":"MT5 Gateway (mt5term)","text":"<p>External gateway process that bridges CSharpMT5 to MT5 terminal via gRPC.</p> <p>Key points:</p> <ul> <li>User connects through gateway, not directly to terminal</li> <li>Gateway handles connection pooling and session management</li> <li>No need to launch MT5 terminal separately when using gateway</li> <li>Requires gateway to be running before connecting</li> </ul> <p>Connection flow: <pre><code>CSharpMT5 \u2192 gRPC \u2192 mt5term Gateway \u2192 MT5 Terminal\n</code></pre></p> <p>Rate limiting: Gateway may limit request frequency to prevent broker throttling.</p>"},{"location":"Glossary/#asyncawait-pattern","title":"Async/Await Pattern","text":"<p>C# asynchronous programming pattern used throughout CSharpMT5.</p> <p>All methods have two versions: <pre><code>// Async version (recommended - 99% of cases)\nvar result = await account.OrderSendAsync(request);\n\n// Sync version (legacy/specific scenarios)\nvar result = account.OrderSend(request);\n</code></pre></p> <p>Why async? - Non-blocking I/O for gRPC calls - Better performance with multiple operations - Scalable for high-frequency trading</p> <p>Documentation: Sync_vs_Async.md</p>"},{"location":"Glossary/#return-codes","title":"Return Codes","text":"<p>Proto return codes indicating operation success/failure.</p> <p>Common codes:</p> <ul> <li>10009 = Success (TRADE_RETCODE_DONE)</li> <li>10004 = Requote</li> <li>10006 = Request rejected</li> <li>10013 = Invalid request</li> <li>10014 = Invalid volume</li> <li>10015 = Invalid price</li> <li>10016 = Invalid stops</li> <li>10018 = Market closed</li> <li>10019 = Not enough money</li> <li>10031 = No connection with trade server</li> </ul> <p>Always check <code>ReturnedCode</code> or <code>RetCode</code> in trading operations.</p> <p>Documentation: ReturnCodes_Reference_EN.md</p>"},{"location":"Glossary/#trading-terms-project-context","title":"\ud83c\udf93 Trading Terms (Project Context)","text":""},{"location":"Glossary/#risk-amount","title":"Risk Amount","text":"<p>Dollar amount willing to lose if Stop Loss hit.</p> <p>Example: Risk $50 per trade means if SL triggered, you lose exactly $50.</p> <p>Used in:</p> <ul> <li><code>SimpleScalpingOrchestrator</code> for position sizing</li> <li><code>CalculateVolume()</code>, <code>BuyByRisk()</code>, <code>SellByRisk()</code> methods</li> </ul>"},{"location":"Glossary/#breakeven","title":"Breakeven","text":"<p>Moving Stop Loss to entry price to eliminate risk.</p> <p>Example:</p> <ul> <li>Entry: BUY at 1.10000</li> <li>Price rises to 1.10050 (+50 points profit)</li> <li>Move SL from 1.09950 to 1.10000 (breakeven)</li> <li>Now risk-free: worst case = break even</li> </ul> <p>Implementation: <pre><code>if (currentProfit &gt;= breakevenThreshold)\n{\n    await service.ModifyPosition(ticket, entryPrice, tp);\n}\n</code></pre></p>"},{"location":"Glossary/#grid-trading","title":"Grid Trading","text":"<p>Strategy that places multiple pending orders at equal intervals above and below current price.</p> <p>How it works:</p> <ol> <li>Place Buy Limit orders below current price (e.g., every 20 points)</li> <li>Place Sell Limit orders above current price (e.g., every 20 points)</li> <li>When price oscillates, orders trigger and close with TP</li> <li>Works best in range-bound markets</li> </ol> <p>Example: <pre><code>Price: 1.10000\nBuy Limits:  1.09980 (-20 pts), 1.09960 (-40 pts), 1.09940 (-60 pts)\nSell Limits: 1.10020 (+20 pts), 1.10040 (+40 pts), 1.10060 (+60 pts)\n</code></pre></p> <p>Used in: <code>GridTradingOrchestrator</code></p> <p>\u26a0\ufe0f Risk: High volatility can trigger many orders, increasing exposure.</p>"},{"location":"Glossary/#scalping","title":"Scalping","text":"<p>Quick trading strategy with small profits (5-25 points) and tight stops (10-20 points).</p> <p>Characteristics:</p> <ul> <li>Very short hold times (seconds to minutes)</li> <li>High win rate, small profit per trade</li> <li>Risk:Reward typically 1:1 to 1:2</li> <li>Requires low spreads</li> </ul> <p>Used in: <code>SimpleScalpingOrchestrator</code></p>"},{"location":"Glossary/#news-trading-straddle","title":"News Trading (Straddle)","text":"<p>Placing orders on both sides of price before high-impact news events.</p> <p>How it works:</p> <ol> <li>Before news: Place Buy Stop above + Sell Stop below</li> <li>News released: Price breaks out in one direction</li> <li>One order triggers, cancel the other</li> <li>Capture volatility spike</li> </ol> <p>Example: <pre><code>Current price: 1.10000\nBuy Stop:  1.10030 (+30 points)\nSell Stop: 1.09970 (-30 points)\nNews \u2192 Price spikes to 1.10050 \u2192 Buy Stop triggers \u2192 Cancel Sell Stop\n</code></pre></p> <p>Used in: <code>NewsStraddleOrchestrator</code></p> <p>\u26a0\ufe0f Risk: Slippage during news can cause both orders to trigger.</p>"},{"location":"Glossary/#volume-limits","title":"Volume Limits","text":"<p>Broker-specific constraints on position sizing.</p> <p>Retrieved via: <pre><code>(double minVol, double maxVol, double stepVol) =\n    await service.GetVolumeLimitsAsync(symbol);\n\n// Example: minVol=0.01, maxVol=100.0, stepVol=0.01\n</code></pre></p> <p>Used for: Auto-normalization in MT5Sugar.</p> <p>Validation: <pre><code>if (volume &lt; minVol)\n    volume = minVol;\nif (volume &gt; maxVol)\n    volume = maxVol;\n\n// Round to step\nvolume = Math.Round(volume / stepVol) * stepVol;\n</code></pre></p>"},{"location":"Glossary/#file-organization-terms","title":"\ud83d\udcc1 File Organization Terms","text":""},{"location":"Glossary/#examples","title":"Examples","text":"<p>Runnable demonstration code showing API usage patterns at different layers.</p> <p>Structure:</p> <ul> <li><code>Examples\\LowLevel\\</code> - MT5Account examples (proto level)</li> <li><code>Examples\\Service\\</code> - MT5Service examples (wrapper level)</li> <li><code>Examples\\Sugar\\</code> - MT5Sugar examples (convenience level)</li> <li><code>Examples\\Orchestrators\\</code> - Strategy implementations</li> <li><code>Examples\\Presets\\</code> - Multi-strategy systems</li> </ul> <p>How to run: <pre><code>dotnet run positions       # Service layer example\ndotnet run pendingorders   # Sugar layer example\ndotnet run grid            # Grid trading orchestrator\ndotnet run preset          # Adaptive preset\n</code></pre></p> <p>Location: <code>Examples\\</code></p>"},{"location":"Glossary/#programcs","title":"Program.cs","text":"<p>Main entry point that routes <code>dotnet run</code> commands to appropriate examples/orchestrators/presets.</p> <p>Key characteristics:</p> <ul> <li>Single entry point for all runnable code</li> <li>Command routing based on aliases (grid, scalping, preset, etc.)</li> <li>Provides helpful error messages for unknown commands</li> <li>Handles Ctrl+C gracefully for orchestrators</li> </ul> <p>How it works: <pre><code>dotnet run grid\n    \u2193\nProgram.cs Main(args)\n    \u2193\nRouteCommand(\"grid\")\n    \u2193\nExamples.Orchestrators.GridTradingOrchestrator.RunAsync()\n</code></pre></p> <p>Location: <code>Program.cs</code></p> <p>Available commands: See header comment in <code>Program.cs</code> for complete list.</p>"},{"location":"Glossary/#connectionhelper","title":"ConnectionHelper","text":"<p>Utility class for building MT5 connection configuration and establishing connections.</p> <p>Methods: <pre><code>// Build configuration from appsettings.json\nvar config = ConnectionHelper.BuildConfiguration();\n\n// Create and connect to MT5\nvar account = await ConnectionHelper.CreateAndConnectAccountAsync(config);\n</code></pre></p> <p>What it does:</p> <ul> <li>Reads <code>Config\\appsettings.json</code></li> <li>Validates connection settings</li> <li>Creates MT5Account instance</li> <li>Establishes gRPC connection</li> <li>Returns connected account</li> </ul> <p>Location: <code>Examples\\Helpers\\ConnectionHelper.cs</code></p>"},{"location":"Glossary/#progressbarhelper","title":"ProgressBarHelper","text":"<p>Visual progress bar for orchestrators during waiting periods.</p> <p>Features:</p> <ul> <li>Shows countdown with time remaining</li> <li>Displays progress bar ([=====&gt;    ])</li> <li>Clears line to prevent duplication</li> <li>Works well with terminal scrolling</li> </ul> <p>Usage: <pre><code>await ProgressBarHelper.ShowProgressBar(\n    durationSeconds: 60,\n    message: \"Monitoring positions\",\n    cancellationToken: cts.Token\n);\n</code></pre></p> <p>Location: <code>Examples\\Helpers\\ProgressBarHelper.cs</code></p> <p>Used in: All orchestrators for visual feedback during runtime.</p>"},{"location":"Glossary/#configuration-terms","title":"\u2699\ufe0f Configuration Terms","text":""},{"location":"Glossary/#appsettingsjson","title":"appsettings.json","text":"<p>Central configuration file for MT5 connection settings.</p> <p>Key settings:</p> <ul> <li><code>Host</code> - MT5 terminal/gateway host (usually localhost)</li> <li><code>Port</code> - gRPC server port (e.g., 5555)</li> <li><code>Login</code> - MT5 account number</li> <li><code>Password</code> - MT5 account password</li> <li><code>Symbol</code> - Default trading symbol (e.g., \"EURUSD\")</li> <li><code>UseSSL</code> - SSL/TLS encryption (true/false)</li> <li><code>TimeoutSeconds</code> - Request timeout (default 30)</li> </ul> <p>Location: <code>Config\\appsettings.json</code></p> <p>\u26a0\ufe0f Security: Never commit real credentials to git (add to .gitignore).</p> <p>Example: <pre><code>{\n  \"MT5Connection\": {\n    \"Host\": \"localhost\",\n    \"Port\": 5555,\n    \"Login\": 12345678,\n    \"Password\": \"your_password\",\n    \"Symbol\": \"EURUSD\",\n    \"UseSSL\": false,\n    \"TimeoutSeconds\": 30\n  }\n}\n</code></pre></p>"},{"location":"Glossary/#csproj-file","title":".csproj File","text":"<p>C# project file containing build configuration, dependencies, and metadata.</p> <p>Key elements:</p> <ul> <li><code>&lt;TargetFramework&gt;net8.0&lt;/TargetFramework&gt;</code> - .NET version</li> <li><code>&lt;PackageReference&gt;</code> - NuGet package dependencies (Grpc.Net.Client, etc.)</li> <li><code>&lt;PropertyGroup&gt;</code> - Compiler settings</li> </ul> <p>Location: <code>mt5_term_api.csproj</code></p> <p>Build commands: <pre><code>dotnet build        # Compile project\ndotnet clean        # Clean build artifacts\ndotnet restore      # Restore NuGet packages\n</code></pre></p>"},{"location":"Glossary/#bin-and-obj-folders","title":"bin/ and obj/ Folders","text":"<p>Build output directories containing compiled files.</p> <p>Contents:</p> <ul> <li><code>bin/</code> - Final compiled assemblies (.dll, .exe)</li> <li><code>obj/</code> - Intermediate build files</li> </ul> <p>Purpose:</p> <ul> <li>Auto-generated during <code>dotnet build</code> or <code>dotnet run</code></li> <li>Can be safely deleted for clean rebuild</li> <li>Excluded from git via .gitignore</li> </ul> <p>Troubleshooting: <pre><code># If you get weird compilation errors:\ndotnet clean        # Clean build outputs\ndotnet build        # Rebuild from scratch\n</code></pre></p>"},{"location":"Glossary/#cross-component-terms","title":"\ud83d\udd17 Cross-Component Terms","text":""},{"location":"Glossary/#snapshot","title":"Snapshot","text":"<p>Complete state capture at a point in time.</p> <p>Types:</p> <ul> <li>Account Snapshot: Balance, equity, margin, profit, positions count, leverage</li> <li>Symbol Snapshot: Bid, ask, spread, point size, digits, volume limits, tick data</li> </ul> <p>Methods (MT5Sugar): <pre><code>var accountSnap = await sugar.GetAccountSnapshot();\nConsole.WriteLine($\"Balance: {accountSnap.Summary.AccountBalance}\");\nConsole.WriteLine($\"Equity: {accountSnap.Summary.AccountEquity}\");\n\nvar symbolSnap = await sugar.GetSymbolSnapshot(\"EURUSD\");\nConsole.WriteLine($\"Bid: {symbolSnap.Tick.Bid}\");\nConsole.WriteLine($\"Ask: {symbolSnap.Tick.Ask}\");\nConsole.WriteLine($\"Spread: {(symbolSnap.Tick.Ask - symbolSnap.Tick.Bid) / symbolSnap.Point} points\");\n</code></pre></p> <p>Use case: Dashboards, logging, performance tracking, orchestrator monitoring.</p>"},{"location":"Glossary/#batch-operations","title":"Batch Operations","text":"<p>Execute action on multiple positions/orders at once.</p> <p>Methods (MT5Sugar): <pre><code>// Close positions\nint closed = await sugar.CloseAll();                    // All positions\nint closedBuy = await sugar.CloseAllBuy();              // Only BUY\nint closedSell = await sugar.CloseAllSell();            // Only SELL\nint closedSymbol = await sugar.CloseAllPositions(symbol); // By symbol\n\n// Cancel orders\nint cancelled = await sugar.CancelAll();                // All pending orders\nint cancelledSymbol = await sugar.CancelAll(symbol);    // By symbol\n</code></pre></p> <p>Use case: Emergency exits, end-of-session cleanup, strategy resets.</p> <p>Used in: All orchestrators for cleanup on exit.</p>"},{"location":"Glossary/#history-queries","title":"History Queries","text":"<p>Retrieve past orders and positions for analysis.</p> <p>Methods (MT5Account): <pre><code>// Get order history with pagination\nvar orders = await account.OrderHistoryAsync(\n    fromDate,\n    toDate,\n    page,\n    itemsPerPage\n);\n\n// Get position history\nvar positions = await account.PositionsHistoryAsync(\n    fromDate,\n    toDate,\n    page,\n    itemsPerPage\n);\n</code></pre></p> <p>Use case: Performance analysis, trade logs, strategy backtesting validation.</p>"},{"location":"Glossary/#project-philosophy-terms","title":"\ud83c\udfaf Project Philosophy Terms","text":""},{"location":"Glossary/#progressive-complexity","title":"Progressive Complexity","text":"<p>Design principle: start simple, access complexity only when needed.</p> <p>In CSharpMT5:</p> <ul> <li>Start with MT5Sugar (simplest)</li> <li>Drop to MT5Service if need wrappers without auto-normalization</li> <li>Drop to MT5Account for proto-level control</li> </ul> <p>User journey: Sugar \u2192 Service \u2192 Account (as needed).</p> <p>Benefits:</p> <ul> <li>Lower learning curve</li> <li>Faster development for common tasks</li> <li>Full power available when needed</li> </ul>"},{"location":"Glossary/#educational-project","title":"Educational Project","text":"<p>CSharpMT5 orchestrators and presets are learning materials and API demonstrations, NOT production trading systems.</p> <p>Implications:</p> <ul> <li>\u2705 Study code and patterns</li> <li>\u2705 Modify for your needs</li> <li>\u2705 Test on demo accounts</li> <li>\u2705 Use as templates for building your strategies</li> <li>\u274c Don't use as-is with real money</li> <li>\u274c Don't expect production-grade risk management</li> <li>\u274c Don't expect proper error handling for all edge cases</li> </ul> <p>See: Disclaimer in Strategies.Master.Overview.md</p>"},{"location":"Glossary/#demo-account-first","title":"Demo Account First","text":"<p>ALWAYS test on demo accounts before live trading.</p> <p>Why:</p> <ul> <li>No financial risk</li> <li>Test strategies without pressure</li> <li>Validate code works with your broker</li> <li>Practice execution and monitoring</li> <li>Build confidence</li> </ul> <p>How to get demo account:</p> <ol> <li>Open MT5 terminal</li> <li>File \u2192 Open Account</li> <li>Select broker \u2192 Demo Account</li> <li>Fill registration form</li> <li>Note credentials for appsettings.json</li> </ol>"},{"location":"Glossary/#see-also","title":"\ud83d\udcda See Also","text":"<ul> <li>Strategies.Master.Overview.md - All orchestrators and presets</li> <li>MT5Account.Master.Overview.md - Low-level API reference</li> <li>GRPC_STREAM_MANAGEMENT.md - Streaming subscriptions guide</li> <li>ReturnCodes_Reference_EN.md - Complete return codes reference</li> <li>UserCode_Sandbox_Guide.md - How to write custom strategies</li> </ul>"},{"location":"Glossary/#quick-term-lookup","title":"\ud83d\udca1 Quick Term Lookup","text":"Term Category Definition MT5Account Architecture Layer 1 - Low-level gRPC API MT5Service Architecture Layer 2 - Wrapper methods MT5Sugar Architecture Layer 3 - Convenience API \u2b50 Orchestrator Strategy Single-strategy implementation Preset Strategy Multi-orchestrator adaptive system Auto-normalization Technical Automatic parameter adjustment to broker rules Risk-based sizing Trading Position size from dollar risk amount Point Trading Smallest price movement (1 tick) Pip Trading Traditional forex unit (0.0001 for most pairs) Points-based methods Technical Methods using point offsets (BuyLimitPoints, etc.) Trailing stop Trading SL that follows profit Hedging Trading Opposite position to lock P/L Pending order Trading Order at future price level Grid trading Strategy Orders at regular intervals above/below price Scalping Strategy Quick trades with small profits News trading Strategy Straddle orders before high-impact news gRPC Technical RPC framework for communication mt5term Technical Gateway process bridging to MT5 terminal Async/await Technical C# asynchronous programming pattern Return codes Technical Proto codes indicating success/failure Snapshot Technical Complete state capture (account/symbol) Batch operation Technical Action on multiple items at once Retry logic Technical Exponential backoff for connection errors ConnectionHelper Utility Builds config and connects to MT5 ProgressBarHelper Utility Visual countdown for orchestrators Progressive complexity Philosophy Start simple, access complexity as needed Educational project Philosophy Learning materials, not production systems <p>\ud83d\udca1 New to CSharpMT5? 1. Read Strategies.Master.Overview.md to understand orchestrators and presets 2. Check MT5Account.Master.Overview.md for complete API reference 3. Explore examples in <code>Examples\\</code> folder to see API usage patterns 4. Start with MT5Sugar for the easiest API - drop down only when needed 5. ALWAYS test on demo accounts first!</p> <p>\"Trade safe, code clean, and may your async operations always complete successfully.\"</p>"},{"location":"MT5_For_Beginners/","title":"MT5 For Beginners: Your First Steps in Trading","text":"<p>Welcome! This guide is designed for complete beginners who have never worked with MetaTrader 5 or trading before. We'll walk you through everything you need to get started.</p>"},{"location":"MT5_For_Beginners/#what-is-metatrader-5-mt5","title":"What is MetaTrader 5 (MT5)?","text":"<p>MetaTrader 5 is a powerful trading platform used by millions of traders worldwide. It allows you to:</p> <ul> <li>Trade forex, stocks, commodities, and cryptocurrencies</li> <li>Analyze markets using charts and indicators</li> <li>Execute automated trading strategies</li> <li>Monitor your positions in real-time</li> </ul> <p>Think of MT5 as your \"cockpit\" for accessing financial markets. CSharpMT5 lets you control this cockpit programmatically using C#.</p>"},{"location":"MT5_For_Beginners/#demo-vs-real-account-start-safe","title":"Demo vs Real Account: Start Safe","text":""},{"location":"MT5_For_Beginners/#why-start-with-a-demo-account","title":"Why Start with a Demo Account?","text":"<p>A demo account is a risk-free practice account with virtual money. We strongly recommend starting with demo for several reasons:</p> <ul> <li>\u2705 Zero risk - practice with virtual funds ($10,000 - $100,000 typically)</li> <li>\u2705 Real market conditions - live prices and market behavior</li> <li>\u2705 Learn the platform - understand how MT5 works before risking real money</li> <li>\u2705 Test your code - perfect for developing and testing your CSharpMT5 applications</li> </ul>"},{"location":"MT5_For_Beginners/#real-account","title":"Real Account","text":"<p>A real account uses your actual money. Only switch to real trading when you:</p> <ul> <li>Understand how MT5 works</li> <li>Have tested your strategies thoroughly on demo</li> <li>Are comfortable with the risks involved</li> </ul>"},{"location":"MT5_For_Beginners/#quick-start-creating-a-demo-account","title":"Quick Start: Creating a Demo Account","text":"<p>The fastest way to get started is creating a demo account directly through the MT5 terminal application.</p>"},{"location":"MT5_For_Beginners/#step-1-download-and-install-mt5-terminal","title":"Step 1: Download and Install MT5 Terminal","text":"<ol> <li> <p>Visit the official MetaTrader website: https://www.metatrader5.com/en/download</p> </li> <li> <p>Download the version for your operating system (Windows/Mac/Linux)</p> </li> <li> <p>Install the application</p> </li> </ol> <p>Alternative: Many brokers offer their own MT5 download links (pre-configured with their servers).</p>"},{"location":"MT5_For_Beginners/#step-2-launch-mt5-and-locate-the-navigator-panel","title":"Step 2: Launch MT5 and Locate the Navigator Panel","text":"<p>When you open the MetaTrader 5 application, you'll typically see a popup window prompting you to:</p> <ul> <li> <p>Register in the MQL community</p> </li> <li> <p>Open a new account or log into an existing one</p> </li> </ul> <p>If this popup doesn't appear automatically, you'll need to find the Navigator panel.</p> <p>Locating the Navigator Panel:</p> <p>The Navigator panel is usually located on the left side of the screen, below the Market Watch panel.</p> <p></p> <p>Inside the Navigator panel, you'll see several sections: - Accounts - Subscriptions - Indicators - Expert Advisors - And others</p>"},{"location":"MT5_For_Beginners/#step-3-open-a-new-demo-account","title":"Step 3: Open a New Demo Account","text":"<ol> <li>In the Navigator panel, locate the Accounts section</li> <li>Right-click on \"Accounts\"</li> <li>Select \"Open an Account\" from the context menu</li> </ol> <p>This will open the broker server search panel.</p>"},{"location":"MT5_For_Beginners/#step-4-choose-metaquotes-demo-server","title":"Step 4: Choose MetaQuotes Demo Server","text":"<p>In the broker search window, you'll see a list of available MT5 servers.</p> <p>For your first demo account, we'll use the simplest option:</p> <ul> <li>Look for \"MetaQuotes-Demo\" or \"MetaQuotes Ltd\" in the list</li> <li>This is the default demo server provided by MetaTrader developers</li> <li>If you don't see it immediately, use the search box at the top to find it</li> </ul> <p>Select the MetaQuotes server and click Next.</p> <p></p>"},{"location":"MT5_For_Beginners/#step-5-choose-account-type","title":"Step 5: Choose Account Type","text":"<p>On the next screen, you'll have options to:</p> <ul> <li>Open a new demo account (top option)</li> <li>Log in to an existing account (demo or real)</li> </ul> <p>Select \"Open a new demo account\" and click Next.</p> <p></p>"},{"location":"MT5_For_Beginners/#step-6-fill-in-your-personal-information","title":"Step 6: Fill in Your Personal Information","text":"<p>You'll now see a form asking for your details:</p> <ul> <li>Name: Your first name</li> <li>Last Name: Your last name</li> <li>Email: Your email address</li> <li>Phone: Optional (can skip for demo)</li> <li>Account Type: Choose your preferred account settings</li> <li>Deposit: Virtual amount (e.g., $10,000)</li> <li>Leverage: 1:100 is a good starting point</li> <li>Currency: USD, EUR, etc.</li> </ul> <p>Check the box to agree to the terms and conditions, then click Next.</p> <p></p>"},{"location":"MT5_For_Beginners/#step-7-save-your-account-credentials","title":"Step 7: Save Your Account Credentials","text":"<p>MT5 will now create your demo account and display your credentials:</p> <p>Important credentials shown:</p> <ul> <li>Login: Your account number (e.g., 591129415)</li> <li>Password: Your master password for trading</li> <li>Investor Password: Read-only password (for monitoring)</li> <li>Server: The server name (e.g., \"MetaQuotes-Demo\")</li> </ul> <p>\u26a0\ufe0f CRITICAL: Save these credentials immediately! You'll need them to: - Log back into MT5 - Configure CSharpMT5 in <code>Config\\appsettings.json</code></p> <p></p> <p>Click Finish to complete the account creation.</p>"},{"location":"MT5_For_Beginners/#step-8-configure-csharpmt5-with-your-credentials","title":"Step 8: Configure CSharpMT5 with Your Credentials","text":"<p>Now that you have your MT5 demo account, you need to configure CSharpMT5 to connect to it.</p> <ol> <li>Open your CSharpMT5 project</li> <li>Navigate to <code>Config\\appsettings.json</code></li> <li>Fill in the credentials you just saved:</li> </ol> <pre><code>{\n  \"MT5\": {\n    \"User\": 591129415,                    // Your Login number\n    \"Password\": \"YourPasswordHere\",        // Your Password\n    \"ServerName\": \"MetaQuotes-Demo\",       // Server name\n    \"Host\": \"mt5.mrpc.pro\",                // Gateway host (provided by MetaRPC)\n    \"Port\": 443,\n    \"GrpcServer\": \"https://mt5.mrpc.pro:443\",\n    \"BaseChartSymbol\": \"EURUSD\",\n    \"InstanceId\": null,\n    \"ConnectTimeoutSeconds\": 120\n  }\n}\n</code></pre> <p>Important notes:</p> <ul> <li>User: Replace with your account Login number</li> <li>Password: Replace with your account Password</li> <li>ServerName: Use the exact server name from MT5 (e.g., \"MetaQuotes-Demo\")</li> </ul> <p></p>"},{"location":"MT5_For_Beginners/#step-9-verify-mt5-connection","title":"Step 9: Verify MT5 Connection","text":"<p>Back in the MT5 terminal:</p> <ol> <li>MT5 should automatically log you into your new demo account</li> <li>Check the bottom-right corner of the terminal window</li> <li>You should see:</li> <li>A green connection indicator (means connected to server)</li> <li>Your account balance (e.g., $10,000)</li> </ol> <p>![Placeholder: Screenshot of MT5 bottom-right corner showing green indicator and balance]</p> <p>You're now ready to start testing!</p>"},{"location":"MT5_For_Beginners/#step-10-start-testing-csharpmt5","title":"Step 10: Start Testing CSharpMT5","text":"<p>With your MT5 demo account created and configured in <code>appsettings.json</code>, you can now start running examples:</p> <pre><code># Navigate to your CSharpMT5 project folder\ncd CSharpMT5\n\n# Run your first example\ndotnet run market\n</code></pre> <p>When trading operations occur, your demo account balance will increase or decrease accordingly. Feel free to experiment - it's virtual money, so there's no risk!</p> <p>All trades executed by CSharpMT5 will appear in your MT5 terminal in real-time.</p>"},{"location":"MT5_For_Beginners/#understanding-mt5-password-types","title":"Understanding MT5 Password Types","text":"<p>MT5 uses two types of passwords for security and flexibility:</p>"},{"location":"MT5_For_Beginners/#master-password-main-password","title":"Master Password (Main Password)","text":"<ul> <li>Full access to your trading account</li> <li>Can open/close trades, deposit/withdraw funds, change settings</li> <li>This is the password you created during account registration</li> <li>Use this password for:</li> <li>Trading (including CSharpMT5 applications)</li> <li>Modifying account settings</li> <li>Withdrawing funds (real accounts)</li> </ul>"},{"location":"MT5_For_Beginners/#investor-password-read-only-password","title":"Investor Password (Read-Only Password)","text":"<ul> <li>View-only access to your account</li> <li>Can see trades, balance, history - but cannot trade</li> <li>Useful for:</li> <li>Sharing your account performance with others (investors, friends)</li> <li>Monitoring your account without risk</li> <li>Auditing and analytics tools</li> </ul> <p>How to get your Investor Password:</p> <ol> <li>In MT5, go to Tools \u2192 Options</li> <li>Select the Server tab</li> <li>Click Change next to \"Investor Password\"</li> <li>Set a new investor password</li> </ol> <p>![Placeholder: Screenshot of investor password settings]</p>"},{"location":"MT5_For_Beginners/#choosing-a-broker-optional","title":"Choosing a Broker (Optional)","text":"<p>While you can use the MetaQuotes demo server for practice, you may want to choose a specific broker for:</p> <ul> <li>Real trading later</li> <li>Better demo conditions (spreads, instruments)</li> <li>Specific regional support</li> </ul>"},{"location":"MT5_For_Beginners/#popular-mt5-brokers","title":"Popular MT5 Brokers:","text":"<p>Note: This is not financial advice. Always do your own research before choosing a broker.</p> <ul> <li>IC Markets - Popular for forex and low spreads</li> <li>Pepperstone - Well-regulated, good for beginners</li> <li>OANDA - Strong reputation, US clients accepted</li> <li>XM - Easy account opening, multiple account types</li> <li>RoboForex - Good for automated trading</li> </ul>"},{"location":"MT5_For_Beginners/#what-to-look-for","title":"What to Look For:","text":"<ul> <li> <p>\u2705 Regulation - Check if regulated by FCA, ASIC, CySEC, etc.</p> </li> <li> <p>\u2705 MT5 Support - Ensure they offer MT5 (not just MT4).</p> </li> <li> <p>\u2705 Demo Account - Free demo without expiration (Although the demo account is usually valid for 30 days, it becomes inactive afterwards).</p> </li> <li> <p>\u2705 Good Spreads - Lower spreads = lower trading costs.</p> </li> <li> <p>\u2705 Customer Support - Responsive support in your language.</p> </li> </ul>"},{"location":"MT5_For_Beginners/#basic-trading-terms-glossary","title":"Basic Trading Terms (Glossary)","text":"<p>Before you start coding with CSharpMT5, familiarize yourself with these essential terms:</p>"},{"location":"MT5_For_Beginners/#market-instruments","title":"Market &amp; Instruments","text":"Term Description Example Symbol A tradable instrument EURUSD, AAPL, GOLD Forex Foreign exchange market (currency pairs) EUR/USD, GBP/JPY CFD Contract for Difference (stocks, commodities) Gold, Oil, Apple stock Spread Difference between buy and sell price 2 pips on EURUSD Pip Smallest price movement 0.0001 for EURUSD"},{"location":"MT5_For_Beginners/#trading-actions","title":"Trading Actions","text":"Term Description Buy (Long) Open a position expecting price to go up Sell (Short) Open a position expecting price to go down Lot Trading volume (1.0 = 100,000 units in forex) Position An open trade Order A pending instruction to open a trade"},{"location":"MT5_For_Beginners/#risk-management","title":"Risk Management","text":"Term Description Stop Loss (SL) Automatic exit point to limit losses Take Profit (TP) Automatic exit point to lock in profits Leverage Borrowed funds to increase position size (e.g., 1:100) Margin Amount of funds required to open a position Equity Current account value (balance + floating profit/loss)"},{"location":"MT5_For_Beginners/#account-types","title":"Account Types","text":"Term Description Balance Total funds in your account Free Margin Available funds to open new positions Margin Level Ratio of equity to used margin (safety indicator) <p>For a complete glossary, see Glossary.md.</p>"},{"location":"MT5_For_Beginners/#whats-next","title":"What's Next?","text":"<p>Now that you have a demo account and understand the basics, you're ready to:</p>"},{"location":"MT5_For_Beginners/#1-set-up-csharpmt5","title":"1. Set Up CSharpMT5","text":"<p>Follow our main getting started guide to connect CSharpMT5 to your MT5 account:</p> <p>\ud83d\udc49 Getting Started with CSharpMT5</p>"},{"location":"MT5_For_Beginners/#2-understand-the-api-architecture","title":"2. Understand the API Architecture","text":"<p>CSharpMT5 is built in three layers, from low-level to high-level. You can choose where to start based on your needs:</p>"},{"location":"MT5_For_Beginners/#layer-1-mt5account-low-level-grpc-foundation","title":"Layer 1: MT5Account (Low-Level gRPC Foundation)","text":"<p>\ud83d\udc49 MT5Account Overview</p> <ul> <li>Direct gRPC calls to MT5 terminal</li> <li>The foundation of everything - all other layers use this internally</li> <li>Maximum control and flexibility</li> <li>Best for: Advanced users who need fine-grained control</li> </ul>"},{"location":"MT5_For_Beginners/#layer-2-mt5service-convenient-wrappers","title":"Layer 2: MT5Service (Convenient Wrappers)","text":"<p>\ud83d\udc49 MT5Service Overview</p> <ul> <li>Wrapper methods over MT5Account gRPC calls</li> <li>Simplified error handling and response parsing</li> <li>Easier to work with than raw gRPC</li> <li>Best for: Most common trading scenarios</li> </ul>"},{"location":"MT5_For_Beginners/#layer-3-mt5sugar-high-level-helpers","title":"Layer 3: MT5Sugar (High-Level Helpers)","text":"<p>\ud83d\udc49 MT5Sugar API Overview</p> <ul> <li>Syntactic sugar and convenience methods</li> <li>Chainable operations, smart defaults</li> <li>Most intuitive and beginner-friendly</li> <li>Best for: Quick prototyping and simple strategies</li> </ul> <p>\ud83d\udca1 Recommendation:</p> <ul> <li>Start with MT5Sugar if you're new to the SDK - it's the easiest</li> <li>Move to MT5Service when you need more control</li> <li>Deep dive into MT5Account when you need maximum flexibility or want to understand how everything works under the hood</li> </ul>"},{"location":"MT5_For_Beginners/#important-reminders","title":"Important Reminders","text":""},{"location":"MT5_For_Beginners/#security","title":"\ud83d\udee1\ufe0f Security","text":"<ul> <li>Never share your master password with anyone</li> <li>Use investor password for monitoring/analytics tools</li> <li>Keep your credentials secure (use password managers)</li> </ul>"},{"location":"MT5_For_Beginners/#risk-management_1","title":"\ud83d\udcca Risk Management","text":"<ul> <li>Demo accounts are risk-free, but build good habits:</li> <li>Always use Stop Loss</li> <li>Don't risk more than 1-2% per trade</li> <li>Understand position sizing</li> </ul>"},{"location":"MT5_For_Beginners/#testing","title":"\ud83e\uddea Testing","text":"<ul> <li>Test all your CSharpMT5 code on demo first</li> <li>Verify strategies over weeks/months, not days</li> <li>Paper trading (demo) doesn't guarantee real results</li> </ul>"},{"location":"MT5_For_Beginners/#education","title":"\ud83d\udcda Education","text":"<ul> <li>Trading has a steep learning curve</li> <li>Focus on learning before earning</li> <li>Consider courses, books, and communities</li> </ul> <p>Ready to start coding? Head over to Getting Started to connect CSharpMT5 to your MT5 account!</p>"},{"location":"PROJECT_MAP/","title":"CSharpMT5 Project Map","text":"<p>Complete project structure guide. Shows what's where, what's user-facing vs internal, and how components connect.</p>"},{"location":"PROJECT_MAP/#project-overview","title":"\ud83d\uddfa\ufe0f Project Overview","text":"<pre><code>CSharpMT5/\n\u251c\u2500\u2500 \ud83d\udce6 Core API (Internal - 3 layers)\n\u251c\u2500\u2500 \ud83c\udfaf User Code (Orchestrators, Presets, Examples)\n\u251c\u2500\u2500 \ud83d\udcda Documentation\n\u2514\u2500\u2500 \u2699\ufe0f Configuration &amp; Build\n\nExternal Dependencies:\n\u2514\u2500\u2500 \ud83d\udd0c gRPC &amp; Proto (NuGet packages)\n</code></pre>"},{"location":"PROJECT_MAP/#core-api-internal-root-level","title":"\ud83d\udce6 Core API (Internal - Root Level)","text":"<p>What: Three-tier architecture for MT5 trading automation.</p> <p>User interaction: Import and use, but typically don't modify.</p> <pre><code>/\n\u251c\u2500\u2500 package/                   \u2190 NuGet package source files (auto-generated)\n\u2502   \u2514\u2500\u2500 Helpers/\n\u2502       \u2514\u2500\u2500 MT5Account.cs      \u2190 LAYER 1: Low-level gRPC\n\u2502           \u2514\u2500\u2500 Direct gRPC calls to MT5 terminal\n\u2502           \u2514\u2500\u2500 Connection management with retry logic\n\u2502           \u2514\u2500\u2500 Proto Request/Response handling\n\u2502           \u2514\u2500\u2500 Async/Sync method variants\n\u2502           \u2514\u2500\u2500 Built-in connection resilience\n\u2502\n\u251c\u2500\u2500 MT5Service.cs              \u2190 LAYER 2: Wrapper methods\n\u2502   \u2514\u2500\u2500 Simplified signatures (no proto objects)\n\u2502   \u2514\u2500\u2500 Type conversions (proto \u2192 C# primitives)\n\u2502   \u2514\u2500\u2500 Direct data returns\n\u2502   \u2514\u2500\u2500 Extension methods for convenience\n\u2502\n\u2514\u2500\u2500 MT5Sugar.cs                \u2190 LAYER 3: Convenience layer \u2b50\n    \u2514\u2500\u2500 Auto-normalization (volumes, prices)\n    \u2514\u2500\u2500 Risk management (CalculateVolume, BuyByRisk)\n    \u2514\u2500\u2500 Points-based methods (BuyLimitPoints, etc.)\n    \u2514\u2500\u2500 Batch operations (CloseAll, CancelAll)\n    \u2514\u2500\u2500 Snapshots (GetAccountSnapshot, GetSymbolSnapshot)\n    \u2514\u2500\u2500 Smart helpers (conversions, limits)\n\nErrors/\n\u2514\u2500\u2500 ConnectExceptionMT5.cs     \u2190 Connection exception wrapper\n</code></pre> <p>Architecture flow: <pre><code>MT5Sugar \u2192 uses \u2192 MT5Service \u2192 uses \u2192 MT5Account \u2192 gRPC \u2192 MT5 Terminal\n</code></pre></p> <p>User decision:</p> <ul> <li>95% of cases: Start with <code>MT5Sugar</code> (highest level, easiest)</li> <li>Need wrappers: Drop to <code>MT5Service</code> (no auto-normalization)</li> <li>Need raw proto: Drop to <code>MT5Account</code> (full control)</li> </ul> <p>Documentation:</p> <ul> <li>MT5Account API Reference</li> <li>MT5Service API Reference</li> <li>MT5Sugar API Reference</li> </ul>"},{"location":"PROJECT_MAP/#user-code-your-trading-strategies","title":"\ud83c\udfaf User Code (Your Trading Strategies)","text":""},{"location":"PROJECT_MAP/#orchestrators-examplesorchestrators","title":"Orchestrators (Examples\\Orchestrators)","text":"<p>What: Pre-built trading strategy implementations.</p> <pre><code>Examples\\Orchestrators\\\n\u251c\u2500\u2500 GridTradingOrchestrator.cs        \u2190 Grid trading (range-bound markets)\n\u251c\u2500\u2500 SimpleScalpingOrchestrator.cs     \u2190 Quick scalping with tight stops\n\u251c\u2500\u2500 QuickHedgeOrchestrator.cs         \u2190 Hedging strategy (high volatility)\n\u251c\u2500\u2500 NewsStraddleOrchestrator.cs       \u2190 Breakout trading around news\n\u2514\u2500\u2500 PendingBreakoutOrchestrator.cs    \u2190 Pending orders for breakouts\n</code></pre> <p>Purpose: Educational examples showing complete strategy workflows:</p> <ul> <li>Entry logic (risk-based volume where applicable)</li> <li>Position monitoring with progress bars</li> <li>Exit management and cleanup</li> <li>Performance tracking (balance, equity, P/L)</li> <li>Configurable parameters via properties</li> </ul> <p>How to use:</p> <ol> <li>Study existing orchestrators</li> <li>Copy one as template</li> <li>Modify for your strategy</li> <li>Test on demo account</li> </ol> <p>How to run: <pre><code>dotnet run grid         # GridTradingOrchestrator\ndotnet run scalping     # SimpleScalpingOrchestrator\ndotnet run hedge        # QuickHedgeOrchestrator\ndotnet run news         # NewsStraddleOrchestrator\ndotnet run breakout     # PendingBreakoutOrchestrator\n</code></pre></p> <p>Documentation: Strategies.Master.Overview.md</p>"},{"location":"PROJECT_MAP/#presets-examplespresets","title":"Presets (Examples\\Presets)","text":"<p>What: Multi-orchestrator combinations with adaptive logic based on market analysis.</p> <p>User interaction: \u2705 Advanced usage - combine multiple strategies.</p> <pre><code>Examples\\Presets\\\n\u2514\u2500\u2500 AdaptiveMarketModePreset.cs    \u2190 Intelligent multi-strategy system\n</code></pre> <p>Purpose: Show how to:</p> <ul> <li>Chain multiple orchestrators</li> <li>Adaptive decision-making (volatility \u2192 strategy)</li> <li>Market condition analysis (simplified demo)</li> <li>Multi-phase trading sessions</li> <li>Performance tracking across phases</li> </ul> <p>How to run: <pre><code>dotnet run preset       # AdaptiveMarketModePreset\ndotnet run adaptive     # Same as above\n</code></pre></p> <p>Documentation: AdaptiveMarketModePreset.md</p>"},{"location":"PROJECT_MAP/#examples-examples","title":"Examples (Examples)","text":"<p>What: Runnable examples demonstrating API usage at different layers.</p> <p>User interaction: \u2705 Learning materials - run to understand APIs.</p> <pre><code>Examples\\\n\u251c\u2500\u2500 LowLevel\\                          \u2190 MT5Account examples (proto level)\n\u2502   \u2514\u2500\u2500 Program.LowLevel.Positions.cs  \u2190 Low-level position operations\n\u2502\n\u251c\u2500\u2500 Service\\                           \u2190 MT5Service examples (wrapper level)\n\u2502   \u2514\u2500\u2500 Program.Service.Positions.cs   \u2190 Service layer positions demo\n\u2502\n\u2514\u2500\u2500 Sugar\\                             \u2190 MT5Sugar examples (convenience level)\n    \u251c\u2500\u2500 Program.Sugar.MarketOrders.cs  \u2190 Market orders demo\n    \u2514\u2500\u2500 Program.Sugar.PendingOrders.cs \u2190 Pending orders + retry logic demo\n</code></pre> <p>How to run: <pre><code>dotnet run positions       # Service layer positions\ndotnet run market          # Sugar market orders\ndotnet run pendingorders   # Sugar pending orders\n</code></pre></p>"},{"location":"PROJECT_MAP/#programcs-root","title":"Program.cs (Root)","text":"<p>What: Main entry point that routes <code>dotnet run</code> commands to appropriate examples/orchestrators/presets.</p> <p>User interaction: \ud83d\udccb Runner + Documentation - launches everything.</p> <pre><code>Program.cs\n\u251c\u2500\u2500 Main()                              \u2190 Entry point, parses args\n\u251c\u2500\u2500 RouteCommand()                      \u2190 Maps aliases to runners\n\u251c\u2500\u2500 RunOrchestrator()                   \u2190 Launches orchestrators\n\u251c\u2500\u2500 RunPreset()                         \u2190 Launches presets\n\u251c\u2500\u2500 RunExample()                        \u2190 Launches examples\n\u2514\u2500\u2500 Header documentation                \u2190 Complete command reference\n</code></pre> <p>How it works:</p> <pre><code>dotnet run grid\n    \u2193\nProgram.cs Main(args)  // args[0] = \"grid\"\n    \u2193\nRouteCommand(\"grid\")\n    \u2193\nRunOrchestrator(\"grid\")\n    \u2193\nGridTradingOrchestrator.RunAsync()\n</code></pre> <p>Purpose:</p> <ul> <li>Single entry point for all runnable code</li> <li>Command routing with aliases (grid, scalping, preset, etc.)</li> <li>Helpful error messages for unknown commands</li> <li>Ctrl+C handling for graceful shutdowns</li> </ul> <p>Available commands: See header comment in <code>Program.cs</code> for complete list.</p>"},{"location":"PROJECT_MAP/#helpers-exampleshelpers","title":"Helpers (Examples\\Helpers)","text":"<p>What: Utility classes for examples and orchestrators.</p> <pre><code>Examples\\Helpers\\\n\u251c\u2500\u2500 ConnectionHelper.cs        \u2190 MT5 connection setup\n\u2514\u2500\u2500 ProgressBarHelper.cs       \u2190 Visual progress bars\n</code></pre> <p>ConnectionHelper: <pre><code>// Build configuration from appsettings.json\nvar config = ConnectionHelper.BuildConfiguration();\n\n// Create and connect to MT5\nvar account = await ConnectionHelper.CreateAndConnectAccountAsync(config);\nvar service = new MT5Service(account);\n</code></pre></p> <p>ProgressBarHelper: <pre><code>// Visual countdown during orchestrator runtime\nawait ProgressBarHelper.ShowProgressBar(\n    durationSeconds: 60,\n    message: \"Monitoring positions\",\n    cancellationToken: cts.Token\n);\n</code></pre></p>"},{"location":"PROJECT_MAP/#documentation-docs","title":"\ud83d\udcda Documentation (docs)","text":"<p>What: Complete API and strategy documentation.</p> <p>User interaction: \ud83d\udcd6 Read first! Comprehensive reference.</p> <pre><code>docs\\\n\u251c\u2500\u2500 index.md                           \u2190 \u2b50 Homepage - project introduction\n\u2502\n\u251c\u2500\u2500 Getting_Started.md                 \u2190 \u2b50 Start here! Setup &amp; first steps\n\u2502\n\u251c\u2500\u2500 PROJECT_MAP.md                     \u2190 \u2b50 This file - complete structure\n\u2502\n\u251c\u2500\u2500 Glossary.md                        \u2190 \u2b50 Terms and definitions\n\u2502\n\u251c\u2500\u2500 MT5_For_Beginners.md               \u2190 Creating demo account for testing\n\u2502\n\u251c\u2500\u2500 Your_First_Project.ru.md           \u2190 Your first project guide\n\u2502\n\u251c\u2500\u2500 ReturnCodes_Reference_EN.md        \u2190 Proto return codes reference\n\u2502\n\u251c\u2500\u2500 UserCode_Sandbox_Guide.md          \u2190 How to write custom strategies\n\u2502\n\u251c\u2500\u2500 GRPC_STREAM_MANAGEMENT.md          \u2190 Streaming subscriptions guide\n\u2502\n\u251c\u2500\u2500 Sync_vs_Async.md                   \u2190 Async/sync patterns explained\n\u2502\n\u251c\u2500\u2500 ProtobufInspector.README.EN.md     \u2190 Protobuf inspector tool guide\n\u2502\n\u251c\u2500\u2500 Strategies\\                        \u2190 Strategy documentation\n\u2502   \u251c\u2500\u2500 Strategies.Master.Overview.md  \u2190 \u2b50 ALL orchestrators &amp; presets\n\u2502   \u251c\u2500\u2500 Orchestrators_EN\\              \u2190 Individual orchestrator docs\n\u2502   \u2502   \u251c\u2500\u2500 GridTradingOrchestrator.md\n\u2502   \u2502   \u251c\u2500\u2500 GridTradingOrchestrator.HOW_IT_WORKS.md\n\u2502   \u2502   \u251c\u2500\u2500 SimpleScalpingOrchestrator.md\n\u2502   \u2502   \u251c\u2500\u2500 SimpleScalpingOrchestrator.HOW_IT_WORKS.md\n\u2502   \u2502   \u251c\u2500\u2500 QuickHedgeOrchestrator.md\n\u2502   \u2502   \u251c\u2500\u2500 QuickHedgeOrchestrator.HOW_IT_WORKS.md\n\u2502   \u2502   \u251c\u2500\u2500 NewsStraddleOrchestrator.md\n\u2502   \u2502   \u251c\u2500\u2500 NewsStraddleOrchestrator.HOW_IT_WORKS.md\n\u2502   \u2502   \u251c\u2500\u2500 PendingBreakoutOrchestrator.md\n\u2502   \u2502   \u2514\u2500\u2500 PendingBreakoutOrchestrator.HOW_IT_WORKS.md\n\u2502   \u2514\u2500\u2500 Presets\\\n\u2502       \u2514\u2500\u2500 AdaptiveMarketModePreset.md\n\u2502\n\u251c\u2500\u2500 API_Reference\\                     \u2190 API documentation\n\u2502   \u251c\u2500\u2500 MT5Account.API.md              \u2190 Layer 1 API reference\n\u2502   \u251c\u2500\u2500 MT5Service.API.md              \u2190 Layer 2 API reference\n\u2502   \u2514\u2500\u2500 MT5Sugar.API.md                \u2190 Layer 3 API reference\n\u2502\n\u251c\u2500\u2500 MT5Account\\                        \u2190 Low-level proto API docs\n\u2502   \u251c\u2500\u2500 MT5Account.Master.Overview.md  \u2190 \u2b50 Complete API reference\n\u2502   \u251c\u2500\u2500 1. Account_information\\        \u2190 Account methods\n\u2502   \u251c\u2500\u2500 2. Symbol_information\\         \u2190 Symbol/market data methods\n\u2502   \u251c\u2500\u2500 3. Position_Orders_Information\\ \u2190 Position/order methods\n\u2502   \u251c\u2500\u2500 4. Trading_Operations\\         \u2190 Trading execution methods\n\u2502   \u251c\u2500\u2500 5. Market_Depth(DOM)\\          \u2190 Market depth methods\n\u2502   \u251c\u2500\u2500 6. Additional_Methods\\         \u2190 Additional helpers\n\u2502   \u2514\u2500\u2500 7. Streaming_Methods\\          \u2190 Real-time subscriptions\n\u2502\n\u251c\u2500\u2500 MT5Service\\                        \u2190 Service layer method docs\n\u2502   \u251c\u2500\u2500 MT5Service.Overview.md          \u2190 \u2b50 Complete Service API reference\n\u2502   \u251c\u2500\u2500 Account_Convenience_Methods.md  \u2190 Account helper methods\n\u2502   \u251c\u2500\u2500 Symbol_Convenience_Methods.md   \u2190 Symbol helper methods\n\u2502   \u251c\u2500\u2500 Trading_Convenience_Methods.md  \u2190 Trading helper methods\n\u2502   \u2514\u2500\u2500 History_Convenience_Methods.md  \u2190 History helper methods\n\u2502\n\u2514\u2500\u2500 MT5Sugar\\                          \u2190 Sugar layer method docs\n    \u251c\u2500\u2500 MT5Sugar.API_Overview.md        \u2190 \u2b50 Complete Sugar API reference\n    \u251c\u2500\u2500 1. Infrastructure\\              \u2190 Core infrastructure methods\n    \u251c\u2500\u2500 2. Snapshots\\                   \u2190 Account/Symbol snapshots\n    \u251c\u2500\u2500 3. Normalization_Utils\\         \u2190 Price/volume normalization\n    \u251c\u2500\u2500 4. History_Helpers\\             \u2190 History retrieval helpers\n    \u251c\u2500\u2500 5. Streams_Helpers\\             \u2190 Bounded streaming methods\n    \u251c\u2500\u2500 6. Trading_Market_Pending\\      \u2190 Market &amp; pending orders\n    \u251c\u2500\u2500 8. Volume_Price_Utils\\          \u2190 Volume calculation &amp; pricing\n    \u251c\u2500\u2500 9. Pending_ByPoints\\            \u2190 Pending orders by points\n    \u251c\u2500\u2500 10. Market_ByRisk\\              \u2190 Market orders by risk\n    \u251c\u2500\u2500 11. Bulk_Convenience\\           \u2190 Bulk operations (close/cancel all)\n    \u251c\u2500\u2500 12. Market_Depth_DOM\\           \u2190 Market depth (DOM) methods\n    \u251c\u2500\u2500 13. Order_Validation\\           \u2190 Pre-flight order validation\n    \u251c\u2500\u2500 14. Session_Time\\               \u2190 Trading session info\n    \u2514\u2500\u2500 15. Position_Monitoring\\        \u2190 Position monitoring &amp; stats\n</code></pre> <p>Structure:</p> <ul> <li>Each method has its own <code>.md</code> file with examples</li> <li>Overview files (<code>*.Master.Overview.md</code>) provide navigation</li> <li><code>HOW_IT_WORKS.md</code> files explain algorithms step-by-step</li> <li>Links between related methods</li> <li>Usage examples in every file</li> </ul>"},{"location":"PROJECT_MAP/#grpc-proto-nuget-dependencies","title":"\ud83d\udd0c gRPC &amp; Proto (NuGet Dependencies)","text":"<p>What: Protocol Buffer and gRPC libraries for MT5 terminal communication.</p> <p>User interaction: \ud83d\udccb Reference only - managed by NuGet.</p> <p>Key NuGet packages:</p> <ul> <li><code>Grpc.Net.Client</code> - gRPC client library</li> <li><code>Google.Protobuf</code> - Protocol Buffers runtime</li> <li><code>Grpc.Tools</code> - Proto compilation tools</li> </ul> <p>How it works:</p> <ol> <li>NuGet restores packages on build</li> <li>Proto files compiled by Grpc.Tools (if present)</li> <li>Generated C# classes available for import</li> <li>MT5Account layer uses proto-generated types</li> </ol> <p>Proto-generated types:</p> <ul> <li><code>mt5_term_api.*</code> - Trading API types</li> <li>Request/Response message types</li> <li>Enum definitions</li> <li>Service contracts</li> </ul> <p>Purpose:</p> <ul> <li>Define gRPC service contracts</li> <li>Type-safe communication with MT5 terminal</li> <li>Used by MT5Account layer</li> <li>Hidden by MT5Service and MT5Sugar layers</li> </ul>"},{"location":"PROJECT_MAP/#component-interaction-diagram","title":"\ud83d\udcca Component Interaction Diagram","text":"<pre><code>YOUR CODE (User-facing)\n  \u251c\u2500 Orchestrators (strategy implementations)\n  \u251c\u2500 Presets (multi-strategy combinations)\n  \u2514\u2500 Examples (learning materials)\n                  \u2502\n                  \u2502 uses\n                  \u2193\nMT5Sugar (Layer 3 - Convenience)\n  \u251c\u2500 Auto-normalization\n  \u251c\u2500 Risk management\n  \u251c\u2500 Points-based methods\n  \u2514\u2500 Batch operations\n                  \u2502\n                  \u2502 uses\n                  \u2193\nMT5Service (Layer 2 - Wrappers)\n  \u251c\u2500 Direct data returns\n  \u251c\u2500 Type conversions\n  \u2514\u2500 Simplified signatures\n                  \u2502\n                  \u2502 uses\n                  \u2193\nMT5Account (Layer 1 - Low-level)\n  \u251c\u2500 Proto Request/Response\n  \u251c\u2500 gRPC communication\n  \u251c\u2500 Connection management\n  \u2514\u2500 Auto-reconnection\n                  \u2502\n                  \u2502 gRPC\n                  \u2193\nMT5 Gateway (mt5term) or MT5 Terminal\n  \u2514\u2500 MetaTrader 5 with gRPC server\n</code></pre>"},{"location":"PROJECT_MAP/#file-naming-conventions","title":"\ud83d\udd0d File Naming Conventions","text":""},{"location":"PROJECT_MAP/#core-api-root-level","title":"Core API (Root Level)","text":"<ul> <li><code>MT5Account</code> - Layer 1 (low-level gRPC, located in <code>package/Helpers/MT5Account.cs</code>)</li> <li><code>MT5Service.cs</code> - Layer 2 (wrapper methods)</li> <li><code>MT5Sugar.cs</code> - Layer 3 (convenience API)</li> <li><code>*ExceptionMT5.cs</code> - Exception types</li> </ul>"},{"location":"PROJECT_MAP/#user-code-examples","title":"User Code (Examples)","text":"<ul> <li><code>*Orchestrator.cs</code> - Single-strategy implementations</li> <li><code>*Preset.cs</code> - Multi-strategy combinations</li> <li><code>Program.*.cs</code> - Runnable examples at different layers</li> <li><code>*Helper.cs</code> - Utility classes (ConnectionHelper, ProgressBarHelper)</li> </ul>"},{"location":"PROJECT_MAP/#documentation-docs_1","title":"Documentation (docs)","text":"<ul> <li><code>*.Master.Overview.md</code> - Complete category overviews</li> <li><code>*.Overview.md</code> - Section overviews</li> <li><code>MethodName.md</code> - Individual method documentation</li> <li><code>*.HOW_IT_WORKS.md</code> - Algorithm explanations</li> </ul>"},{"location":"PROJECT_MAP/#what-to-modify-vs-what-to-leave-alone","title":"\ud83d\udcc2 What to Modify vs What to Leave Alone","text":""},{"location":"PROJECT_MAP/#modify-user-code","title":"\u2705 MODIFY (User Code)","text":"<pre><code>Examples\\Orchestrators\\        \u2190 Copy and customize for your strategies\nExamples\\Presets\\              \u2190 Create your own multi-strategy systems\nExamples\\LowLevel\\             \u2190 Add your own low-level examples\nExamples\\Service\\              \u2190 Add your own service examples\nExamples\\Sugar\\                \u2190 Add your own sugar examples\nExamples\\Helpers\\              \u2190 Add your own helper utilities\nConfig\\appsettings.json        \u2190 Configure for your MT5 terminal/gateway\nProgram.cs                     \u2190 Add new command routing if needed\nREADME.md                      \u2190 Update with your changes\n</code></pre>"},{"location":"PROJECT_MAP/#read-core-api","title":"\ud83d\udcd6 READ (Core API)","text":"<pre><code>package/Helpers/MT5Account.cs  \u2190 Use but don't modify (import and call)\nMT5Service.cs                  \u2190 Use but don't modify\nMT5Sugar.cs                    \u2190 Use but don't modify\ndocs\\                          \u2190 Reference documentation\n</code></pre>"},{"location":"PROJECT_MAP/#leave-alone-generatedbuild","title":"\ud83d\udd12 LEAVE ALONE (Generated/Build)","text":"<pre><code>package\\                       \u2190 NuGet package source (auto-generated by CI/CD)\nbin\\                           \u2190 Compiled assemblies (auto-generated)\nobj\\                           \u2190 Intermediate build files (auto-generated)\n.vs\\                           \u2190 Visual Studio cache (auto-generated)\n*.csproj.user                  \u2190 User-specific project settings\n</code></pre> <p>Note about <code>package/</code> folder:</p> <p>This folder contains decompiled source code from the NuGet package and is automatically generated by GitLab Runner during CI/CD builds. It includes:</p> <ul> <li><code>package/Helpers/MT5Account.cs</code> - Core gRPC layer</li> <li><code>package/Helpers/ApiExceptionMT5.cs</code>, <code>ConnectExceptionMT5.cs</code> - Exception classes</li> <li>Proto-generated files: <code>Mt5TermApiAccountHelper.cs</code>, <code>Mt5TermApiMarketInfo.cs</code>, <code>Mt5TermApiConnection.cs</code>, etc.</li> <li>gRPC client stubs: <code>Mt5-term-api-*Grpc.cs</code> files</li> <li>Error types: <code>MrpcMt5Error.cs</code></li> <li>Project files: <code>MetaRPC.MT5.csproj</code>, <code>MetaRPC.MT5.sln</code></li> </ul> <p>\u26a0\ufe0f Do not manually modify files in <code>package/</code> - changes will be overwritten on next CI/CD run. This folder is included in the repository for transparency and debugging purposes.</p>"},{"location":"PROJECT_MAP/#project-philosophy","title":"\ud83c\udfaf Project Philosophy","text":"<p>Goal: Make MT5 trading automation accessible through progressive complexity.</p> <p>Three-tier design:</p> <ol> <li>Low-level (MT5Account): Full control, proto/gRPC</li> <li>Wrapper (MT5Service): Simplified method calls</li> <li>Convenience (MT5Sugar): Auto-everything, batteries included</li> </ol> <p>User code:</p> <ul> <li>Orchestrators: Pre-built strategy templates</li> <li>Presets: Multi-strategy adaptive systems</li> <li>Examples: Learning materials at all layers</li> </ul> <p>Start high (MT5Sugar), drop down only when needed.</p>"},{"location":"PROJECT_MAP/#troubleshooting","title":"\ud83d\udee0\ufe0f Troubleshooting","text":""},{"location":"PROJECT_MAP/#build-issues","title":"Build Issues","text":"<pre><code># Clean and rebuild\ndotnet clean\ndotnet build\n\n# Restore NuGet packages\ndotnet restore\n\n# Check .NET version\ndotnet --version   # Should be 8.0 or higher\n</code></pre>"},{"location":"PROJECT_MAP/#connection-issues","title":"Connection Issues","text":"<pre><code>1. Check appsettings.json (host, port, credentials)\n2. Verify MT5 terminal/gateway is running\n3. Check firewall/antivirus isn't blocking port\n4. Try different port if 5555 is in use\n5. Check MT5 terminal logs for errors\n</code></pre>"},{"location":"PROJECT_MAP/#runtime-issues","title":"Runtime Issues","text":"<pre><code>1. Always test on demo account first\n2. Check return codes (10009 = success, 10031 = connection error)\n3. Monitor console output for errors\n4. Use retry logic for intermittent issues\n5. Check broker allows your strategy type (hedging, etc.)\n</code></pre>"},{"location":"PROJECT_MAP/#performance-considerations","title":"\ud83d\udcc8 Performance Considerations","text":""},{"location":"PROJECT_MAP/#connection-management","title":"Connection Management","text":"<ul> <li>Single gRPC connection shared across operations</li> <li>Built-in automatic reconnection handles temporary failures</li> <li>Retry logic with exponential backoff (1s \u2192 2s \u2192 4s)</li> </ul>"},{"location":"PROJECT_MAP/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>3-second delays between order placements (demo examples)</li> <li>Gateway may enforce additional rate limits</li> <li>Adjust delays based on broker requirements</li> </ul>"},{"location":"PROJECT_MAP/#resource-usage","title":"Resource Usage","text":"<ul> <li>Async/await throughout for non-blocking I/O</li> <li>CancellationToken for graceful shutdowns</li> <li>Proper cleanup in finally blocks</li> </ul>"},{"location":"PROJECT_MAP/#best-practices","title":"\ud83d\udcdd Best Practices","text":""},{"location":"PROJECT_MAP/#code-organization","title":"Code Organization","text":"<pre><code>\u2705 DO: Separate concerns (analysis, execution, monitoring)\n\u2705 DO: Use async/await for all I/O operations\n\u2705 DO: Add comprehensive error handling\n\u2705 DO: Document your strategy logic clearly\n\u2705 DO: Use ProgressBarHelper for long-running operations\n\n\u274c DON'T: Mix strategy logic with API calls\n\u274c DON'T: Use Thread.Sleep (use await Task.Delay)\n\u274c DON'T: Ignore return codes\n\u274c DON'T: Test on live accounts without extensive demo testing\n</code></pre>"},{"location":"PROJECT_MAP/#strategy-development","title":"Strategy Development","text":"<pre><code>\u2705 DO: Start with existing orchestrator as template\n\u2705 DO: Test each component separately\n\u2705 DO: Log all trading decisions and results\n\u2705 DO: Use demo accounts for development\n\u2705 DO: Implement proper risk management\n\n\u274c DON'T: Over-optimize on limited data\n\u274c DON'T: Ignore edge cases and failures\n\u274c DON'T: Use fixed lot sizes without risk calculation\n\u274c DON'T: Deploy without backtesting and forward testing\n</code></pre> <p>\ud83d\udca1 Remember: This is an educational project. All orchestrators and presets are demonstration examples, not production-ready trading systems. Always test on demo accounts, understand the code thoroughly, and implement proper risk management before considering live trading.</p> <p>\"Trade safe, code clean, and may your async operations always complete successfully.\"</p>"},{"location":"ProtobufInspector.README.EN/","title":"\ud83d\udd0d Interactive Protobuf Types Inspector","text":"<p>Interactive utility for exploring MT5 gRPC API protobuf types.</p>"},{"location":"ProtobufInspector.README.EN/#why-you-need-this-tool","title":"\ud83d\udccc Why You Need This Tool","text":"<p>When working with MT5 gRPC API, you constantly face questions like:</p> <ul> <li>\"What fields does <code>AccountSummaryData</code> have?\"</li> <li>\"Where can I find the <code>Ticket</code> field?\"</li> <li>\"What values does the <code>ORDER_TYPE</code> enum contain?\"</li> <li>\"What types are available for working with orders/positions?\"</li> </ul> <p>Yes, all this information is already in the documentation, but without this inspector you would have to:</p> <ul> <li>Open multiple documentation files and scroll through pages</li> <li>Remember which doc file contains which type</li> <li>Manually search through text (Ctrl+F) in each file</li> <li>Constantly switch between IDE and documentation browser</li> <li>Interrupt your coding flow to look up references</li> </ul> <p>ProtobufInspector solves all these problems in one command! \ud83c\udfaf</p>"},{"location":"ProtobufInspector.README.EN/#convenience-features","title":"\u2728 Convenience Features:","text":"<ul> <li>Instant launch \u2014 just <code>dotnet run inspect</code></li> <li>Smart search \u2014 find types by name, field, or keyword</li> <li>Clear output \u2014 structured display with emojis and formatting</li> <li>Case insensitive \u2014 no need to remember exact casing</li> <li>Interactive \u2014 explore API in real-time without recompiling code</li> <li>Time saver \u2014 answers in seconds instead of minutes of searching</li> </ul> <p>Real-world benefit: Instead of spending 5-10 minutes searching documentation or proto files, you get the answer in 5 seconds. For daily MT5 API development, this tool becomes indispensable.</p>"},{"location":"ProtobufInspector.README.EN/#launch","title":"\ud83d\ude80 Launch","text":"<pre><code>dotnet run inspect\n</code></pre>"},{"location":"ProtobufInspector.README.EN/#available-commands","title":"\ud83d\udcd6 Available Commands","text":"Command Description Example <code>list</code> or <code>ls</code> Show all available types <code>list</code> <code>&lt;TypeName&gt;</code> Inspect specific type <code>OpenedOrdersData</code> <code>search &lt;text&gt;</code> or <code>find &lt;text&gt;</code> Find types containing text <code>search Order</code> <code>field &lt;name&gt;</code> Find types with specific field <code>field Balance</code> <code>enum &lt;name&gt;</code> Show enum values <code>enum BMT5_ENUM_ORDER_TYPE</code> <code>help</code> or <code>?</code> Show help <code>help</code> <code>exit</code>, <code>quit</code> or <code>q</code> Exit inspector <code>exit</code>"},{"location":"ProtobufInspector.README.EN/#practical-examples","title":"\ud83d\udca1 Practical Examples","text":""},{"location":"ProtobufInspector.README.EN/#example-1-discover-accountsummarydata-fields","title":"Example 1: Discover AccountSummaryData fields","text":"<p><pre><code>&gt; AccountSummaryData\n</code></pre> Result: <pre><code>\ud83d\udccb Properties (15):\n  \u2022 AccountBalance    : double\n  \u2022 AccountEquity     : double\n  \u2022 AccountProfit     : double\n  \u2022 AccountMargin     : double\n  ...\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#example-2-find-type-with-ticket-field","title":"Example 2: Find type with \"Ticket\" field","text":"<p><pre><code>&gt; field Ticket\n</code></pre> Result: <pre><code>\u2705 Found in 5 type(s):\n\n\ud83d\udce6 OpenedOrderInfo:\n   \u2514\u2500 Ticket: ulong\n\n\ud83d\udce6 PositionInfo:\n   \u2514\u2500 Ticket: ulong\n\n\ud83d\udce6 OrderCloseRequest:\n   \u2514\u2500 Ticket: ulong\n...\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#example-3-view-order_type-values","title":"Example 3: View ORDER_TYPE values","text":"<p><pre><code>&gt; enum ENUM_ORDER_TYPE\n</code></pre> Result: <pre><code>\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    ENUM: ENUM_ORDER_TYPE                      \n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  ORDER_TYPE_BUY           = 0\n  ORDER_TYPE_SELL          = 1\n  ORDER_TYPE_BUY_LIMIT     = 2\n  ORDER_TYPE_SELL_LIMIT    = 3\n  ORDER_TYPE_BUY_STOP      = 4\n  ORDER_TYPE_SELL_STOP     = 5\n  ...\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#example-4-find-all-position-related-types","title":"Example 4: Find all \"Position\" related types","text":"<p><pre><code>&gt; search Position\n</code></pre> Result: <pre><code>\u2705 Found 8 type(s):\n\n  [Class]  PositionInfo\n  [Class]  PositionsTotalData\n  [Class]  PositionsHistoryData\n  [Enum]   ENUM_POSITION_TYPE\n  ...\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#example-5-view-all-available-types","title":"Example 5: View all available types","text":"<p><pre><code>&gt; list\n</code></pre> Result: <pre><code>\ud83d\udce6 Found 156 types:\n\n  [Data]    AccountSummaryData\n  [Data]    BalanceData\n  [Data]    OpenedOrdersData\n  [Request] OrderSendRequest\n  [Request] OrderCloseRequest\n  ...\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#common-use-cases","title":"\ud83c\udfaf Common Use Cases","text":""},{"location":"ProtobufInspector.README.EN/#scenario-1-getting-field-not-found-error","title":"Scenario 1: \"Getting 'field not found' error\"","text":"<p>Problem: Writing <code>summary.FreeMargin</code> but getting compilation error.</p> <p>Solution: <pre><code>&gt; field FreeMargin\n# or\n&gt; AccountSummaryData\n</code></pre> Result: Discover the correct field name is <code>AccountBalance</code> or <code>AccountEquity</code>.</p>"},{"location":"ProtobufInspector.README.EN/#scenario-2-dont-know-what-properties-a-type-has","title":"Scenario 2: \"Don't know what properties a type has\"","text":"<p>Problem: Working with <code>OpenedOrdersData</code> but unsure what's inside.</p> <p>Solution: <pre><code>&gt; OpenedOrdersData\n</code></pre> Result: <pre><code>  \ud83d\udcda OpenedOrders  : List&lt;OpenedOrderInfo&gt;\n  \ud83d\udcda PositionInfos : List&lt;PositionInfo&gt;\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#scenario-3-need-enum-values-for-order_type","title":"Scenario 3: \"Need enum values for ORDER_TYPE\"","text":"<p>Problem: Want to use enum but don't know exact values.</p> <p>Solution: <pre><code>&gt; enum BMT5_ENUM_ORDER_TYPE\n</code></pre> Result: All values with numeric codes.</p>"},{"location":"ProtobufInspector.README.EN/#scenario-4-looking-for-order-related-types","title":"Scenario 4: \"Looking for order-related types\"","text":"<p>Problem: Need to find all types related to orders.</p> <p>Solution: <pre><code>&gt; search Order\n</code></pre> Result: <code>OrderSendRequest</code>, <code>OrderCloseRequest</code>, <code>OpenedOrderInfo</code>, etc.</p>"},{"location":"ProtobufInspector.README.EN/#scenario-5-want-to-understand-whats-available-in-api","title":"Scenario 5: \"Want to understand what's available in API\"","text":"<p>Problem: New to the API, want to see what's available.</p> <p>Solution: <pre><code>&gt; list\n</code></pre> Result: Complete list of all types (Data, Request, Reply).</p>"},{"location":"ProtobufInspector.README.EN/#code-integration","title":"\ud83d\udd27 Code Integration","text":"<p>After finding needed information:</p> <pre><code>// Found via inspector that correct field is AccountBalance\n&gt; AccountSummaryData\n  \u2022 AccountBalance : double  \u2190 here it is!\n\n// Use in code:\nvar summary = await service.GetAccountSnapshot();\nConsole.WriteLine(summary.Summary.AccountBalance);  // \u2705 Works!\n</code></pre>"},{"location":"ProtobufInspector.README.EN/#notes","title":"\ud83d\udcdd Notes","text":"<ul> <li>Case insensitive: can write <code>openeordersdata</code> or <code>OpenedOrdersData</code></li> <li>Partial search: <code>search Pos</code> finds <code>Position</code>, <code>PositionInfo</code>, etc.</li> <li>Lists marked \ud83d\udcda: <code>List&lt;T&gt;</code> or <code>RepeatedField&lt;T&gt;</code></li> <li>Classes marked \ud83d\udce6: regular types</li> <li>Enums marked as <code>[Enum]</code></li> </ul>"},{"location":"ProtobufInspector.README.EN/#troubleshooting","title":"\ud83d\udea8 Troubleshooting","text":"<p>Q: Command doesn't find type <pre><code>&gt; MyType\n\u274c Type 'MyType' not found\n</code></pre> A: Try search: <pre><code>&gt; search MyType\n</code></pre></p> <p>Q: Need to find all enums <pre><code>&gt; list\n# Look for lines with [Enum]\n</code></pre></p> <p>Q: Want to exit inspector <pre><code>&gt; exit\n# or\n&gt; quit\n# or\n&gt; q\n# or just Ctrl+C\n</code></pre></p>"},{"location":"ProtobufInspector.README.EN/#additional-information","title":"\ud83c\udf93 Additional Information","text":"<ul> <li>File location: <code>Examples/Helpers/ProtobufInspector.cs</code></li> <li>Invoked from Program.cs: <code>case \"inspect\"</code> or <code>case \"types\"</code></li> <li>Used for: Exploring MT5 gRPC API types from <code>mt5_term_api</code></li> </ul>"},{"location":"ProtobufInspector.README.EN/#technical-details","title":"\ud83d\udcbb Technical Details","text":"<p>What is inspected:</p> <ul> <li>All types from namespace <code>mt5_term_api</code></li> <li>Only public types (public classes/enums)</li> <li>Types with suffixes: <code>Data</code>, <code>Request</code>, <code>Reply</code></li> <li>All public properties and their types</li> </ul> <p>Supported types:</p> <ul> <li>\u2705 Classes (protobuf messages)</li> <li>\u2705 Enums</li> <li>\u2705 Generic types (List, etc.) <li>\u2705 Primitive types (int, double, string, etc.)</li>"},{"location":"ReturnCodes_Reference_EN/","title":"MT5 Return Codes (RetCodes) Reference","text":""},{"location":"ReturnCodes_Reference_EN/#what-is-retcode","title":"What is RetCode?","text":"<p>RetCode (Return Code) is a status code that MT5 Terminal returns after executing a trading operation. The code indicates success or the reason for failure.</p> <p>RetCodes only appear in trading methods because only trading operations go through the broker and can be rejected for various reasons (insufficient margin, invalid price, market closed, etc.).</p>"},{"location":"ReturnCodes_Reference_EN/#retcode-source","title":"RetCode Source","text":"<p>RetCodes are standard MQL5 codes defined in the official MetaQuotes documentation:</p> <p>MQL5 Documentation: Trade Result Codes (ENUM_TRADE_RETCODE)</p> <p>These codes are:</p> <ul> <li>Unified across all languages (C#, Python, Java, Node.js, Go, PHP)</li> <li>Unified with MT5 Terminal - returned directly from the trade server</li> <li>Defined in protobuf - enum <code>MqlErrorTradeCode</code> in the API proto contract</li> </ul>"},{"location":"ReturnCodes_Reference_EN/#where-is-retcode-used-in-the-api","title":"Where is RetCode Used in the API?","text":"<p>RetCode is returned in three types of trading operations:</p>"},{"location":"ReturnCodes_Reference_EN/#1-ordersend-opening-orders","title":"1. OrderSend (opening orders)","text":"<pre><code>var result = await mt5Service.BuyMarketAsync(\"EURUSD\", 0.01, stopLoss: 1.0800);\nConsole.WriteLine($\"RetCode: {result.ReturnedCode}\"); // uint32\nConsole.WriteLine($\"String Code: {result.ReturnedStringCode}\"); // \"TRADE_RETCODE_DONE\"\nConsole.WriteLine($\"Description: {result.ReturnedCodeDescription}\"); // \"Request completed\"\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#2-ordermodify-modifying-sltp","title":"2. OrderModify (modifying SL/TP)","text":"<pre><code>var result = await mt5Account.OrderModifyAsync(ticket: 12345, stopLoss: 1.0850);\nif (result.Data.ReturnedCode == 10009) {\n    Console.WriteLine(\"Modification successful\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#3-orderclose-closing-positions","title":"3. OrderClose (closing positions)","text":"<pre><code>var result = await mt5Account.OrderCloseAsync(ticket: 12345);\nif (result.Data.ReturnedCode != 10009) {\n    Console.WriteLine($\"Close failed: {result.Data.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#why-retcode-only-in-trading-methods","title":"Why RetCode Only in Trading Methods?","text":"<p>Information methods (getting prices, symbols, balance) DO NOT return RetCode because:</p> <ul> <li>They don't go through the broker</li> <li>They can't be \"rejected\" - either data exists or not (gRPC error)</li> <li>They work with local terminal data</li> </ul> <p>Trading methods return RetCode because:</p> <ul> <li>Request is sent to broker via trade server</li> <li>Broker validates: margin, symbol rules, trading hours, limits</li> <li>Broker can reject request for dozens of reasons</li> <li>Each reason has its unique code</li> </ul>"},{"location":"ReturnCodes_Reference_EN/#complete-retcode-list","title":"Complete RetCode List","text":""},{"location":"ReturnCodes_Reference_EN/#success-codes","title":"\u2705 Success Codes","text":"Code Enum Description 0 <code>TRADE_RETCODE_SUCCESS</code> Successful execution (non-trading operation) 10008 <code>TRADE_RETCODE_PLACED</code> Pending order placed 10009 <code>TRADE_RETCODE_DONE</code> Request completed (market order opened) 10010 <code>TRADE_RETCODE_DONE_PARTIAL</code> Partial execution"},{"location":"ReturnCodes_Reference_EN/#requote-codes","title":"\u26a0\ufe0f Requote Codes","text":"Code Enum Description 10004 <code>TRADE_RETCODE_REQUOTE</code> Requote - price changed, need to request again 10020 <code>TRADE_RETCODE_PRICE_CHANGED</code> Price changed - similar to requote"},{"location":"ReturnCodes_Reference_EN/#request-rejection-codes-validation-errors","title":"\u274c Request Rejection Codes (Validation Errors)","text":"Code Enum Description Reason 10006 <code>TRADE_RETCODE_REJECT</code> Request rejected General rejection by broker 10007 <code>TRADE_RETCODE_CANCEL</code> Request canceled by trader User canceled request manually 10013 <code>TRADE_RETCODE_INVALID</code> Invalid request Incorrect parameters 10014 <code>TRADE_RETCODE_INVALID_VOLUME</code> Invalid volume Volume &lt; MinVolume or &gt; MaxVolume 10015 <code>TRADE_RETCODE_INVALID_PRICE</code> Invalid price Price doesn't comply with symbol rules 10016 <code>TRADE_RETCODE_INVALID_STOPS</code> Invalid stops SL/TP too close to price or violates StopLevel 10022 <code>TRADE_RETCODE_INVALID_EXPIRATION</code> Invalid expiration date Expiration time is incorrect 10030 <code>TRADE_RETCODE_INVALID_FILL</code> Invalid fill type Fill policy not supported by symbol 10035 <code>TRADE_RETCODE_INVALID_ORDER</code> Invalid order type Order type prohibited for symbol 10038 <code>TRADE_RETCODE_INVALID_CLOSE_VOLUME</code> Invalid close volume Volume greater than current position"},{"location":"ReturnCodes_Reference_EN/#trading-restriction-codes","title":"\ud83d\udeab Trading Restriction Codes","text":"Code Enum Description Reason 10017 <code>TRADE_RETCODE_TRADE_DISABLED</code> Trading disabled Trading disabled for symbol 10018 <code>TRADE_RETCODE_MARKET_CLOSED</code> Market closed Outside trading hours 10026 <code>TRADE_RETCODE_SERVER_DISABLES_AT</code> Autotrading disabled by server Broker disabled autotrading 10027 <code>TRADE_RETCODE_CLIENT_DISABLES_AT</code> Autotrading disabled by client AutoTrading disabled in terminal 10032 <code>TRADE_RETCODE_ONLY_REAL</code> Operation for live accounts only Action unavailable on demo 10042 <code>TRADE_RETCODE_LONG_ONLY</code> Long positions only Short positions prohibited 10043 <code>TRADE_RETCODE_SHORT_ONLY</code> Short positions only Long positions prohibited 10044 <code>TRADE_RETCODE_CLOSE_ONLY</code> Close only Opening new positions prohibited 10045 <code>TRADE_RETCODE_FIFO_CLOSE</code> FIFO close only FIFO rule mandatory (US regulation) 10046 <code>TRADE_RETCODE_HEDGE_PROHIBITED</code> Hedging prohibited Cannot open opposite positions"},{"location":"ReturnCodes_Reference_EN/#resource-limit-codes","title":"\ud83d\udcb0 Resource Limit Codes","text":"Code Enum Description Reason 10019 <code>TRADE_RETCODE_NO_MONEY</code> Insufficient funds Free Margin &lt; Required Margin 10033 <code>TRADE_RETCODE_LIMIT_ORDERS</code> Pending orders limit reached Maximum number of orders 10034 <code>TRADE_RETCODE_LIMIT_VOLUME</code> Volume limit reached Total position volume exceeded 10040 <code>TRADE_RETCODE_LIMIT_POSITIONS</code> Open positions limit reached Maximum number of positions"},{"location":"ReturnCodes_Reference_EN/#technical-issue-codes","title":"\ud83d\udd27 Technical Issue Codes","text":"Code Enum Description Reason 10011 <code>TRADE_RETCODE_ERROR</code> Request processing error Internal server error 10012 <code>TRADE_RETCODE_TIMEOUT</code> Request timeout Request not processed in time 10021 <code>TRADE_RETCODE_PRICE_OFF</code> No quotes Symbol price unavailable 10024 <code>TRADE_RETCODE_TOO_MANY_REQUESTS</code> Too many requests Rate limiting from broker 10028 <code>TRADE_RETCODE_LOCKED</code> Request locked for processing Previous request still processing 10029 <code>TRADE_RETCODE_FROZEN</code> Order/position frozen Temporary lock 10031 <code>TRADE_RETCODE_CONNECTION</code> No connection with trade server Connection lost"},{"location":"ReturnCodes_Reference_EN/#state-management-codes","title":"\ud83d\udd04 State Management Codes","text":"Code Enum Description Reason 10023 <code>TRADE_RETCODE_ORDER_CHANGED</code> Order state changed Order already modified/closed 10025 <code>TRADE_RETCODE_NO_CHANGES</code> No changes in request New parameters match current ones 10036 <code>TRADE_RETCODE_POSITION_CLOSED</code> Position already closed Attempt to close non-existent position 10039 <code>TRADE_RETCODE_CLOSE_ORDER_EXIST</code> Close order already exists Duplicate close request 10041 <code>TRADE_RETCODE_REJECT_CANCEL</code> Pending order activation rejected Pending order cannot be activated"},{"location":"ReturnCodes_Reference_EN/#usage-examples","title":"Usage Examples","text":""},{"location":"ReturnCodes_Reference_EN/#example-1-checking-order-opening-success","title":"Example 1: Checking Order Opening Success","text":"<pre><code>using mt5_term_api;\nusing mt5_term_api;\n\nvar config = ConnectionHelper.BuildConfiguration();\nvar account = await ConnectionHelper.CreateAndConnectAccountAsync(config);\nvar service = new MT5Service(account);\n\n// Open market order\nvar result = await service.BuyMarketAsync(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    stopLoss: 1.0800,\n    takeProfit: 1.0900\n);\n\n// Check RetCode\nif (result.ReturnedCode == 10009) // TRADE_RETCODE_DONE\n{\n    Console.WriteLine($\"\u2705 Order opened successfully!\");\n    Console.WriteLine($\"   Ticket: #{result.Order}\");\n    Console.WriteLine($\"   Volume: {result.Volume} lots\");\n    Console.WriteLine($\"   Price: {result.Price}\");\n}\nelse if (result.ReturnedCode == 10008) // TRADE_RETCODE_PLACED\n{\n    Console.WriteLine($\"\u2705 Pending order placed!\");\n    Console.WriteLine($\"   Ticket: #{result.Order}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Order failed!\");\n    Console.WriteLine($\"   RetCode: {result.ReturnedCode}\");\n    Console.WriteLine($\"   String: {result.ReturnedStringCode}\");\n    Console.WriteLine($\"   Description: {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#example-2-handling-common-errors","title":"Example 2: Handling Common Errors","text":"<pre><code>var result = await service.SellMarketAsync(\"GBPUSD\", 0.5);\n\nswitch (result.ReturnedCode)\n{\n    case 10009: // Success\n        Console.WriteLine($\"Order #{result.Order} opened at {result.Price}\");\n        break;\n\n    case 10019: // No money\n        Console.WriteLine(\"\u26a0\ufe0f Insufficient funds! Reduce volume or add margin.\");\n        break;\n\n    case 10018: // Market closed\n        Console.WriteLine(\"\u26a0\ufe0f Market is closed. Try again during trading hours.\");\n        break;\n\n    case 10016: // Invalid stops\n        Console.WriteLine(\"\u26a0\ufe0f Stop Loss or Take Profit too close to market price.\");\n        Console.WriteLine(\"   Increase distance between entry and SL/TP.\");\n        break;\n\n    case 10014: // Invalid volume\n        var limits = await service.GetVolumeLimitsAsync(\"GBPUSD\");\n        Console.WriteLine($\"\u26a0\ufe0f Volume {result.Volume} is invalid.\");\n        Console.WriteLine($\"   Min: {limits.MinVolume}, Max: {limits.MaxVolume}, Step: {limits.VolumeStep}\");\n        break;\n\n    case 10004: // Requote\n    case 10020: // Price changed\n        Console.WriteLine(\"\u26a0\ufe0f Price changed. Retrying with new price...\");\n        // Retry request\n        var retry = await service.SellMarketAsync(\"GBPUSD\", 0.5);\n        break;\n\n    default:\n        Console.WriteLine($\"\u274c Unexpected error: {result.ReturnedCodeDescription}\");\n        break;\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#example-3-retry-logic-for-requotes","title":"Example 3: Retry Logic for Requotes","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SendWithRetry(\n    MT5Service service,\n    string symbol,\n    double volume,\n    int maxRetries = 3)\n{\n    for (int attempt = 1; attempt &lt;= maxRetries; attempt++)\n    {\n        var result = await service.BuyMarketAsync(symbol, volume);\n\n        // Success\n        if (result.ReturnedCode == 10009 || result.ReturnedCode == 10008)\n        {\n            return result;\n        }\n\n        // Requote - retry\n        if (result.ReturnedCode == 10004 || result.ReturnedCode == 10020)\n        {\n            Console.WriteLine($\"Requote on attempt {attempt}, retrying...\");\n            await Task.Delay(100); // Small delay\n            continue;\n        }\n\n        // Other error - abort\n        Console.WriteLine($\"Failed: {result.ReturnedCodeDescription}\");\n        return result;\n    }\n\n    throw new Exception($\"Failed after {maxRetries} retries\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#example-4-sugar-api-with-auto-check","title":"Example 4: Sugar API with Auto-Check","text":"<pre><code>using mt5_term_api;\n\nvar service = new MT5Service(account);\n\n// Sugar API: risk-based order\nvar result = await service.BuyMarketByRisk(\n    symbol: \"EURUSD\",\n    riskAmount: 50.0,      // Risk $50\n    stopLossPoints: 20     // SL 20 points away\n);\n\n// Sugar API automatically calculates volume\nConsole.WriteLine($\"Calculated volume: {result.Volume} lots\");\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Position opened with $50 risk at ticket #{result.Order}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#example-5-modify-sltp-with-validation","title":"Example 5: Modify SL/TP with Validation","text":"<pre><code>// Modify SL/TP of existing position\nvar modifyResult = await mt5Account.OrderModifyAsync(\n    ticket: 123456,\n    stopLoss: 1.0850,\n    takeProfit: 1.0950\n);\n\nif (modifyResult.Data.ReturnedCode == 10009)\n{\n    Console.WriteLine(\"\u2705 SL/TP updated successfully\");\n}\nelse if (modifyResult.Data.ReturnedCode == 10025) // No changes\n{\n    Console.WriteLine(\"\u26a0\ufe0f New SL/TP values are same as current - no action taken\");\n}\nelse if (modifyResult.Data.ReturnedCode == 10036) // Position closed\n{\n    Console.WriteLine(\"\u26a0\ufe0f Position already closed by SL/TP or manually\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Modify failed: {modifyResult.Data.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#c-enum","title":"C# Enum","text":"<p>RetCodes are defined in enum <code>MqlErrorTradeCode</code>:</p> <pre><code>using Mt5TermApi;\n\n// Using enum instead of magic numbers\nif (result.ReturnedCode == (uint32)MqlErrorTradeCode.TradeRetcodeDone)\n{\n    Console.WriteLine(\"Success!\");\n}\n\n// Or simply use numeric constants\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine(\"Success!\");\n}\n</code></pre>"},{"location":"ReturnCodes_Reference_EN/#best-practices","title":"Best Practices","text":"<ol> <li>Always check RetCode after trading operations</li> <li>10009 = success for market orders, 10008 = success for pending orders</li> <li>Requotes (10004, 10020) - retry the request</li> <li>10019 (No Money) - check Free Margin before order</li> <li>10016 (Invalid Stops) - increase distance to SL/TP (check StopLevel)</li> <li>10018 (Market Closed) - check symbol trading hours</li> <li>Use <code>returned_code_description</code> to display user-friendly messages</li> </ol>"},{"location":"Sync_vs_Async/","title":"Synchronous vs Asynchronous Methods - When to Use What","text":"<p>Every method in MT5Account has two versions: <code>Async</code> (e.g., <code>AccountSummaryAsync</code>) and Sync (e.g., <code>AccountSummary</code>). This guide explains when to use each.</p>"},{"location":"Sync_vs_Async/#quick-answer","title":"\ud83c\udfaf Quick Answer","text":"<p>Use Async version (99% of cases): <pre><code>var summary = await account.AccountSummaryAsync();  // \u2705 Recommended\n</code></pre></p> <p>Use Sync version (rare specific scenarios): <pre><code>var summary = account.AccountSummary();  // \u26a0\ufe0f Only when necessary\n</code></pre></p>"},{"location":"Sync_vs_Async/#side-by-side-comparison","title":"\ud83d\udcca Side-by-Side Comparison","text":"Aspect Async Version (<code>await MethodAsync()</code>) Sync Version (<code>Method()</code>) Thread blocking \u274c Does NOT block thread \u2705 Blocks calling thread Performance \u2705 Better (thread pooling) \u274c Worse (one thread per call) Scalability \u2705 High (1 thread = 1000s of operations) \u274c Low (1 thread = 1 operation) Responsiveness \u2705 UI stays responsive \u274c UI freezes during call Memory usage \u2705 Lower (fewer threads) \u274c Higher (more threads) Deadlock risk \u2705 Lower \u274c Higher (especially in UI) Recommended by \u2705 Microsoft, .NET guidelines \u26a0\ufe0f Legacy compatibility only When to use Almost always Very specific scenarios"},{"location":"Sync_vs_Async/#when-to-use-async-recommended","title":"\ud83d\ude80 When to Use ASYNC (Recommended)","text":""},{"location":"Sync_vs_Async/#use-case-1-aspnet-web-apis","title":"\u2705 Use Case 1: ASP.NET / Web APIs","text":"<pre><code>// Web API Controller\n[HttpGet(\"balance\")]\npublic async Task&lt;ActionResult&lt;double&gt;&gt; GetBalance()\n{\n    // \u2705 Async frees thread for other requests\n    var summary = await _mt5Account.AccountSummaryAsync();\n    return Ok(summary.AccountBalance);\n}\n</code></pre> <p>Why: In web servers, threads are expensive. Async allows one thread to handle thousands of concurrent requests.</p> <p>Result:</p> <ul> <li>\ud83d\ude80 100 threads can handle 10,000+ concurrent requests</li> <li>Without async: 100 threads = only 100 concurrent requests</li> </ul>"},{"location":"Sync_vs_Async/#use-case-2-desktop-ui-wpf-winforms-avalonia","title":"\u2705 Use Case 2: Desktop UI (WPF, WinForms, Avalonia)","text":"<pre><code>// Button click handler\nprivate async void OnCheckBalanceClick(object sender, EventArgs e)\n{\n    // \u2705 UI thread stays responsive\n    var summary = await _mt5Account.AccountSummaryAsync();\n    BalanceLabel.Text = $\"Balance: ${summary.AccountBalance}\";\n}\n</code></pre> <p>Why: Async keeps UI responsive. User can still interact while waiting for MT5 response.</p> <p>Result:</p> <ul> <li>\u2705 UI doesn't freeze</li> <li>\u2705 User can cancel operation</li> <li>\u2705 Better user experience</li> </ul>"},{"location":"Sync_vs_Async/#use-case-3-trading-bots-strategy-execution","title":"\u2705 Use Case 3: Trading Bots / Strategy Execution","text":"<pre><code>// Trading strategy\npublic async Task ExecuteStrategyAsync()\n{\n    // \u2705 Can monitor multiple symbols concurrently\n    var tasks = symbols.Select(async symbol =&gt;\n    {\n        var tick = await _mt5Account.SymbolInfoTickAsync(symbol);\n        return AnalyzeSignal(tick);\n    });\n\n    var signals = await Task.WhenAll(tasks);\n}\n</code></pre> <p>Why: Process multiple symbols in parallel without blocking threads.</p> <p>Result:</p> <ul> <li>\ud83d\ude80 10 symbols analyzed in ~1 second (concurrent)</li> <li>Without async: 10 symbols = ~10 seconds (sequential)</li> </ul>"},{"location":"Sync_vs_Async/#use-case-4-real-time-streaming","title":"\u2705 Use Case 4: Real-Time Streaming","text":"<pre><code>// Real-time tick monitoring\nawait foreach (var tick in _mt5Account.OnSymbolTickAsync(symbols, cancellationToken))\n{\n    // \u2705 Non-blocking stream processing\n    ProcessTick(tick);\n}\n</code></pre> <p>Why: Streaming is inherently asynchronous. Can't do it with sync methods.</p> <p>Result:</p> <ul> <li>\u2705 Continuous data flow</li> <li>\u2705 Cancellable streams</li> <li>\u2705 No thread blocking</li> </ul>"},{"location":"Sync_vs_Async/#when-to-use-sync-rare-cases","title":"\u26a0\ufe0f When to Use SYNC (Rare Cases)","text":""},{"location":"Sync_vs_Async/#use-case-1-console-applications-quick-scripts","title":"\ud83d\udfe1 Use Case 1: Console Applications (Quick Scripts)","text":"<pre><code>// Simple one-off script\nstatic void Main()\n{\n    var account = new MT5Account(...);\n    account.Connect();\n\n    // \u2705 Acceptable for simple scripts\n    var summary = account.AccountSummary();\n    Console.WriteLine($\"Balance: {summary.AccountBalance}\");\n}\n</code></pre> <p>Why: For simple scripts that run once and exit, blocking is acceptable.</p> <p>When acceptable:</p> <ul> <li>Script runs once and exits</li> <li>No UI, no web server</li> <li>Not performance-critical</li> <li>Note: Even here, async Main is better (C# 7.1+)</li> </ul> <p>Better alternative: <pre><code>static async Task Main()\n{\n    var account = new MT5Account(...);\n    await account.ConnectAsync();\n\n    var summary = await account.AccountSummaryAsync();  // Still better!\n    Console.WriteLine($\"Balance: {summary.AccountBalance}\");\n}\n</code></pre></p>"},{"location":"Sync_vs_Async/#use-case-2-legacy-code-integration","title":"\ud83d\udfe1 Use Case 2: Legacy Code Integration","text":"<pre><code>// Old library that doesn't support async\npublic class LegacyTradingSystem\n{\n    private MT5Account _account;\n\n    // Old interface - can't change signature\n    public double GetBalance()\n    {\n        // \u26a0\ufe0f Forced to use sync version\n        return _account.AccountSummary().AccountBalance;\n    }\n}\n</code></pre> <p>Why: Existing codebase can't be modified to support async/await.</p> <p>When acceptable:</p> <ul> <li>Third-party library constraints</li> <li>Can't change method signatures</li> <li>Gradual migration to async</li> </ul> <p>Better alternative:</p> <ul> <li>Wrap in async layer when possible</li> <li>Plan migration to async API</li> </ul>"},{"location":"Sync_vs_Async/#use-case-3-synchronous-constructors","title":"\ud83d\udfe1 Use Case 3: Synchronous Constructors","text":"<pre><code>public class TradingContext\n{\n    public double InitialBalance { get; }\n\n    public TradingContext(MT5Account account)\n    {\n        // \u274c Can't use async in constructor\n        // \u26a0\ufe0f Forced to use sync version\n        InitialBalance = account.AccountSummary().AccountBalance;\n    }\n}\n</code></pre> <p>Why: C# constructors can't be async.</p> <p>When acceptable:</p> <ul> <li>Initialization code in constructors</li> <li>Static initializers</li> </ul> <p>Better alternative: <pre><code>public class TradingContext\n{\n    public double InitialBalance { get; private set; }\n\n    private TradingContext() { }\n\n    // \u2705 Static async factory method\n    public static async Task&lt;TradingContext&gt; CreateAsync(MT5Account account)\n    {\n        var context = new TradingContext();\n        var summary = await account.AccountSummaryAsync();\n        context.InitialBalance = summary.AccountBalance;\n        return context;\n    }\n}\n</code></pre></p>"},{"location":"Sync_vs_Async/#use-case-4-unit-tests-rare","title":"\ud83d\udfe1 Use Case 4: Unit Tests (Rare)","text":"<pre><code>[Test]\npublic void TestAccountBalance()\n{\n    var account = CreateMockAccount();\n\n    // \u26a0\ufe0f Some test frameworks don't support async tests well\n    var balance = account.AccountSummary().AccountBalance;\n\n    Assert.AreEqual(10000.0, balance);\n}\n</code></pre> <p>Why: Some older test frameworks have poor async support.</p> <p>Better alternative: <pre><code>[Test]\npublic async Task TestAccountBalance()\n{\n    var account = CreateMockAccount();\n\n    // \u2705 Modern test frameworks support async\n    var summary = await account.AccountSummaryAsync();\n\n    Assert.AreEqual(10000.0, summary.AccountBalance);\n}\n</code></pre></p>"},{"location":"Sync_vs_Async/#when-not-to-use-sync-common-mistakes","title":"\u274c When NOT to Use SYNC (Common Mistakes)","text":""},{"location":"Sync_vs_Async/#mistake-1-ui-thread-blocking","title":"\u274c Mistake 1: UI Thread Blocking","text":"<pre><code>// \u274c WRONG - Freezes UI!\nprivate void OnButtonClick(object sender, EventArgs e)\n{\n    var summary = _account.AccountSummary();  // UI freezes here!\n    BalanceLabel.Text = $\"${summary.AccountBalance}\";\n}\n\n// \u2705 CORRECT - UI stays responsive\nprivate async void OnButtonClick(object sender, EventArgs e)\n{\n    var summary = await _account.AccountSummaryAsync();\n    BalanceLabel.Text = $\"${summary.AccountBalance}\";\n}\n</code></pre>"},{"location":"Sync_vs_Async/#mistake-2-deadlock-in-aspnet","title":"\u274c Mistake 2: Deadlock in ASP.NET","text":"<pre><code>// \u274c WRONG - Can cause deadlock!\n[HttpGet(\"balance\")]\npublic ActionResult&lt;double&gt; GetBalance()\n{\n    var summary = _account.AccountSummary();  // Deadlock risk!\n    return Ok(summary.AccountBalance);\n}\n\n// \u2705 CORRECT - No deadlock\n[HttpGet(\"balance\")]\npublic async Task&lt;ActionResult&lt;double&gt;&gt; GetBalance()\n{\n    var summary = await _account.AccountSummaryAsync();\n    return Ok(summary.AccountBalance);\n}\n</code></pre>"},{"location":"Sync_vs_Async/#mistake-3-poor-scalability","title":"\u274c Mistake 3: Poor Scalability","text":"<pre><code>// \u274c WRONG - Blocks 10 threads!\nvar results = symbols.Select(symbol =&gt;\n{\n    return _account.SymbolInfoTick(symbol);  // Each call blocks a thread\n}).ToList();\n\n// \u2705 CORRECT - Concurrent, no blocking\nvar tasks = symbols.Select(symbol =&gt;\n    _account.SymbolInfoTickAsync(symbol)\n);\nvar results = await Task.WhenAll(tasks);\n</code></pre>"},{"location":"Sync_vs_Async/#technical-deep-dive","title":"\ud83d\udd2c Technical Deep Dive","text":""},{"location":"Sync_vs_Async/#how-async-works","title":"How Async Works","text":"<pre><code>// When you call:\nvar summary = await account.AccountSummaryAsync();\n\n// What happens:\n// 1. Thread sends gRPC request to MT5\n// 2. Thread is RELEASED back to thread pool (can handle other work)\n// 3. When MT5 responds, ANY available thread picks up the result\n// 4. Execution continues after 'await'\n</code></pre> <p>Key point: Thread doesn't wait idle. It's freed to do other work.</p>"},{"location":"Sync_vs_Async/#how-sync-works","title":"How Sync Works","text":"<pre><code>// When you call:\nvar summary = account.AccountSummary();\n\n// What happens:\n// 1. Thread sends gRPC request to MT5\n// 2. Thread BLOCKS and waits (can't do anything else)\n// 3. When MT5 responds, same thread continues\n// 4. Thread was wasted during wait time\n</code></pre> <p>Key point: Thread is blocked and wasted during I/O wait.</p>"},{"location":"Sync_vs_Async/#performance-impact","title":"\ud83d\udcc8 Performance Impact","text":""},{"location":"Sync_vs_Async/#scenario-web-api-with-1000-concurrent-requests","title":"Scenario: Web API with 1000 concurrent requests","text":"<p>Using Async: <pre><code>Threads needed: ~10-20\nMemory usage: ~50 MB\nResponse time: ~100ms average\nResult: \u2705 All 1000 requests handled smoothly\n</code></pre></p> <p>Using Sync: <pre><code>Threads needed: 1000\nMemory usage: ~1 GB\nResponse time: ~500ms average (thread starvation)\nResult: \u274c Server crashes or rejects requests\n</code></pre></p>"},{"location":"Sync_vs_Async/#best-practices","title":"\ud83c\udf93 Best Practices","text":""},{"location":"Sync_vs_Async/#do","title":"\u2705 DO:","text":"<ul> <li>Use async/await for ALL I/O operations (MT5 calls, database, HTTP)</li> <li>Use <code>ConfigureAwait(false)</code> in libraries (not in UI code)</li> <li>Always pass <code>CancellationToken</code> for long-running operations</li> <li>Use async Main in console apps (C# 7.1+)</li> </ul>"},{"location":"Sync_vs_Async/#dont","title":"\u274c DON'T:","text":"<ul> <li>Don't use <code>.Result</code> or <code>.Wait()</code> on async methods (causes deadlocks)</li> <li>Don't mix sync and async code unnecessarily</li> <li>Don't use sync methods in UI threads</li> <li>Don't use sync methods in ASP.NET controllers</li> </ul>"},{"location":"Sync_vs_Async/#method-naming-convention","title":"\ud83d\udd17 Method Naming Convention","text":"<p>All methods follow this pattern:</p> Pattern Example When to Use <code>MethodAsync()</code> <code>AccountSummaryAsync()</code> Default choice (99% of cases) <code>Method()</code> <code>AccountSummary()</code> Rare specific scenarios only <p>Suffix <code>Async</code> = This method is asynchronous (recommended) No suffix = This method is synchronous (compatibility only)</p>"},{"location":"Sync_vs_Async/#real-world-examples","title":"\ud83d\udcda Real-World Examples","text":""},{"location":"Sync_vs_Async/#example-1-trading-bot-async-correct","title":"Example 1: Trading Bot (Async - Correct)","text":"<pre><code>public class TradingBot\n{\n    private readonly MT5Account _account;\n\n    public async Task RunAsync(CancellationToken cancellationToken)\n    {\n        // \u2705 Monitors multiple streams concurrently\n        await foreach (var tick in _account.OnSymbolTickAsync(_symbols, cancellationToken))\n        {\n            // Analyze tick\n            var signal = await AnalyzeTickAsync(tick);\n\n            if (signal.ShouldTrade)\n            {\n                // Place order\n                await _account.OrderSendAsync(CreateOrder(signal));\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"Sync_vs_Async/#example-2-price-monitor-dashboard-async-correct","title":"Example 2: Price Monitor Dashboard (Async - Correct)","text":"<pre><code>public class PriceMonitor\n{\n    public async Task&lt;List&lt;SymbolPrice&gt;&gt; GetAllPricesAsync(string[] symbols)\n    {\n        // \u2705 Fetch all symbols concurrently (parallel)\n        var tasks = symbols.Select(async symbol =&gt;\n        {\n            var tick = await _account.SymbolInfoTickAsync(symbol);\n            return new SymbolPrice\n            {\n                Symbol = symbol,\n                Bid = tick.Bid,\n                Ask = tick.Ask,\n                Time = tick.Time.ToDateTime()\n            };\n        });\n\n        return (await Task.WhenAll(tasks)).ToList();\n    }\n}\n</code></pre> <p>Performance:</p> <ul> <li>Async: Fetches 100 symbols in ~1 second (parallel)</li> <li>Sync: Fetches 100 symbols in ~100 seconds (sequential)</li> </ul>"},{"location":"Sync_vs_Async/#decision-tree","title":"\ud83c\udfaf Decision Tree","text":"<pre><code>Need to call MT5 method?\n\u2502\n\u251c\u2500 Is this a UI application?\n\u2502  \u2514\u2500 YES \u2192 Use Async (keeps UI responsive)\n\u2502\n\u251c\u2500 Is this a web application/API?\n\u2502  \u2514\u2500 YES \u2192 Use Async (better scalability)\n\u2502\n\u251c\u2500 Is this a trading bot/long-running service?\n\u2502  \u2514\u2500 YES \u2192 Use Async (better performance)\n\u2502\n\u251c\u2500 Is this a simple one-off script?\n\u2502  \u2514\u2500 YES \u2192 Use Async Main (C# 7.1+) OR Sync if really necessary\n\u2502\n\u2514\u2500 Are you forced by legacy constraints?\n   \u2514\u2500 YES \u2192 Use Sync temporarily, plan migration to Async\n</code></pre>"},{"location":"Sync_vs_Async/#further-reading","title":"\ud83d\udcd6 Further Reading","text":"<ul> <li>Microsoft: Async/Await Best Practices</li> <li>Stephen Cleary: Don't Block on Async Code</li> <li>Task-based Asynchronous Pattern (TAP)</li> </ul>"},{"location":"Sync_vs_Async/#summary","title":"\ud83d\udca1 Summary","text":"Question Answer Which should I use? Async in 99% of cases Why Async? Better performance, scalability, responsiveness When is Sync okay? Simple scripts, legacy integration, constructors (rare) Main rule? If doing I/O (network, disk, database) \u2192 use Async <p>Remember: Async is not harder, it's just different. Once you understand <code>async/await</code>, you'll never want to go back to blocking code! \ud83d\ude80</p>"},{"location":"UserCode_Sandbox_Guide/","title":"User Code Sandbox Guide","text":""},{"location":"UserCode_Sandbox_Guide/#what-is-this","title":"What is This?","text":"<p>This is your sandbox for writing custom MT5 trading code. Connection setup is already done - you just add your trading logic!</p>"},{"location":"UserCode_Sandbox_Guide/#quick-start","title":"Quick Start","text":"<ol> <li>Uncomment the case block in Program.cs</li> <li>Open <code>Program.cs</code> (root folder)</li> <li>Find the <code>USER CODE SANDBOX</code> section (around line 172)</li> <li> <p>Uncomment the case block for \"usercode\", \"user\", \"sandbox\"</p> </li> <li> <p>Open <code>ProgramUserCode.cs</code></p> </li> <li> <p>Write your code or uncomment examples</p> </li> <li> <p>Run: <pre><code>dotnet run usercode\n</code></pre></p> </li> </ol> <p>That's it! Your code will execute with full MT5 connection.</p>"},{"location":"UserCode_Sandbox_Guide/#how-to-use","title":"How to Use","text":""},{"location":"UserCode_Sandbox_Guide/#option-1-uncomment-examples","title":"Option 1: Uncomment Examples","text":"<p>The file contains 9 ready-to-use examples:</p> <pre><code>// Example 1: Get account information\n// var accountInfo = await service.GetAccountInfoAsync();\n// Console.WriteLine($\"Balance: ${accountInfo.Balance}\");\n</code></pre> <p>Just remove <code>//</code> to activate!</p>"},{"location":"UserCode_Sandbox_Guide/#option-2-write-your-own-code","title":"Option 2: Write Your Own Code","text":"<p>Add your logic between the markers:</p> <pre><code>// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// YOUR CODE STARTS HERE \u2193\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n// Your trading strategy here...\n\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// YOUR CODE ENDS HERE \u2191\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#available-commands","title":"Available Commands","text":"<p>Run your code with any of these:</p> <pre><code>dotnet run usercode\ndotnet run user\ndotnet run sandbox\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#whats-already-set-up","title":"What's Already Set Up","text":"<p>\u2713 Connection - MT5 Terminal connected via gRPC</p> <p>\u2713 Configuration - Loaded from <code>appsettings.json</code></p> <p>\u2713 MT5Account - Low-level gRPC client (variable: <code>account</code>)</p> <p>\u2713 MT5Service - High-level wrapper with Sugar API (variable: <code>service</code>)</p>"},{"location":"UserCode_Sandbox_Guide/#can-you-mix-api-levels","title":"Can You Mix API Levels?","text":"<p>Yes! You can use all three levels in one file:</p> <pre><code>// Low-level (direct gRPC)\nvar positions = await account.PositionsGetAsync(new Empty());\n\n// Mid-level (MT5Service)\nvar accountInfo = await service.GetAccountInfoAsync();\n\n// High-level (Sugar API)\nvar result = await service.BuyMarketByRisk(\"EURUSD\", 10.0, 20);\n</code></pre> <p>All three variables are available simultaneously: - <code>account</code> - for full control (gRPC) - <code>service</code> - for convenient methods (Service + Sugar)</p>"},{"location":"UserCode_Sandbox_Guide/#quick-reference","title":"Quick Reference","text":""},{"location":"UserCode_Sandbox_Guide/#get-account-info","title":"Get Account Info","text":"<pre><code>var accountInfo = await service.GetAccountInfoAsync();\nConsole.WriteLine($\"Balance: ${accountInfo.Balance}\");\nConsole.WriteLine($\"Equity: ${accountInfo.Equity}\");\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#get-current-price","title":"Get Current Price","text":"<pre><code>var tick = await service.SymbolInfoTickAsync(\"EURUSD\");\nConsole.WriteLine($\"EURUSD Bid: {tick.Bid}, Ask: {tick.Ask}\");\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#open-market-order-risk-based","title":"Open Market Order (Risk-Based)","text":"<pre><code>var result = await service.BuyMarketByRisk(\n    symbol: \"EURUSD\",\n    riskAmount: 10.0,        // Risk $10\n    stopLossPoints: 20       // SL 20 points away\n);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Order opened: #{result.Order}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Failed: {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#place-pending-order","title":"Place Pending Order","text":"<pre><code>var result = await service.BuyLimitPoints(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    offsetPoints: 20,        // 20 points below Ask\n    stopLossPoints: 15,\n    takeProfitPoints: 30\n);\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#get-open-positions","title":"Get Open Positions","text":"<pre><code>var positions = await account.PositionsGetAsync(new Empty());\nConsole.WriteLine($\"Open positions: {positions.Data.Positions.Count}\");\n\nforeach (var pos in positions.Data.Positions)\n{\n    Console.WriteLine($\"  #{pos.Ticket} {pos.Symbol} {pos.Type} {pos.Volume} lots\");\n}\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#close-all-positions","title":"Close All Positions","text":"<pre><code>await service.CloseAll(\"EURUSD\");\n</code></pre>"},{"location":"UserCode_Sandbox_Guide/#return-codes-retcodes","title":"Return Codes (RetCodes)","text":"<p>Always check RetCode after trading operations!</p> <pre><code>if (result.ReturnedCode == 10009)  // Success for market orders\nif (result.ReturnedCode == 10008)  // Success for pending orders\n</code></pre> <p>Complete list: ReturnCodes_Reference_EN.md</p>"},{"location":"UserCode_Sandbox_Guide/#documentation","title":"Documentation","text":"<ul> <li>MT5Account API - Low-level gRPC client (72 methods)</li> <li>MT5Service API - Mid-level convenience wrapper (66 methods)</li> <li>MT5Sugar API - High-level extension methods (48 methods + 2 records)</li> </ul>"},{"location":"UserCode_Sandbox_Guide/#tips","title":"Tips","text":"<ol> <li>Start simple - Uncomment one example at a time</li> <li>Check RetCode - Always validate trading operations</li> <li>Use Sugar API - Methods like <code>BuyMarketByRisk()</code> are easier than low-level</li> <li>Test on demo - Make sure you're using a demo account first!</li> <li>Read docs - ReturnCodes_Reference_EN.md explains all error codes</li> </ol>"},{"location":"Your_First_Project.ru/","title":"Your First Project From Scratch","text":"<p>Quick Start - Create your own MT5 trading project in 10 minutes using only the MetaRPC.MT5 NuGet package</p>"},{"location":"Your_First_Project.ru/#who-is-this-guide-for","title":"Who Is This Guide For?","text":"<p>This document is designed for those who want to:</p> <ul> <li>Get started quickly writing code for MT5 in their own project</li> <li>Avoid cloning the entire CSharpMT5 repository</li> <li>Create a project from scratch and connect minimal dependencies</li> <li>Write their first method and see results immediately</li> </ul> <p>Difference between this guide and Getting_Started.md:</p> Getting Started Your First Project (this guide) Clone a ready-made repository Create a project from scratch Study architecture and examples Write working code immediately Long learning path Quick results For deep dive For quick start <p>After completing this guide and getting your first results, we recommend studying Getting Started to understand the full SDK architecture.</p>"},{"location":"Your_First_Project.ru/#what-will-we-do","title":"What Will We Do?","text":"<p>In this guide, we'll create a minimalist project that:</p> <ol> <li>Connects to MT5 terminal through gRPC gateway</li> <li>Retrieves account balance</li> <li>Outputs results to console</li> </ol> <p>This takes 10 minutes and requires minimal code.</p>"},{"location":"Your_First_Project.ru/#step-1-install-net-8-sdk","title":"Step 1: Install .NET 8 SDK","text":"<p>If you don't have .NET 8 SDK installed yet:</p> <p>Download and install:</p> <ul> <li>.NET 8 SDK Download</li> </ul> <p>Verify installation:</p> <pre><code>dotnet --version\n# Should show: 8.0.x or higher\n</code></pre>"},{"location":"Your_First_Project.ru/#step-2-create-a-new-console-project","title":"Step 2: Create a New Console Project","text":"<p>Open terminal (command prompt) and execute:</p> <pre><code># Create project folder and navigate into it\nmkdir MyMT5Project\ncd MyMT5Project\n\n# Create new console project in current folder\ndotnet new console\n</code></pre> <p>What happened:</p> <ul> <li>Created <code>MyMT5Project</code> folder</li> <li>Created .NET console project with files:</li> <li><code>MyMT5Project.csproj</code> - project file</li> <li><code>Program.cs</code> - main code file</li> </ul> <p>Opening the Project in VS Code:</p> <p>If you're working through VS Code, the editor won't automatically open the created directory. To do this:</p> <p>Method 1: Via VS Code Menu - File \u2192 Open Folder - Select <code>C:\\Users\\[your_name]\\MyMT5Project</code> - Click \"Select Folder\"</p> <p>Method 2: Via Terminal <pre><code># While in the project folder, execute:\ncode .\n</code></pre> (the dot means \"open current folder in VS Code\")</p> <p>Method 3: Drag and Drop - Drag the <code>MyMT5Project</code> folder onto the VS Code icon</p> <p>After opening, you'll see the project structure: <pre><code>MyMT5Project/\n\u251c\u2500\u2500 Program.cs\n\u251c\u2500\u2500 MyMT5Project.csproj\n\u2514\u2500\u2500 obj/\n</code></pre></p>"},{"location":"Your_First_Project.ru/#step-3-install-metarpcmt5-nuget-package","title":"Step 3: Install MetaRPC.MT5 NuGet Package","text":"<p>This is the most important step - installing the package that contains everything needed:</p> <pre><code>dotnet add package MetaRPC.MT5\n</code></pre> <p>What this package includes:</p> <ul> <li>Proto files (Protocol Buffers schemas for gRPC)</li> <li><code>MT5Account</code> class for low-level interaction with MT5</li> <li>All necessary dependencies (Grpc.Net.Client, Grpc.Core, etc.)</li> </ul> <p>Important: This package is ALL you need to work with MT5. No additional files need to be cloned.</p>"},{"location":"Your_First_Project.ru/#step-4-install-packages-for-configuration-management","title":"Step 4: Install Packages for Configuration Management","text":"<p>We'll need packages to read <code>appsettings.json</code>:</p> <pre><code>dotnet add package Microsoft.Extensions.Configuration\ndotnet add package Microsoft.Extensions.Configuration.Json\ndotnet add package Microsoft.Extensions.Configuration.Binder\n</code></pre>"},{"location":"Your_First_Project.ru/#step-5-create-appsettingsjson-configuration-file","title":"Step 5: Create appsettings.json Configuration File","text":"<p>Create an <code>appsettings.json</code> file in the project root (next to <code>Program.cs</code>):</p> <pre><code>{\n  \"MT5\": {\n    \"User\": 591129415,\n    \"Password\": \"IpoHj17tYu67@\",\n    \"ServerName\": \"FxPro-MT5 Demo\",\n    \"Host\": \"mt5.mrpc.pro\",\n    \"Port\": 443,\n    \"GrpcServer\": \"https://mt5.mrpc.pro:443\",\n    \"BaseChartSymbol\": \"EURUSD\",\n    \"InstanceId\": null,\n    \"ConnectTimeoutSeconds\": 120\n  }\n}\n</code></pre> <p>\u26a0\ufe0f IMPORTANT: The <code>User</code>, <code>Password</code>, and <code>ServerName</code> values in the example above are placeholders! You MUST replace them with your MT5 account credentials, otherwise the connection won't work.</p> <p>Parameter explanation:</p> Parameter Description Example User Your MT5 account number (login) <code>591129415</code> Password Master password for MT5 account <code>\"IpoHj17tYu67@\"</code> ServerName Your broker's server name <code>\"FxPro-MT5 Demo\"</code> Host gRPC gateway address (provided by MetaRPC) <code>\"mt5.mrpc.pro\"</code> Port Gateway port <code>443</code> GrpcServer Full gateway URL <code>\"https://mt5.mrpc.pro:443\"</code> BaseChartSymbol Default trading symbol <code>\"EURUSD\"</code> InstanceId Instance ID (leave <code>null</code> for auto) <code>null</code> ConnectTimeoutSeconds Connection timeout in seconds <code>120</code> <p>What needs to be replaced:</p> <p>\u270f\ufe0f MUST replace with YOUR data:</p> <ul> <li><code>User</code> - your MT5 account login</li> <li><code>Password</code> - your MT5 account password</li> <li><code>ServerName</code> - your broker's server name (shown in MT5 terminal)</li> </ul> <p>\u2705 Leave unchanged:</p> <ul> <li><code>Host</code>, <code>Port</code>, <code>GrpcServer</code> - MetaRPC public gateway address</li> <li><code>BaseChartSymbol</code>, <code>InstanceId</code>, <code>ConnectTimeoutSeconds</code> - standard settings</li> </ul> <p>Don't have an MT5 account? Read MT5 for Beginners - it shows step-by-step how to create a demo account.</p>"},{"location":"Your_First_Project.ru/#step-6-configure-appsettingsjson-copying-to-bin","title":"Step 6: Configure appsettings.json Copying to bin","text":"<p>Open the <code>MyMT5Project.csproj</code> file and add this section inside <code>&lt;Project&gt;</code>:</p> <pre><code>&lt;ItemGroup&gt;\n  &lt;None Remove=\"appsettings.json\" /&gt;\n  &lt;Content Include=\"appsettings.json\"&gt;\n    &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;\n  &lt;/Content&gt;\n&lt;/ItemGroup&gt;\n</code></pre> <p>Complete csproj file example:</p> <pre><code>&lt;Project Sdk=\"Microsoft.NET.Sdk\"&gt;\n\n  &lt;PropertyGroup&gt;\n    &lt;OutputType&gt;Exe&lt;/OutputType&gt;\n    &lt;TargetFramework&gt;net8.0&lt;/TargetFramework&gt;\n    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;\n    &lt;Nullable&gt;enable&lt;/Nullable&gt;\n  &lt;/PropertyGroup&gt;\n\n  &lt;ItemGroup&gt;\n    &lt;PackageReference Include=\"MetaRPC.MT5\" Version=\"1.0.942\" /&gt;\n    &lt;PackageReference Include=\"Microsoft.Extensions.Configuration\" Version=\"8.0.0\" /&gt;\n    &lt;PackageReference Include=\"Microsoft.Extensions.Configuration.Binder\" Version=\"8.0.2\" /&gt;\n    &lt;PackageReference Include=\"Microsoft.Extensions.Configuration.Json\" Version=\"8.0.0\" /&gt;\n  &lt;/ItemGroup&gt;\n\n  &lt;!-- Copy appsettings.json to bin --&gt;\n  &lt;ItemGroup&gt;\n    &lt;None Remove=\"appsettings.json\" /&gt;\n    &lt;Content Include=\"appsettings.json\"&gt;\n      &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;\n    &lt;/Content&gt;\n  &lt;/ItemGroup&gt;\n\n&lt;/Project&gt;\n</code></pre>"},{"location":"Your_First_Project.ru/#step-7-write-code-to-connect-and-retrieve-balance","title":"Step 7: Write Code to Connect and Retrieve Balance","text":"<p>Open <code>Program.cs</code> and replace its content with the following code:</p> <pre><code>using Microsoft.Extensions.Configuration;\nusing mt5_term_api;\n\n// ============================================================================\n// CONFIGURATION - Load settings from appsettings.json\n// ============================================================================\n\nvar configuration = new ConfigurationBuilder()\n    .SetBasePath(Directory.GetCurrentDirectory())\n    .AddJsonFile(\"appsettings.json\", optional: false, reloadOnChange: false)\n    .Build();\n\nvar mt5Config = configuration.GetSection(\"MT5\");\n\nulong user = mt5Config.GetValue&lt;ulong&gt;(\"User\");\nstring password = mt5Config.GetValue&lt;string&gt;(\"Password\") ?? \"\";\nstring serverName = mt5Config.GetValue&lt;string&gt;(\"ServerName\") ?? \"\";\nstring grpcServer = mt5Config.GetValue&lt;string&gt;(\"GrpcServer\") ?? \"\";\nstring baseSymbol = mt5Config.GetValue&lt;string&gt;(\"BaseChartSymbol\") ?? \"EURUSD\";\nint connectTimeout = mt5Config.GetValue&lt;int&gt;(\"ConnectTimeoutSeconds\", 120);\n\nConsole.WriteLine(\"=== MT5 Connection Configuration ===\");\nConsole.WriteLine($\"User: {user}\");\nConsole.WriteLine($\"Server: {serverName}\");\nConsole.WriteLine($\"gRPC: {grpcServer}\");\nConsole.WriteLine($\"Symbol: {baseSymbol}\");\nConsole.WriteLine(\"====================================\\n\");\n\n// ============================================================================\n// CONNECTION - Create MT5Account (LOW-LEVEL API from NuGet package)\n// ============================================================================\n\nConsole.WriteLine(\"Connecting to MT5 gateway...\");\n\n// Create MT5Account - pass credentials to constructor\nvar mt5Account = new MT5Account(user, password, grpcServer, Guid.NewGuid());\n\n// Connect to MT5 terminal via ServerName\nawait mt5Account.ConnectByServerNameAsync(\n    serverName: serverName,\n    baseChartSymbol: baseSymbol,\n    waitForTerminalIsAlive: true,\n    timeoutSeconds: connectTimeout\n);\n\nConsole.WriteLine(\"\u2713 Connected successfully!\");\nConsole.WriteLine($\"Account ID: {mt5Account.Id}\\n\");\n\n// ============================================================================\n// FETCH BALANCE - Use AccountSummaryAsync (LOW-LEVEL method)\n// ============================================================================\n\nConsole.WriteLine(\"Fetching account information...\");\n\nvar accountSummary = await mt5Account.AccountSummaryAsync(\n    deadline: DateTime.UtcNow.AddSeconds(30),\n    cancellationToken: CancellationToken.None\n);\n\n// Output account information using REAL field names from proto\nConsole.WriteLine(\"=== Account Information ===\");\nConsole.WriteLine($\"Login: {accountSummary.AccountLogin}\");\nConsole.WriteLine($\"Name: {accountSummary.AccountUserName}\");\nConsole.WriteLine($\"Company: {accountSummary.AccountCompanyName}\");\nConsole.WriteLine($\"Currency: {accountSummary.AccountCurrency}\");\nConsole.WriteLine($\"Leverage: 1:{accountSummary.AccountLeverage}\");\nConsole.WriteLine($\"Balance: {accountSummary.AccountBalance:F2}\");\nConsole.WriteLine($\"Credit: {accountSummary.AccountCredit:F2}\");\nConsole.WriteLine($\"Equity: {accountSummary.AccountEquity:F2}\");\nConsole.WriteLine($\"Trade Mode: {accountSummary.AccountTradeMode}\");\nConsole.WriteLine(\"===========================\\n\");\n\nConsole.WriteLine(\"\u2713 Success! Your first MT5 connection using LOW-LEVEL API is complete.\");\n</code></pre>"},{"location":"Your_First_Project.ru/#step-8-run-the-project","title":"Step 8: Run the Project","text":"<p>Save all files and execute:</p> <pre><code>dotnet run\n</code></pre> <p>Expected output:</p> <pre><code>=== MT5 Connection Configuration ===\nUser: 591129415\nServer: FxPro-MT5 Demo\ngRPC: https://mt5.mrpc.pro:443\nSymbol: EURUSD\n====================================\n\nConnecting to MT5 gateway...\n\u2713 Connected successfully!\nAccount ID: 9afb34d7-45a3-4433-b6f5-45b32e52e6bd\n\nFetching account information...\n=== Account Information ===\nLogin: your login\nName: your name\nCompany: FXPRO Financial Services Ltd\nCurrency: EUR\nLeverage: 1:30\nBalance: 9519.02\nCredit: 0.00\nEquity: 9519.02\nTrade Mode: MrpcAccountTradeModeDemo\n===========================\n\n\u2713 Success! Your first MT5 connection using LOW-LEVEL API is complete.\n</code></pre>"},{"location":"Your_First_Project.ru/#congratulations-you-did-it","title":"Congratulations! You Did It!","text":"<p>You just:</p> <p>\u2705 Created a new .NET project from scratch</p> <p>\u2705 Connected the MetaRPC.MT5 NuGet package</p> <p>\u2705 Configured connection settings</p> <p>\u2705 Connected to MT5 terminal via gRPC</p> <p>\u2705 Retrieved account balance programmatically</p> <p>This was a low-level approach with direct use of <code>MT5Account</code> and gRPC.</p>"},{"location":"Your_First_Project.ru/#whats-next","title":"What's Next?","text":"<p>Now that you have a working project, you can:</p>"},{"location":"Your_First_Project.ru/#1-study-the-full-sdk-architecture","title":"1. Study the Full SDK Architecture","text":"<p>Read Getting Started to learn about:</p> <ul> <li>MT5Account (Low-Level) - what you just used</li> <li>MT5Service (Wrappers) - convenient wrappers over MT5Account</li> <li>MT5Sugar (High-Level) - syntactic sugar for rapid development</li> </ul>"},{"location":"Your_First_Project.ru/#2-add-more-functionality","title":"2. Add More Functionality","text":"<p>Examples of what you can do with MT5Account (Low-Level API):</p> <pre><code>// Get all open positions and orders\nvar openedOrders = await mt5Account.OpenedOrdersAsync(\n    sortMode: BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc\n);\n\n// Send a market order\nvar orderRequest = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy\n};\nvar orderResponse = await mt5Account.OrderSendAsync(orderRequest);\nConsole.WriteLine($\"Order: {orderResponse.Order}, Deal: {orderResponse.Deal}\");\n\n// Get real-time ticks (streaming)\nvar symbols = new[] { \"EURUSD\", \"GBPUSD\" };\nusing var cts = new CancellationTokenSource(TimeSpan.FromSeconds(30));\ntry\n{\n    await foreach (var tickData in mt5Account.OnSymbolTickAsync(symbols, cts.Token))\n    {\n        var tick = tickData.SymbolTick;\n        Console.WriteLine($\"Symbol: {tick.Symbol}, Bid: {tick.Bid}, Ask: {tick.Ask}\");\n        // Use break to exit the loop\n    }\n}\ncatch (Grpc.Core.RpcException ex) when (ex.StatusCode == Grpc.Core.StatusCode.Cancelled)\n{\n    Console.WriteLine(\"Timeout expired\");\n}\n\n// Get position history\nvar positionsHistory = await mt5Account.PositionsHistoryAsync(\n    sortType: AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AhPositionOpenTimeAsc,\n    openFrom: DateTime.UtcNow.AddDays(-7),\n    openTo: DateTime.UtcNow,\n    page: 0,\n    size: 100\n);\nforeach (var position in positionsHistory.HistoryPositions)\n{\n    Console.WriteLine($\"Ticket: {position.PositionTicket}, Profit: {position.Profit}\");\n}\n</code></pre>"},{"location":"Your_First_Project.ru/#3-copy-ready-made-classes-from-repository","title":"3. Copy Ready-Made Classes from Repository","text":"<p>If you want to use MT5Service or MT5Sugar in your project:</p> <ol> <li>Clone the CSharpMT5 repository</li> <li>Copy <code>MT5Service.cs</code> and/or <code>MT5Sugar.cs</code> files to your project</li> <li>Use convenient high-level methods</li> </ol> <p>Example with MT5Sugar:</p> <pre><code>var sugar = new MT5Sugar(mt5Account, instanceId);\n\n// Open Buy position\nawait sugar.Buy(\"EURUSD\", 0.01);\n\n// Close all positions for a symbol\nawait sugar.CloseAllPositions(\"EURUSD\");\n\n// Get balance in one line\nvar balance = await sugar.GetBalance();\n</code></pre>"},{"location":"Your_First_Project.ru/#4-study-ready-made-examples","title":"4. Study Ready-Made Examples","text":"<p>The CSharpMT5 repository contains many examples:</p> <ul> <li>Orchestrators - ready-made trading strategies</li> <li>Adaptive Preset - smart multi-strategy</li> <li>User Code Sandbox - template for your strategies</li> </ul>"},{"location":"Your_First_Project.ru/#5-read-additional-guides","title":"5. Read Additional Guides","text":"<ul> <li>Sync vs Async - when to use synchronous/asynchronous methods</li> <li>gRPC Stream Management - working with streaming data</li> <li>Return Codes Reference - operation return codes</li> </ul>"},{"location":"Your_First_Project.ru/#do-i-need-to-install-mt5-terminal","title":"Do I Need to Install MT5 Terminal?","text":"<p>No! The MetaRPC gateway connects to MT5 servers itself. You only need:</p> <ul> <li>MT5 account login/password</li> <li>Broker server name</li> <li>Access to gRPC gateway</li> </ul>"},{"location":"Your_First_Project.ru/#your-project-structure","title":"Your Project Structure","text":"<p>After completing all steps, your project structure should look like this:</p> <pre><code>MyMT5Project/\n\u251c\u2500\u2500 appsettings.json          # Connection configuration\n\u251c\u2500\u2500 MyMT5Project.csproj       # Project file with dependencies\n\u251c\u2500\u2500 Program.cs                # Main application code\n\u2514\u2500\u2500 bin/                      # Compiled files (created automatically)\n    \u2514\u2500\u2500 Debug/\n        \u2514\u2500\u2500 net8.0/\n            \u251c\u2500\u2500 MyMT5Project.exe\n            \u2514\u2500\u2500 appsettings.json\n</code></pre>"},{"location":"Your_First_Project.ru/#summary-what-we-did","title":"Summary: What We Did","text":"<p>In this guide, you created a minimalist project that:</p> <ol> <li>Uses only NuGet package - no repository cloning required</li> <li>Connects to MT5 through gRPC gateway using <code>MT5Account</code> class from package</li> <li>Reads configuration from <code>appsettings.json</code></li> <li>Calls real low-level methods - <code>ConnectByServerNameAsync()</code>, <code>AccountSummaryAsync()</code></li> <li>Works with proto structures - <code>AccountSummaryData</code> with fields like <code>AccountBalance</code>, <code>AccountEquity</code></li> </ol> <p>This is the foundation for any of your MT5 projects in C# using direct low-level API.</p>"},{"location":"Your_First_Project.ru/#next-steps","title":"Next Steps","text":"<p>Now you're ready for:</p> <ul> <li>\ud83d\udcd6 Getting Started - Complete SDK architecture study</li> <li>\ud83d\udcd6 MT5Account API - Low-level API reference</li> <li>\ud83d\udcd6 MT5Service API - Convenient wrappers</li> <li>\ud83d\udcd6 MT5Sugar API - High-level API</li> <li>\ud83c\udfaf Orchestrators - Ready-made trading strategies</li> </ul> <p>Good luck developing your trading systems!</p> <p>\"The best way to learn something is to build it from scratch. Now you have the foundation. Build.\"</p> <p>\u2014 MetaRPC Team</p>"},{"location":"API_Reference/MT5Account.API/","title":"MT5Account API","text":"<p>Parsing package/Helpers/MT5Account.cs... Found 71 methods Generated docs/API_Reference/MT5Account.API.md</p>"},{"location":"API_Reference/MT5Account.API/#table-of-contents","title":"Table of Contents","text":"<ol> <li>ConnectByHostPortAsync</li> <li>Connect</li> <li>ConnectByServerNameAsync</li> <li>ConnectByServerName</li> <li>AccountSummaryAsync</li> <li>AccountSummary</li> <li>AccountInfoDoubleAsync</li> <li>AccountInfoDouble</li> <li>AccountInfoIntegerAsync</li> <li>AccountInfoInteger</li> <li>AccountInfoStringAsync</li> <li>AccountInfoString</li> <li>SymbolsTotalAsync</li> <li>SymbolsTotal</li> <li>SymbolExistAsync</li> <li>SymbolExist</li> <li>SymbolNameAsync</li> <li>SymbolName</li> <li>SymbolSelectAsync</li> <li>SymbolSelect</li> <li>SymbolIsSynchronizedAsync</li> <li>SymbolIsSynchronized</li> <li>SymbolInfoDoubleAsync</li> <li>SymbolInfoDouble</li> <li>SymbolInfoIntegerAsync</li> <li>SymbolInfoInteger</li> <li>SymbolInfoStringAsync</li> <li>SymbolInfoString</li> <li>SymbolInfoMarginRateAsync</li> <li>SymbolInfoMarginRate</li> <li>SymbolInfoTickAsync</li> <li>SymbolInfoTick</li> <li>SymbolInfoSessionQuoteAsync</li> <li>SymbolInfoSessionQuote</li> <li>SymbolInfoSessionTradeAsync</li> <li>SymbolInfoSessionTrade</li> <li>OpenedOrdersAsync</li> <li>OpenedOrders</li> <li>OrderHistoryAsync</li> <li>OrderHistory</li> <li>OpenedOrdersTicketsAsync</li> <li>OpenedOrdersTickets</li> <li>PositionsHistoryAsync</li> <li>PositionsHistory</li> <li>PositionsTotalAsync</li> <li>PositionsTotal</li> <li>MarketBookAddAsync</li> <li>MarketBookAdd</li> <li>MarketBookGetAsync</li> <li>MarketBookGet</li> <li>MarketBookReleaseAsync</li> <li>MarketBookRelease</li> <li>TickValueWithSizeAsync</li> <li>TickValueWithSize</li> <li>SymbolParamsManyAsync</li> <li>SymbolParamsMany</li> <li>OrderSendAsync</li> <li>OrderSend</li> <li>OrderModifyAsync</li> <li>OrderModify</li> <li>OrderCloseAsync</li> <li>OrderClose</li> <li>OrderCalcMarginAsync</li> <li>OrderCalcMargin</li> <li>OrderCheckAsync</li> <li>OrderCheck</li> <li>OnSymbolTickAsync</li> <li>OnTradeAsync</li> <li>OnPositionProfitAsync</li> <li>OnPositionsAndPendingOrdersTicketsAsync</li> <li>OnTradeTransactionAsync</li> </ol>"},{"location":"API_Reference/MT5Account.API/#connectbyhostportasync","title":"ConnectByHostPortAsync","text":"<p>Connects to the MT5 terminal using host and port asynchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature","title":"Signature","text":"<pre><code>public Task ConnectByHostPortAsync(\n    string host,\n    int port = 443,\n    string baseChartSymbol = \"EURUSD\",\n    bool waitForTerminalIsAlive = true,\n    int timeoutSeconds = 30,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters","title":"Parameters","text":"Parameter Type Description <code>host</code> <code>string</code> The IP address or domain of the MT5 server. <code>port</code> <code>int</code> The port on which the MT5 server listens (default is 443). <code>baseChartSymbol</code> <code>string</code> The base chart symbol to use (e.g., \"EURUSD\"). <code>waitForTerminalIsAlive</code> <code>bool</code> Whether to wait for terminal readiness before returning. <code>timeoutSeconds</code> <code>int</code> How long to wait for terminal readiness before timing out. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns","title":"Returns","text":"<p><code>Task</code> - A task representing the asynchronous connection operation.</p>"},{"location":"API_Reference/MT5Account.API/#connect","title":"Connect","text":"<p>Connects to the MT5 terminal using host and port synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_1","title":"Signature","text":"<pre><code>public void Connect(\n    string host,\n    int port = 443,\n    string baseChartSymbol = \"EURUSD\",\n    bool waitForTerminalIsAlive = true,\n    int timeoutSeconds = 30\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>host</code> <code>string</code> The IP address or domain of the MT5 server. <code>port</code> <code>int</code> The port on which the MT5 server listens (default is 443). <code>baseChartSymbol</code> <code>string</code> The base chart symbol to use (e.g., \"EURUSD\"). <code>waitForTerminalIsAlive</code> <code>bool</code> Whether to wait for terminal readiness before returning. <code>timeoutSeconds</code> <code>int</code> How long to wait for terminal readiness before timing out."},{"location":"API_Reference/MT5Account.API/#connectbyservernameasync","title":"ConnectByServerNameAsync","text":"<p>Connects to the MT5 terminal using server name asynchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_2","title":"Signature","text":"<pre><code>public Task ConnectByServerNameAsync(\n    string serverName,\n    string baseChartSymbol = \"EURUSD\",\n    bool waitForTerminalIsAlive = true,\n    int timeoutSeconds = 30,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>serverName</code> <code>string</code> The MT5 server cluster name. <code>baseChartSymbol</code> <code>string</code> The base chart symbol to use (e.g., \"EURUSD\"). <code>waitForTerminalIsAlive</code> <code>bool</code> Whether to wait for terminal readiness before returning. <code>timeoutSeconds</code> <code>int</code> How long to wait for terminal readiness before timing out. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_1","title":"Returns","text":"<p><code>Task</code> - A task representing the asynchronous connection operation.</p>"},{"location":"API_Reference/MT5Account.API/#connectbyservername","title":"ConnectByServerName","text":"<p>Connects to the MT5 terminal using server name synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_3","title":"Signature","text":"<pre><code>public void ConnectByServerName(\n    string serverName,\n    string baseChartSymbol = \"EURUSD\",\n    bool waitForTerminalIsAlive = true,\n    int timeoutSeconds = 30\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>serverName</code> <code>string</code> The MT5 server cluster name. <code>baseChartSymbol</code> <code>string</code> The base chart symbol to use (e.g., \"EURUSD\"). <code>waitForTerminalIsAlive</code> <code>bool</code> Whether to wait for terminal readiness before returning. <code>timeoutSeconds</code> <code>int</code> How long to wait for terminal readiness before timing out."},{"location":"API_Reference/MT5Account.API/#accountsummaryasync","title":"AccountSummaryAsync","text":"<p>Gets the complete summary of the trading account in a single call. Returns all essential account information including balance, equity, margin, profit, leverage, and currency. This is the recommended method for retrieving account data as it minimizes network calls.</p>"},{"location":"API_Reference/MT5Account.API/#signature_4","title":"Signature","text":"<pre><code>public Task&lt;AccountSummaryData&gt; AccountSummaryAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional deadline after which the request will be canceled if not completed. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the request."},{"location":"API_Reference/MT5Account.API/#returns_2","title":"Returns","text":"<p><code>Task&lt;AccountSummaryData&gt;</code> - The server's response containing account summary data.</p>"},{"location":"API_Reference/MT5Account.API/#accountsummary","title":"AccountSummary","text":"<p>Gets the complete summary of the trading account synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_5","title":"Signature","text":"<pre><code>public AccountSummaryData AccountSummary(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional deadline after which the request will be canceled if not completed. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the request."},{"location":"API_Reference/MT5Account.API/#returns_3","title":"Returns","text":"<p><code>AccountSummaryData</code> - The server's response containing account summary data.</p>"},{"location":"API_Reference/MT5Account.API/#accountinfodoubleasync","title":"AccountInfoDoubleAsync","text":"<p>Retrieves a specific double-precision property of the trading account. Use this to get individual numeric values such as BALANCE, EQUITY, MARGIN, PROFIT, etc.</p>"},{"location":"API_Reference/MT5Account.API/#signature_6","title":"Signature","text":"<pre><code>public Task&lt;double&gt; AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoDoublePropertyType</code> The account double property to retrieve. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the call will be cancelled. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the operation."},{"location":"API_Reference/MT5Account.API/#returns_4","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - The double value of the requested account property.</p>"},{"location":"API_Reference/MT5Account.API/#accountinfodouble","title":"AccountInfoDouble","text":"<p>Retrieves a specific double-precision property of the trading account synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_7","title":"Signature","text":"<pre><code>public double AccountInfoDouble(\n    AccountInfoDoublePropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoDoublePropertyType</code> The account double property to retrieve. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the call will be cancelled. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the operation."},{"location":"API_Reference/MT5Account.API/#returns_5","title":"Returns","text":"<p><code>double</code> - The double value of the requested account property.</p>"},{"location":"API_Reference/MT5Account.API/#accountinfointegerasync","title":"AccountInfoIntegerAsync","text":"<p>Retrieves a specific integer property of the trading account. Use this to get values such as LOGIN, LEVERAGE, TRADE_MODE, LIMIT_ORDERS, etc.</p>"},{"location":"API_Reference/MT5Account.API/#signature_8","title":"Signature","text":"<pre><code>public Task&lt;long&gt; AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoIntegerPropertyType</code> The account integer property to retrieve. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the call will be cancelled. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the operation."},{"location":"API_Reference/MT5Account.API/#returns_6","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - The integer value of the requested account property.</p>"},{"location":"API_Reference/MT5Account.API/#accountinfointeger","title":"AccountInfoInteger","text":"<p>Retrieves a specific integer property of the trading account synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_9","title":"Signature","text":"<pre><code>public long AccountInfoInteger(\n    AccountInfoIntegerPropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoIntegerPropertyType</code> The account integer property to retrieve. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the call will be cancelled. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the operation."},{"location":"API_Reference/MT5Account.API/#returns_7","title":"Returns","text":"<p><code>long</code> - The integer value of the requested account property.</p>"},{"location":"API_Reference/MT5Account.API/#accountinfostringasync","title":"AccountInfoStringAsync","text":"<p>Retrieves a specific string property of the trading account. Use this to get textual information such as account NAME, SERVER, CURRENCY, or COMPANY.</p>"},{"location":"API_Reference/MT5Account.API/#signature_10","title":"Signature","text":"<pre><code>public Task&lt;string&gt; AccountInfoStringAsync(\n    AccountInfoStringPropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoStringPropertyType</code> The account string property to retrieve. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the call will be cancelled. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the operation."},{"location":"API_Reference/MT5Account.API/#returns_8","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - The string value of the requested account property.</p>"},{"location":"API_Reference/MT5Account.API/#accountinfostring","title":"AccountInfoString","text":"<p>Retrieves a specific string property of the trading account synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_11","title":"Signature","text":"<pre><code>public string AccountInfoString(\n    AccountInfoStringPropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoStringPropertyType</code> The account string property to retrieve. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the call will be cancelled. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the operation."},{"location":"API_Reference/MT5Account.API/#returns_9","title":"Returns","text":"<p><code>string</code> - The string value of the requested account property.</p>"},{"location":"API_Reference/MT5Account.API/#symbolstotalasync","title":"SymbolsTotalAsync","text":"<p>Gets the total count of available symbols on the MT5 server. Returns either all symbols known to the server or only those currently shown in the MarketWatch window. Use this to determine how many symbols are available before requesting detailed symbol information.</p>"},{"location":"API_Reference/MT5Account.API/#signature_12","title":"Signature","text":"<pre><code>public Task&lt;SymbolsTotalData&gt; SymbolsTotalAsync(\n    bool selectedOnly,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>selectedOnly</code> <code>bool</code> If true, returns only symbols visible in MarketWatch; if false, returns all available symbols. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_10","title":"Returns","text":"<p><code>Task&lt;SymbolsTotalData&gt;</code> - Total number of symbols matching the filter criteria.</p>"},{"location":"API_Reference/MT5Account.API/#symbolstotal","title":"SymbolsTotal","text":"<p>Gets the total count of available symbols on the MT5 server synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_13","title":"Signature","text":"<pre><code>public SymbolsTotalData SymbolsTotal(\n    bool selectedOnly,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_13","title":"Parameters","text":"Parameter Type Description <code>selectedOnly</code> <code>bool</code> If true, returns only symbols visible in MarketWatch; if false, returns all available symbols. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_11","title":"Returns","text":"<p><code>SymbolsTotalData</code> - Total number of symbols matching the filter criteria.</p>"},{"location":"API_Reference/MT5Account.API/#symbolexistasync","title":"SymbolExistAsync","text":"<p>Checks if a symbol exists on the MT5 server. Returns whether the specified symbol name is available for trading.</p>"},{"location":"API_Reference/MT5Account.API/#signature_14","title":"Signature","text":"<pre><code>public Task&lt;SymbolExistData&gt; SymbolExistAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to check (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_12","title":"Returns","text":"<p><code>Task&lt;SymbolExistData&gt;</code> - Reply with existence status.</p>"},{"location":"API_Reference/MT5Account.API/#symbolexist","title":"SymbolExist","text":"<p>Checks if a symbol exists on the MT5 server synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_15","title":"Signature","text":"<pre><code>public SymbolExistData SymbolExist(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to check (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_13","title":"Returns","text":"<p><code>SymbolExistData</code> - Reply with existence status.</p>"},{"location":"API_Reference/MT5Account.API/#symbolnameasync","title":"SymbolNameAsync","text":"<p>Gets the symbol name by its position in the symbols list. Returns the name of the symbol at the specified index.</p>"},{"location":"API_Reference/MT5Account.API/#signature_16","title":"Signature","text":"<pre><code>public Task&lt;SymbolNameData&gt; SymbolNameAsync(\n    int index,\n    bool selected,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_16","title":"Parameters","text":"Parameter Type Description <code>index</code> <code>int</code> Position in the symbols list (0-based index). <code>selected</code> <code>bool</code> If true, searches only in Market Watch; if false, searches all symbols. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_14","title":"Returns","text":"<p><code>Task&lt;SymbolNameData&gt;</code> - Reply with symbol name.</p>"},{"location":"API_Reference/MT5Account.API/#symbolname","title":"SymbolName","text":"<p>Gets the symbol name by its position in the symbols list synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_17","title":"Signature","text":"<pre><code>public SymbolNameData SymbolName(\n    int index,\n    bool selected,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_17","title":"Parameters","text":"Parameter Type Description <code>index</code> <code>int</code> Position in the symbols list (0-based index). <code>selected</code> <code>bool</code> If true, searches only in Market Watch; if false, searches all symbols. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_15","title":"Returns","text":"<p><code>SymbolNameData</code> - Reply with symbol name.</p>"},{"location":"API_Reference/MT5Account.API/#symbolselectasync","title":"SymbolSelectAsync","text":"<p>Selects or deselects a symbol in the Market Watch window. Symbols must be selected in Market Watch to receive price updates and place trades.</p>"},{"location":"API_Reference/MT5Account.API/#signature_18","title":"Signature","text":"<pre><code>public Task&lt;SymbolSelectData&gt; SymbolSelectAsync(\n    string symbol,\n    bool select,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_18","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>select</code> <code>bool</code> True to select symbol, false to remove from Market Watch. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_16","title":"Returns","text":"<p><code>Task&lt;SymbolSelectData&gt;</code> - Reply with success status.</p>"},{"location":"API_Reference/MT5Account.API/#symbolselect","title":"SymbolSelect","text":"<p>Selects or deselects a symbol in the Market Watch window synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_19","title":"Signature","text":"<pre><code>public SymbolSelectData SymbolSelect(\n    string symbol,\n    bool select,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_19","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>select</code> <code>bool</code> True to select symbol, false to remove from Market Watch. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_17","title":"Returns","text":"<p><code>SymbolSelectData</code> - Reply with success status.</p>"},{"location":"API_Reference/MT5Account.API/#symbolissynchronizedasync","title":"SymbolIsSynchronizedAsync","text":"<p>Checks if symbol data is synchronized with the trade server. Returns whether the symbol's price and market data is currently up to date.</p>"},{"location":"API_Reference/MT5Account.API/#signature_20","title":"Signature","text":"<pre><code>public Task&lt;SymbolIsSynchronizedData&gt; SymbolIsSynchronizedAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_20","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_18","title":"Returns","text":"<p><code>Task&lt;SymbolIsSynchronizedData&gt;</code> - Reply with synchronization status.</p>"},{"location":"API_Reference/MT5Account.API/#symbolissynchronized","title":"SymbolIsSynchronized","text":"<p>Checks if symbol data is synchronized with the trade server synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_21","title":"Signature","text":"<pre><code>public SymbolIsSynchronizedData SymbolIsSynchronized(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_21","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_19","title":"Returns","text":"<p><code>SymbolIsSynchronizedData</code> - Reply with synchronization status.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfodoubleasync","title":"SymbolInfoDoubleAsync","text":"<p>Gets a double property value for a specified symbol. Used to retrieve numeric properties like point size, spread, volume limits, etc.</p>"},{"location":"API_Reference/MT5Account.API/#signature_22","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoDoubleData&gt; SymbolInfoDoubleAsync(\n    string symbol,\n    SymbolInfoDoubleProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_22","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoDoubleProperty</code> Property type (SYMBOL_POINT, SYMBOL_VOLUME_MIN, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_20","title":"Returns","text":"<p><code>Task&lt;SymbolInfoDoubleData&gt;</code> - Reply with the property value.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfodouble","title":"SymbolInfoDouble","text":"<p>Gets a double property value for a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_23","title":"Signature","text":"<pre><code>public SymbolInfoDoubleData SymbolInfoDouble(\n    string symbol,\n    SymbolInfoDoubleProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_23","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoDoubleProperty</code> Property type (SYMBOL_POINT, SYMBOL_VOLUME_MIN, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_21","title":"Returns","text":"<p><code>SymbolInfoDoubleData</code> - Reply with the property value.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfointegerasync","title":"SymbolInfoIntegerAsync","text":"<p>Gets an integer property value for a specified symbol. Used to retrieve integer properties like digits, spread in points, trade mode, etc.</p>"},{"location":"API_Reference/MT5Account.API/#signature_24","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoIntegerData&gt; SymbolInfoIntegerAsync(\n    string symbol,\n    SymbolInfoIntegerProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_24","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoIntegerProperty</code> Property type (SYMBOL_DIGITS, SYMBOL_SPREAD, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_22","title":"Returns","text":"<p><code>Task&lt;SymbolInfoIntegerData&gt;</code> - Reply with the property value.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfointeger","title":"SymbolInfoInteger","text":"<p>Gets an integer property value for a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_25","title":"Signature","text":"<pre><code>public SymbolInfoIntegerData SymbolInfoInteger(\n    string symbol,\n    SymbolInfoIntegerProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_25","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoIntegerProperty</code> Property type (SYMBOL_DIGITS, SYMBOL_SPREAD, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_23","title":"Returns","text":"<p><code>SymbolInfoIntegerData</code> - Reply with the property value.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfostringasync","title":"SymbolInfoStringAsync","text":"<p>Gets a string property value for a specified symbol. Used to retrieve string properties like base currency, description, path, etc.</p>"},{"location":"API_Reference/MT5Account.API/#signature_26","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoStringData&gt; SymbolInfoStringAsync(\n    string symbol,\n    SymbolInfoStringProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_26","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoStringProperty</code> Property type (SYMBOL_CURRENCY_BASE, SYMBOL_DESCRIPTION, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_24","title":"Returns","text":"<p><code>Task&lt;SymbolInfoStringData&gt;</code> - Reply with the property value.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfostring","title":"SymbolInfoString","text":"<p>Gets a string property value for a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_27","title":"Signature","text":"<pre><code>public SymbolInfoStringData SymbolInfoString(\n    string symbol,\n    SymbolInfoStringProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_27","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoStringProperty</code> Property type (SYMBOL_CURRENCY_BASE, SYMBOL_DESCRIPTION, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_25","title":"Returns","text":"<p><code>SymbolInfoStringData</code> - Reply with the property value.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfomarginrateasync","title":"SymbolInfoMarginRateAsync","text":"<p>Gets the margin rate required for opening positions on a specified symbol. Returns the margin multiplier applied for buy and sell orders, which varies based on order type. Use this to calculate the exact margin requirement before placing orders.</p>"},{"location":"API_Reference/MT5Account.API/#signature_28","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoMarginRateData&gt; SymbolInfoMarginRateAsync(\n    string symbol,\n    ENUM_ORDER_TYPE orderType,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_28","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>orderType</code> <code>ENUM_ORDER_TYPE</code> Type of order (BUY, SELL, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_26","title":"Returns","text":"<p><code>Task&lt;SymbolInfoMarginRateData&gt;</code> - Margin rate information including initial and maintenance margin multipliers.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfomarginrate","title":"SymbolInfoMarginRate","text":"<p>Gets the margin rate required for opening positions on a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_29","title":"Signature","text":"<pre><code>public SymbolInfoMarginRateData SymbolInfoMarginRate(\n    string symbol,\n    ENUM_ORDER_TYPE orderType,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_29","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>orderType</code> <code>ENUM_ORDER_TYPE</code> Type of order (BUY, SELL, etc.). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_27","title":"Returns","text":"<p><code>SymbolInfoMarginRateData</code> - Margin rate information including initial and maintenance margin multipliers.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfotickasync","title":"SymbolInfoTickAsync","text":"<p>Gets the latest tick data for a specified symbol. Returns real-time market information including current bid/ask prices, last trade price, volume, and timestamp. This is the primary method for retrieving current market prices for trading decisions.</p>"},{"location":"API_Reference/MT5Account.API/#signature_30","title":"Signature","text":"<pre><code>public Task&lt;MrpcMqlTick&gt; SymbolInfoTickAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_30","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"GBPUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_28","title":"Returns","text":"<p><code>Task&lt;MrpcMqlTick&gt;</code> - Latest tick data with bid/ask prices, last price, volume, and time.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfotick","title":"SymbolInfoTick","text":"<p>Gets the latest tick data for a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_31","title":"Signature","text":"<pre><code>public MrpcMqlTick SymbolInfoTick(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_31","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"GBPUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_29","title":"Returns","text":"<p><code>MrpcMqlTick</code> - Latest tick data with bid/ask prices, last price, volume, and time.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfosessionquoteasync","title":"SymbolInfoSessionQuoteAsync","text":"<p>Gets the quote (pricing) session schedule for a symbol on a specific day. Returns the start and end times when price quotes are available for the symbol. Use this to determine when you can expect to receive price updates for market data.</p>"},{"location":"API_Reference/MT5Account.API/#signature_32","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoSessionQuoteData&gt; SymbolInfoSessionQuoteAsync(\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    uint sessionIndex,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_32","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of the week (SUNDAY=0, MONDAY=1, ..., SATURDAY=6). <code>sessionIndex</code> <code>uint</code> Session index (0 for first session, 1 for second session if multiple sessions exist). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_30","title":"Returns","text":"<p><code>Task&lt;SymbolInfoSessionQuoteData&gt;</code> - Quote session times including start and end times in seconds since midnight.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfosessionquote","title":"SymbolInfoSessionQuote","text":"<p>Gets the quote (pricing) session schedule for a symbol on a specific day synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_33","title":"Signature","text":"<pre><code>public SymbolInfoSessionQuoteData SymbolInfoSessionQuote(\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    uint sessionIndex,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_33","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of the week (SUNDAY=0, MONDAY=1, ..., SATURDAY=6). <code>sessionIndex</code> <code>uint</code> Session index (0 for first session, 1 for second session if multiple sessions exist). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_31","title":"Returns","text":"<p><code>SymbolInfoSessionQuoteData</code> - Quote session times including start and end times in seconds since midnight.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfosessiontradeasync","title":"SymbolInfoSessionTradeAsync","text":"<p>Gets the trading session schedule for a symbol on a specific day. Returns the start and end times when trading operations are allowed for the symbol. Use this to determine when you can open/close positions and place orders.</p>"},{"location":"API_Reference/MT5Account.API/#signature_34","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoSessionTradeData&gt; SymbolInfoSessionTradeAsync(\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    uint sessionIndex,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_34","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of the week (SUNDAY=0, MONDAY=1, ..., SATURDAY=6). <code>sessionIndex</code> <code>uint</code> Session index (0 for first session, 1 for second session if multiple sessions exist). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_32","title":"Returns","text":"<p><code>Task&lt;SymbolInfoSessionTradeData&gt;</code> - Trade session times including start and end times in seconds since midnight.</p>"},{"location":"API_Reference/MT5Account.API/#symbolinfosessiontrade","title":"SymbolInfoSessionTrade","text":"<p>Gets the trading session schedule for a symbol on a specific day synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_35","title":"Signature","text":"<pre><code>public SymbolInfoSessionTradeData SymbolInfoSessionTrade(\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    uint sessionIndex,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_35","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of the week (SUNDAY=0, MONDAY=1, ..., SATURDAY=6). <code>sessionIndex</code> <code>uint</code> Session index (0 for first session, 1 for second session if multiple sessions exist). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_33","title":"Returns","text":"<p><code>SymbolInfoSessionTradeData</code> - Trade session times including start and end times in seconds since midnight.</p>"},{"location":"API_Reference/MT5Account.API/#openedordersasync","title":"OpenedOrdersAsync","text":"<p>Gets the currently opened orders and positions for the connected account asynchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_36","title":"Signature","text":"<pre><code>public Task&lt;OpenedOrdersData&gt; OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE sortMode = BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_36","title":"Parameters","text":"Parameter Type Description <code>sortMode</code> <code>BMT5_ENUM_OPENED_ORDER_SORT_TYPE</code> The sort mode for the opened orders. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the request will be canceled if not completed. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the request."},{"location":"API_Reference/MT5Account.API/#returns_34","title":"Returns","text":"<p><code>Task&lt;OpenedOrdersData&gt;</code> - A task representing the asynchronous operation. The result contains opened orders and positions.</p>"},{"location":"API_Reference/MT5Account.API/#openedorders","title":"OpenedOrders","text":"<p>Gets the currently opened orders and positions for the connected account synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_37","title":"Signature","text":"<pre><code>public OpenedOrdersData OpenedOrders(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE sortMode = BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_37","title":"Parameters","text":"Parameter Type Description <code>sortMode</code> <code>BMT5_ENUM_OPENED_ORDER_SORT_TYPE</code> The sort mode for the opened orders. <code>deadline</code> <code>DateTime?</code> Optional deadline after which the request will be canceled if not completed. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the request."},{"location":"API_Reference/MT5Account.API/#returns_35","title":"Returns","text":"<p><code>OpenedOrdersData</code> - The server's response containing opened orders and positions.</p>"},{"location":"API_Reference/MT5Account.API/#orderhistoryasync","title":"OrderHistoryAsync","text":"<p>Gets the historical orders for the connected trading account within the specified time range asynchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_38","title":"Signature","text":"<pre><code>public Task&lt;OrdersHistoryData&gt; OrderHistoryAsync(\n    DateTime from,\n    DateTime to,\n    BMT5_ENUM_ORDER_HISTORY_SORT_TYPE sortMode = BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeAsc,\n    int pageNumber = 0,\n    int itemsPerPage = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_38","title":"Parameters","text":"Parameter Type Description <code>from</code> <code>DateTime</code> The start time for the history query (server time). <code>to</code> <code>DateTime</code> The end time for the history query (server time). <code>sortMode</code> <code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> The sort mode: by open time, close time, or ticket ID. <code>pageNumber</code> <code>int</code> The page number for paginated results (default 0). <code>itemsPerPage</code> <code>int</code> The number of items per page (default 0 = all). <code>deadline</code> <code>DateTime?</code> Optional deadline after which the request will be canceled if not completed. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the request."},{"location":"API_Reference/MT5Account.API/#returns_36","title":"Returns","text":"<p><code>Task&lt;OrdersHistoryData&gt;</code> - A task representing the asynchronous operation. The result contains paged historical order data.</p>"},{"location":"API_Reference/MT5Account.API/#orderhistory","title":"OrderHistory","text":"<p>Gets the historical orders for the connected trading account within the specified time range synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_39","title":"Signature","text":"<pre><code>public OrdersHistoryData OrderHistory(\n    DateTime from,\n    DateTime to,\n    BMT5_ENUM_ORDER_HISTORY_SORT_TYPE sortMode = BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeAsc,\n    int pageNumber = 0,\n    int itemsPerPage = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_39","title":"Parameters","text":"Parameter Type Description <code>from</code> <code>DateTime</code> The start time for the history query (server time). <code>to</code> <code>DateTime</code> The end time for the history query (server time). <code>sortMode</code> <code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> The sort mode: by open time, close time, or ticket ID. <code>pageNumber</code> <code>int</code> The page number for paginated results (default 0). <code>itemsPerPage</code> <code>int</code> The number of items per page (default 0 = all). <code>deadline</code> <code>DateTime?</code> Optional deadline after which the request will be canceled if not completed. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token to cancel the request."},{"location":"API_Reference/MT5Account.API/#returns_37","title":"Returns","text":"<p><code>OrdersHistoryData</code> - The server's response containing paged historical order data.</p>"},{"location":"API_Reference/MT5Account.API/#openedordersticketsasync","title":"OpenedOrdersTicketsAsync","text":"<p>Gets ticket IDs of all currently opened orders and positions asynchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_40","title":"Signature","text":"<pre><code>public Task&lt;OpenedOrdersTicketsData&gt; OpenedOrdersTicketsAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_40","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_38","title":"Returns","text":"<p><code>Task&lt;OpenedOrdersTicketsData&gt;</code> - Task containing collection of opened order and position tickets.</p>"},{"location":"API_Reference/MT5Account.API/#openedorderstickets","title":"OpenedOrdersTickets","text":"<p>Gets ticket IDs of all currently opened orders and positions synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_41","title":"Signature","text":"<pre><code>public OpenedOrdersTicketsData OpenedOrdersTickets(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_41","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_39","title":"Returns","text":"<p><code>OpenedOrdersTicketsData</code> - Collection of opened order and position tickets.</p>"},{"location":"API_Reference/MT5Account.API/#positionshistoryasync","title":"PositionsHistoryAsync","text":"<p>Retrieves historical positions based on filter and time range asynchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_42","title":"Signature","text":"<pre><code>public Task&lt;PositionsHistoryData&gt; PositionsHistoryAsync(\n    AH_ENUM_POSITIONS_HISTORY_SORT_TYPE sortType,\n    DateTime? openFrom = null,\n    DateTime? openTo = null,\n    int page = 0,\n    int size = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_42","title":"Parameters","text":"Parameter Type Description <code>sortType</code> <code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> Sorting type for historical positions. <code>openFrom</code> <code>DateTime?</code> Optional start of open time filter (UTC). <code>openTo</code> <code>DateTime?</code> Optional end of open time filter (UTC). <code>page</code> <code>int</code> Optional page number. <code>size</code> <code>int</code> Optional items per page. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_40","title":"Returns","text":"<p><code>Task&lt;PositionsHistoryData&gt;</code> - Task containing historical position records.</p>"},{"location":"API_Reference/MT5Account.API/#positionshistory","title":"PositionsHistory","text":"<p>Retrieves historical positions based on filter and time range synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_43","title":"Signature","text":"<pre><code>public PositionsHistoryData PositionsHistory(\n    AH_ENUM_POSITIONS_HISTORY_SORT_TYPE sortType,\n    DateTime? openFrom = null,\n    DateTime? openTo = null,\n    int page = 0,\n    int size = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_43","title":"Parameters","text":"Parameter Type Description <code>sortType</code> <code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> Sorting type for historical positions. <code>openFrom</code> <code>DateTime?</code> Optional start of open time filter (UTC). <code>openTo</code> <code>DateTime?</code> Optional end of open time filter (UTC). <code>page</code> <code>int</code> Optional page number. <code>size</code> <code>int</code> Optional items per page. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_41","title":"Returns","text":"<p><code>PositionsHistoryData</code> - Historical position records.</p>"},{"location":"API_Reference/MT5Account.API/#positionstotalasync","title":"PositionsTotalAsync","text":"<p>Gets the total count of currently open positions on the account. Returns a simple count of all active positions regardless of symbol. Use this for quick checks of position count before retrieving detailed position information.</p>"},{"location":"API_Reference/MT5Account.API/#signature_44","title":"Signature","text":"<pre><code>public Task&lt;PositionsTotalData&gt; PositionsTotalAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_44","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_42","title":"Returns","text":"<p><code>Task&lt;PositionsTotalData&gt;</code> - Total number of open positions.</p>"},{"location":"API_Reference/MT5Account.API/#positionstotal","title":"PositionsTotal","text":"<p>Gets the total count of currently open positions on the account synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_45","title":"Signature","text":"<pre><code>public PositionsTotalData PositionsTotal(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_45","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_43","title":"Returns","text":"<p><code>PositionsTotalData</code> - Total number of open positions.</p>"},{"location":"API_Reference/MT5Account.API/#marketbookaddasync","title":"MarketBookAddAsync","text":"<p>Subscribes to Market Depth (DOM/Level II) updates for a specified symbol. After subscription, you can retrieve current order book data showing pending buy and sell orders. Use this to access liquidity information and see the market depth before placing large orders.</p>"},{"location":"API_Reference/MT5Account.API/#signature_46","title":"Signature","text":"<pre><code>public Task&lt;MarketBookAddData&gt; MarketBookAddAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_46","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_44","title":"Returns","text":"<p><code>Task&lt;MarketBookAddData&gt;</code> - Subscription confirmation response.</p>"},{"location":"API_Reference/MT5Account.API/#marketbookadd","title":"MarketBookAdd","text":"<p>Subscribes to Market Depth (DOM/Level II) updates for a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_47","title":"Signature","text":"<pre><code>public MarketBookAddData MarketBookAdd(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_47","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_45","title":"Returns","text":"<p><code>MarketBookAddData</code> - Subscription confirmation response.</p>"},{"location":"API_Reference/MT5Account.API/#marketbookgetasync","title":"MarketBookGetAsync","text":"<p>Gets the current Market Depth (order book) data for a subscribed symbol. Returns pending buy and sell orders with prices and volumes from the order book. Use this to analyze liquidity, identify support/resistance levels, or optimize order placement.</p>"},{"location":"API_Reference/MT5Account.API/#signature_48","title":"Signature","text":"<pre><code>public Task&lt;MarketBookGetData&gt; MarketBookGetAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_48","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (must be subscribed via MarketBookAdd first). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_46","title":"Returns","text":"<p><code>Task&lt;MarketBookGetData&gt;</code> - Market book data containing arrays of buy and sell orders with prices and volumes.</p>"},{"location":"API_Reference/MT5Account.API/#marketbookget","title":"MarketBookGet","text":"<p>Gets the current Market Depth (order book) data for a subscribed symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_49","title":"Signature","text":"<pre><code>public MarketBookGetData MarketBookGet(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_49","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (must be subscribed via MarketBookAdd first). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_47","title":"Returns","text":"<p><code>MarketBookGetData</code> - Market book data containing arrays of buy and sell orders with prices and volumes.</p>"},{"location":"API_Reference/MT5Account.API/#marketbookreleaseasync","title":"MarketBookReleaseAsync","text":"<p>Unsubscribes from Market Depth updates for a specified symbol. Stops receiving order book data and releases associated resources. Use this when you no longer need DOM data for a symbol to free up resources.</p>"},{"location":"API_Reference/MT5Account.API/#signature_50","title":"Signature","text":"<pre><code>public Task&lt;MarketBookReleaseData&gt; MarketBookReleaseAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_50","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_48","title":"Returns","text":"<p><code>Task&lt;MarketBookReleaseData&gt;</code> - Unsubscription confirmation response.</p>"},{"location":"API_Reference/MT5Account.API/#marketbookrelease","title":"MarketBookRelease","text":"<p>Unsubscribes from Market Depth updates for a specified symbol synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_51","title":"Signature","text":"<pre><code>public MarketBookReleaseData MarketBookRelease(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_51","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_49","title":"Returns","text":"<p><code>MarketBookReleaseData</code> - Unsubscription confirmation response.</p>"},{"location":"API_Reference/MT5Account.API/#tickvaluewithsizeasync","title":"TickValueWithSizeAsync","text":"<p>Gets tick value and tick size data for the given symbols asynchronously. Returns tick values, contract size, and tick size for trading calculations.</p>"},{"location":"API_Reference/MT5Account.API/#signature_52","title":"Signature","text":"<pre><code>public Task&lt;TickValueWithSizeData&gt; TickValueWithSizeAsync(\n    IEnumerable&lt;string&gt; symbols,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_52","title":"Parameters","text":"Parameter Type Description <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> List of symbol names. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_50","title":"Returns","text":"<p><code>Task&lt;TickValueWithSizeData&gt;</code> - Task containing tick value and contract size info per symbol.</p>"},{"location":"API_Reference/MT5Account.API/#tickvaluewithsize","title":"TickValueWithSize","text":"<p>Gets tick value and tick size data for the given symbols synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_53","title":"Signature","text":"<pre><code>public TickValueWithSizeData TickValueWithSize(\n    IEnumerable&lt;string&gt; symbols,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_53","title":"Parameters","text":"Parameter Type Description <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> List of symbol names. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_51","title":"Returns","text":"<p><code>TickValueWithSizeData</code> - Tick value and contract size info per symbol.</p>"},{"location":"API_Reference/MT5Account.API/#symbolparamsmanyasync","title":"SymbolParamsManyAsync","text":"<p>Retrieves symbol parameters for multiple instruments asynchronously. Gets comprehensive parameter details for one or more symbols with pagination support. Returns extensive symbol information including contract specifications, trading conditions, and current state.</p>"},{"location":"API_Reference/MT5Account.API/#signature_54","title":"Signature","text":"<pre><code>public Task&lt;SymbolParamsManyData&gt; SymbolParamsManyAsync(\n    SymbolParamsManyRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_54","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>SymbolParamsManyRequest</code> The request containing filters and pagination. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_52","title":"Returns","text":"<p><code>Task&lt;SymbolParamsManyData&gt;</code> - Task containing symbol parameter details.</p>"},{"location":"API_Reference/MT5Account.API/#symbolparamsmany","title":"SymbolParamsMany","text":"<p>Retrieves symbol parameters for multiple instruments synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_55","title":"Signature","text":"<pre><code>public SymbolParamsManyData SymbolParamsMany(\n    SymbolParamsManyRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_55","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>SymbolParamsManyRequest</code> The request containing filters and pagination. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_53","title":"Returns","text":"<p><code>SymbolParamsManyData</code> - Symbol parameter details.</p>"},{"location":"API_Reference/MT5Account.API/#ordersendasync","title":"OrderSendAsync","text":"<p>Sends a trading order to the MT5 server (market or pending order). Use this method to open new positions or place pending orders with specified parameters including symbol, volume, price, stop loss, and take profit levels.</p>"},{"location":"API_Reference/MT5Account.API/#signature_56","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; OrderSendAsync(\n    OrderSendRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_56","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderSendRequest</code> The order request to send. <code>deadline</code> <code>DateTime?</code> Optional deadline for the operation. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_54","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> - Task containing response with deal/order confirmation data.</p>"},{"location":"API_Reference/MT5Account.API/#ordersend","title":"OrderSend","text":"<p>Sends a trading order to the MT5 server synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_57","title":"Signature","text":"<pre><code>public OrderSendData OrderSend(\n    OrderSendRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_57","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderSendRequest</code> The order request to send. <code>deadline</code> <code>DateTime?</code> Optional deadline for the operation. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_55","title":"Returns","text":"<p><code>OrderSendData</code> - Response containing deal/order confirmation data.</p>"},{"location":"API_Reference/MT5Account.API/#ordermodifyasync","title":"OrderModifyAsync","text":"<p>Modifies an existing order or position parameters. Use this to update stop loss, take profit, price, or other parameters of an open position or pending order.</p>"},{"location":"API_Reference/MT5Account.API/#signature_58","title":"Signature","text":"<pre><code>public Task&lt;OrderModifyData&gt; OrderModifyAsync(\n    OrderModifyRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_58","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderModifyRequest</code> The modification request (SL, TP, price, expiration, etc.). <code>deadline</code> <code>DateTime?</code> Optional deadline for the operation. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_56","title":"Returns","text":"<p><code>Task&lt;OrderModifyData&gt;</code> - Task containing updated order/deal info.</p>"},{"location":"API_Reference/MT5Account.API/#ordermodify","title":"OrderModify","text":"<p>Modifies an existing order or position synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_59","title":"Signature","text":"<pre><code>public OrderModifyData OrderModify(\n    OrderModifyRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_59","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderModifyRequest</code> The modification request (SL, TP, price, expiration, etc.). <code>deadline</code> <code>DateTime?</code> Optional deadline for the operation. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_57","title":"Returns","text":"<p><code>OrderModifyData</code> - Response containing updated order/deal info.</p>"},{"location":"API_Reference/MT5Account.API/#ordercloseasync","title":"OrderCloseAsync","text":"<p>Closes an open position or deletes a pending order. For positions, you can specify partial closure by providing a volume less than the total position size.</p>"},{"location":"API_Reference/MT5Account.API/#signature_60","title":"Signature","text":"<pre><code>public Task&lt;OrderCloseData&gt; OrderCloseAsync(\n    OrderCloseRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_60","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCloseRequest</code> The close request including ticket, volume, and slippage. <code>deadline</code> <code>DateTime?</code> Optional deadline for the operation. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_58","title":"Returns","text":"<p><code>Task&lt;OrderCloseData&gt;</code> - Task containing the close result and return codes.</p>"},{"location":"API_Reference/MT5Account.API/#orderclose","title":"OrderClose","text":"<p>Closes an open position or deletes a pending order synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_61","title":"Signature","text":"<pre><code>public OrderCloseData OrderClose(\n    OrderCloseRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_61","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCloseRequest</code> The close request including ticket, volume, and slippage. <code>deadline</code> <code>DateTime?</code> Optional deadline for the operation. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_59","title":"Returns","text":"<p><code>OrderCloseData</code> - Response describing the close result and return codes.</p>"},{"location":"API_Reference/MT5Account.API/#ordercalcmarginasync","title":"OrderCalcMarginAsync","text":"<p>Calculates the margin required to open a position with specified parameters. Returns the amount of funds needed in account currency to maintain the position. Use this before placing orders to verify sufficient margin and avoid margin call risks.</p>"},{"location":"API_Reference/MT5Account.API/#signature_62","title":"Signature","text":"<pre><code>public Task&lt;OrderCalcMarginData&gt; OrderCalcMarginAsync(\n    OrderCalcMarginRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_62","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCalcMarginRequest</code> The request containing symbol, order type, volume, and price. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_60","title":"Returns","text":"<p><code>Task&lt;OrderCalcMarginData&gt;</code> - The required margin in account currency.</p>"},{"location":"API_Reference/MT5Account.API/#ordercalcmargin","title":"OrderCalcMargin","text":"<p>Calculates the margin required for a planned trade operation synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_63","title":"Signature","text":"<pre><code>public OrderCalcMarginData OrderCalcMargin(\n    OrderCalcMarginRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_63","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCalcMarginRequest</code> The request containing symbol, order type, volume, and price. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_61","title":"Returns","text":"<p><code>OrderCalcMarginData</code> - The required margin in account currency.</p>"},{"location":"API_Reference/MT5Account.API/#ordercheckasync","title":"OrderCheckAsync","text":"<p>Validates a trading request and checks if there are sufficient funds to execute it. Returns detailed calculations including margin requirements, expected profit, and resulting balance. Use this to verify order validity before sending, preventing rejected orders due to insufficient funds.</p>"},{"location":"API_Reference/MT5Account.API/#signature_64","title":"Signature","text":"<pre><code>public Task&lt;OrderCheckData&gt; OrderCheckAsync(\n    OrderCheckRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_64","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCheckRequest</code> The order check request. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_62","title":"Returns","text":"<p><code>Task&lt;OrderCheckData&gt;</code> - Validation result with margin, profit, balance calculations, and any error codes.</p>"},{"location":"API_Reference/MT5Account.API/#ordercheck","title":"OrderCheck","text":"<p>Validates a trading request and checks if there are sufficient funds to execute it synchronously.</p>"},{"location":"API_Reference/MT5Account.API/#signature_65","title":"Signature","text":"<pre><code>public OrderCheckData OrderCheck(\n    OrderCheckRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_65","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCheckRequest</code> The order check request. <code>deadline</code> <code>DateTime?</code> Optional gRPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_63","title":"Returns","text":"<p><code>OrderCheckData</code> - Validation result with margin, profit, balance calculations, and any error codes.</p>"},{"location":"API_Reference/MT5Account.API/#onsymboltickasync","title":"OnSymbolTickAsync","text":"<p>Subscribes to real-time tick updates for one or more symbols. Receives a continuous stream of price updates (bid, ask, last, volume) whenever prices change. Use this for real-time price monitoring, tick-based trading strategies, or market data feeds.</p>"},{"location":"API_Reference/MT5Account.API/#signature_66","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnSymbolTickData&gt; OnSymbolTickAsync(\n    IEnumerable&lt;string&gt; symbols,\n    [EnumeratorCancellation] CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_66","title":"Parameters","text":"Parameter Type Description <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> The symbol names to subscribe to. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_64","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnSymbolTickData&gt;</code> - Async stream of tick data responses.</p>"},{"location":"API_Reference/MT5Account.API/#ontradeasync","title":"OnTradeAsync","text":"<p>Subscribes to trade events whenever a trading operation occurs. Receives notifications when orders are opened, closed, modified, or deleted. Use this to track all trading activity in real-time and react to order execution events.</p>"},{"location":"API_Reference/MT5Account.API/#signature_67","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnTradeData&gt; OnTradeAsync([EnumeratorCancellation] CancellationToken cancellationToken = default)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_67","title":"Parameters","text":"Parameter Type Description <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_65","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnTradeData&gt;</code> - Async stream of trade event data.</p>"},{"location":"API_Reference/MT5Account.API/#onpositionprofitasync","title":"OnPositionProfitAsync","text":"<p>Subscribes to periodic updates of position profit/loss values. Receives profit updates at regular intervals for all open positions. Use this to monitor unrealized PnL in real-time and implement profit-based exit strategies.</p>"},{"location":"API_Reference/MT5Account.API/#signature_68","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnPositionProfitData&gt; OnPositionProfitAsync(\n    int intervalMs,\n    bool ignoreEmpty = true,\n    [EnumeratorCancellation] CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_68","title":"Parameters","text":"Parameter Type Description <code>intervalMs</code> <code>int</code> Interval in milliseconds to poll server. <code>ignoreEmpty</code> <code>bool</code> Skip frames with no change. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_66","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnPositionProfitData&gt;</code> - Async stream of profit updates.</p>"},{"location":"API_Reference/MT5Account.API/#onpositionsandpendingordersticketsasync","title":"OnPositionsAndPendingOrdersTicketsAsync","text":"<p>Subscribes to periodic updates of position and pending order ticket numbers. Receives lists of currently open position tickets and pending order tickets at regular intervals. Use this to efficiently track which positions/orders exist without retrieving full details.</p>"},{"location":"API_Reference/MT5Account.API/#signature_69","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnPositionsAndPendingOrdersTicketsData&gt; OnPositionsAndPendingOrdersTicketsAsync(\n    int intervalMs,\n    [EnumeratorCancellation] CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_69","title":"Parameters","text":"Parameter Type Description <code>intervalMs</code> <code>int</code> Polling interval in milliseconds. <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_67","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnPositionsAndPendingOrdersTicketsData&gt;</code> - Async stream of ticket ID snapshots.</p>"},{"location":"API_Reference/MT5Account.API/#ontradetransactionasync","title":"OnTradeTransactionAsync","text":"<p>Subscribes to detailed trade transaction events. Receives comprehensive information about every trade operation including request, result, and execution details. Use this for detailed trade auditing, debugging order execution, or building advanced trading analytics.</p>"},{"location":"API_Reference/MT5Account.API/#signature_70","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnTradeTransactionData&gt; OnTradeTransactionAsync([EnumeratorCancellation] CancellationToken cancellationToken = default)\n</code></pre>"},{"location":"API_Reference/MT5Account.API/#parameters_70","title":"Parameters","text":"Parameter Type Description <code>cancellationToken</code> <code>CancellationToken</code> Optional cancellation token."},{"location":"API_Reference/MT5Account.API/#returns_68","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnTradeTransactionData&gt;</code> - Async stream of trade transaction replies.</p>"},{"location":"API_Reference/MT5Service.API/","title":"MT5Service API","text":"<p>Parsing MT5Service.cs... Found 66 methods Generated docs/API_Reference/MT5Service.API.md</p>"},{"location":"API_Reference/MT5Service.API/#table-of-contents","title":"Table of Contents","text":"<ol> <li>ConnectByHostPortAsync</li> <li>ConnectByServerNameAsync</li> <li>AccountSummaryAsync</li> <li>AccountInfoDoubleAsync</li> <li>AccountInfoIntegerAsync</li> <li>AccountInfoStringAsync</li> <li>GetBalanceAsync</li> <li>GetEquityAsync</li> <li>GetMarginAsync</li> <li>GetFreeMarginAsync</li> <li>GetProfitAsync</li> <li>GetLoginAsync</li> <li>GetLeverageAsync</li> <li>GetAccountNameAsync</li> <li>GetServerNameAsync</li> <li>GetCurrencyAsync</li> <li>SymbolsTotalAsync</li> <li>SymbolExistAsync</li> <li>SymbolNameAsync</li> <li>SymbolSelectAsync</li> <li>SymbolIsSynchronizedAsync</li> <li>SymbolInfoDoubleAsync</li> <li>SymbolInfoIntegerAsync</li> <li>SymbolInfoStringAsync</li> <li>SymbolInfoMarginRateAsync</li> <li>GetBidAsync</li> <li>GetAskAsync</li> <li>GetSpreadAsync</li> <li>GetVolumeMinAsync</li> <li>GetVolumeMaxAsync</li> <li>GetVolumeStepAsync</li> <li>GetPointAsync</li> <li>IsSymbolAvailableAsync</li> <li>IsTradingAllowedAsync</li> <li>SymbolInfoTickAsync</li> <li>QuoteAsync</li> <li>SymbolInfoSessionQuoteAsync</li> <li>SymbolInfoSessionTradeAsync</li> <li>TickValueWithSizeAsync</li> <li>SymbolParamsManyAsync</li> <li>MarketBookAddAsync</li> <li>MarketBookReleaseAsync</li> <li>MarketBookGetAsync</li> <li>OpenedOrdersAsync</li> <li>OpenedOrdersTicketsAsync</li> <li>OrderHistoryAsync</li> <li>PositionsHistoryAsync</li> <li>PositionsTotalAsync</li> <li>OrderCalcMarginAsync</li> <li>OrderCheckAsync</li> <li>OrderSendAsync</li> <li>OrderModifyAsync</li> <li>OrderCloseAsync</li> <li>BuyMarketAsync</li> <li>SellMarketAsync</li> <li>BuyLimitAsync</li> <li>SellLimitAsync</li> <li>BuyStopAsync</li> <li>SellStopAsync</li> <li>GetRecentOrdersAsync</li> <li>GetTodayOrdersAsync</li> <li>OnSymbolTickAsync</li> <li>OnTradeAsync</li> <li>OnPositionProfitAsync</li> <li>OnPositionsAndPendingOrdersTicketsAsync</li> <li>OnTradeTransactionAsync</li> </ol>"},{"location":"API_Reference/MT5Service.API/#connectbyhostportasync","title":"ConnectByHostPortAsync","text":"<p>Establishes connection to MT5 terminal via gRPC using direct host and port.</p>"},{"location":"API_Reference/MT5Service.API/#signature","title":"Signature","text":"<pre><code>public Task ConnectByHostPortAsync(\n    string host,\n    int port = 443,\n    string baseChartSymbol = \"EURUSD\",\n    bool waitForTerminalIsAlive = true,\n    int timeoutSeconds = 30,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters","title":"Parameters","text":"Parameter Type Description <code>host</code> <code>string</code> gRPC server hostname or IP address (e.g., \"mt5.mrpc.pro\"). <code>port</code> <code>int</code> gRPC server port number (default: 443 for HTTPS). <code>baseChartSymbol</code> <code>string</code> Symbol to use for initial chart/market watch (default: \"EURUSD\"). <code>waitForTerminalIsAlive</code> <code>bool</code> If true, waits for terminal to be ready before returning (default: true). <code>timeoutSeconds</code> <code>int</code> Connection timeout in seconds (default: 30). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline for this call. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns","title":"Returns","text":"<p><code>Task</code> - Task that completes when connection is established.</p>"},{"location":"API_Reference/MT5Service.API/#connectbyservernameasync","title":"ConnectByServerNameAsync","text":"<p>Establishes connection to MT5 terminal via gRPC using server name lookup.</p>"},{"location":"API_Reference/MT5Service.API/#signature_1","title":"Signature","text":"<pre><code>public Task ConnectByServerNameAsync(\n    string serverName,\n    string baseChartSymbol = \"EURUSD\",\n    bool waitForTerminalIsAlive = true,\n    int timeoutSeconds = 30,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>serverName</code> <code>string</code> MT5 server name (e.g., \"FxPro-MT5 Demo\") - will be resolved to host:port. <code>baseChartSymbol</code> <code>string</code> Symbol to use for initial chart/market watch (default: \"EURUSD\"). <code>waitForTerminalIsAlive</code> <code>bool</code> If true, waits for terminal to be ready before returning (default: true). <code>timeoutSeconds</code> <code>int</code> Connection timeout in seconds (default: 30). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline for this call. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_1","title":"Returns","text":"<p><code>Task</code> - Task that completes when connection is established.</p>"},{"location":"API_Reference/MT5Service.API/#accountsummaryasync","title":"AccountSummaryAsync","text":"<p>Retrieves comprehensive account summary including balance, equity, margin, and key ratios.</p>"},{"location":"API_Reference/MT5Service.API/#signature_2","title":"Signature","text":"<pre><code>public Task&lt;AccountSummaryData&gt; AccountSummaryAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline; if null, uses default timeout. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_2","title":"Returns","text":"<p><code>Task&lt;AccountSummaryData&gt;</code> -  containing balance, equity, margin, free margin, profit, margin level, and other account metrics.</p>"},{"location":"API_Reference/MT5Service.API/#remarks","title":"Remarks","text":"<p>This is a rich object that provides multiple account fields in one call. For single field access, use GetBalanceAsync(), GetEquityAsync(), etc.</p>"},{"location":"API_Reference/MT5Service.API/#accountinfodoubleasync","title":"AccountInfoDoubleAsync","text":"<p>Retrieves a double-precision numeric account property (e.g., Balance, Equity, Margin).</p>"},{"location":"API_Reference/MT5Service.API/#signature_3","title":"Signature","text":"<pre><code>public Task&lt;double&gt; AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoDoublePropertyType</code> The account property type to query. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_3","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Unwrapped double value of the requested property (no .Value needed).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_1","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive double directly instead of Data wrapper. Common properties: AccountBalance, AccountEquity, AccountMargin, AccountMarginFree, AccountProfit.</p>"},{"location":"API_Reference/MT5Service.API/#accountinfointegerasync","title":"AccountInfoIntegerAsync","text":"<p>Retrieves an integer account property (e.g., Login, Leverage, TradeMode).</p>"},{"location":"API_Reference/MT5Service.API/#signature_4","title":"Signature","text":"<pre><code>public Task&lt;long&gt; AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoIntegerPropertyType</code> The account property type to query. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_4","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - Unwrapped long value of the requested property (no .Value needed).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_2","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive long directly instead of Data wrapper. Common properties: AccountLogin, AccountLeverage, AccountTradeAllowed, AccountTradeMode.</p>"},{"location":"API_Reference/MT5Service.API/#accountinfostringasync","title":"AccountInfoStringAsync","text":"<p>Retrieves a string account property (e.g., Name, Server, Currency).</p>"},{"location":"API_Reference/MT5Service.API/#signature_5","title":"Signature","text":"<pre><code>public Task&lt;string&gt; AccountInfoStringAsync(\n    AccountInfoStringPropertyType property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>property</code> <code>AccountInfoStringPropertyType</code> The account property type to query. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_5","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - Unwrapped string value of the requested property (no .Value needed).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_3","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive string directly instead of Data wrapper. Common properties: AccountName, AccountServer, AccountCurrency, AccountCompany.</p>"},{"location":"API_Reference/MT5Service.API/#getbalanceasync","title":"GetBalanceAsync","text":"<p>Gets current account balance (total funds deposited minus withdrawals).</p>"},{"location":"API_Reference/MT5Service.API/#signature_6","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetBalanceAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_6","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Account balance in account currency.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_4","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoDoubleAsync(AccountBalance).</p>"},{"location":"API_Reference/MT5Service.API/#getequityasync","title":"GetEquityAsync","text":"<p>Gets current account equity (balance + floating profit/loss).</p>"},{"location":"API_Reference/MT5Service.API/#signature_7","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetEquityAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_7","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Account equity in account currency.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_5","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoDoubleAsync(AccountEquity). Equity = Balance + Profit from open positions.</p>"},{"location":"API_Reference/MT5Service.API/#getmarginasync","title":"GetMarginAsync","text":"<p>Gets currently used margin for open positions.</p>"},{"location":"API_Reference/MT5Service.API/#signature_8","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetMarginAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_8","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Used margin in account currency.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_6","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoDoubleAsync(AccountMargin).</p>"},{"location":"API_Reference/MT5Service.API/#getfreemarginasync","title":"GetFreeMarginAsync","text":"<p>Gets current free margin available for opening new positions.</p>"},{"location":"API_Reference/MT5Service.API/#signature_9","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetFreeMarginAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_9","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Free margin in account currency.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_7","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoDoubleAsync(AccountMarginFree). Free Margin = Equity - Used Margin.</p>"},{"location":"API_Reference/MT5Service.API/#getprofitasync","title":"GetProfitAsync","text":"<p>Gets current floating profit/loss from all open positions.</p>"},{"location":"API_Reference/MT5Service.API/#signature_10","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetProfitAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_10","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Total floating profit in account currency (can be negative for loss).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_8","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoDoubleAsync(AccountProfit).</p>"},{"location":"API_Reference/MT5Service.API/#getloginasync","title":"GetLoginAsync","text":"<p>Gets the account login/identification number.</p>"},{"location":"API_Reference/MT5Service.API/#signature_11","title":"Signature","text":"<pre><code>public Task&lt;long&gt; GetLoginAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_11","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - Account login number as long.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_9","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoIntegerAsync(AccountLogin).</p>"},{"location":"API_Reference/MT5Service.API/#getleverageasync","title":"GetLeverageAsync","text":"<p>Gets the account leverage ratio (e.g., 100 for 1:100, 500 for 1:500).</p>"},{"location":"API_Reference/MT5Service.API/#signature_12","title":"Signature","text":"<pre><code>public Task&lt;long&gt; GetLeverageAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_12","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - Leverage as long (e.g., 100, 500, 1000).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_10","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoIntegerAsync(AccountLeverage).</p>"},{"location":"API_Reference/MT5Service.API/#getaccountnameasync","title":"GetAccountNameAsync","text":"<p>Gets the account owner's name.</p>"},{"location":"API_Reference/MT5Service.API/#signature_13","title":"Signature","text":"<pre><code>public Task&lt;string&gt; GetAccountNameAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_13","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_13","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - Account holder name as string.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_11","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoStringAsync(AccountName).</p>"},{"location":"API_Reference/MT5Service.API/#getservernameasync","title":"GetServerNameAsync","text":"<p>Gets the MT5 server name this account is connected to.</p>"},{"location":"API_Reference/MT5Service.API/#signature_14","title":"Signature","text":"<pre><code>public Task&lt;string&gt; GetServerNameAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_14","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - Server name as string (e.g., \"FxPro-MT5 Demo\").</p>"},{"location":"API_Reference/MT5Service.API/#remarks_12","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoStringAsync(AccountServer).</p>"},{"location":"API_Reference/MT5Service.API/#getcurrencyasync","title":"GetCurrencyAsync","text":"<p>Gets the account's base currency.</p>"},{"location":"API_Reference/MT5Service.API/#signature_15","title":"Signature","text":"<pre><code>public Task&lt;string&gt; GetCurrencyAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_15","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - Currency code as string (e.g., \"USD\", \"EUR\", \"GBP\").</p>"},{"location":"API_Reference/MT5Service.API/#remarks_13","title":"Remarks","text":"<p>Convenience shortcut for AccountInfoStringAsync(AccountCurrency).</p>"},{"location":"API_Reference/MT5Service.API/#symbolstotalasync","title":"SymbolsTotalAsync","text":"<p>Returns the total number of symbols available in the terminal.</p>"},{"location":"API_Reference/MT5Service.API/#signature_16","title":"Signature","text":"<pre><code>public Task&lt;int&gt; SymbolsTotalAsync(\n    bool selectedOnly,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_16","title":"Parameters","text":"Parameter Type Description <code>selectedOnly</code> <code>bool</code> If true, counts only symbols selected in Market Watch; if false, counts all symbols. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_16","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Total symbol count as int.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_14","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive int directly (was Data.Total).</p>"},{"location":"API_Reference/MT5Service.API/#symbolexistasync","title":"SymbolExistAsync","text":"<p>Checks whether the specified symbol exists in the terminal's symbol list.</p>"},{"location":"API_Reference/MT5Service.API/#signature_17","title":"Signature","text":"<pre><code>public Task&lt;bool&gt; SymbolExistAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_17","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to check (e.g., \"EURUSD\", \"XAUUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_17","title":"Returns","text":"<p><code>Task&lt;bool&gt;</code> - True if symbol exists, false otherwise.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_15","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive bool directly (was Data.Exists). Note: Existence doesn't guarantee the symbol is synchronized - use IsSymbolAvailableAsync() for that.</p>"},{"location":"API_Reference/MT5Service.API/#symbolnameasync","title":"SymbolNameAsync","text":"<p>Gets the symbol name by its index position in the symbols list.</p>"},{"location":"API_Reference/MT5Service.API/#signature_18","title":"Signature","text":"<pre><code>public Task&lt;string&gt; SymbolNameAsync(\n    int index,\n    bool selected,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_18","title":"Parameters","text":"Parameter Type Description <code>index</code> <code>int</code> Zero-based symbol index in the list. <code>selected</code> <code>bool</code> If true, searches only among selected symbols in Market Watch; if false, searches all symbols. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_18","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - Symbol name at the specified index, or empty string if index is out of range.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_16","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive string directly (was Data.Name).</p>"},{"location":"API_Reference/MT5Service.API/#symbolselectasync","title":"SymbolSelectAsync","text":"<p>Selects or deselects a symbol in the Market Watch window.</p>"},{"location":"API_Reference/MT5Service.API/#signature_19","title":"Signature","text":"<pre><code>public Task&lt;bool&gt; SymbolSelectAsync(\n    string symbol,\n    bool selected = true,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_19","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to modify (e.g., \"EURUSD\"). <code>selected</code> <code>bool</code> True to add symbol to Market Watch, false to remove it (default: true). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_19","title":"Returns","text":"<p><code>Task&lt;bool&gt;</code> - True if operation succeeded, false otherwise.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_17","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive bool directly (was Data.Success). Symbols must be selected in Market Watch to receive real-time quotes and trade them.</p>"},{"location":"API_Reference/MT5Service.API/#symbolissynchronizedasync","title":"SymbolIsSynchronizedAsync","text":"<p>Checks whether the specified symbol is synchronized with the server (receiving live quotes).</p>"},{"location":"API_Reference/MT5Service.API/#signature_20","title":"Signature","text":"<pre><code>public Task&lt;bool&gt; SymbolIsSynchronizedAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_20","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to verify (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_20","title":"Returns","text":"<p><code>Task&lt;bool&gt;</code> - True if symbol is synchronized and ready for trading, false otherwise.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_18","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive bool directly (was Data.Synchronized). A symbol must be both Exist and Synchronized to be tradeable. Use IsSymbolAvailableAsync() for combined check.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfodoubleasync","title":"SymbolInfoDoubleAsync","text":"<p>Retrieves a double-precision numeric property of the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_21","title":"Signature","text":"<pre><code>public Task&lt;double&gt; SymbolInfoDoubleAsync(\n    string symbol,\n    SymbolInfoDoubleProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_21","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\", \"XAUUSD\"). <code>property</code> <code>SymbolInfoDoubleProperty</code> Numeric property to query (e.g., SymbolBid, SymbolAsk, SymbolPoint, SymbolVolumeMin). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_21","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Unwrapped double value of the requested property.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_19","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive double directly (was Data.Value). Common properties: SymbolBid, SymbolAsk, SymbolPoint, SymbolVolumeMin, SymbolVolumeMax, SymbolVolumeStep.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfointegerasync","title":"SymbolInfoIntegerAsync","text":"<p>Retrieves an integer property of the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_22","title":"Signature","text":"<pre><code>public Task&lt;long&gt; SymbolInfoIntegerAsync(\n    string symbol,\n    SymbolInfoIntegerProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_22","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoIntegerProperty</code> Integer property to query (e.g., SymbolDigits, SymbolSpread, SymbolTradeMode). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_22","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - Unwrapped long value of the requested property.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_20","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive long directly (was Data.Value). Common properties: SymbolDigits, SymbolSpread, SymbolTradeMode, SymbolStopsLevel.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfostringasync","title":"SymbolInfoStringAsync","text":"<p>Retrieves a string property of the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_23","title":"Signature","text":"<pre><code>public Task&lt;string&gt; SymbolInfoStringAsync(\n    string symbol,\n    SymbolInfoStringProperty property,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_23","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>property</code> <code>SymbolInfoStringProperty</code> String property to query (e.g., SymbolDescription, SymbolBaseCurrency, SymbolPath). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_23","title":"Returns","text":"<p><code>Task&lt;string&gt;</code> - Unwrapped string value of the requested property.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_21","title":"Remarks","text":"<p>UNWRAPPED: Returns primitive string directly (was Data.Value). Common properties: SymbolDescription, SymbolBaseCurrency, SymbolProfitCurrency, SymbolPath.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfomarginrateasync","title":"SymbolInfoMarginRateAsync","text":"<p>Retrieves margin rate information for the specified symbol and order type.</p>"},{"location":"API_Reference/MT5Service.API/#signature_24","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoMarginRateData&gt; SymbolInfoMarginRateAsync(\n    string symbol,\n    ENUM_ORDER_TYPE orderType,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_24","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>orderType</code> <code>ENUM_ORDER_TYPE</code> Order type for margin calculation (BUY or SELL). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_24","title":"Returns","text":"<p><code>Task&lt;SymbolInfoMarginRateData&gt;</code> -  containing initial and maintenance margin rates.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_22","title":"Remarks","text":"<p>Thin wrapper - returns rich object. Used for calculating required margin for positions.</p>"},{"location":"API_Reference/MT5Service.API/#getbidasync","title":"GetBidAsync","text":"<p>Gets the current bid price for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_25","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetBidAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_25","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_25","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Current bid price as double.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_23","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoDoubleAsync(symbol, SymbolBid).</p>"},{"location":"API_Reference/MT5Service.API/#getaskasync","title":"GetAskAsync","text":"<p>Gets the current ask price for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_26","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetAskAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_26","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_26","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Current ask price as double.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_24","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoDoubleAsync(symbol, SymbolAsk).</p>"},{"location":"API_Reference/MT5Service.API/#getspreadasync","title":"GetSpreadAsync","text":"<p>Gets the current spread in points for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_27","title":"Signature","text":"<pre><code>public Task&lt;long&gt; GetSpreadAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_27","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_27","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - Current spread in points as long.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_25","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoIntegerAsync(symbol, SymbolSpread).</p>"},{"location":"API_Reference/MT5Service.API/#getvolumeminasync","title":"GetVolumeMinAsync","text":"<p>Gets the minimum allowed lot size for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_28","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetVolumeMinAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_28","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_28","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Minimum volume in lots as double (e.g., 0.01).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_26","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoDoubleAsync(symbol, SymbolVolumeMin). Use this to validate order volumes before placing trades.</p>"},{"location":"API_Reference/MT5Service.API/#getvolumemaxasync","title":"GetVolumeMaxAsync","text":"<p>Gets the maximum allowed lot size for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_29","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetVolumeMaxAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_29","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_29","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Maximum volume in lots as double (e.g., 100.0).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_27","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoDoubleAsync(symbol, SymbolVolumeMax).</p>"},{"location":"API_Reference/MT5Service.API/#getvolumestepasync","title":"GetVolumeStepAsync","text":"<p>Gets the volume step increment for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_30","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetVolumeStepAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_30","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_30","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Volume step in lots as double (e.g., 0.01 means volumes must be multiples of 0.01).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_28","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoDoubleAsync(symbol, SymbolVolumeStep). Use this to round volumes to valid increments (e.g., if step is 0.01, volume 0.015 is invalid).</p>"},{"location":"API_Reference/MT5Service.API/#getpointasync","title":"GetPointAsync","text":"<p>Gets the point size for the specified symbol (minimum price change).</p>"},{"location":"API_Reference/MT5Service.API/#signature_31","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetPointAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_31","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_31","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Point value as double (e.g., 0.00001 for EURUSD on 5-digit broker).</p>"},{"location":"API_Reference/MT5Service.API/#remarks_29","title":"Remarks","text":"<p>Convenience shortcut for SymbolInfoDoubleAsync(symbol, SymbolPoint). Used for price calculations and converting points to price levels.</p>"},{"location":"API_Reference/MT5Service.API/#issymbolavailableasync","title":"IsSymbolAvailableAsync","text":"<p>Checks if a symbol exists in the terminal AND is synchronized with server (fully ready for trading).</p>"},{"location":"API_Reference/MT5Service.API/#signature_32","title":"Signature","text":"<pre><code>public Task&lt;bool&gt; IsSymbolAvailableAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_32","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to check (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_32","title":"Returns","text":"<p><code>Task&lt;bool&gt;</code> - True if symbol exists and is synchronized (ready to trade), false otherwise.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_30","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Combines SymbolExistAsync() and SymbolIsSynchronizedAsync() checks. More efficient than calling both methods separately. Use this before attempting to trade a symbol.</p>"},{"location":"API_Reference/MT5Service.API/#istradingallowedasync","title":"IsTradingAllowedAsync","text":"<p>Checks if trading operations are allowed for the current account.</p>"},{"location":"API_Reference/MT5Service.API/#signature_33","title":"Signature","text":"<pre><code>public Task&lt;bool&gt; IsTradingAllowedAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_33","title":"Parameters","text":"Parameter Type Description <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_33","title":"Returns","text":"<p><code>Task&lt;bool&gt;</code> - True if trading is allowed, false if account is read-only or trading is disabled.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_31","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Checks AccountInfoIntegerAsync(AccountTradeAllowed). Returns false for investor/read-only accounts or when trading is globally disabled.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfotickasync","title":"SymbolInfoTickAsync","text":"<p>Gets the latest tick data for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_34","title":"Signature","text":"<pre><code>public Task&lt;MrpcMqlTick&gt; SymbolInfoTickAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_34","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_34","title":"Returns","text":"<p><code>Task&lt;MrpcMqlTick&gt;</code> - Last known tick containing bid, ask, and related fields.</p>"},{"location":"API_Reference/MT5Service.API/#quoteasync","title":"QuoteAsync","text":"<p>Gets current quote for symbol (convenience alias for SymbolInfoTickAsync).</p>"},{"location":"API_Reference/MT5Service.API/#signature_35","title":"Signature","text":"<pre><code>public Task&lt;MrpcMqlTick&gt; QuoteAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_35","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_35","title":"Returns","text":"<p><code>Task&lt;MrpcMqlTick&gt;</code> - Last known tick containing bid, ask, and related fields.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfosessionquoteasync","title":"SymbolInfoSessionQuoteAsync","text":"<p>Gets trading session quote information for the specified symbol and day.</p>"},{"location":"API_Reference/MT5Service.API/#signature_36","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoSessionQuoteData&gt; SymbolInfoSessionQuoteAsync(\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    int sessionIndex,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_36","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of the week for which session data is requested. <code>sessionIndex</code> <code>int</code> Index of the session on that day. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_36","title":"Returns","text":"<p><code>Task&lt;SymbolInfoSessionQuoteData&gt;</code> - Session quote information including open and close times.</p>"},{"location":"API_Reference/MT5Service.API/#symbolinfosessiontradeasync","title":"SymbolInfoSessionTradeAsync","text":"<p>Gets trading session trade information for the specified symbol and day.</p>"},{"location":"API_Reference/MT5Service.API/#signature_37","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoSessionTradeData&gt; SymbolInfoSessionTradeAsync(\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    int sessionIndex,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_37","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Target symbol name (e.g., \"EURUSD\"). <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of the week for which trade session data is requested. <code>sessionIndex</code> <code>int</code> Index of the session on that day. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_37","title":"Returns","text":"<p><code>Task&lt;SymbolInfoSessionTradeData&gt;</code> - Session trade information including open and close times.</p>"},{"location":"API_Reference/MT5Service.API/#tickvaluewithsizeasync","title":"TickValueWithSizeAsync","text":"<p>Calculates tick value and size for one or multiple symbols.</p>"},{"location":"API_Reference/MT5Service.API/#signature_38","title":"Signature","text":"<pre><code>public Task&lt;TickValueWithSizeData&gt; TickValueWithSizeAsync(\n    IEnumerable&lt;string&gt; symbols,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_38","title":"Parameters","text":"Parameter Type Description <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> Collection of symbol names (e.g., \"EURUSD\", \"GBPUSD\"). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_38","title":"Returns","text":"<p><code>Task&lt;TickValueWithSizeData&gt;</code> - Tick value and size data for each specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#symbolparamsmanyasync","title":"SymbolParamsManyAsync","text":"<p>Retrieves multiple symbol parameters in a single request.</p>"},{"location":"API_Reference/MT5Service.API/#signature_39","title":"Signature","text":"<pre><code>public Task&lt;SymbolParamsManyData&gt; SymbolParamsManyAsync(\n    SymbolParamsManyRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_39","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>SymbolParamsManyRequest</code> Request object specifying symbols and parameters to fetch. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_39","title":"Returns","text":"<p><code>Task&lt;SymbolParamsManyData&gt;</code> - Combined data set containing requested symbol parameters.</p>"},{"location":"API_Reference/MT5Service.API/#marketbookaddasync","title":"MarketBookAddAsync","text":"<p>Subscribes to market depth (order book) updates for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_40","title":"Signature","text":"<pre><code>public Task&lt;MarketBookAddData&gt; MarketBookAddAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_40","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to subscribe to (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_40","title":"Returns","text":"<p><code>Task&lt;MarketBookAddData&gt;</code> - Result indicating whether the subscription was successful.</p>"},{"location":"API_Reference/MT5Service.API/#marketbookreleaseasync","title":"MarketBookReleaseAsync","text":"<p>Unsubscribes from market depth (order book) updates for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_41","title":"Signature","text":"<pre><code>public Task&lt;MarketBookReleaseData&gt; MarketBookReleaseAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_41","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to unsubscribe from (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_41","title":"Returns","text":"<p><code>Task&lt;MarketBookReleaseData&gt;</code> - Result indicating whether the unsubscription was successful.</p>"},{"location":"API_Reference/MT5Service.API/#marketbookgetasync","title":"MarketBookGetAsync","text":"<p>Retrieves the current market depth (order book) for the specified symbol.</p>"},{"location":"API_Reference/MT5Service.API/#signature_42","title":"Signature","text":"<pre><code>public Task&lt;MarketBookGetData&gt; MarketBookGetAsync(\n    string symbol,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_42","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name to query (e.g., \"EURUSD\"). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_42","title":"Returns","text":"<p><code>Task&lt;MarketBookGetData&gt;</code> - Current order book data containing bid and ask levels.</p>"},{"location":"API_Reference/MT5Service.API/#openedordersasync","title":"OpenedOrdersAsync","text":"<p>Retrieves all currently opened orders with optional sorting.</p>"},{"location":"API_Reference/MT5Service.API/#signature_43","title":"Signature","text":"<pre><code>public Task&lt;OpenedOrdersData&gt; OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE sortMode = BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_43","title":"Parameters","text":"Parameter Type Description <code>sortMode</code> <code>BMT5_ENUM_OPENED_ORDER_SORT_TYPE</code> Sorting mode for the orders (default: by open time ascending). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_43","title":"Returns","text":"<p><code>Task&lt;OpenedOrdersData&gt;</code> - Collection of opened orders with full details.</p>"},{"location":"API_Reference/MT5Service.API/#openedordersticketsasync","title":"OpenedOrdersTicketsAsync","text":"<p>Retrieves ticket numbers of all currently opened orders.</p>"},{"location":"API_Reference/MT5Service.API/#signature_44","title":"Signature","text":"<pre><code>public Task&lt;OpenedOrdersTicketsData&gt; OpenedOrdersTicketsAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#returns_44","title":"Returns","text":"<p><code>Task&lt;OpenedOrdersTicketsData&gt;</code> - List of ticket IDs for opened orders.</p>"},{"location":"API_Reference/MT5Service.API/#orderhistoryasync","title":"OrderHistoryAsync","text":"<p>Retrieves historical orders within a specified date range.</p>"},{"location":"API_Reference/MT5Service.API/#signature_45","title":"Signature","text":"<pre><code>public Task&lt;OrdersHistoryData&gt; OrderHistoryAsync(\n    DateTime from,\n    DateTime to,\n    BMT5_ENUM_ORDER_HISTORY_SORT_TYPE sortMode = BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeAsc,\n    int pageNumber = 0,\n    int itemsPerPage = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_44","title":"Parameters","text":"Parameter Type Description <code>from</code> <code>DateTime</code> Start date of the history interval. <code>to</code> <code>DateTime</code> End date of the history interval. <code>sortMode</code> <code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> Sorting mode for historical orders (default: by close time ascending). <code>pageNumber</code> <code>int</code> Page number for paginated results (0 for all). <code>itemsPerPage</code> <code>int</code> Number of items per page (0 for all). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_45","title":"Returns","text":"<p><code>Task&lt;OrdersHistoryData&gt;</code> - Historical orders data within the requested period.</p>"},{"location":"API_Reference/MT5Service.API/#positionshistoryasync","title":"PositionsHistoryAsync","text":"<p>Retrieves historical positions with sorting, optional time filters, and paging.</p>"},{"location":"API_Reference/MT5Service.API/#signature_46","title":"Signature","text":"<pre><code>public Task&lt;PositionsHistoryData&gt; PositionsHistoryAsync(\n    AH_ENUM_POSITIONS_HISTORY_SORT_TYPE sortType,\n    DateTime? openFrom = null,\n    DateTime? openTo = null,\n    int page = 0,\n    int size = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_45","title":"Parameters","text":"Parameter Type Description <code>sortType</code> <code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> Sorting mode for the positions history. <code>openFrom</code> <code>DateTime?</code> Filter: include positions opened on/after this time (optional). <code>openTo</code> <code>DateTime?</code> Filter: include positions opened before/at this time (optional). <code>page</code> <code>int</code> Page index for paginated results (0-based). <code>size</code> <code>int</code> Items per page (0 to return all). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_46","title":"Returns","text":"<p><code>Task&lt;PositionsHistoryData&gt;</code> - Positions history matching the specified criteria.</p>"},{"location":"API_Reference/MT5Service.API/#positionstotalasync","title":"PositionsTotalAsync","text":"<p>Returns the total number of currently open positions.</p>"},{"location":"API_Reference/MT5Service.API/#signature_47","title":"Signature","text":"<pre><code>public Task&lt;PositionsTotalData&gt; PositionsTotalAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#returns_47","title":"Returns","text":"<p><code>Task&lt;PositionsTotalData&gt;</code> - Total count of open positions.</p>"},{"location":"API_Reference/MT5Service.API/#ordercalcmarginasync","title":"OrderCalcMarginAsync","text":"<p>Estimates required margin for a prospective order.</p>"},{"location":"API_Reference/MT5Service.API/#signature_48","title":"Signature","text":"<pre><code>public Task&lt;OrderCalcMarginData&gt; OrderCalcMarginAsync(\n    OrderCalcMarginRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_46","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCalcMarginRequest</code> Order parameters (e.g., symbol, type, volume, price). <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_48","title":"Returns","text":"<p><code>Task&lt;OrderCalcMarginData&gt;</code> - Calculated margin data for the given order parameters.</p>"},{"location":"API_Reference/MT5Service.API/#ordercheckasync","title":"OrderCheckAsync","text":"<p>Performs a pre-trade check to validate order parameters.</p>"},{"location":"API_Reference/MT5Service.API/#signature_49","title":"Signature","text":"<pre><code>public Task&lt;OrderCheckData&gt; OrderCheckAsync(\n    OrderCheckRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_47","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCheckRequest</code> Order parameters to verify before sending. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_49","title":"Returns","text":"<p><code>Task&lt;OrderCheckData&gt;</code> - Result containing validation status and possible trade errors.</p>"},{"location":"API_Reference/MT5Service.API/#ordersendasync","title":"OrderSendAsync","text":"<p>Sends a trade order to the server for execution.</p>"},{"location":"API_Reference/MT5Service.API/#signature_50","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; OrderSendAsync(\n    OrderSendRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_48","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderSendRequest</code> Order details including symbol, type, volume, and price. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_50","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> - Result containing execution outcome and order ticket.</p>"},{"location":"API_Reference/MT5Service.API/#ordermodifyasync","title":"OrderModifyAsync","text":"<p>Modifies parameters of an existing pending order.</p>"},{"location":"API_Reference/MT5Service.API/#signature_51","title":"Signature","text":"<pre><code>public Task&lt;OrderModifyData&gt; OrderModifyAsync(\n    OrderModifyRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_49","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderModifyRequest</code> New order parameters such as price, SL, or TP levels. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_51","title":"Returns","text":"<p><code>Task&lt;OrderModifyData&gt;</code> - Result indicating success or failure of the modification.</p>"},{"location":"API_Reference/MT5Service.API/#ordercloseasync","title":"OrderCloseAsync","text":"<p>Closes an existing open order or position.</p>"},{"location":"API_Reference/MT5Service.API/#signature_52","title":"Signature","text":"<pre><code>public Task&lt;OrderCloseData&gt; OrderCloseAsync(\n    OrderCloseRequest request,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_50","title":"Parameters","text":"Parameter Type Description <code>request</code> <code>OrderCloseRequest</code> Order close parameters including ticket, volume, and price. <code>deadline</code> <code>DateTime?</code> Optional deadline for the gRPC call. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_52","title":"Returns","text":"<p><code>Task&lt;OrderCloseData&gt;</code> - Result containing close status and related trade data.</p>"},{"location":"API_Reference/MT5Service.API/#buymarketasync","title":"BuyMarketAsync","text":"<p>Opens a market BUY order at the current ask price.</p>"},{"location":"API_Reference/MT5Service.API/#signature_53","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; BuyMarketAsync(\n    string symbol,\n    double volume,\n    double? stopLoss = null,\n    double? takeProfit = null,\n    string comment = \"\",\n    ulong magic = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_51","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots (e.g., 0.01, 0.1, 1.0). <code>stopLoss</code> <code>double?</code> Optional stop loss price level. <code>takeProfit</code> <code>double?</code> Optional take profit price level. <code>comment</code> <code>string</code> Optional comment for the order (max 31 characters). <code>magic</code> <code>ulong</code> Optional magic number for order identification by EA (default: 0). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_53","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> -  containing order ticket, result code, and execution details.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_32","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Simplifies market order placement - no need to manually build OrderSendRequest. Executes immediately at current market price (ask for buy). Use for instant order execution.</p>"},{"location":"API_Reference/MT5Service.API/#sellmarketasync","title":"SellMarketAsync","text":"<p>Opens a market SELL order at the current bid price.</p>"},{"location":"API_Reference/MT5Service.API/#signature_54","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; SellMarketAsync(\n    string symbol,\n    double volume,\n    double? stopLoss = null,\n    double? takeProfit = null,\n    string comment = \"\",\n    ulong magic = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_52","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots (e.g., 0.01, 0.1, 1.0). <code>stopLoss</code> <code>double?</code> Optional stop loss price level. <code>takeProfit</code> <code>double?</code> Optional take profit price level. <code>comment</code> <code>string</code> Optional comment for the order (max 31 characters). <code>magic</code> <code>ulong</code> Optional magic number for order identification by EA (default: 0). <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_54","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> -  containing order ticket, result code, and execution details.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_33","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Simplifies market order placement - no need to manually build OrderSendRequest. Executes immediately at current market price (bid for sell). Use for instant order execution.</p>"},{"location":"API_Reference/MT5Service.API/#buylimitasync","title":"BuyLimitAsync","text":"<p>Places a pending BUY LIMIT order (buy below current price).</p>"},{"location":"API_Reference/MT5Service.API/#signature_55","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; BuyLimitAsync(\n    string symbol,\n    double volume,\n    double price,\n    double? stopLoss = null,\n    double? takeProfit = null,\n    string comment = \"\",\n    ulong magic = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_53","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>price</code> <code>double</code> Entry price level - must be below current ask price. <code>stopLoss</code> <code>double?</code> Optional stop loss price level. <code>takeProfit</code> <code>double?</code> Optional take profit price level. <code>comment</code> <code>string</code> Optional comment for the order. <code>magic</code> <code>ulong</code> Optional magic number for order identification by EA. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_55","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> -  containing order ticket and result code.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_34","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Places pending order that triggers when price drops to specified level. Use when expecting price to fall before going up. Order activates automatically when price reaches entry level.</p>"},{"location":"API_Reference/MT5Service.API/#selllimitasync","title":"SellLimitAsync","text":"<p>Places a pending SELL LIMIT order (sell above current price).</p>"},{"location":"API_Reference/MT5Service.API/#signature_56","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; SellLimitAsync(\n    string symbol,\n    double volume,\n    double price,\n    double? stopLoss = null,\n    double? takeProfit = null,\n    string comment = \"\",\n    ulong magic = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_54","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>price</code> <code>double</code> Entry price level - must be above current bid price. <code>stopLoss</code> <code>double?</code> Optional stop loss price level. <code>takeProfit</code> <code>double?</code> Optional take profit price level. <code>comment</code> <code>string</code> Optional comment for the order. <code>magic</code> <code>ulong</code> Optional magic number for order identification by EA. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_56","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> -  containing order ticket and result code.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_35","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Places pending order that triggers when price rises to specified level. Use when expecting price to rise before going down. Order activates automatically when price reaches entry level.</p>"},{"location":"API_Reference/MT5Service.API/#buystopasync","title":"BuyStopAsync","text":"<p>Places a pending BUY STOP order (buy above current price on breakout).</p>"},{"location":"API_Reference/MT5Service.API/#signature_57","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; BuyStopAsync(\n    string symbol,\n    double volume,\n    double price,\n    double? stopLoss = null,\n    double? takeProfit = null,\n    string comment = \"\",\n    ulong magic = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_55","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>price</code> <code>double</code> Entry price level - must be above current ask price. <code>stopLoss</code> <code>double?</code> Optional stop loss price level. <code>takeProfit</code> <code>double?</code> Optional take profit price level. <code>comment</code> <code>string</code> Optional comment for the order. <code>magic</code> <code>ulong</code> Optional magic number for order identification by EA. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_57","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> -  containing order ticket and result code.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_36","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Places pending order that triggers when price breaks above specified level. Use for breakout strategies - buy when price exceeds resistance. Order activates automatically on breakout.</p>"},{"location":"API_Reference/MT5Service.API/#sellstopasync","title":"SellStopAsync","text":"<p>Places a pending SELL STOP order (sell below current price on breakout).</p>"},{"location":"API_Reference/MT5Service.API/#signature_58","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; SellStopAsync(\n    string symbol,\n    double volume,\n    double price,\n    double? stopLoss = null,\n    double? takeProfit = null,\n    string comment = \"\",\n    ulong magic = 0,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_56","title":"Parameters","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>price</code> <code>double</code> Entry price level - must be below current bid price. <code>stopLoss</code> <code>double?</code> Optional stop loss price level. <code>takeProfit</code> <code>double?</code> Optional take profit price level. <code>comment</code> <code>string</code> Optional comment for the order. <code>magic</code> <code>ulong</code> Optional magic number for order identification by EA. <code>deadline</code> <code>DateTime?</code> Optional RPC deadline. <code>cancellationToken</code> <code>CancellationToken</code> Token to cancel the operation."},{"location":"API_Reference/MT5Service.API/#returns_58","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> -  containing order ticket and result code.</p>"},{"location":"API_Reference/MT5Service.API/#remarks_37","title":"Remarks","text":"<p>NEW CONVENIENCE METHOD: Places pending order that triggers when price breaks below specified level. Use for breakout strategies - sell when price breaks support. Order activates automatically on breakout.</p>"},{"location":"API_Reference/MT5Service.API/#getrecentordersasync","title":"GetRecentOrdersAsync","text":"<p>Gets recent orders from history (last N days).</p>"},{"location":"API_Reference/MT5Service.API/#signature_59","title":"Signature","text":"<pre><code>public Task&lt;OrdersHistoryData&gt; GetRecentOrdersAsync(\n    int days = 7,\n    int limit = 100,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#returns_59","title":"Returns","text":"<p><code>Task&lt;OrdersHistoryData&gt;</code></p>"},{"location":"API_Reference/MT5Service.API/#gettodayordersasync","title":"GetTodayOrdersAsync","text":"<p>Gets today's orders from history.</p>"},{"location":"API_Reference/MT5Service.API/#signature_60","title":"Signature","text":"<pre><code>public Task&lt;OrdersHistoryData&gt; GetTodayOrdersAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#returns_60","title":"Returns","text":"<p><code>Task&lt;OrdersHistoryData&gt;</code></p>"},{"location":"API_Reference/MT5Service.API/#onsymboltickasync","title":"OnSymbolTickAsync","text":"<p>Streams live tick updates for the specified symbols.</p>"},{"location":"API_Reference/MT5Service.API/#signature_61","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnSymbolTickData&gt; OnSymbolTickAsync(\n    IEnumerable&lt;string&gt; symbols,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_57","title":"Parameters","text":"Parameter Type Description <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> Collection of symbol names to subscribe to (e.g., \"EURUSD\", \"GBPUSD\"). <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_61","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnSymbolTickData&gt;</code> - Asynchronous stream of tick data for the subscribed symbols.</p>"},{"location":"API_Reference/MT5Service.API/#ontradeasync","title":"OnTradeAsync","text":"<p>Streams real-time trade events such as order executions or closures.</p>"},{"location":"API_Reference/MT5Service.API/#signature_62","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnTradeData&gt; OnTradeAsync(CancellationToken cancellationToken = default)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#returns_62","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnTradeData&gt;</code> - Asynchronous stream of trade event data.</p>"},{"location":"API_Reference/MT5Service.API/#onpositionprofitasync","title":"OnPositionProfitAsync","text":"<p>Streams periodic snapshots of position profit/loss.</p>"},{"location":"API_Reference/MT5Service.API/#signature_63","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnPositionProfitData&gt; OnPositionProfitAsync(\n    int intervalMs,\n    bool ignoreEmpty = true,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_58","title":"Parameters","text":"Parameter Type Description <code>intervalMs</code> <code>int</code> Polling interval in milliseconds between snapshots. <code>ignoreEmpty</code> <code>bool</code> Skip emissions when there are no positions (true by default). <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_63","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnPositionProfitData&gt;</code> - Asynchronous stream of profit data per position.</p>"},{"location":"API_Reference/MT5Service.API/#onpositionsandpendingordersticketsasync","title":"OnPositionsAndPendingOrdersTicketsAsync","text":"<p>Streams periodic snapshots of tickets for open positions and pending orders.</p>"},{"location":"API_Reference/MT5Service.API/#signature_64","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnPositionsAndPendingOrdersTicketsData&gt; OnPositionsAndPendingOrdersTicketsAsync(\n    int intervalMs,\n    CancellationToken cancellationToken = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#parameters_59","title":"Parameters","text":"Parameter Type Description <code>intervalMs</code> <code>int</code> Polling interval in milliseconds between snapshots. <code>cancellationToken</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Service.API/#returns_64","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnPositionsAndPendingOrdersTicketsData&gt;</code> - Asynchronous stream containing ticket lists for positions and pending orders.</p>"},{"location":"API_Reference/MT5Service.API/#ontradetransactionasync","title":"OnTradeTransactionAsync","text":"<p>Streams real-time trade transaction events from the terminal.</p>"},{"location":"API_Reference/MT5Service.API/#signature_65","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnTradeTransactionData&gt; OnTradeTransactionAsync(CancellationToken cancellationToken = default)\n</code></pre>"},{"location":"API_Reference/MT5Service.API/#returns_65","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnTradeTransactionData&gt;</code> - Asynchronous stream of trade transaction data (order updates, deal executions, etc.).</p>"},{"location":"API_Reference/MT5Sugar.API/","title":"MT5Sugar API","text":"<p>Parsing MT5Sugar.cs... Found 50 methods Generated docs/API_Reference/MT5Sugar.API.md</p>"},{"location":"API_Reference/MT5Sugar.API/#table-of-contents","title":"Table of Contents","text":"<ol> <li>EnsureSelected</li> <li>AccountSnapshot</li> <li>GetAccountSnapshot</li> <li>SymbolSnapshot</li> <li>GetSymbolSnapshot</li> <li>GetPointAsync</li> <li>GetDigitsAsync</li> <li>NormalizePriceAsync</li> <li>PointsToPipsAsync</li> <li>GetSpreadPointsAsync</li> <li>OrdersHistoryLast</li> <li>PositionsHistoryPaged</li> <li>ReadTicks</li> <li>ReadTrades</li> <li>PlaceMarket</li> <li>PlacePending</li> <li>ModifySlTpAsync</li> <li>CloseByTicket</li> <li>CloseAll</li> <li>GetVolumeLimitsAsync</li> <li>NormalizeVolumeAsync</li> <li>GetTickValueAndSizeAsync</li> <li>PriceFromOffsetPointsAsync</li> <li>CalcVolumeForRiskAsync</li> <li>BuyLimitPoints</li> <li>SellLimitPoints</li> <li>BuyStopPoints</li> <li>SellStopPoints</li> <li>BuyMarketByRisk</li> <li>SellMarketByRisk</li> <li>CancelAll</li> <li>CloseAllPositions</li> <li>CloseAllPending</li> <li>SubscribeToMarketBookAsync</li> <li>GetMarketBookSnapshotAsync</li> <li>GetBestBidAskFromBookAsync</li> <li>CalculateLiquidityAtLevelAsync</li> <li>ValidateOrderAsync</li> <li>CalculateBuyMarginAsync</li> <li>CalculateSellMarginAsync</li> <li>CheckMarginAvailabilityAsync</li> <li>GetQuoteSessionAsync</li> <li>GetTradeSessionAsync</li> <li>GetProfitablePositionsAsync</li> <li>GetLosingPositionsAsync</li> <li>GetTotalProfitLossAsync</li> <li>GetPositionCountAsync</li> <li>GetPositionStatsBySymbolAsync</li> <li>AccountSnapshot</li> <li>SymbolSnapshot</li> </ol>"},{"location":"API_Reference/MT5Sugar.API/#ensureselected","title":"EnsureSelected","text":"<p>Ensures the specified symbol is selected in the MT5 terminal and fully synchronized. Required before performing operations on symbols that may not be in Market Watch.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature","title":"Signature","text":"<pre><code>public Task EnsureSelected(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name to select and synchronize (e.g., \"EURUSD\", \"XAUUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns","title":"Returns","text":"<p><code>Task</code> - Task that completes when symbol is selected and synchronized.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks","title":"Remarks","text":"<p>This is a critical helper for symbol operations. Many MT5 functions require symbols to be: 1. Selected (added to Market Watch) 2. Synchronized (receiving live quotes from broker) Without this, operations like getting symbol info, placing orders, or retrieving ticks may fail. PERFORMANCE NOTE: This method makes 2 sequential RPC calls. Cache symbols when possible.</p>"},{"location":"API_Reference/MT5Sugar.API/#accountsnapshot","title":"AccountSnapshot","text":"<p>Composite snapshot containing account summary and all currently opened orders/positions. Provides a complete view of account state at a single point in time.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_1","title":"Signature","text":"<pre><code>public sealed record AccountSnapshot(\n    AccountSummaryData Summary,\n    OpenedOrdersData OpenedOrders\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>Summary</code> <code>AccountSummaryData</code> Account summary with balance, equity, margin, and other account-level metrics. <code>OpenedOrders</code> <code>OpenedOrdersData</code> All opened orders and positions sorted by open time (ascending)."},{"location":"API_Reference/MT5Sugar.API/#returns_1","title":"Returns","text":"<p><code>sealed record</code></p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_1","title":"Remarks","text":"<p>This record combines two frequently-needed pieces of information into one atomic snapshot. Useful for dashboards, risk monitoring, and account state logging.</p>"},{"location":"API_Reference/MT5Sugar.API/#getaccountsnapshot","title":"GetAccountSnapshot","text":"<p>Retrieves a complete account snapshot including summary data and all opened orders/positions. Optimizes performance by fetching both datasets in parallel where possible.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_2","title":"Signature","text":"<pre><code>public Task&lt;AccountSnapshot&gt; GetAccountSnapshot(\n    this MT5Service svc,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_2","title":"Returns","text":"<p><code>Task&lt;AccountSnapshot&gt;</code> -  containing account summary and opened orders.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_2","title":"Remarks","text":"<p>This method combines two RPC calls into a single operation: AccountSummaryAsync - gets balance, equity, margin, profit, etc. OpenedOrdersAsync - gets all active orders and positions PERFORMANCE: Both calls use the same deadline for consistency. USE CASES: Dashboard updates showing account state + active trades Risk monitoring (check margin level + open positions) Periodic state logging/auditing Pre-trade validation (check available margin before opening) </p>"},{"location":"API_Reference/MT5Sugar.API/#symbolsnapshot","title":"SymbolSnapshot","text":"<p>Composite snapshot containing essential symbol trading parameters at a single point in time. Includes current tick, price precision, and margin requirements.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_3","title":"Signature","text":"<pre><code>public sealed record SymbolSnapshot(\n    MrpcMqlTick Tick,\n    double Point,\n    int Digits,\n    SymbolInfoMarginRateData MarginRate\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>Tick</code> <code>MrpcMqlTick</code> Current tick data (bid, ask, last, volume, time). <code>Point</code> <code>double</code> Minimal price change step (e.g., 0.00001 for EURUSD). <code>Digits</code> <code>int</code> Number of decimal places in price quotes (e.g., 5 for EURUSD). <code>MarginRate</code> <code>SymbolInfoMarginRateData</code> Margin rate data for BUY orders (initial margin, maintenance margin)."},{"location":"API_Reference/MT5Sugar.API/#returns_3","title":"Returns","text":"<p><code>sealed record</code></p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_3","title":"Remarks","text":"<p>This record bundles the most commonly-needed symbol properties for trading operations. Particularly useful for order validation, price normalization, and risk calculations.</p>"},{"location":"API_Reference/MT5Sugar.API/#getsymbolsnapshot","title":"GetSymbolSnapshot","text":"<p>Retrieves a complete trading snapshot for the specified symbol. Fetches current tick, price precision, and margin requirements in one operation.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_4","title":"Signature","text":"<pre><code>public Task&lt;SymbolSnapshot&gt; GetSymbolSnapshot(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name to snapshot (e.g., \"EURUSD\", \"XAUUSD\", \"BTCUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_4","title":"Returns","text":"<p><code>Task&lt;SymbolSnapshot&gt;</code> -  containing tick data, point size, digits, and margin rates.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_4","title":"Remarks","text":"<p>This method performs the following operations: Ensures symbol is selected and synchronized Fetches current tick (bid, ask, last price) Retrieves point size (minimal price step) Gets price precision (number of decimal digits) Queries margin rate for BUY orders PERFORMANCE: Makes 5 sequential RPC calls. Consider caching for frequently-used symbols. USE CASES: Pre-trade validation (check current prices + margin) Price normalization (round to correct digits) Stop-loss/take-profit calculation (use point for pip distance) Risk management (calculate margin requirements) </p>"},{"location":"API_Reference/MT5Sugar.API/#getpointasync","title":"GetPointAsync","text":"<p>Retrieves the symbol's point value - the minimal price change step. Convenience wrapper around SymbolInfoDouble(SymbolPoint).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_5","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetPointAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_5","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Point value as a double (e.g., 0.00001 for 5-digit EURUSD, 0.01 for XAUUSD).</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_5","title":"Remarks","text":"<p>POINT is the fundamental unit for price calculations in MT5: 5-digit EURUSD: point = 0.00001 (1 pip = 10 points) 3-digit USDJPY: point = 0.001 (1 pip = 10 points) 2-digit XAUUSD: point = 0.01 (1 pip = 1 point) Used for calculating stop-loss/take-profit distances, spreads, and price movements.</p>"},{"location":"API_Reference/MT5Sugar.API/#getdigitsasync","title":"GetDigitsAsync","text":"<p>Gets the number of decimal places used in price quotes for the specified symbol. Convenience wrapper around SymbolInfoInteger(SymbolDigits).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_6","title":"Signature","text":"<pre><code>public Task&lt;int&gt; GetDigitsAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_6","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Number of digits as integer (e.g., 5 for EURUSD, 2 for XAUUSD, 3 for USDJPY).</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_6","title":"Remarks","text":"<p>Digits determine price precision and formatting: 5 digits: 1.08550 (typical for major FX pairs) 3 digits: 150.123 (typical for JPY pairs) 2 digits: 1925.50 (typical for gold/silver) Use with Math.Round() to format prices correctly before displaying or sending to MT5.</p>"},{"location":"API_Reference/MT5Sugar.API/#normalizepriceasync","title":"NormalizePriceAsync","text":"<p>Normalizes a price to the symbol's tick size (not just digits). Uses SYMBOL_TRADE_TICK_SIZE for strict broker-compliant rounding.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_7","title":"Signature","text":"<pre><code>public Task&lt;double&gt; NormalizePriceAsync(\n    this MT5Service svc,\n    string symbol,\n    double price,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\"). <code>price</code> <code>double</code> Raw price value to normalize. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_7","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Normalized price that aligns with the symbol's tick size.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_7","title":"Remarks","text":"<p>IMPORTANT: This uses tick size, NOT digits. Tick size is broker-specific and more accurate. Example: Some brokers use tick size of 0.00005 for EURUSD (5 points), not 0.00001. Always use this method to normalize stop-loss, take-profit, and limit prices before sending orders. PERFORMANCE: Makes 1 RPC call. Consider caching tick size for repeated operations.</p>"},{"location":"API_Reference/MT5Sugar.API/#pointstopipsasync","title":"PointsToPipsAsync","text":"<p>Converts points to pips based on symbol's digit precision. For 5-digit pairs: 10 points = 1 pip. For 3-digit pairs: 10 points = 1 pip.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_8","title":"Signature","text":"<pre><code>public Task&lt;double&gt; PointsToPipsAsync(\n    this MT5Service svc,\n    string symbol,\n    double points,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"USDJPY\"). <code>points</code> <code>double</code> Number of points to convert. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_8","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Equivalent value in pips (fractional).</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_8","title":"Remarks","text":"<p>PIP (Percentage In Point) is the standard unit traders use for price movements: 5-digit EURUSD (1.08550): 1 pip = 10 points = 0.0010 move 3-digit USDJPY (150.123): 1 pip = 10 points = 0.10 move 2-digit XAUUSD (1925.50): 1 pip = 1 point = 1.00 move Use this for human-readable distance reporting (e.g., \"Stop loss is 20 pips away\").</p>"},{"location":"API_Reference/MT5Sugar.API/#getspreadpointsasync","title":"GetSpreadPointsAsync","text":"<p>Calculates the current spread (Ask - Bid) in points. Fetches latest tick and computes spread using symbol's point value.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_9","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetSpreadPointsAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_9","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Spread in points (e.g., 15.0 for a 1.5-pip spread on 5-digit EURUSD).</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_9","title":"Remarks","text":"<p>Spread represents the broker's markup and liquidity cost. Typical spreads: EURUSD: 10-20 points (1-2 pips) on ECN accounts XAUUSD: 20-50 points (0.20-0.50 USD) depending on volatility Exotic pairs: 50-200+ points PERFORMANCE: Makes 2 RPC calls (tick + point). Monitor spread before trading.</p>"},{"location":"API_Reference/MT5Sugar.API/#ordershistorylast","title":"OrdersHistoryLast","text":"<p>Retrieves closed orders history for the last N days with pagination support. Convenience wrapper that automatically calculates the date range from current time.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_10","title":"Signature","text":"<pre><code>public Task&lt;OrdersHistoryData&gt; OrdersHistoryLast(\n    this MT5Service svc,\n    int days = 7,\n    int page = 0,\n    int size = 100,\n    BMT5_ENUM_ORDER_HISTORY_SORT_TYPE sort = BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeAsc,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>days</code> <code>int</code> Number of days to look back from today (default: 7). <code>page</code> <code>int</code> Page number for pagination, zero-based (default: 0). <code>size</code> <code>int</code> Number of records per page (default: 100). <code>sort</code> <code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> Sort order for results (default: by close time ascending). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 20). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_10","title":"Returns","text":"<p><code>Task&lt;OrdersHistoryData&gt;</code> -  containing closed orders within the specified date range.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_10","title":"Remarks","text":"<p>Fetches orders that were closed/cancelled within the last N days. Date range: from (now - N days) to (now), both in UTC. PAGINATION: Use page/size parameters to retrieve large histories incrementally. USE CASES: Trading journal/audit (retrieve last week's trades) Performance analysis (calculate win rate, avg profit) Trade replication (replay recent orders) Debugging (check what orders were executed) </p>"},{"location":"API_Reference/MT5Sugar.API/#positionshistorypaged","title":"PositionsHistoryPaged","text":"<p>Retrieves positions history with pagination and optional date filtering. Returns closed positions (deals) with full profit/loss information.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_11","title":"Signature","text":"<pre><code>public Task&lt;PositionsHistoryData&gt; PositionsHistoryPaged(\n    this MT5Service svc,\n    AH_ENUM_POSITIONS_HISTORY_SORT_TYPE sort = AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AhPositionOpenTimeAsc,\n    DateTime? openFrom = null,\n    DateTime? openTo = null,\n    int page = 0,\n    int size = 100,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>sort</code> <code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> Sort order for results (default: by position open time ascending). <code>openFrom</code> <code>DateTime?</code> Optional start date for position open time filter (UTC). Null = no lower bound. <code>openTo</code> <code>DateTime?</code> Optional end date for position open time filter (UTC). Null = no upper bound. <code>page</code> <code>int</code> Page number for pagination, zero-based (default: 0). <code>size</code> <code>int</code> Number of records per page (default: 100). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 20). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_11","title":"Returns","text":"<p><code>Task&lt;PositionsHistoryData&gt;</code> -  containing closed positions with P&amp;L details.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_11","title":"Remarks","text":"<p>IMPORTANT: This retrieves CLOSED positions (deals), not current open positions. Each position includes: Entry/exit prices and times Realized profit/loss Commission and swap charges Position volume and symbol PAGINATION: Essential for accounts with large trading history. USE CASES: Performance analytics (calculate total profit, drawdown) Strategy backtesting validation (compare algo vs actual) Tax reporting (export closed positions for accounting) Trade history review (analyze winning/losing patterns) </p>"},{"location":"API_Reference/MT5Sugar.API/#readticks","title":"ReadTicks","text":"<p>Reads a limited number of tick events from specified symbols or until duration timeout expires. Provides bounded streaming with automatic termination safeguards.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_12","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnSymbolTickData&gt; ReadTicks(\n    this MT5Service svc,\n    IEnumerable&lt;string&gt; symbols,\n    int maxEvents = 50,\n    int durationSec = 5,\n    [EnumeratorCancellation] CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> Collection of symbol names to subscribe to (e.g., [\"EURUSD\", \"XAUUSD\"]). <code>maxEvents</code> <code>int</code> Maximum number of tick events to read before stopping (default: 50). <code>durationSec</code> <code>int</code> Maximum duration in seconds to read ticks before timeout (default: 5). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_12","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnSymbolTickData&gt;</code> - Async enumerable stream of  tick events. Stream automatically terminates when either maxEvents or durationSec is reached.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_12","title":"Remarks","text":"<p>BOUNDED STREAMING: Unlike raw OnSymbolTickAsync, this helper automatically limits the stream. TERMINATION CONDITIONS (whichever comes first): Received maxEvents tick updates Duration timeout (durationSec) expired Cancellation token triggered USE CASES: Sample recent tick data for analysis Monitor prices briefly before placing orders Test streaming connectivity without infinite loops Collect tick samples for spread/volatility calculation PERFORMANCE: Creates a linked CancellationTokenSource for timeout management.</p>"},{"location":"API_Reference/MT5Sugar.API/#readtrades","title":"ReadTrades","text":"<p>Reads a limited number of trade transaction events or until duration timeout expires. Monitors order fills, modifications, and cancellations with automatic termination.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_13","title":"Signature","text":"<pre><code>public IAsyncEnumerable&lt;OnTradeData&gt; ReadTrades(\n    this MT5Service svc,\n    int maxEvents = 20,\n    int durationSec = 5,\n    [EnumeratorCancellation] CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_13","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>maxEvents</code> <code>int</code> Maximum number of trade events to read before stopping (default: 20). <code>durationSec</code> <code>int</code> Maximum duration in seconds to read events before timeout (default: 5). <code>ct</code> <code>CancellationToken</code> Cancellation token to cancel the operation."},{"location":"API_Reference/MT5Sugar.API/#returns_13","title":"Returns","text":"<p><code>IAsyncEnumerable&lt;OnTradeData&gt;</code> - Async enumerable stream of  trade transaction events. Stream automatically terminates when either maxEvents or durationSec is reached.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_13","title":"Remarks","text":"<p>TRADE EVENTS include: Order placements (market, limit, stop) Order fills and partial fills Order modifications (SL/TP changes) Order cancellations Position opens/closes BOUNDED STREAMING: Automatically limits the stream to prevent infinite loops. TERMINATION CONDITIONS (whichever comes first): Received maxEvents trade updates Duration timeout (durationSec) expired Cancellation token triggered USE CASES: Monitor order execution confirmations Audit recent trading activity Test trade notification system Verify stop-loss/take-profit triggers </p>"},{"location":"API_Reference/MT5Sugar.API/#placemarket","title":"PlaceMarket","text":"<p>Places a market order (BUY or SELL) with optional stop-loss and take-profit.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_14","title":"Signature","text":"<pre><code>public Task&lt;mt5_term_api.OrderSendData&gt; PlaceMarket(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    bool isBuy,\n    double? sl = null,\n    double? tp = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>isBuy</code> <code>bool</code> True for BUY, false for SELL. <code>sl</code> <code>double?</code> Optional stop-loss price. <code>tp</code> <code>double?</code> Optional take-profit price. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_14","title":"Returns","text":"<p><code>Task&lt;mt5_term_api.OrderSendData&gt;</code> - Order send result with ticket number and execution details.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_14","title":"Remarks","text":"<p>Uses reflection to set order type (BUY=0, SELL=1) to avoid hard enum dependency. Automatically ensures symbol is selected before placing order.</p>"},{"location":"API_Reference/MT5Sugar.API/#placepending","title":"PlacePending","text":"<p>Places a pending order (Buy/Sell Limit or Stop) at specified price.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_15","title":"Signature","text":"<pre><code>public Task&lt;mt5_term_api.OrderSendData&gt; PlacePending(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    ENUM_ORDER_TYPE type,\n    double price,\n    double? sl = null,\n    double? tp = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to trade. <code>volume</code> <code>double</code> Volume in lots. <code>type</code> <code>ENUM_ORDER_TYPE</code> Order type (BuyLimit, SellLimit, BuyStop, SellStop). <code>price</code> <code>double</code> Entry price for the pending order. <code>sl</code> <code>double?</code> Optional stop-loss price. <code>tp</code> <code>double?</code> Optional take-profit price. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_15","title":"Returns","text":"<p><code>Task&lt;mt5_term_api.OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#modifysltpasync","title":"ModifySlTpAsync","text":"<p>Modifies stop-loss and/or take-profit for an existing order or position.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_16","title":"Signature","text":"<pre><code>public Task&lt;OrderModifyData&gt; ModifySlTpAsync(\n    this MT5Service svc,\n    ulong ticket,\n    double? slPrice = null,\n    double? tpPrice = null,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_16","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>ticket</code> <code>ulong</code> Order or position ticket number. <code>slPrice</code> <code>double?</code> New stop-loss price (absolute value). Pass null to keep current SL unchanged. <code>tpPrice</code> <code>double?</code> New take-profit price (absolute value). Pass null to keep current TP unchanged. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_16","title":"Returns","text":"<p><code>Task&lt;OrderModifyData&gt;</code> - Order modify result with execution details.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_15","title":"Remarks","text":"<p>At least one parameter (slPrice or tpPrice) must be provided. Pass absolute price values, not relative points or offsets.</p>"},{"location":"API_Reference/MT5Sugar.API/#closebyticket","title":"CloseByTicket","text":"<p>Closes an order or position by ticket number with optional partial volume.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_17","title":"Signature","text":"<pre><code>public Task&lt;OrderCloseData&gt; CloseByTicket(\n    this MT5Service svc,\n    ulong ticket,\n    double? volume = null,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_17","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>ticket</code> <code>ulong</code> Order or position ticket number to close. <code>volume</code> <code>double?</code> Volume to close in lots. Pass null to close entire position. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_17","title":"Returns","text":"<p><code>Task&lt;OrderCloseData&gt;</code> - Order close result with execution details.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_16","title":"Remarks","text":"<p>For full position closure, pass volume as null. For partial closure, specify exact volume to close (must not exceed position volume).</p>"},{"location":"API_Reference/MT5Sugar.API/#closeall","title":"CloseAll","text":"<p>Closes all open orders and positions with optional filtering by symbol and direction.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_18","title":"Signature","text":"<pre><code>public Task&lt;int&gt; CloseAll(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_18","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter (e.g., \"EURUSD\"). Pass null to close all symbols. <code>isBuy</code> <code>bool?</code> Optional direction filter. True = close only BUY orders, False = close only SELL orders, null = close both. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_18","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Number of orders/positions that were closed.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_17","title":"Remarks","text":"<p>This method retrieves all open orders, applies filters, and closes matching positions sequentially. WARNING: Use with caution in live trading. Consider filters to avoid closing unintended positions.</p>"},{"location":"API_Reference/MT5Sugar.API/#getvolumelimitsasync","title":"GetVolumeLimitsAsync","text":"<p>Retrieves volume constraints for a symbol (minimum, maximum, and step size).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_19","title":"Signature","text":"<pre><code>public Task&lt;(double min, double max, double step)&gt; GetVolumeLimitsAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_19","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_19","title":"Returns","text":"<p><code>Task&lt;(double min, double max, double step)&gt;</code> - Tuple containing minimum volume, maximum volume, and volume step.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_18","title":"Remarks","text":"<p>Volume step defines the smallest increment allowed (e.g., 0.01 lots). Use this data to validate and normalize volumes before placing orders.</p>"},{"location":"API_Reference/MT5Sugar.API/#normalizevolumeasync","title":"NormalizeVolumeAsync","text":"<p>Normalizes volume to comply with symbol's step size and min/max limits.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_20","title":"Signature","text":"<pre><code>public Task&lt;double&gt; NormalizeVolumeAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_20","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Desired volume in lots. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_20","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Normalized volume that broker will accept.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_19","title":"Remarks","text":"<p>Rounds volume to nearest valid step and clamps to min/max range. Always use before placing orders to avoid broker rejections.</p>"},{"location":"API_Reference/MT5Sugar.API/#gettickvalueandsizeasync","title":"GetTickValueAndSizeAsync","text":"<p>Retrieves tick value and tick size for risk and P&amp;L calculations.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_21","title":"Signature","text":"<pre><code>public Task&lt;(double tickValue, double tickSize)&gt; GetTickValueAndSizeAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_21","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_21","title":"Returns","text":"<p><code>Task&lt;(double tickValue, double tickSize)&gt;</code> - Tuple containing tick value (monetary value per tick) and tick size (price increment).</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_20","title":"Remarks","text":"<p>Tick value represents how much money changes per one tick of price movement for 1 lot. Essential for accurate risk calculations and position sizing.</p>"},{"location":"API_Reference/MT5Sugar.API/#pricefromoffsetpointsasync","title":"PriceFromOffsetPointsAsync","text":"<p>Calculates pending order price by offset in points from current market price.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_22","title":"Signature","text":"<pre><code>public Task&lt;double&gt; PriceFromOffsetPointsAsync(\n    this MT5Service svc,\n    string symbol,\n    ENUM_ORDER_TYPE type,\n    double offsetPoints,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_22","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>type</code> <code>ENUM_ORDER_TYPE</code> Order type (BuyLimit, SellStop, etc.). <code>offsetPoints</code> <code>double</code> Distance in points from current bid/ask. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_22","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Normalized price for pending order placement.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_21","title":"Remarks","text":"<p>Automatically uses Ask for buy orders and Bid for sell orders. Result is normalized to symbol's tick size.</p>"},{"location":"API_Reference/MT5Sugar.API/#calcvolumeforriskasync","title":"CalcVolumeForRiskAsync","text":"<p>Calculates position size (volume in lots) based on risk amount and stop-loss distance.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_23","title":"Signature","text":"<pre><code>public Task&lt;double&gt; CalcVolumeForRiskAsync(\n    this MT5Service svc,\n    string symbol,\n    double stopPoints,\n    double riskMoney,\n    int timeoutSec = 10,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_23","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>stopPoints</code> <code>double</code> Stop-loss distance in points. <code>riskMoney</code> <code>double</code> Maximum amount of money to risk (in account currency). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_23","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Normalized volume in lots that matches the specified risk.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_22","title":"Remarks","text":"<p>Core risk management method. Calculates exact lot size so that if stop-loss is hit, the loss equals the specified risk amount.</p>"},{"location":"API_Reference/MT5Sugar.API/#buylimitpoints","title":"BuyLimitPoints","text":"<p>Places Buy Limit pending order using point-based offset from current Ask price.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_24","title":"Signature","text":"<pre><code>public Task&lt;mt5_term_api.OrderSendData&gt; BuyLimitPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_24","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>priceOffsetPoints</code> <code>double</code> Distance in points below current Ask (always positive). <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points below entry price. <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points above entry price. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_24","title":"Returns","text":"<p><code>Task&lt;mt5_term_api.OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#selllimitpoints","title":"SellLimitPoints","text":"<p>Places Sell Limit pending order using point-based offset from current Bid price.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_25","title":"Signature","text":"<pre><code>public Task&lt;mt5_term_api.OrderSendData&gt; SellLimitPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_25","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>priceOffsetPoints</code> <code>double</code> Distance in points above current Bid (always positive). <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points above entry price. <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points below entry price. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_25","title":"Returns","text":"<p><code>Task&lt;mt5_term_api.OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#buystoppoints","title":"BuyStopPoints","text":"<p>Places Buy Stop pending order using point-based offset from current Ask price.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_26","title":"Signature","text":"<pre><code>public Task&lt;mt5_term_api.OrderSendData&gt; BuyStopPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_26","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>priceOffsetPoints</code> <code>double</code> Distance in points above current Ask (always positive). <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points below entry price. <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points above entry price. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_26","title":"Returns","text":"<p><code>Task&lt;mt5_term_api.OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#sellstoppoints","title":"SellStopPoints","text":"<p>Places Sell Stop pending order using point-based offset from current Bid price.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_27","title":"Signature","text":"<pre><code>public Task&lt;mt5_term_api.OrderSendData&gt; SellStopPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_27","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>volume</code> <code>double</code> Volume in lots. <code>priceOffsetPoints</code> <code>double</code> Distance in points below current Bid (always positive). <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points above entry price. <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points below entry price. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_27","title":"Returns","text":"<p><code>Task&lt;mt5_term_api.OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#buymarketbyrisk","title":"BuyMarketByRisk","text":"<p>Opens Buy market position with volume calculated based on risk amount and stop-loss distance.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_28","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; BuyMarketByRisk(\n    this MT5Service svc,\n    string symbol,\n    double stopPoints,\n    double riskMoney,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_28","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>stopPoints</code> <code>double</code> Stop-loss distance in points. <code>riskMoney</code> <code>double</code> Maximum amount to risk (in account currency). <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 20). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_28","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_23","title":"Remarks","text":"<p>Combines CalcVolumeForRiskAsync and market order execution in one method.</p>"},{"location":"API_Reference/MT5Sugar.API/#sellmarketbyrisk","title":"SellMarketByRisk","text":"<p>Opens Sell market position with volume calculated based on risk amount and stop-loss distance.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_29","title":"Signature","text":"<pre><code>public Task&lt;OrderSendData&gt; SellMarketByRisk(\n    this MT5Service svc,\n    string symbol,\n    double stopPoints,\n    double riskMoney,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_29","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\"). <code>stopPoints</code> <code>double</code> Stop-loss distance in points. <code>riskMoney</code> <code>double</code> Maximum amount to risk (in account currency). <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points. <code>comment</code> <code>string?</code> Optional order comment. <code>deviationPoints</code> <code>int</code> Maximum price deviation in points. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 20). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_29","title":"Returns","text":"<p><code>Task&lt;OrderSendData&gt;</code> - Order send result with ticket number.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_24","title":"Remarks","text":"<p>Combines CalcVolumeForRiskAsync and market order execution in one method.</p>"},{"location":"API_Reference/MT5Sugar.API/#cancelall","title":"CancelAll","text":"<p>Cancels all pending orders with optional filtering by symbol and direction.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_30","title":"Signature","text":"<pre><code>public Task&lt;int&gt; CancelAll(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_30","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter. Pass null to cancel all symbols. <code>isBuy</code> <code>bool?</code> Optional direction filter. True = cancel only buy orders, False = cancel only sell orders, null = cancel both. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_30","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Number of pending orders cancelled.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_25","title":"Remarks","text":"<p>Only affects pending orders (Limit, Stop, Stop Limit). Market positions are not cancelled.</p>"},{"location":"API_Reference/MT5Sugar.API/#closeallpositions","title":"CloseAllPositions","text":"<p>Closes all open market positions with optional filtering by symbol and direction.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_31","title":"Signature","text":"<pre><code>public Task&lt;int&gt; CloseAllPositions(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_31","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter. Pass null to close all symbols. <code>isBuy</code> <code>bool?</code> Optional direction filter. True = close only buy positions, False = close only sell positions, null = close both. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_31","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Number of market positions closed.</p>"},{"location":"API_Reference/MT5Sugar.API/#remarks_26","title":"Remarks","text":"<p>Only affects market positions (BUY/SELL). Pending orders are not affected.</p>"},{"location":"API_Reference/MT5Sugar.API/#closeallpending","title":"CloseAllPending","text":"<p>Alias for CancelAll. Cancels all pending orders with optional filtering.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_32","title":"Signature","text":"<pre><code>public Task&lt;int&gt; CloseAllPending(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_32","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter. <code>isBuy</code> <code>bool?</code> Optional direction filter. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30). <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_32","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Number of pending orders cancelled.</p>"},{"location":"API_Reference/MT5Sugar.API/#subscribetomarketbookasync","title":"SubscribeToMarketBookAsync","text":"<p>Subscribe to Market Depth (order book) for a symbol and return a disposable subscription. Automatically releases the subscription when disposed.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_33","title":"Signature","text":"<pre><code>public Task&lt;IDisposable&gt; SubscribeToMarketBookAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_33","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to subscribe (e.g., \"EURUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_33","title":"Returns","text":"<p><code>Task&lt;IDisposable&gt;</code> - IDisposable that releases the subscription when disposed.</p>"},{"location":"API_Reference/MT5Sugar.API/#getmarketbooksnapshotasync","title":"GetMarketBookSnapshotAsync","text":"<p>Gets the current Market Depth (order book) snapshot for a symbol. You must subscribe first using SubscribeToMarketBookAsync or MarketBookAddAsync.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_34","title":"Signature","text":"<pre><code>public Task&lt;MarketBookGetData&gt; GetMarketBookSnapshotAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_34","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to query (e.g., \"EURUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_34","title":"Returns","text":"<p><code>Task&lt;MarketBookGetData&gt;</code> - MarketBookGetData with buy/sell book entries.</p>"},{"location":"API_Reference/MT5Sugar.API/#getbestbidaskfrombookasync","title":"GetBestBidAskFromBookAsync","text":"<p>Extracts best bid and ask prices from the current order book. Returns (bestBid, bestAsk) or (0, 0) if book is empty.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_35","title":"Signature","text":"<pre><code>public Task&lt;(double bestBid, double bestAsk)&gt; GetBestBidAskFromBookAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_35","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to query (e.g., \"EURUSD\"). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_35","title":"Returns","text":"<p><code>Task&lt;(double bestBid, double bestAsk)&gt;</code> - Tuple (bestBid, bestAsk).</p>"},{"location":"API_Reference/MT5Sugar.API/#calculateliquidityatlevelasync","title":"CalculateLiquidityAtLevelAsync","text":"<p>Calculates total liquidity (volume) available at a specific price level in the order book.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_36","title":"Signature","text":"<pre><code>public Task&lt;long&gt; CalculateLiquidityAtLevelAsync(\n    this MT5Service svc,\n    string symbol,\n    double price,\n    bool isBuy,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_36","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to query (e.g., \"EURUSD\"). <code>price</code> <code>double</code> Price level to check. <code>isBuy</code> <code>bool</code> True for buy side (bids), false for sell side (asks). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_36","title":"Returns","text":"<p><code>Task&lt;long&gt;</code> - Total volume at the price level.</p>"},{"location":"API_Reference/MT5Sugar.API/#validateorderasync","title":"ValidateOrderAsync","text":"<p>Validates an order before sending (pre-flight check). Checks symbol availability, lot size constraints, margin requirements, etc.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_37","title":"Signature","text":"<pre><code>public Task&lt;OrderCheckData&gt; ValidateOrderAsync(\n    this MT5Service svc,\n    OrderCheckRequest request,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_37","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>request</code> <code>OrderCheckRequest</code> OrderCheckRequest with MqlTradeRequest populated. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_37","title":"Returns","text":"<p><code>Task&lt;OrderCheckData&gt;</code> - OrderCheckData with validation result and potential error codes.</p>"},{"location":"API_Reference/MT5Sugar.API/#calculatebuymarginasync","title":"CalculateBuyMarginAsync","text":"<p>Calculates margin required for a BUY order before placing it.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_38","title":"Signature","text":"<pre><code>public Task&lt;double&gt; CalculateBuyMarginAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double price = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_38","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to trade. <code>volume</code> <code>double</code> Volume in lots. <code>price</code> <code>double</code> Entry price (0 for market price). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_38","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Required margin amount.</p>"},{"location":"API_Reference/MT5Sugar.API/#calculatesellmarginasync","title":"CalculateSellMarginAsync","text":"<p>Calculates margin required for a SELL order before placing it.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_39","title":"Signature","text":"<pre><code>public Task&lt;double&gt; CalculateSellMarginAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double price = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_39","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to trade. <code>volume</code> <code>double</code> Volume in lots. <code>price</code> <code>double</code> Entry price (0 for market price). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_39","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Required margin amount.</p>"},{"location":"API_Reference/MT5Sugar.API/#checkmarginavailabilityasync","title":"CheckMarginAvailabilityAsync","text":"<p>Checks if account has enough free margin for a trade. Returns (hasEnoughMargin, freeMargin, requiredMargin).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_40","title":"Signature","text":"<pre><code>public Task&lt;(bool hasEnough, double freeMargin, double required)&gt; CheckMarginAvailabilityAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    bool isBuy,\n    double price = 0,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_40","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to trade. <code>volume</code> <code>double</code> Volume in lots. <code>isBuy</code> <code>bool</code> True for BUY, false for SELL. <code>price</code> <code>double</code> Entry price (0 for market price). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_40","title":"Returns","text":"<p><code>Task&lt;(bool hasEnough, double freeMargin, double required)&gt;</code> - Tuple (hasEnoughMargin, freeMargin, requiredMargin).</p>"},{"location":"API_Reference/MT5Sugar.API/#getquotesessionasync","title":"GetQuoteSessionAsync","text":"<p>Gets quote session information for a symbol. Convenience wrapper with default timeout.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_41","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoSessionQuoteData&gt; GetQuoteSessionAsync(\n    this MT5Service svc,\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    int sessionIndex = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_41","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to query. <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of week. <code>sessionIndex</code> <code>int</code> Session index (0 = first session, 1 = second, etc.). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_41","title":"Returns","text":"<p><code>Task&lt;SymbolInfoSessionQuoteData&gt;</code> - SymbolInfoSessionQuoteData.</p>"},{"location":"API_Reference/MT5Sugar.API/#gettradesessionasync","title":"GetTradeSessionAsync","text":"<p>Gets trade session information for a symbol. Convenience wrapper with default timeout.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_42","title":"Signature","text":"<pre><code>public Task&lt;SymbolInfoSessionTradeData&gt; GetTradeSessionAsync(\n    this MT5Service svc,\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    int sessionIndex = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_42","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string</code> Symbol to query. <code>dayOfWeek</code> <code>mt5_term_api.DayOfWeek</code> Day of week. <code>sessionIndex</code> <code>int</code> Session index (0 = first session, 1 = second, etc.). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_42","title":"Returns","text":"<p><code>Task&lt;SymbolInfoSessionTradeData&gt;</code> - SymbolInfoSessionTradeData.</p>"},{"location":"API_Reference/MT5Sugar.API/#getprofitablepositionsasync","title":"GetProfitablePositionsAsync","text":"<p>Gets all currently profitable positions (P&amp;L &gt; 0).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_43","title":"Signature","text":"<pre><code>public Task&lt;List&lt;object&gt;&gt; GetProfitablePositionsAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_43","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter (null = all symbols). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_43","title":"Returns","text":"<p><code>Task&lt;List&lt;object&gt;&gt;</code> - List of profitable positions.</p>"},{"location":"API_Reference/MT5Sugar.API/#getlosingpositionsasync","title":"GetLosingPositionsAsync","text":"<p>Gets all currently losing positions (P&amp;L &lt; 0).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_44","title":"Signature","text":"<pre><code>public Task&lt;List&lt;object&gt;&gt; GetLosingPositionsAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_44","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter (null = all symbols). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_44","title":"Returns","text":"<p><code>Task&lt;List&lt;object&gt;&gt;</code> - List of losing positions.</p>"},{"location":"API_Reference/MT5Sugar.API/#gettotalprofitlossasync","title":"GetTotalProfitLossAsync","text":"<p>Calculates total profit/loss across all open positions.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_45","title":"Signature","text":"<pre><code>public Task&lt;double&gt; GetTotalProfitLossAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_45","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter (null = all symbols). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_45","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Total P&amp;L.</p>"},{"location":"API_Reference/MT5Sugar.API/#getpositioncountasync","title":"GetPositionCountAsync","text":"<p>Gets count of open positions (optionally filtered by symbol).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_46","title":"Signature","text":"<pre><code>public Task&lt;int&gt; GetPositionCountAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_46","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>symbol</code> <code>string?</code> Optional symbol filter (null = all symbols). <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_46","title":"Returns","text":"<p><code>Task&lt;int&gt;</code> - Number of open positions.</p>"},{"location":"API_Reference/MT5Sugar.API/#getpositionstatsbysymbolasync","title":"GetPositionStatsBySymbolAsync","text":"<p>Aggregates position statistics by symbol. Returns dictionary: symbol -&gt; (count, totalVolume, totalPnL).</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_47","title":"Signature","text":"<pre><code>public Task&lt;Dictionary&lt;string, (int count, double totalVolume, double totalPnL)&gt;&gt;\n            GetPositionStatsBySymbolAsync(\n    this MT5Service svc,\n    int timeoutSec = 20,\n    CancellationToken ct = default\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_47","title":"Parameters","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance. <code>timeoutSec</code> <code>int</code> RPC timeout in seconds. <code>ct</code> <code>CancellationToken</code> Cancellation token."},{"location":"API_Reference/MT5Sugar.API/#returns_47","title":"Returns","text":"<p><code>Task&lt;Dictionary&lt;string, (int count, double totalVolume, double totalPnL)&gt;&gt;</code> - Dictionary of position statistics per symbol.</p>"},{"location":"API_Reference/MT5Sugar.API/#accountsnapshot_1","title":"AccountSnapshot","text":"<p>Composite snapshot containing account summary and all currently opened orders/positions. Provides a complete view of account state at a single point in time.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_48","title":"Signature","text":"<pre><code>public record AccountSnapshot(\n    AccountSummaryData Summary,\n    OpenedOrdersData OpenedOrders\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_48","title":"Parameters","text":"Parameter Type Description <code>Summary</code> <code>AccountSummaryData</code> Account summary with balance, equity, margin, and other account-level metrics. <code>OpenedOrders</code> <code>OpenedOrdersData</code> All opened orders and positions sorted by open time (ascending)."},{"location":"API_Reference/MT5Sugar.API/#remarks_27","title":"Remarks","text":"<p>This record combines two frequently-needed pieces of information into one atomic snapshot. Useful for dashboards, risk monitoring, and account state logging.</p>"},{"location":"API_Reference/MT5Sugar.API/#symbolsnapshot_1","title":"SymbolSnapshot","text":"<p>Composite snapshot containing essential symbol trading parameters at a single point in time. Includes current tick, price precision, and margin requirements.</p>"},{"location":"API_Reference/MT5Sugar.API/#signature_49","title":"Signature","text":"<pre><code>public record SymbolSnapshot(\n    MrpcMqlTick Tick,\n    double Point,\n    int Digits,\n    SymbolInfoMarginRateData MarginRate\n)\n</code></pre>"},{"location":"API_Reference/MT5Sugar.API/#parameters_49","title":"Parameters","text":"Parameter Type Description <code>Tick</code> <code>MrpcMqlTick</code> Current tick data (bid, ask, last, volume, time). <code>Point</code> <code>double</code> Minimal price change step (e.g., 0.00001 for EURUSD). <code>Digits</code> <code>int</code> Number of decimal places in price quotes (e.g., 5 for EURUSD). <code>MarginRate</code> <code>SymbolInfoMarginRateData</code> Margin rate data for BUY orders (initial margin, maintenance margin)."},{"location":"API_Reference/MT5Sugar.API/#remarks_28","title":"Remarks","text":"<p>This record bundles the most commonly-needed symbol properties for trading operations. Particularly useful for order validation, price normalization, and risk calculations.</p>"},{"location":"MT5Account/MT5Account.Master.Overview/","title":"MT5Account - Master Overview","text":"<p>One page to orient fast: what lives where, how to choose the right API, and jump links to every overview and method spec in this docs set.</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#start-here-section-overviews","title":"\ud83d\udea6 Start here - Section Overviews","text":"<ul> <li> <p>Account_Information - Overview   Account balance/equity/margin/leverage, complete snapshot or single properties.</p> </li> <li> <p>Symbol_Information - Overview   Quotes, symbol properties, trading rules, tick values, Market Watch management.</p> </li> <li> <p>Position_Orders_Information - Overview   Open positions, pending orders, historical deals, order history.</p> </li> <li> <p>Trading_Operations - Overview   Order execution, position management, margin calculations, trade validation.</p> </li> <li> <p>Market_Depth_DOM - Overview   Level II quotes, order book data, market depth subscription.</p> </li> <li> <p>Additional_Methods - Overview   Advanced symbol info, trading sessions, margin rates, batch operations.</p> </li> <li> <p>Streaming_Methods - Overview   Real-time streams: ticks, trades, profit updates, transaction log.   \ud83d\udcd6 Complete Streaming Guide - How to properly work with subscriptions (patterns, best practices, memory management)</p> </li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#how-to-pick-an-api","title":"\ud83e\udded How to pick an API","text":"If you need\u2026 Go to\u2026 Typical calls Account snapshot Account_Information <code>AccountSummaryAsync</code>, <code>AccountInfoDoubleAsync</code>, <code>AccountInfoIntegerAsync</code> Quotes &amp; symbol properties Symbol_Information <code>SymbolInfoTickAsync</code>, <code>SymbolInfoDoubleAsync</code>, <code>SymbolsTotalAsync</code> Current positions &amp; orders Position_Orders_Information <code>PositionsTotalAsync</code>, <code>OpenedOrdersAsync</code>, <code>OpenedOrdersTicketsAsync</code> Historical trades Position_Orders_Information <code>OrderHistoryAsync</code>, <code>PositionsHistoryAsync</code> Level II / Order book Market_Depth_DOM <code>MarketBookAddAsync</code>, <code>MarketBookGetAsync</code>, <code>MarketBookReleaseAsync</code> Trading operations Trading_Operations <code>OrderSendAsync</code>, <code>OrderModifyAsync</code>, <code>OrderCloseAsync</code> Pre-trade calculations Trading_Operations <code>OrderCalcMarginAsync</code>, <code>OrderCheckAsync</code> Real-time updates Streaming_Methods <code>OnSymbolTickAsync</code>, <code>OnTradeAsync</code>, <code>OnPositionProfitAsync</code>"},{"location":"MT5Account/MT5Account.Master.Overview/#usage-pattern-grpc-protocol","title":"\ud83d\udd0c Usage pattern (gRPC protocol)","text":"<p>Every method is available in two versions: Async (recommended) and Sync (rare scenarios).</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#async-version-recommended-99-of-cases","title":"Async Version (Recommended - 99% of cases)","text":"<pre><code>var summary = await account.AccountSummaryAsync();\nvar tick = await account.SymbolInfoTickAsync(\"EURUSD\");\n</code></pre>"},{"location":"MT5Account/MT5Account.Master.Overview/#sync-version-legacyspecific-scenarios-only","title":"Sync Version (Legacy/specific scenarios only)","text":"<pre><code>var summary = account.AccountSummary();\nvar tick = account.SymbolInfoTick(\"EURUSD\");\n</code></pre> <p>\ud83d\udcd6 Read: Sync vs Async - When to Use What - Detailed guide with use cases and performance comparisons.</p> <p>Every method follows the same shape:</p> <ul> <li>Proto Service/Method: <code>Service.Method(Request) \u2192 Reply</code></li> <li>C# wrapper: <code>await mt5Account.MethodAsync(...)</code> or <code>mt5Account.Method()</code></li> <li>Reply structure: <code>Reply.Data</code> payload (proto-generated objects)</li> <li>Return codes: <code>10009</code> = success; other codes = check error message</li> </ul> <p>Timestamps = UTC (<code>google.protobuf.Timestamp</code>). For streaming subscriptions, use <code>IAsyncEnumerable&lt;T&gt;</code> with <code>await foreach</code> pattern.</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#full-index-all-method-specs","title":"\ud83d\udcda Full Index \u00b7 All Method Specs","text":""},{"location":"MT5Account/MT5Account.Master.Overview/#account-information","title":"\ud83d\udcc4 Account Information","text":"<ul> <li>Overview: Account_Information.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#complete-snapshot","title":"Complete Snapshot","text":"<ul> <li>AccountSummary.md - All account info at once (balance, equity, margin, etc.)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#individual-properties","title":"Individual Properties","text":"<ul> <li>AccountInfoDouble.md - Single double value (balance, equity, margin, profit, etc.)</li> <li>AccountInfoInteger.md - Single integer value (login, leverage, limit orders, etc.)</li> <li>AccountInfoString.md - Single string value (name, server, currency, company)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#symbol-information","title":"\ud83d\udcca Symbol Information","text":"<ul> <li>Overview: Symbol_Information.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#current-quotes","title":"Current Quotes","text":"<ul> <li>SymbolInfoTick.md - Current quote for symbol (bid, ask, last, volume, time)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#symbol-inventory-management","title":"Symbol Inventory &amp; Management","text":"<ul> <li>SymbolsTotal.md - Count of available symbols</li> <li>SymbolName.md - Get symbol name by index</li> <li>SymbolSelect.md - Enable/disable symbol in Market Watch</li> <li>SymbolExist.md - Check if symbol exists</li> <li>SymbolIsSynchronized.md - Check symbol data sync status</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#symbol-properties","title":"Symbol Properties","text":"<ul> <li>SymbolInfoDouble.md - Single double property (bid, ask, point, volume min/max, etc.)</li> <li>SymbolInfoInteger.md - Single integer property (digits, spread, stops level, etc.)</li> <li>SymbolInfoString.md - Single string property (description, currency, path)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#positions-orders","title":"\ud83d\udce6 Positions &amp; Orders","text":"<ul> <li>Overview: Position_Orders_Information.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#current-state","title":"Current State","text":"<ul> <li>PositionsTotal.md - Count of open positions</li> <li>OpenedOrders.md - Full details of all open positions and pending orders</li> <li>OpenedOrdersTickets.md - Ticket numbers only (lightweight)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#historical-data","title":"Historical Data","text":"<ul> <li>OrderHistory.md - Historical orders within time range (with pagination)</li> <li>PositionsHistory.md - Closed positions within time range (with pagination)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#trading-actions","title":"\ud83d\udee0 Trading Actions","text":"<ul> <li>Overview: Trading_Operations.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#order-execution-management","title":"Order Execution &amp; Management","text":"<ul> <li>OrderSend.md - Place market or pending orders</li> <li>OrderModify.md - Modify SL/TP or order parameters</li> <li>OrderClose.md - Close positions (full or partial)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#pre-trade-calculations","title":"Pre-Trade Calculations","text":"<ul> <li>OrderCalcMargin.md - Calculate margin required for trade</li> <li>OrderCheck.md - Validate trade request before execution</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#market-depth-dom","title":"\ud83d\udcc8 Market Depth (DOM)","text":"<ul> <li>Overview: Market_Depth_DOM.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#level-ii-quotes","title":"Level II Quotes","text":"<ul> <li>MarketBookAdd.md - Subscribe to Market Depth for symbol</li> <li>MarketBookGet.md - Get current order book data</li> <li>MarketBookRelease.md - Unsubscribe from Market Depth</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#additional-methods","title":"\ud83d\udd27 Additional Methods","text":"<ul> <li>Overview: Additional_Methods.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#advanced-symbol-information","title":"Advanced Symbol Information","text":"<ul> <li>SymbolInfoMarginRate.md - Margin rates for symbol and order type</li> <li>SymbolInfoSessionQuote.md - Quote session times</li> <li>SymbolInfoSessionTrade.md - Trade session times</li> <li>SymbolParamsMany.md - Detailed parameters for multiple symbols (112 fields!)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#trading-calculations","title":"Trading Calculations","text":"<ul> <li>TickValueWithSize.md - Batch tick values for multiple symbols</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#subscriptions-streaming","title":"\ud83d\udce1 Subscriptions (Streaming)","text":"<ul> <li>Overview: Streaming_Methods.Overview.md</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#real-time-price-updates","title":"Real-Time Price Updates","text":"<ul> <li>SubscribeToTicks.md - Real-time tick stream for symbols</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#trading-events","title":"Trading Events","text":"<ul> <li>OnTrade.md - Position/order changes (opened, closed, modified)</li> <li>SubscribeToTradeTransaction.md - Detailed transaction log (complete audit trail)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#position-monitoring","title":"Position Monitoring","text":"<ul> <li>SubscribeToPositionProfit.md - Periodic profit/loss updates</li> <li>OnPositionsAndPendingOrdersTickets.md - Periodic ticket lists (lightweight)</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#quick-navigation-by-use-case","title":"\ud83c\udfaf Quick Navigation by Use Case","text":"I want to... Use this method ACCOUNT INFORMATION Get complete account snapshot AccountSummaryAsync Get account balance AccountInfoDoubleAsync (BALANCE) Get account equity AccountInfoDoubleAsync (EQUITY) Get account leverage AccountInfoIntegerAsync (LEVERAGE) Get account currency AccountInfoStringAsync (CURRENCY) SYMBOL INFORMATION Get current price for symbol SymbolInfoTickAsync List all available symbols SymbolsTotalAsync + SymbolNameAsync Add symbol to Market Watch SymbolSelectAsync (true) Get symbol digits (decimal places) SymbolInfoIntegerAsync (DIGITS) Get point size for symbol SymbolInfoDoubleAsync (POINT) Get symbol volume limits SymbolInfoDoubleAsync (VOLUME_MIN/MAX/STEP) Get tick values for symbols TickValueWithSizeAsync POSITIONS &amp; ORDERS Count open positions PositionsTotalAsync Get all open positions (full details) OpenedOrdersAsync Get position ticket numbers only OpenedOrdersTicketsAsync Get historical orders OrderHistoryAsync Get historical deals/trades PositionsHistoryAsync MARKET DEPTH Subscribe to Level II quotes MarketBookAddAsync Get order book data MarketBookGetAsync Unsubscribe from Level II MarketBookReleaseAsync TRADING OPERATIONS Open market BUY position OrderSendAsync (type=BUY) Open market SELL position OrderSendAsync (type=SELL) Place BUY LIMIT order OrderSendAsync (type=BUY_LIMIT) Place SELL LIMIT order OrderSendAsync (type=SELL_LIMIT) Place BUY STOP order OrderSendAsync (type=BUY_STOP) Place SELL STOP order OrderSendAsync (type=SELL_STOP) Modify SL/TP of position OrderModifyAsync Close a position OrderCloseAsync Calculate margin before trade OrderCalcMarginAsync Validate trade before execution OrderCheckAsync REAL-TIME SUBSCRIPTIONS Stream live prices OnSymbolTickAsync Monitor trade events OnTradeAsync Track profit changes OnPositionProfitAsync Monitor ticket changes OnPositionsAndPendingOrdersTicketsAsync Detailed transaction log OnTradeTransactionAsync"},{"location":"MT5Account/MT5Account.Master.Overview/#api-architecture","title":"\ud83c\udfd7\ufe0f API Architecture","text":""},{"location":"MT5Account/MT5Account.Master.Overview/#layer-1-mt5account-low-level","title":"Layer 1: MT5Account (Low-Level)","text":"<p>What: Direct proto/gRPC communication with MT5 terminal.</p> <p>When to use: - Need full control over protocol - Building custom wrappers - Proto-level integration required</p> <p>Characteristics: - Works with proto Request/Response objects - Raw gRPC method calls - Complete access to all MT5 functions - Highest complexity</p> <p>Location: <code>package/Helpers/MT5Account.cs</code> (NuGet package source)</p> <p>Documentation: This folder (you are here!)</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#layer-2-mt5service","title":"Layer 2: MT5Service","text":"<p>What: Simplified wrapper methods without proto complexity.</p> <p>When to use: - Want simplified API but not auto-normalization - Building custom convenience layers - Need direct data returns</p> <p>Characteristics: - Simple method signatures - Type conversions (proto \u2192 C# primitives) - No proto objects in return values - No auto-normalization</p> <p>Location: <code>MT5Service.cs</code></p> <p>Documentation: MT5Service.Overview.md</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#layer-3-mt5sugar","title":"Layer 3: MT5Sugar","text":"<p>What: High-level convenience API with ~50 smart methods.</p> <p>When to use: - Most trading scenarios (95% of cases) - Want auto-normalization - Need risk management helpers - Building strategies quickly</p> <p>Characteristics: - Auto-normalization of volumes/prices - Risk-based position sizing - Batch operations - Smart helpers</p> <p>Location: <code>MT5Sugar.cs</code></p> <p>Documentation: MT5Sugar.API_Overview.md</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#learning-path","title":"\ud83c\udf93 Learning Path","text":"<p>Recommended sequence: Start from foundation (MT5Account) \u2192 Build up to convenience layers (MT5Service \u2192 MT5Sugar)</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#step-1-master-the-foundation-mt5account","title":"Step 1: Master the Foundation (MT5Account)","text":"<p>Why first: MT5Account is the foundation - everything else is built on top of it. Understanding the protocol level gives you complete control.</p> <pre><code>1. Read: This documentation folder (docs/MT5Account/)\n2. Study: Proto definitions and gRPC communication\n3. Understand: Request/Response patterns\n4. Learn: Return codes and error handling\n5. Practice: Low-level method calls\n</code></pre> <p>Goal: Deep understanding of MT5 protocol and terminal communication.</p> <p>Documentation: MT5Account.Master.Overview.md (you are here!)</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#step-2-understand-wrappers-mt5service","title":"Step 2: Understand Wrappers (MT5Service)","text":"<p>Why second: Once you know the foundation, see how MT5Service simplifies it by wrapping proto objects.</p> <pre><code>1. Study: How MT5Service wraps MT5Account methods\n2. Compare: Wrapper vs low-level implementations\n3. Learn: Type conversions (proto \u2192 C# primitives)\n4. Practice: Simplified method calls without proto objects\n</code></pre> <p>Goal: Learn to build clean API wrappers on top of complex protocols.</p> <p>Documentation: MT5Service.Overview.md</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#step-3-use-convenience-layer-mt5sugar","title":"Step 3: Use Convenience Layer (MT5Sugar)","text":"<p>Why last: With foundation + wrappers understood, appreciate how MT5Sugar adds auto-normalization and smart helpers.</p> <pre><code>1. Study: MT5Sugar convenience methods (~50 methods)\n2. Learn: Auto-normalization, risk management, batch operations\n3. Use: High-level methods for rapid strategy development\n4. Build: Trading strategies using Sugar API\n</code></pre> <p>Goal: Rapid strategy development with production-ready convenience methods.</p> <p>Documentation: MT5Sugar.API_Overview.md</p> <p>Summary: MT5Account (foundation) \u2192 MT5Service (wrappers) \u2192 MT5Sugar (convenience)</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#key-concepts","title":"\ud83d\udca1 Key Concepts","text":""},{"location":"MT5Account/MT5Account.Master.Overview/#proto-return-codes","title":"Proto Return Codes","text":"<ul> <li>10009 = Success / DONE</li> <li>10004 = Requote</li> <li>10006 = Request rejected</li> <li>10013 = Invalid request</li> <li>10014 = Invalid volume</li> <li>10015 = Invalid price</li> <li>10016 = Invalid stops</li> <li>10018 = Market closed</li> <li>10019 = Not enough money</li> <li>10031 = No connection with trade server</li> </ul> <p>Always check <code>ReturnedCode</code> field in trading operations.</p> <p>Complete Reference: ReturnCodes_Reference_EN.md</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#c-async-patterns","title":"C# Async Patterns","text":"<p>Request/Reply methods: <pre><code>var result = await account.MethodAsync(parameters, deadline, cancellationToken);\n</code></pre></p> <p>Streaming methods: <pre><code>await foreach (var data in account.OnMethodAsync(parameters, cancellationToken))\n{\n    // Process streaming data\n}\n</code></pre></p> <p>Detailed Guide: Sync_vs_Async.md - When to use async vs sync, performance comparisons, best practices</p>"},{"location":"MT5Account/MT5Account.Master.Overview/#important-notes","title":"\u26a0\ufe0f Important Notes","text":"<ul> <li>Demo account first: Always test on demo before live trading.</li> <li>Check return codes: Every trading operation returns status code.</li> <li>Validate parameters: Use <code>OrderCheckAsync()</code> before <code>OrderSendAsync()</code>.</li> <li>Handle errors: Network/protocol errors can occur.</li> <li>Thread safety: Streams execute on background threads.</li> <li>Resource cleanup: Unsubscribe from streams when done (use CancellationToken).</li> <li>UTC timestamps: All times are in UTC, not local time.</li> <li>Broker limitations: Not all brokers support all features (DOM, hedging, etc.).</li> <li>Async/await: Always use <code>await</code> with async methods.</li> <li>CancellationToken: Always provide cancellation tokens for long-running operations.</li> </ul>"},{"location":"MT5Account/MT5Account.Master.Overview/#best-practices","title":"\ud83d\udccb Best Practices","text":""},{"location":"MT5Account/MT5Account.Master.Overview/#error-handling","title":"Error Handling","text":"<pre><code>try\n{\n    var result = await account.OrderSendAsync(request);\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine(\"\u2705 Success\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Error: {result.Comment}\");\n    }\n}\ncatch (RpcException ex)\n{\n    Console.WriteLine($\"gRPC Error: {ex.Status}\");\n}\n</code></pre>"},{"location":"MT5Account/MT5Account.Master.Overview/#streaming-with-cancellation","title":"Streaming with Cancellation","text":"<pre><code>var cts = new CancellationTokenSource(TimeSpan.FromMinutes(5));\ntry\n{\n    await foreach (var tick in account.OnSymbolTickAsync(symbols, cts.Token))\n    {\n        // Process tick\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre> <p>\"Trade safe, code clean, and may your async operations always complete successfully.\"</p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/","title":"\u2705 Getting Individual Account Double Properties","text":"<p>Request: single <code>double</code> property from MT5 account. Fetch specific numeric properties like balance, equity, margin, profit, etc.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.AccountInfoDoubleAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountInformation</code></li> <li>Proto definition: <code>AccountInfoDouble</code> (defined in <code>mt5-term-api-account-information.proto</code>)</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountInformation</code></li> <li>Method: <code>AccountInfoDouble(AccountInfoDoubleRequest) \u2192 AccountInfoDoubleReply</code></li> <li>Low\u2011level client (generated): <code>AccountInformation.AccountInfoDouble(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;double&gt; AccountInfoDoubleAsync(\n            AccountInfoDoublePropertyType property,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>AccountInfoDoubleRequest { property_id: AccountInfoDoublePropertyType }</code></p> <p>Reply message:</p> <p><code>AccountInfoDoubleReply { data: AccountInfoDoubleData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>property</code> <code>AccountInfoDoublePropertyType</code> \u2705 Property to retrieve (see enum below) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#output-accountinfodoubledata","title":"\u2b06\ufe0f Output \u2014 <code>AccountInfoDoubleData</code>","text":"Field Type Description <code>RequestedValue</code> <code>double</code> The requested property value <p>The method returns <code>double</code> directly (unwrapped from the proto message).</p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#accountinfodoublepropertytype","title":"<code>AccountInfoDoublePropertyType</code>","text":"Enum Value Value Description MQL5 Docs <code>ACCOUNT_BALANCE</code> 0 Account balance in the deposit currency AccountInfoDouble <code>ACCOUNT_CREDIT</code> 1 Account credit in the deposit currency <code>ACCOUNT_PROFIT</code> 2 Current profit of an account in the deposit currency <code>ACCOUNT_EQUITY</code> 3 Account equity in the deposit currency (Balance + Profit) <code>ACCOUNT_MARGIN</code> 4 Account margin used in the deposit currency <code>ACCOUNT_MARGIN_FREE</code> 5 Free margin of an account in the deposit currency <code>ACCOUNT_MARGIN_LEVEL</code> 6 Account margin level in percents <code>ACCOUNT_MARGIN_SO_CALL</code> 7 Margin call level. Depending on the set ACCOUNT_MARGIN_SO_MODE is expressed in percents or in the deposit currency <code>ACCOUNT_MARGIN_SO_SO</code> 8 Margin stop out level. Depending on the set ACCOUNT_MARGIN_SO_MODE is expressed in percents or in the deposit currency <code>ACCOUNT_MARGIN_INITIAL</code> 9 Initial margin. The amount reserved on an account to cover the margin of all pending orders <code>ACCOUNT_MARGIN_MAINTENANCE</code> 10 Maintenance margin. The minimum equity reserved on an account to cover the minimum amount of all open positions <code>ACCOUNT_ASSETS</code> 11 The current assets of an account <code>ACCOUNT_LIABILITIES</code> 12 The current liabilities on an account <code>ACCOUNT_COMMISSION_BLOCKED</code> 13 The current blocked commission amount on an account"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning one specific <code>double</code> property of the account.</li> <li>Why you need it. When you only need one property (e.g., margin level before placing an order) instead of fetching the full account summary.</li> <li>Performance. Lightweight call \u2014 ideal for frequent checks of specific properties.</li> <li>Alternative. Use <code>AccountSummaryAsync()</code> if you need multiple properties at once.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Check a single account property (margin, equity, profit, etc.) without fetching all account data.</li> <li>Monitor specific properties frequently (e.g., margin level for risk management).</li> <li>Verify free margin before placing trades.</li> <li>Calculate margin requirements dynamically.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Prefer <code>AccountSummaryAsync()</code> if you need multiple properties \u2014 it's more efficient to fetch all data in one call.</li> <li>Use short per\u2011call timeout (3\u20135s) with retries for margin checks before trading operations.</li> <li>All MT5Account methods have built-in protection against transient gRPC errors with automatic reconnection.</li> <li>For UI dashboards displaying multiple properties, use <code>AccountSummaryAsync()</code> instead.</li> <li>The method returns <code>double</code> directly (not wrapped in a proto message) for convenience.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#1-check-margin-level-before-placing-order","title":"1) Check margin level before placing order","text":"<pre><code>// Ensure sufficient margin before trading\nvar marginLevel = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_MARGIN_LEVEL,\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nif (marginLevel &lt; 200.0)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Warning: Low margin level {marginLevel:F2}%\");\n    // Skip trading or reduce position size\n}\nelse\n{\n    Console.WriteLine($\"\u2705 Margin level OK: {marginLevel:F2}%\");\n}\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#2-get-current-profit","title":"2) Get current profit","text":"<pre><code>// Monitor floating profit/loss\nvar profit = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_PROFIT);\nConsole.WriteLine($\"Current P/L: {profit:F2}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#3-check-free-margin","title":"3) Check free margin","text":"<pre><code>// Verify free margin before opening position\nvar freeMargin = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_MARGIN_FREE);\n\nConsole.WriteLine($\"Free margin: {freeMargin:F2}\");\n\nif (freeMargin &lt; 100.0)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Insufficient free margin\");\n}\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#4-monitor-margin-usage","title":"4) Monitor margin usage","text":"<pre><code>// Fetch margin-related properties\nvar margin = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_MARGIN);\nvar marginFree = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_MARGIN_FREE);\nvar marginLevel = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_MARGIN_LEVEL);\n\nConsole.WriteLine($\"Margin:       {margin:F2}\");\nConsole.WriteLine($\"Free:         {marginFree:F2}\");\nConsole.WriteLine($\"Level:        {marginLevel:F2}%\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoDouble/#5-compare-equity-vs-balance","title":"5) Compare equity vs balance","text":"<pre><code>// Calculate floating P/L by comparing equity and balance\nvar balance = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_BALANCE);\nvar equity = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_EQUITY);\n\nvar floatingPL = equity - balance;\nConsole.WriteLine($\"Balance:      {balance:F2}\");\nConsole.WriteLine($\"Equity:       {equity:F2}\");\nConsole.WriteLine($\"Floating P/L: {floatingPL:F2}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/","title":"\u2705 Getting Individual Account Integer Properties","text":"<p>Request: single <code>long</code> property from MT5 account. Fetch specific integer properties like login, leverage, trade mode, limits, etc.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.AccountInfoIntegerAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountInformation</code></li> <li>Proto definition: <code>AccountInfoInteger</code> (defined in <code>mt5-term-api-account-information.proto</code>)</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountInformation</code></li> <li>Method: <code>AccountInfoInteger(AccountInfoIntegerRequest) \u2192 AccountInfoIntegerReply</code></li> <li>Low\u2011level client (generated): <code>AccountInformation.AccountInfoInteger(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;long&gt; AccountInfoIntegerAsync(\n            AccountInfoIntegerPropertyType property,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>AccountInfoIntegerRequest { property_id: AccountInfoIntegerPropertyType }</code></p> <p>Reply message:</p> <p><code>AccountInfoIntegerReply { data: AccountInfoIntegerData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>property</code> <code>AccountInfoIntegerPropertyType</code> \u2705 Property to retrieve (see enum below) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#output-accountinfointegerdata","title":"\u2b06\ufe0f Output \u2014 <code>AccountInfoIntegerData</code>","text":"Field Type Description <code>RequestedValue</code> <code>long</code> The requested property value <p>The method returns <code>long</code> directly (unwrapped from the proto message).</p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#accountinfointegerpropertytype","title":"<code>AccountInfoIntegerPropertyType</code>","text":"Enum Value Value Description MQL5 Docs <code>ACCOUNT_LOGIN</code> 0 Account number AccountInfoInteger <code>ACCOUNT_TRADE_MODE</code> 1 Account trade mode (Demo/Contest/Real) \u2014 see <code>MrpcEnumAccountTradeMode</code> <code>ACCOUNT_LEVERAGE</code> 2 Account leverage (e.g., <code>100</code> for 1:100) <code>ACCOUNT_LIMIT_ORDERS</code> 3 Maximum allowed number of open positions and active pending orders (in total). <code>0</code> = unlimited <code>ACCOUNT_MARGIN_SO_MODE</code> 4 Mode for setting the minimal allowed margin \u2014 see <code>EnumAccountStopOutMode</code> (not yet documented) <code>ACCOUNT_TRADE_ALLOWED</code> 5 Allowed trade for the current account (returns 1 or 0) <code>ACCOUNT_TRADE_EXPERT</code> 6 Allowed trade for an Expert Advisor (returns 1 or 0) <code>ACCOUNT_MARGIN_MODE</code> 7 Margin calculation mode \u2014 see <code>EnumAccountMarginMode</code> (not yet documented) <code>ACCOUNT_CURRENCY_DIGITS</code> 8 The number of decimal places in the account currency, which are required for an accurate display of trading results <code>ACCOUNT_FIFO_CLOSE</code> 9 An indication showing that positions can only be closed by FIFO rule. If the property value is set to true, then each symbol positions will be closed in the same order, in which they are opened, starting with the oldest one. In case of an attempt to close positions in a different order, the trader will receive an appropriate error (returns 1 or 0) <code>ACCOUNT_HEDGE_ALLOWED</code> 10 Allowed opposite positions on a single symbol (hedging) - returns 1 or 0"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#related-enums-referenced-above","title":"Related Enums (referenced above)","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#mrpcenumaccounttrademode","title":"<code>MrpcEnumAccountTradeMode</code>","text":"<ul> <li><code>MRPC_ACCOUNT_TRADE_MODE_DEMO = 0</code> \u2014 demo/practice</li> <li><code>MRPC_ACCOUNT_TRADE_MODE_CONTEST = 1</code> \u2014 contest</li> <li><code>MRPC_ACCOUNT_TRADE_MODE_REAL = 2</code> \u2014 real trading</li> </ul> <p>See AccountSummary.md for full details.</p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning one specific <code>long</code> property of the account.</li> <li>Why you need it. When you only need one integer property (e.g., leverage, login, trade mode) instead of fetching the full account summary.</li> <li>Performance. Lightweight call \u2014 ideal for quick checks of specific properties.</li> <li>Type note. All properties return <code>long</code> (int64), even boolean flags (1 = true, 0 = false).</li> <li>Alternative. Use <code>AccountSummaryAsync()</code> if you need multiple properties at once.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Check a single integer account property without fetching all account data.</li> <li>Verify account leverage before calculating position sizes.</li> <li>Check if trading is allowed (<code>ACCOUNT_TRADE_ALLOWED</code>, <code>ACCOUNT_TRADE_EXPERT</code>).</li> <li>Determine account trade mode (demo/contest/real).</li> <li>Check position limits (<code>ACCOUNT_LIMIT_ORDERS</code>).</li> <li>Verify FIFO close rules or hedging permissions.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Prefer <code>AccountSummaryAsync()</code> if you need multiple properties \u2014 it's more efficient to fetch all data in one call.</li> <li>Boolean properties return <code>1</code> (true) or <code>0</code> (false) as <code>long</code> values.</li> <li>Use short per\u2011call timeout (3\u20135s) with retries when checking permissions before trading operations.</li> <li>All MT5Account methods have built-in protection against transient gRPC errors with automatic reconnection.</li> <li>The method returns <code>long</code> directly (not wrapped in a proto message) for convenience.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#1-get-account-login","title":"1) Get account login","text":"<pre><code>// Retrieve account login number\nvar login = await acct.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.ACCOUNT_LOGIN,\n    deadline: DateTime.UtcNow.AddSeconds(3));\nConsole.WriteLine($\"Account login: {login}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#2-check-account-leverage","title":"2) Check account leverage","text":"<pre><code>// Get current leverage setting\nvar leverage = await acct.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.ACCOUNT_LEVERAGE);\nConsole.WriteLine($\"Account leverage: 1:{leverage}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#3-verify-trading-is-allowed","title":"3) Verify trading is allowed","text":"<pre><code>// Check if trading is enabled for this account\nvar tradeAllowed = await acct.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.ACCOUNT_TRADE_ALLOWED);\n\nif (tradeAllowed == 0)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Trading is disabled for this account\");\n    return;\n}\n\n// Check if EA trading is allowed\nvar expertAllowed = await acct.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.ACCOUNT_TRADE_EXPERT);\n\nif (expertAllowed == 0)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Expert Advisor trading is disabled\");\n}\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#4-get-account-trade-mode","title":"4) Get account trade mode","text":"<pre><code>// Determine if account is demo, contest, or real\nvar tradeMode = await acct.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.ACCOUNT_TRADE_MODE);\n\nvar modeLabel = tradeMode switch\n{\n    0 =&gt; \"Demo\",\n    1 =&gt; \"Contest\",\n    2 =&gt; \"Real\",\n    _ =&gt; \"Unknown\"\n};\n\nConsole.WriteLine($\"Account mode: {modeLabel}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoInteger/#5-check-position-limits","title":"5) Check position limits","text":"<pre><code>// Get maximum allowed positions + pending orders\nvar limitOrders = await acct.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.ACCOUNT_LIMIT_ORDERS);\n\nif (limitOrders == 0)\n{\n    Console.WriteLine(\"\u2705 No position limits\");\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f Max positions + pending orders: {limitOrders}\");\n}\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/","title":"\u2705 Getting Individual Account String Properties","text":"<p>Request: single <code>string</code> property from MT5 account. Fetch specific text properties like currency, company name, account name, server name.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.AccountInfoStringAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountInformation</code></li> <li>Proto definition: <code>AccountInfoString</code> (defined in <code>mt5-term-api-account-information.proto</code>)</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountInformation</code></li> <li>Method: <code>AccountInfoString(AccountInfoStringRequest) \u2192 AccountInfoStringReply</code></li> <li>Low\u2011level client (generated): <code>AccountInformation.AccountInfoString(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;string&gt; AccountInfoStringAsync(\n            AccountInfoStringPropertyType property,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>AccountInfoStringRequest { property_id: AccountInfoStringPropertyType }</code></p> <p>Reply message:</p> <p><code>AccountInfoStringReply { data: AccountInfoStringData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>property</code> <code>AccountInfoStringPropertyType</code> \u2705 Property to retrieve (see enum below) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#output-accountinfostringdata","title":"\u2b06\ufe0f Output \u2014 <code>AccountInfoStringData</code>","text":"Field Type Description <code>RequestedValue</code> <code>string</code> The requested property value <p>The method returns <code>string</code> directly (unwrapped from the proto message).</p>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#accountinfostringpropertytype","title":"<code>AccountInfoStringPropertyType</code>","text":"Enum Value Value Description MQL5 Docs <code>ACCOUNT_NAME</code> 0 Client name AccountInfoString <code>ACCOUNT_SERVER</code> 1 Trade server name <code>ACCOUNT_CURRENCY</code> 2 Account currency (e.g., <code>USD</code>, <code>EUR</code>) <code>ACCOUNT_COMPANY</code> 3 Name of a company that serves the account"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning one specific <code>string</code> property of the account.</li> <li>Why you need it. When you only need one text property (e.g., currency for display, company name for logging) instead of fetching the full account summary.</li> <li>Performance. Lightweight call \u2014 ideal for quick checks of specific properties.</li> <li>Alternative. Use <code>AccountSummaryAsync()</code> if you need multiple properties at once (more efficient).</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Get the account currency for display or calculations.</li> <li>Retrieve the broker/company name for logging or verification.</li> <li>Fetch the client name for personalized UI.</li> <li>Get the server name for diagnostics or multi-account management.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Prefer <code>AccountSummaryAsync()</code> if you need multiple properties \u2014 it's more efficient to fetch all data in one call.</li> <li>The currency property (<code>ACCOUNT_CURRENCY</code>) is commonly used for displaying balances with proper formatting.</li> <li>Use short per\u2011call timeout (3\u20135s) with retries when fetching properties for UI display.</li> <li>All MT5Account methods have built-in protection against transient gRPC errors with automatic reconnection.</li> <li>The method returns <code>string</code> directly (not wrapped in a proto message) for convenience.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#1-get-account-currency","title":"1) Get account currency","text":"<pre><code>// Retrieve deposit currency\nvar currency = await acct.AccountInfoStringAsync(\n    AccountInfoStringPropertyType.ACCOUNT_CURRENCY,\n    deadline: DateTime.UtcNow.AddSeconds(3));\nConsole.WriteLine($\"Account currency: {currency}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#2-get-broker-company-name","title":"2) Get broker company name","text":"<pre><code>// Fetch broker/company name\nvar company = await acct.AccountInfoStringAsync(\n    AccountInfoStringPropertyType.ACCOUNT_COMPANY);\nConsole.WriteLine($\"Broker: {company}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#3-get-client-name","title":"3) Get client name","text":"<pre><code>// Retrieve account holder name\nvar name = await acct.AccountInfoStringAsync(\n    AccountInfoStringPropertyType.ACCOUNT_NAME);\nConsole.WriteLine($\"Account holder: {name}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#4-get-server-name","title":"4) Get server name","text":"<pre><code>// Retrieve trade server name for diagnostics\nvar server = await acct.AccountInfoStringAsync(\n    AccountInfoStringPropertyType.ACCOUNT_SERVER);\nConsole.WriteLine($\"Connected to server: {server}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountInfoString/#5-display-balance-with-currency","title":"5) Display balance with currency","text":"<pre><code>// Combine with AccountInfoDouble for formatted output\nvar balance = await acct.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.ACCOUNT_BALANCE);\nvar currency = await acct.AccountInfoStringAsync(\n    AccountInfoStringPropertyType.ACCOUNT_CURRENCY);\n\nConsole.WriteLine($\"Balance: {balance:F2} {currency}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/","title":"\u2705 Getting an Account Summary","text":"<p>Request: full account summary (<code>AccountSummaryData</code>) from MT5. Fetch all core account metrics in a single call.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.AccountSummaryAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>AccountSummary</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>AccountSummary(AccountSummaryRequest) \u2192 AccountSummaryReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.AccountSummaryAsync(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;AccountSummaryData&gt; AccountSummaryAsync(\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>AccountSummaryRequest {}</code></p> <p>Reply message:</p> <p><code>AccountSummaryReply { data: AccountSummaryData }</code></p>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#input","title":"\ud83d\udd3d Input","text":"<p>No required parameters.</p> Parameter Type Description <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#output-accountsummarydata","title":"\u2b06\ufe0f Output \u2014 <code>AccountSummaryData</code>","text":"Field Type Description <code>AccountLogin</code> <code>long</code> Trading account login (ID). <code>AccountBalance</code> <code>double</code> Balance excluding floating P/L. <code>AccountEquity</code> <code>double</code> Equity = balance + floating P/L. <code>AccountLeverage</code> <code>long</code> Leverage (e.g., <code>100</code> for 1:100). <code>AccountTradeMode</code> <code>int (enum)</code> See <code>MrpcEnumAccountTradeMode</code> below. <code>AccountCurrency</code> <code>string</code> Deposit currency (e.g., <code>USD</code>). <code>AccountCompanyName</code> <code>string</code> Broker/company display name. <code>AccountUserName</code> <code>string</code> Account holder name. <code>ServerTime</code> <code>Timestamp</code> Server time (UTC) at response. <code>UtcTimezoneServerTimeShiftMinutes</code> <code>long</code> Server offset relative to UTC (minutes). <code>AccountCredit</code> <code>double</code> Credit amount."},{"location":"MT5Account/1.%20Account_information/AccountSummary/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/1.%20Account_information/AccountSummary/#mrpcenumaccounttrademode","title":"<code>MrpcEnumAccountTradeMode</code>","text":"<ul> <li><code>MRPC_ACCOUNT_TRADE_MODE_DEMO = 0</code> \u2014 demo/practice</li> <li><code>MRPC_ACCOUNT_TRADE_MODE_CONTEST = 1</code> \u2014 contest</li> <li><code>MRPC_ACCOUNT_TRADE_MODE_REAL = 2</code> \u2014 real trading</li> </ul> <p>Map enum \u2192 label in UI via your helper, e.g. a <code>switch</code> or generated <code>Name(value)</code>.</p>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning account state: balance, equity, currency, leverage, trade mode, server time.</li> <li>Why you need it. Fast dashboard/CLI status; double\u2011check login/currency/leverage; heartbeat via <code>ServerTimeUtc</code>.</li> <li>Sanity check. If you see <code>AccountLogin</code>, <code>AccountCurrency</code>, <code>AccountLeverage</code>, <code>AccountEquity</code> \u2192 connection is alive.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to display real\u2011time account state and sanity\u2011check connectivity:</p> <ul> <li>Dashboard/CLI status in one call.</li> <li>Verify free\u2011margin &amp; equity before trading.</li> <li>Terminal heartbeat via <code>ServerTimeUtc</code> and <code>UtcServerTimeShiftMinutes</code>.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Prefer a short per\u2011call timeout (3\u20135s) with retries when the terminal is warming up/syncing.</li> <li>All MT5Account methods have built-in protection against transient gRPC errors with automatic reconnection.</li> <li>Convert enum codes to labels as close to UI as possible.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/1.%20Account_information/AccountSummary/#1-percall-deadline","title":"1) Per\u2011call deadline","text":"<pre><code>// Enforce a short absolute UTC deadline to avoid hanging calls\nvar summary = await acct.AccountSummaryAsync(\n    deadline: DateTime.UtcNow.AddSeconds(3));\nConsole.WriteLine($\"[deadline] Equity={summary.AccountEquity:F2}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#2-cooperative-cancellation-with-cancellationtoken","title":"2) Cooperative cancellation (with CancellationToken)","text":"<pre><code>// Allow a graceful stop from another task\nusing var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(3));\nvar s2 = await acct.AccountSummaryAsync(\n    deadline: DateTime.UtcNow.AddSeconds(3),\n    cancellationToken: cts.Token);\nConsole.WriteLine($\"[cancel] Currency={s2.AccountCurrency}\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#3-compact-status-line-for-uicli","title":"3) Compact status line for UI/CLI","text":"<pre><code>var s = await acct.AccountSummaryAsync();\nvar status = $\"Acc {s.AccountLogin} | {s.AccountCurrency} | \" +\n             $\"Bal {s.AccountBalance:F2} | Eq {s.AccountEquity:F2} | \" +\n             $\"Lev {s.AccountLeverage} | Mode {s.AccountTradeMode}\";\nConsole.WriteLine(status);\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#4-humanreadable-server-time-with-timezone-shift","title":"4) Human\u2011readable server time with timezone shift","text":"<pre><code>var x = await acct.AccountSummaryAsync();\nvar serverUtc = x.ServerTime.ToDateTime(); // generated Timestamp \u2192 DateTime\nvar shift = TimeSpan.FromMinutes(x.UtcTimezoneServerTimeShiftMinutes);\nvar serverLocal = serverUtc + shift;\nConsole.WriteLine($\"Server time: {serverLocal:O} (shift {shift})\");\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/AccountSummary/#5-map-proto-thin-viewmodel","title":"5) Map proto \u2192 thin view\u2011model","text":"<pre><code>// Keep only what UI needs; fast and test\u2011friendly\npublic record AccountSummaryView(\n    long Login,\n    string Currency,\n    double Balance,\n    double Equity,\n    long Leverage,\n    int Mode)\n{\n    public static AccountSummaryView FromProto(AccountSummaryData p) =&gt;\n        new(\n            Login: p.AccountLogin,\n            Currency: p.AccountCurrency,\n            Balance: p.AccountBalance,\n            Equity: p.AccountEquity,\n            Leverage: p.AccountLeverage,\n            Mode: p.AccountTradeMode\n        );\n}\n\nvar proto = await acct.AccountSummaryAsync();\nvar view = AccountSummaryView.FromProto(proto);\nConsole.WriteLine(view);\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/","title":"MT5Account \u00b7 Account Information - Overview","text":"<p>Account balance, equity, margin, leverage, currency, and other account properties. Use this page to choose the right API for accessing account state.</p>"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>AccountSummary - all account info at once (balance, equity, margin, leverage, profit, etc.).</li> <li>AccountInfoDouble - single double value from account (balance, equity, margin, profit, credit, etc.).</li> <li>AccountInfoInteger - single integer value from account (login, leverage, limit orders, etc.).</li> <li>AccountInfoString - single string value from account (name, server, currency, company).</li> </ul>"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>AccountSummary \u2192 the one-stop shop for complete account snapshot (balance, equity, margin level, etc.).</li> <li>AccountInfoDouble \u2192 grab one numeric property when you need just balance or margin.</li> <li>AccountInfoInteger \u2192 grab one integer property like login number or leverage.</li> <li>AccountInfoString \u2192 grab one text property like account name or currency.</li> </ul> <p>Rule of thumb: need full snapshot \u2192 <code>AccountSummaryAsync</code>; need one specific value \u2192 <code>AccountInfo*Async</code> (Double/Integer/String).</p>"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns Key inputs Complete account snapshot (all values) <code>AccountSummaryAsync</code> Full account data object (none) One numeric value (balance, equity, margin, etc.) <code>AccountInfoDoubleAsync</code> Single <code>double</code> Property enum (BALANCE, EQUITY, etc.) One integer value (login, leverage, etc.) <code>AccountInfoIntegerAsync</code> Single <code>long</code> Property enum (LOGIN, LEVERAGE, etc.) One text value (name, currency, server, etc.) <code>AccountInfoStringAsync</code> Single <code>string</code> Property enum (NAME, CURRENCY, etc.)"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>Margin Level = (Equity / Margin) \u00d7 100 - watch for stop-out level.</li> <li>Free Margin = Equity - Margin - available for new positions.</li> <li>AccountSummary includes everything; use it for dashboards.</li> <li>AccountInfo* methods are lighter if you only need one property.</li> <li>Currency affects how profits are calculated - always check account currency.</li> <li>Leverage determines margin requirements - higher leverage = less margin needed.</li> </ul>"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Get complete account snapshot\nvar summary = await account.AccountSummaryAsync();\nConsole.WriteLine($\"Balance: ${summary.AccountBalance:F2}, Equity: ${summary.AccountEquity:F2}, Leverage: 1:{summary.AccountLeverage}\");\n</code></pre> <pre><code>// Get single property - account balance\nvar balance = await account.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.AccountBalance\n);\nConsole.WriteLine($\"Balance: ${balance:F2}\");\n</code></pre> <pre><code>// Get account leverage\nvar leverage = await account.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.AccountLeverage\n);\nConsole.WriteLine($\"Leverage: 1:{leverage}\");\n</code></pre> <pre><code>// Get account currency\nvar currency = await account.AccountInfoStringAsync(\n    AccountInfoStringPropertyType.AccountCurrency\n);\nConsole.WriteLine($\"Currency: {currency}\");\n</code></pre> <pre><code>// Check account balance and equity\nvar summary = await account.AccountSummaryAsync();\nvar balance = summary.AccountBalance;\nvar equity = summary.AccountEquity;\nif (equity &lt; balance * 0.8)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Warning: Equity below 80% of balance!\");\n}\n</code></pre>"},{"location":"MT5Account/1.%20Account_information/Account_Information.Overview/#see-also","title":"See also","text":"<ul> <li>Streaming: SubscribeToPositionProfit - real-time equity/profit updates</li> <li>Trading calculations: OrderCalcMargin - calculate required margin before trading</li> <li>Positions: PositionsTotal - count open positions</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/","title":"\u2705 Checking if Symbol Exists","text":"<p>Request: check symbol existence from MT5. Verify if a symbol with a specified name exists (standard or custom).</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolExistAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolExist</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolExist(SymbolExistRequest) \u2192 SymbolExistReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolExist(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolExistData&gt; SymbolExistAsync(\n            string symbolName,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolExistRequest { name: string }</code></p> <p>Reply message:</p> <p><code>SymbolExistReply { data: SymbolExistData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name to check (e.g., <code>\"EURUSD\"</code>, <code>\"BTCUSD\"</code>) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#output-symbolexistdata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolExistData</code>","text":"Field Type Description <code>Exists</code> <code>bool</code> <code>true</code> if symbol exists (standard or custom), <code>false</code> if not found <code>IsCustom</code> <code>bool</code> <code>true</code> if the detected symbol is a custom symbol, <code>false</code> for standard symbols (see MQL5 Custom Symbols)"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC checking if a symbol exists and whether it's custom.</li> <li>Why you need it. Validate symbol names before trading, check if broker supports a symbol, detect custom symbols.</li> <li>Two flags. <code>Exists</code> tells if found, <code>IsCustom</code> tells if it's a custom (synthetic) symbol.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Verify a symbol name before attempting to trade or get quotes.</li> <li>Check if your broker supports a specific symbol.</li> <li>Detect whether a symbol is standard or custom/synthetic.</li> <li>Validate user input (symbol names) in your trading application.</li> <li>Handle different symbols gracefully (fail early if symbol doesn't exist).</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Symbol names are case-sensitive in some brokers (use exact spelling: <code>\"EURUSD\"</code> not <code>\"eurusd\"</code>).</li> <li>If <code>Exists=false</code>, the symbol is not available from your broker.</li> <li>If <code>Exists=true</code> and <code>IsCustom=true</code>, the symbol is synthetic/custom - may have different trading rules.</li> <li>Use this before <code>SymbolSelectAsync()</code> to avoid errors when adding symbols to Market Watch.</li> <li>Fast operation - use short timeout (3-5s).</li> <li>Standard symbols: forex pairs, stocks, indices, commodities from broker.</li> <li>Custom symbols: user-created synthetic instruments, spreads, custom data feeds.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#1-check-if-symbol-exists","title":"1) Check if symbol exists","text":"<pre><code>// Verify EURUSD is available\nvar result = await acc.SymbolExistAsync(\n    \"EURUSD\",\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nif (result.Exists)\n{\n    Console.WriteLine(\"\u2705 EURUSD exists\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c EURUSD not found\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#2-detect-custom-symbols","title":"2) Detect custom symbols","text":"<pre><code>// Check if symbol is custom/synthetic\nvar btc = await acc.SymbolExistAsync(\"BTCUSD\");\n\nConsole.WriteLine($\"Exists:   {btc.Exists}\");\nConsole.WriteLine($\"Custom:   {btc.IsCustom}\");\n\nif (btc.Exists &amp;&amp; btc.IsCustom)\n{\n    Console.WriteLine(\"\u26a0\ufe0f This is a custom/synthetic symbol\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#3-validate-user-input","title":"3) Validate user input","text":"<pre><code>// Validate symbol before trading\nstring userSymbol = \"GBPJPY\"; // from user input\n\nvar check = await acc.SymbolExistAsync(userSymbol);\n\nif (!check.Exists)\n{\n    Console.WriteLine($\"\u274c Error: Symbol '{userSymbol}' not available\");\n    return;\n}\n\nConsole.WriteLine($\"\u2705 Symbol '{userSymbol}' is valid\");\n// Continue with trading logic...\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#4-check-multiple-symbols","title":"4) Check multiple symbols","text":"<pre><code>// Verify a list of symbols\nvar symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\nConsole.WriteLine(\"Checking symbols:\");\nforeach (var sym in symbols)\n{\n    var result = await acc.SymbolExistAsync(sym);\n    var status = result.Exists ? \"\u2705\" : \"\u274c\";\n    var type = result.IsCustom ? \"(custom)\" : \"(standard)\";\n    Console.WriteLine($\"  {status} {sym,-10} {(result.Exists ? type : \"\")}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolExist/#5-safe-symbol-selection","title":"5) Safe symbol selection","text":"<pre><code>// Check existence before adding to Market Watch\nvar symbolName = \"EURUSD\";\nvar exists = await acc.SymbolExistAsync(symbolName);\n\nif (!exists.Exists)\n{\n    Console.WriteLine($\"\u274c Cannot add '{symbolName}': symbol doesn't exist\");\n    return;\n}\n\n// Symbol exists - safe to add to Market Watch\nvar selected = await acc.SymbolSelectAsync(symbolName, select: true);\nConsole.WriteLine($\"\u2705 '{symbolName}' added to Market Watch\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/","title":"\u2705 Getting Symbol Double Properties","text":"<p>Request: double (numeric) property of a symbol from MT5. Get prices, volumes, swaps, margins, and other numeric symbol parameters.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoDoubleAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoDouble</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoDouble(SymbolInfoDoubleRequest) \u2192 SymbolInfoDoubleReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolInfoDouble(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolInfoDoubleData&gt; SymbolInfoDoubleAsync(\n            string symbolName,\n            SymbolInfoDoubleProperty propertyType,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoDoubleRequest { symbol: string, type: SymbolInfoDoubleProperty }</code></p> <p>Reply message:</p> <p><code>SymbolInfoDoubleReply { data: SymbolInfoDoubleData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name (e.g., <code>\"EURUSD\"</code>) <code>propertyType</code> <code>SymbolInfoDoubleProperty</code> \u2705 Property to retrieve (see enum below) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#output-symbolinfodoubledata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolInfoDoubleData</code>","text":"Field Type Description <code>Value</code> <code>double</code> The requested property value"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#symbolinfodoubleproperty-grouped-by-category","title":"<code>SymbolInfoDoubleProperty</code> - Grouped by Category","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#current-prices-bidask","title":"Current Prices (Bid/Ask)","text":"Enum Value Value Description <code>SYMBOL_BID</code> 0 Bid - best sell offer <code>SYMBOL_BIDHIGH</code> 1 Maximal Bid of the day <code>SYMBOL_BIDLOW</code> 2 Minimal Bid of the day <code>SYMBOL_ASK</code> 3 Ask - best buy offer <code>SYMBOL_ASKHIGH</code> 4 Maximal Ask of the day <code>SYMBOL_ASKLOW</code> 5 Minimal Ask of the day"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#last-price-volume","title":"Last Price &amp; Volume","text":"Enum Value Value Description <code>SYMBOL_LAST</code> 6 Price of the last deal <code>SYMBOL_LASTHIGH</code> 7 Maximal Last of the day <code>SYMBOL_LASTLOW</code> 8 Minimal Last of the day <code>SYMBOL_VOLUME_REAL</code> 9 Volume of the last deal <code>SYMBOL_VOLUMEHIGH_REAL</code> 10 Maximum Volume of the day <code>SYMBOL_VOLUMELOW_REAL</code> 11 Minimum Volume of the day"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#trading-parameters","title":"Trading Parameters","text":"Enum Value Value Description <code>SYMBOL_POINT</code> 13 Symbol point value (minimum price change) <code>SYMBOL_TRADE_TICK_SIZE</code> 17 Minimal price change (tick size) <code>SYMBOL_TRADE_CONTRACT_SIZE</code> 18 Trade contract size (lot size in base currency units) <code>SYMBOL_VOLUME_MIN</code> 22 Minimal volume for a deal <code>SYMBOL_VOLUME_MAX</code> 23 Maximal volume for a deal <code>SYMBOL_VOLUME_STEP</code> 24 Minimal volume change step for deal execution <code>SYMBOL_VOLUME_LIMIT</code> 25 Maximum allowed aggregate volume in one direction"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#tick-values","title":"Tick Values","text":"Enum Value Value Description <code>SYMBOL_TRADE_TICK_VALUE</code> 14 Value of SYMBOL_TRADE_TICK_VALUE_PROFIT <code>SYMBOL_TRADE_TICK_VALUE_PROFIT</code> 15 Calculated tick price for a profitable position <code>SYMBOL_TRADE_TICK_VALUE_LOSS</code> 16 Calculated tick price for a losing position"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#swap-values","title":"Swap Values","text":"Enum Value Value Description <code>SYMBOL_SWAP_LONG</code> 26 Long swap value <code>SYMBOL_SWAP_SHORT</code> 27 Short swap value <code>SYMBOL_SWAP_SUNDAY</code> 28 Swap ratio for positions rolled over from Sunday (0, 1, or 3) <code>SYMBOL_SWAP_MONDAY</code> 29 Swap ratio for Monday \u2192 Tuesday <code>SYMBOL_SWAP_TUESDAY</code> 30 Swap ratio for Tuesday \u2192 Wednesday <code>SYMBOL_SWAP_WEDNESDAY</code> 31 Swap ratio for Wednesday \u2192 Thursday <code>SYMBOL_SWAP_THURSDAY</code> 32 Swap ratio for Thursday \u2192 Friday <code>SYMBOL_SWAP_FRIDAY</code> 33 Swap ratio for Friday \u2192 Saturday <code>SYMBOL_SWAP_SATURDAY</code> 34 Swap ratio for Saturday \u2192 Sunday"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#margin-requirements","title":"Margin Requirements","text":"Enum Value Value Description <code>SYMBOL_MARGIN_INITIAL</code> 35 Initial margin for opening a position with 1 lot <code>SYMBOL_MARGIN_MAINTENANCE</code> 36 Maintenance margin for keeping position open <code>SYMBOL_MARGIN_HEDGED</code> 48 Hedged margin (for opposite positions)"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#session-data","title":"Session Data","text":"Enum Value Value Description <code>SYMBOL_SESSION_VOLUME</code> 37 Summary volume of current session deals <code>SYMBOL_SESSION_TURNOVER</code> 38 Summary turnover of the current session <code>SYMBOL_SESSION_INTEREST</code> 39 Summary open interest <code>SYMBOL_SESSION_BUY_ORDERS_VOLUME</code> 40 Current volume of Buy orders <code>SYMBOL_SESSION_SELL_ORDERS_VOLUME</code> 41 Current volume of Sell orders <code>SYMBOL_SESSION_OPEN</code> 42 Open price of the current session <code>SYMBOL_SESSION_CLOSE</code> 43 Close price of the current session <code>SYMBOL_SESSION_AW</code> 44 Average weighted price of current session <code>SYMBOL_SESSION_PRICE_SETTLEMENT</code> 45 Settlement price of the current session <code>SYMBOL_SESSION_PRICE_LIMIT_MIN</code> 46 Minimal price of the current session <code>SYMBOL_SESSION_PRICE_LIMIT_MAX</code> 47 Maximal price of the current session"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#price-statistics","title":"Price Statistics","text":"Enum Value Value Description <code>SYMBOL_PRICE_CHANGE</code> 49 Change relative to previous day end in % <code>SYMBOL_PRICE_VOLATILITY</code> 50 Price volatility in %"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#optionsderivatives","title":"Options/Derivatives","text":"Enum Value Value Description <code>SYMBOL_OPTION_STRIKE</code> 12 Strike price of an option <code>SYMBOL_PRICE_THEORETICAL</code> 51 Theoretical option price <code>SYMBOL_PRICE_DELTA</code> 52 Option delta (price change per 1 unit of underlying) <code>SYMBOL_PRICE_THETA</code> 53 Option theta (time decay per day) <code>SYMBOL_PRICE_GAMMA</code> 54 Option gamma (delta change rate) <code>SYMBOL_PRICE_VEGA</code> 55 Option vega (price change per 1% volatility) <code>SYMBOL_PRICE_RHO</code> 56 Option rho (price change per 1% interest rate) <code>SYMBOL_PRICE_OMEGA</code> 57 Option omega (elasticity) <code>SYMBOL_PRICE_SENSITIVITY</code> 58 Option sensitivity"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#bondsspecial","title":"Bonds/Special","text":"Enum Value Value Description <code>SYMBOL_TRADE_ACCRUED_INTEREST</code> 19 Accrued interest (bonds) <code>SYMBOL_TRADE_FACE_VALUE</code> 20 Face value (bonds) <code>SYMBOL_TRADE_LIQUIDITY_RATE</code> 21 Liquidity rate (asset share for margin)"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#internal","title":"Internal","text":"Enum Value Value Description <code>SYMBOL_COUNT</code> 59 The count of symbol properties <p>MQL5 Reference: SymbolInfoDouble</p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning one numeric property of a symbol.</li> <li>Why you need it. Get current prices, calculate position sizes, check trading constraints, retrieve margin requirements.</li> <li>Most common. <code>SYMBOL_BID</code>, <code>SYMBOL_ASK</code>, <code>SYMBOL_POINT</code>, <code>SYMBOL_VOLUME_MIN/MAX/STEP</code>, <code>SYMBOL_TRADE_CONTRACT_SIZE</code>.</li> <li>60 properties covering prices, volumes, swaps, margins, sessions, options.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Get current Bid/Ask prices (alternative to <code>SymbolInfoTickAsync</code>).</li> <li>Calculate position sizes based on volume constraints.</li> <li>Retrieve tick value for profit calculations.</li> <li>Check swap values before holding overnight positions.</li> <li>Get margin requirements for risk management.</li> <li>Obtain contract size for lot-to-units conversion.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>SYMBOL_BID/ASK - use <code>SymbolInfoTickAsync()</code> for faster Bid/Ask retrieval.</li> <li>SYMBOL_POINT - minimum price change (e.g., 0.00001 for EURUSD).</li> <li>SYMBOL_VOLUME_MIN/MAX/STEP - critical for validating lot sizes before trading.</li> <li>SYMBOL_TRADE_CONTRACT_SIZE - lot size in base currency units (e.g., 100,000 for Forex standard lot).</li> <li>Swap values - charged for positions held overnight (positive = you earn, negative = you pay).</li> <li>Margin requirements - used for calculating required margin before opening positions.</li> <li>Properties are cached - use short timeout (3-5s).</li> <li>Some properties may return 0 if not applicable (e.g., options Greeks for Forex).</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#1-get-bidask-prices","title":"1) Get Bid/Ask prices","text":"<pre><code>// Get current Bid and Ask\nvar bid = await acc.SymbolInfoDoubleAsync(\n    \"EURUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_BID,\n    deadline: DateTime.UtcNow.AddSeconds(3));\nvar ask = await acc.SymbolInfoDoubleAsync(\n    \"EURUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_ASK);\n\nConsole.WriteLine($\"EURUSD Bid: {bid.Value:F5}, Ask: {ask.Value:F5}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#2-get-volume-constraints","title":"2) Get volume constraints","text":"<pre><code>// Retrieve trading volume limits\nvar volumeMin = await acc.SymbolInfoDoubleAsync(\n    \"GBPUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_VOLUME_MIN);\nvar volumeMax = await acc.SymbolInfoDoubleAsync(\n    \"GBPUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_VOLUME_MAX);\nvar volumeStep = await acc.SymbolInfoDoubleAsync(\n    \"GBPUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_VOLUME_STEP);\n\nConsole.WriteLine($\"GBPUSD Volume:\");\nConsole.WriteLine($\"  Min:  {volumeMin.Value:F2} lots\");\nConsole.WriteLine($\"  Max:  {volumeMax.Value:F2} lots\");\nConsole.WriteLine($\"  Step: {volumeStep.Value:F2} lots\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#3-calculate-position-size","title":"3) Calculate position size","text":"<pre><code>// Get parameters for position size calculation\nvar symbol = \"EURUSD\";\n\nvar point = await acc.SymbolInfoDoubleAsync(symbol, SymbolInfoDoubleProperty.SYMBOL_POINT);\nvar contractSize = await acc.SymbolInfoDoubleAsync(symbol, SymbolInfoDoubleProperty.SYMBOL_TRADE_CONTRACT_SIZE);\nvar volumeMin = await acc.SymbolInfoDoubleAsync(symbol, SymbolInfoDoubleProperty.SYMBOL_VOLUME_MIN);\n\nConsole.WriteLine($\"{symbol} Trading Parameters:\");\nConsole.WriteLine($\"  Point:         {point.Value}\");\nConsole.WriteLine($\"  Contract Size: {contractSize.Value:F0}\");\nConsole.WriteLine($\"  Min Volume:    {volumeMin.Value:F2}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#4-check-swap-costs","title":"4) Check swap costs","text":"<pre><code>// Get swap values for overnight positions\nvar swapLong = await acc.SymbolInfoDoubleAsync(\n    \"EURUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_SWAP_LONG);\nvar swapShort = await acc.SymbolInfoDoubleAsync(\n    \"EURUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_SWAP_SHORT);\n\nConsole.WriteLine($\"EURUSD Swap:\");\nConsole.WriteLine($\"  Long:  {swapLong.Value:F2}\");\nConsole.WriteLine($\"  Short: {swapShort.Value:F2}\");\n\nif (swapLong.Value &lt; 0)\n    Console.WriteLine(\"  \u26a0\ufe0f Long positions pay swap\");\nelse\n    Console.WriteLine(\"  \u2705 Long positions earn swap\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoDouble/#5-get-margin-requirements","title":"5) Get margin requirements","text":"<pre><code>// Check margin needed for 1 lot\nvar marginInit = await acc.SymbolInfoDoubleAsync(\n    \"XAUUSD\",\n    SymbolInfoDoubleProperty.SYMBOL_MARGIN_INITIAL);\n\nConsole.WriteLine($\"XAUUSD Initial Margin: {marginInit.Value:F2}\");\nConsole.WriteLine($\"(Required margin for opening 1 lot)\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/","title":"\u2705 Getting Symbol Integer Properties","text":"<p>Request: integer (long) property of a symbol from MT5. Get digits, spread, execution modes, time parameters, and other integer symbol properties.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoIntegerAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoInteger</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoInteger(SymbolInfoIntegerRequest) \u2192 SymbolInfoIntegerReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolInfoInteger(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolInfoIntegerData&gt; SymbolInfoIntegerAsync(\n            string symbolName,\n            SymbolInfoIntegerProperty propertyType,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoIntegerRequest { symbol: string, type: SymbolInfoIntegerProperty }</code></p> <p>Reply message:</p> <p><code>SymbolInfoIntegerReply { data: SymbolInfoIntegerData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name (e.g., <code>\"EURUSD\"</code>) <code>propertyType</code> <code>SymbolInfoIntegerProperty</code> \u2705 Property to retrieve (see enum below) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#output-symbolinfointegerdata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolInfoIntegerData</code>","text":"Field Type Description <code>Value</code> <code>long</code> The requested property value"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#symbolinfointegerproperty","title":"<code>SymbolInfoIntegerProperty</code>","text":"Enum Value Value Description <code>SYMBOL_SUBSCRIPTION_DELAY</code> 0 Symbol data arrives with a delay. Only for symbols in Market Watch (error 4302 for others) <code>SYMBOL_SECTOR</code> 1 The sector of the economy to which the asset belongs (enum value) <code>SYMBOL_INDUSTRY</code> 2 The industry/branch to which the symbol belongs (enum value) <code>SYMBOL_CUSTOM</code> 3 Custom symbol flag: <code>1</code> if synthetic, <code>0</code> if standard <code>SYMBOL_BACKGROUND_COLOR</code> 4 Background color for symbol in Market Watch (color code) <code>SYMBOL_CHART_MODE</code> 5 Price type for generating bars: Bid or Last (enum) <code>SYMBOL_EXIST</code> 6 Symbol with this name exists: <code>1</code> = yes, <code>0</code> = no <code>SYMBOL_SELECT</code> 7 Symbol is selected in Market Watch: <code>1</code> = yes, <code>0</code> = no <code>SYMBOL_VISIBLE</code> 8 Symbol is visible in Market Watch: <code>1</code> = yes, <code>0</code> = no (some cross-rates are selected but not visible) <code>SYMBOL_SESSION_DEALS</code> 9 Number of deals in the current session <code>SYMBOL_SESSION_BUY_ORDERS</code> 10 Number of Buy orders at the moment <code>SYMBOL_SESSION_SELL_ORDERS</code> 11 Number of Sell orders at the moment <code>SYMBOL_VOLUME</code> 12 Volume of the last deal (integer) <code>SYMBOL_VOLUMEHIGH</code> 13 Maximal day volume <code>SYMBOL_VOLUMELOW</code> 14 Minimal day volume <code>SYMBOL_TIME</code> 15 Time of the last quote (Unix timestamp seconds) <code>SYMBOL_TIME_MSC</code> 16 Time of the last quote in milliseconds since 1970.01.01 <code>SYMBOL_DIGITS</code> 17 Digits after a decimal point (e.g., 5 for EURUSD = 1.12345) <code>SYMBOL_SPREAD_FLOAT</code> 18 Indication of a floating spread: <code>1</code> = floating, <code>0</code> = fixed <code>SYMBOL_SPREAD</code> 19 Spread value in points <code>SYMBOL_TICKS_BOOKDEPTH</code> 20 Maximal number of requests in Depth of Market. <code>0</code> if no DOM available. <code>SYMBOL_TRADE_CALC_MODE</code> 21 Contract price calculation mode (enum: Forex, CFD, Futures, etc.) <code>SYMBOL_TRADE_MODE</code> 22 Order execution type (enum: Disabled, LongOnly, ShortOnly, CloseOnly, Full) <code>SYMBOL_START_TIME</code> 23 Date of symbol trade beginning (Unix timestamp) - usually for futures <code>SYMBOL_EXPIRATION_TIME</code> 24 Date of symbol trade end (Unix timestamp) - usually for futures <code>SYMBOL_TRADE_STOPS_LEVEL</code> 25 Minimal distance in points from current price to place Stop orders <code>SYMBOL_TRADE_FREEZE_LEVEL</code> 26 Distance to freeze trade operations in points (can't modify/close orders within this distance) <code>SYMBOL_TRADE_EXEMODE</code> 27 Deal execution mode (enum: Request, Instant, Market, Exchange) <code>SYMBOL_SWAP_MODE</code> 28 Swap calculation model (enum: Disabled, Points, Currency modes, Interest, Reopen) <code>SYMBOL_SWAP_ROLLOVER3DAYS</code> 29 Day of week to charge 3-day swap rollover (enum: SUNDAY=0 ... SATURDAY=6) <code>SYMBOL_MARGIN_HEDGED_USE_LEG</code> 30 Calculating hedging margin using the larger leg (Buy or Sell): <code>1</code> = yes, <code>0</code> = no <code>SYMBOL_EXPIRATION_MODE</code> 31 Flags of allowed order expiration modes (bitmask: GTC, Today, Specified, SpecifiedDay) <code>SYMBOL_FILLING_MODE</code> 32 Flags of allowed order filling modes (bitmask: FOK, IOC, BOC, Return) <code>SYMBOL_ORDER_MODE</code> 33 Flags of allowed order types (bitmask: Market, Limit, Stop, StopLimit, etc.) <code>SYMBOL_ORDER_GTC_MODE</code> 34 Expiration of SL/TP orders if SYMBOL_EXPIRATION_MODE=GTC (enum: GTC, Daily, DailyExcludingStops) <code>SYMBOL_OPTION_MODE</code> 35 Option type (enum: European, American) <code>SYMBOL_OPTION_RIGHT</code> 36 Option right (enum: Call, Put) <p>MQL5 Reference: SymbolInfoInteger</p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning one integer property of a symbol.</li> <li>Why you need it. Check digits, spread, trading restrictions, execution modes, stops level, symbol status.</li> <li>Most common. <code>SYMBOL_DIGITS</code> (precision), <code>SYMBOL_SPREAD</code> (current spread), <code>SYMBOL_TRADE_STOPS_LEVEL</code> (min SL/TP distance).</li> <li>37 properties covering precision, trading modes, status flags, execution parameters.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Get symbol precision (digits) for price formatting.</li> <li>Check current spread in points.</li> <li>Verify minimum stops level before setting SL/TP.</li> <li>Check if symbol is selected/visible in Market Watch.</li> <li>Determine execution mode and trading restrictions.</li> <li>Get freeze level to avoid order modification errors.</li> <li>Check expiration/filling modes supported by symbol.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>SYMBOL_DIGITS - decimal places (5 for EURUSD = 1.12345, 2 for XAUUSD = 1925.42).</li> <li>SYMBOL_SPREAD - current spread in points (not pips!). For EURUSD with 5 digits, 10 points = 1 pip.</li> <li>SYMBOL_TRADE_STOPS_LEVEL - minimum distance from current price for SL/TP. <code>0</code> = no restriction.</li> <li>SYMBOL_TRADE_FREEZE_LEVEL - distance within which you cannot modify/close orders.</li> <li>Boolean flags return <code>1</code> (true) or <code>0</code> (false) as <code>long</code>.</li> <li>Enum properties return integer enum values - need to map to enum types.</li> <li>Bitmask properties (EXPIRATION_MODE, FILLING_MODE, ORDER_MODE) use bitwise flags.</li> <li>Properties are cached - use short timeout (3-5s).</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#1-get-symbol-precision","title":"1) Get symbol precision","text":"<pre><code>// Get number of decimal places\nvar digits = await acc.SymbolInfoIntegerAsync(\n    \"EURUSD\",\n    SymbolInfoIntegerProperty.SYMBOL_DIGITS,\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nConsole.WriteLine($\"EURUSD Digits: {digits.Value}\");\n// Output: 5 (prices like 1.12345)\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#2-get-current-spread","title":"2) Get current spread","text":"<pre><code>// Get spread in points\nvar spread = await acc.SymbolInfoIntegerAsync(\n    \"GBPUSD\",\n    SymbolInfoIntegerProperty.SYMBOL_SPREAD);\n\nvar digits = await acc.SymbolInfoIntegerAsync(\n    \"GBPUSD\",\n    SymbolInfoIntegerProperty.SYMBOL_DIGITS);\n\n// Convert points to pips\ndouble pips = spread.Value / Math.Pow(10, digits.Value - 1);\n\nConsole.WriteLine($\"GBPUSD Spread: {spread.Value} points ({pips:F1} pips)\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#3-check-stops-level","title":"3) Check stops level","text":"<pre><code>// Get minimum SL/TP distance\nvar stopsLevel = await acc.SymbolInfoIntegerAsync(\n    \"EURUSD\",\n    SymbolInfoIntegerProperty.SYMBOL_TRADE_STOPS_LEVEL);\n\nif (stopsLevel.Value == 0)\n{\n    Console.WriteLine(\"\u2705 No stops level restriction\");\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f Minimum SL/TP distance: {stopsLevel.Value} points\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#4-check-if-symbol-is-in-market-watch","title":"4) Check if symbol is in Market Watch","text":"<pre><code>// Verify symbol is selected\nvar isSelected = await acc.SymbolInfoIntegerAsync(\n    \"XAUUSD\",\n    SymbolInfoIntegerProperty.SYMBOL_SELECT);\n\nif (isSelected.Value == 1)\n{\n    Console.WriteLine(\"\u2705 XAUUSD is in Market Watch\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c XAUUSD not in Market Watch\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoInteger/#5-get-trading-parameters","title":"5) Get trading parameters","text":"<pre><code>// Retrieve key trading info\nvar symbol = \"EURUSD\";\n\nvar digits = await acc.SymbolInfoIntegerAsync(symbol, SymbolInfoIntegerProperty.SYMBOL_DIGITS);\nvar spread = await acc.SymbolInfoIntegerAsync(symbol, SymbolInfoIntegerProperty.SYMBOL_SPREAD);\nvar stopsLevel = await acc.SymbolInfoIntegerAsync(symbol, SymbolInfoIntegerProperty.SYMBOL_TRADE_STOPS_LEVEL);\nvar freezeLevel = await acc.SymbolInfoIntegerAsync(symbol, SymbolInfoIntegerProperty.SYMBOL_TRADE_FREEZE_LEVEL);\n\nConsole.WriteLine($\"{symbol} Trading Parameters:\");\nConsole.WriteLine($\"  Digits:       {digits.Value}\");\nConsole.WriteLine($\"  Spread:       {spread.Value} points\");\nConsole.WriteLine($\"  Stops Level:  {stopsLevel.Value} points\");\nConsole.WriteLine($\"  Freeze Level: {freezeLevel.Value} points\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/","title":"\u2705 Getting Symbol String Properties","text":"<p>Request: string property of a symbol from MT5. Get text-based symbol information like description, currencies, exchange, ISIN, etc.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoStringAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoString</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoString(SymbolInfoStringRequest) \u2192 SymbolInfoStringReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolInfoString(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolInfoStringData&gt; SymbolInfoStringAsync(\n            string symbolName,\n            SymbolInfoStringProperty propertyType,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoStringRequest { symbol: string, type: SymbolInfoStringProperty }</code></p> <p>Reply message:</p> <p><code>SymbolInfoStringReply { data: SymbolInfoStringData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name (e.g., <code>\"EURUSD\"</code>) <code>propertyType</code> <code>SymbolInfoStringProperty</code> \u2705 Property to retrieve (see enum below) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#output-symbolinfostringdata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolInfoStringData</code>","text":"Field Type Description <code>Value</code> <code>string</code> The requested property value"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#symbolinfostringproperty","title":"<code>SymbolInfoStringProperty</code>","text":"Enum Value Value Description MQL5 Docs <code>SYMBOL_BASIS</code> 0 The underlying asset of a derivative SymbolInfoString <code>SYMBOL_CATEGORY</code> 1 The name of the sector or category to which the financial symbol belongs <code>SYMBOL_COUNTRY</code> 2 The country to which the financial symbol belongs <code>SYMBOL_SECTOR_NAME</code> 3 The sector of the economy to which the financial symbol belongs <code>SYMBOL_INDUSTRY_NAME</code> 4 The industry branch or the industry to which the financial symbol belongs <code>SYMBOL_CURRENCY_BASE</code> 5 Basic currency of a symbol (e.g., for <code>EURUSD</code> this is <code>EUR</code>) <code>SYMBOL_CURRENCY_PROFIT</code> 6 Profit currency (currency in which profit/loss is calculated, e.g., for <code>EURUSD</code> this is <code>USD</code>) <code>SYMBOL_CURRENCY_MARGIN</code> 7 Margin currency (currency used for margin calculations) <code>SYMBOL_BANK</code> 8 Feeder of the current quote (data provider) <code>SYMBOL_DESCRIPTION</code> 9 Symbol description (full name, e.g., <code>\"Euro vs US Dollar\"</code>) <code>SYMBOL_EXCHANGE</code> 10 The name of the exchange in which the financial symbol is traded <code>SYMBOL_FORMULA</code> 11 The formula used for custom symbol pricing. If the name starts with a digit or contains special characters (\"&gt;\", \".\", \"-\", \"&amp;\", \"#\"), use quotation marks. Examples: Synthetic: <code>\"@ESU19\"/EURCAD</code>, Calendar spread: <code>\"Si-9.13\"-\"Si-6.13\"</code>, Euro index: <code>34.38805726 * pow(EURUSD,0.3155) * pow(EURGBP,0.3056) * pow(EURJPY,0.1891) * pow(EURCHF,0.1113) * pow(EURSEK,0.0785)</code> <code>SYMBOL_ISIN</code> 12 ISIN (International Securities Identification Number) - a 12-digit alphanumeric code that uniquely identifies a security. Presence depends on trade server. <code>SYMBOL_PAGE</code> 13 The address of the web page containing symbol information. Displayed as a link in terminal symbol properties. <code>SYMBOL_PATH</code> 14 Path in the symbol tree (folder structure in Market Watch)"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning one string property of a symbol.</li> <li>Why you need it. Get symbol description, currencies, metadata for display, logging, or trading logic.</li> <li>Most common. <code>SYMBOL_DESCRIPTION</code> (full name), <code>SYMBOL_CURRENCY_BASE</code> (base currency), <code>SYMBOL_CURRENCY_PROFIT</code> (profit currency).</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Display symbol's full description in UI (e.g., <code>\"Euro vs US Dollar\"</code>).</li> <li>Get base and profit currencies for position size calculations.</li> <li>Retrieve margin currency for margin calculations.</li> <li>Get exchange name for stocks/futures.</li> <li>Obtain ISIN code for regulatory compliance.</li> <li>Display symbol metadata in logs or reports.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>SYMBOL_CURRENCY_BASE - the first currency in a pair (for <code>EURUSD</code> = <code>EUR</code>).</li> <li>SYMBOL_CURRENCY_PROFIT - currency of profit/loss (for <code>EURUSD</code> = <code>USD</code>).</li> <li>SYMBOL_CURRENCY_MARGIN - currency used for margin (usually same as profit).</li> <li>For Forex pairs: <code>Base/Profit</code> (e.g., <code>EUR/USD</code> means EUR is base, USD is profit).</li> <li>Some properties may return empty strings if not available from broker.</li> <li>Use short timeout (3-5s) as this is metadata (cached).</li> <li>SYMBOL_FORMULA is for custom symbols only - synthetic instruments.</li> <li>SYMBOL_ISIN availability depends on broker/instrument type.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#1-get-symbol-description","title":"1) Get symbol description","text":"<pre><code>// Get human-readable description\nvar desc = await acc.SymbolInfoStringAsync(\n    \"EURUSD\",\n    SymbolInfoStringProperty.SYMBOL_DESCRIPTION,\n    deadline: DateTime.UtcNow.AddSeconds(3));\nConsole.WriteLine($\"Description: {desc.Value}\");\n// Output: \"Euro vs US Dollar\" or similar\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#2-get-base-and-profit-currencies","title":"2) Get base and profit currencies","text":"<pre><code>// Retrieve currency pair components\nvar baseCurr = await acc.SymbolInfoStringAsync(\n    \"GBPUSD\",\n    SymbolInfoStringProperty.SYMBOL_CURRENCY_BASE);\nvar profitCurr = await acc.SymbolInfoStringAsync(\n    \"GBPUSD\",\n    SymbolInfoStringProperty.SYMBOL_CURRENCY_PROFIT);\n\nConsole.WriteLine($\"GBPUSD:\");\nConsole.WriteLine($\"  Base currency:   {baseCurr.Value}\");   // GBP\nConsole.WriteLine($\"  Profit currency: {profitCurr.Value}\"); // USD\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#3-display-symbol-metadata","title":"3) Display symbol metadata","text":"<pre><code>// Show detailed symbol information\nvar symbol = \"EURUSD\";\n\nvar description = await acc.SymbolInfoStringAsync(symbol, SymbolInfoStringProperty.SYMBOL_DESCRIPTION);\nvar baseCurr = await acc.SymbolInfoStringAsync(symbol, SymbolInfoStringProperty.SYMBOL_CURRENCY_BASE);\nvar profitCurr = await acc.SymbolInfoStringAsync(symbol, SymbolInfoStringProperty.SYMBOL_CURRENCY_PROFIT);\nvar exchange = await acc.SymbolInfoStringAsync(symbol, SymbolInfoStringProperty.SYMBOL_EXCHANGE);\n\nConsole.WriteLine($\"Symbol: {symbol}\");\nConsole.WriteLine($\"  Description: {description.Value}\");\nConsole.WriteLine($\"  Base:        {baseCurr.Value}\");\nConsole.WriteLine($\"  Profit:      {profitCurr.Value}\");\nConsole.WriteLine($\"  Exchange:    {exchange.Value}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#4-get-isin-code","title":"4) Get ISIN code","text":"<pre><code>// Retrieve ISIN (if available)\nvar isin = await acc.SymbolInfoStringAsync(\n    \"AAPL\", // Apple stock\n    SymbolInfoStringProperty.SYMBOL_ISIN);\n\nif (!string.IsNullOrEmpty(isin.Value))\n{\n    Console.WriteLine($\"ISIN: {isin.Value}\");\n}\nelse\n{\n    Console.WriteLine(\"ISIN not available\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoString/#5-log-symbol-details-for-debugging","title":"5) Log symbol details for debugging","text":"<pre><code>// Comprehensive symbol info for logs\nvar symbol = \"XAUUSD\";\n\nConsole.WriteLine($\"=== Symbol Info: {symbol} ===\");\n\n// Get all string properties\nvar props = new[]\n{\n    (SymbolInfoStringProperty.SYMBOL_DESCRIPTION, \"Description\"),\n    (SymbolInfoStringProperty.SYMBOL_CURRENCY_BASE, \"Base Currency\"),\n    (SymbolInfoStringProperty.SYMBOL_CURRENCY_PROFIT, \"Profit Currency\"),\n    (SymbolInfoStringProperty.SYMBOL_CURRENCY_MARGIN, \"Margin Currency\"),\n    (SymbolInfoStringProperty.SYMBOL_EXCHANGE, \"Exchange\"),\n    (SymbolInfoStringProperty.SYMBOL_CATEGORY, \"Category\"),\n    (SymbolInfoStringProperty.SYMBOL_SECTOR_NAME, \"Sector\"),\n    (SymbolInfoStringProperty.SYMBOL_PATH, \"Path\")\n};\n\nforeach (var (prop, label) in props)\n{\n    var result = await acc.SymbolInfoStringAsync(symbol, prop);\n    Console.WriteLine($\"  {label,-20}: {result.Value}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/","title":"\u2705 Getting Last Tick Data","text":"<p>Request: current tick data from MT5. Get the latest price information (Bid, Ask, Last, Volume) for a symbol.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoTickAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoTick</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoTick(SymbolInfoTickRequest) \u2192 SymbolInfoTickRequestReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolInfoTick(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;MrpcMqlTick&gt; SymbolInfoTickAsync(\n            string symbolName,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoTickRequest { symbol: string }</code></p> <p>Reply message:</p> <p><code>SymbolInfoTickRequestReply { data: MrpcMqlTick }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name (e.g., <code>\"EURUSD\"</code>) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#output-mrpcmqltick","title":"\u2b06\ufe0f Output \u2014 <code>MrpcMqlTick</code>","text":"Field Type Description <code>Time</code> <code>long</code> Time of the last prices update (Unix timestamp in seconds) <code>Bid</code> <code>double</code> Current Bid price (sell price) <code>Ask</code> <code>double</code> Current Ask price (buy price) <code>Last</code> <code>double</code> Price of the last deal (Last) <code>Volume</code> <code>ulong</code> Volume for the current Last price <code>TimeMsc</code> <code>long</code> Time of a price last update in milliseconds (Unix timestamp) <code>Flags</code> <code>uint</code> Tick flags (see MQL5 docs for flag meanings) <code>VolumeReal</code> <code>double</code> Volume for the current Last price with greater accuracy (fractional)"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning the latest tick (price quote) for a symbol.</li> <li>Why you need it. Get current market prices, calculate spreads, check last update time, verify quotes before trading.</li> <li>Key fields. <code>Bid</code> (sell price), <code>Ask</code> (buy price), <code>Time</code> (when updated).</li> <li>Performance. Fast snapshot of current market state.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Get current Bid/Ask prices before placing an order.</li> <li>Calculate the current spread (<code>Ask - Bid</code>).</li> <li>Check when the last price update occurred.</li> <li>Verify symbol has active quotes.</li> <li>Monitor price changes in real-time (polling).</li> <li>Get Last price and volume for exchange-traded instruments.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Bid = price at which you can sell (broker buys from you).</li> <li>Ask = price at which you can buy (broker sells to you).</li> <li>Spread = <code>Ask - Bid</code> (broker's markup, in price units).</li> <li><code>Time</code> is Unix timestamp in seconds - use <code>DateTimeOffset.FromUnixTimeSeconds(tick.Time)</code> to convert.</li> <li><code>TimeMsc</code> provides millisecond precision for high-frequency trading.</li> <li><code>Last</code> and <code>Volume</code> are primarily used for exchange-traded instruments (stocks, futures).</li> <li>For Forex, <code>Bid</code> and <code>Ask</code> are the main prices - <code>Last</code> may be 0.</li> <li>Ensure symbol is in Market Watch and synchronized before calling.</li> <li>Use short timeout (3-5s) as quotes update frequently.</li> <li>For real-time monitoring, consider using streaming API (<code>SubscribeToTicksAsync</code>) instead of polling.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#1-get-current-bidask","title":"1) Get current Bid/Ask","text":"<pre><code>// Get current prices for EURUSD\nvar tick = await acc.SymbolInfoTickAsync(\n    \"EURUSD\",\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nConsole.WriteLine($\"EURUSD:\");\nConsole.WriteLine($\"  Bid: {tick.Bid:F5}\");\nConsole.WriteLine($\"  Ask: {tick.Ask:F5}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#2-calculate-spread","title":"2) Calculate spread","text":"<pre><code>// Calculate current spread\nvar tick = await acc.SymbolInfoTickAsync(\"EURUSD\");\n\ndouble spread = tick.Ask - tick.Bid;\nConsole.WriteLine($\"EURUSD Spread: {spread:F5} ({spread * 10000:F1} pips)\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#3-check-quote-freshness","title":"3) Check quote freshness","text":"<pre><code>// Verify quote is recent\nvar tick = await acc.SymbolInfoTickAsync(\"GBPUSD\");\n\nvar quoteTime = DateTimeOffset.FromUnixTimeSeconds(tick.Time).DateTime;\nvar age = DateTime.UtcNow - quoteTime;\n\nConsole.WriteLine($\"Quote time: {quoteTime:yyyy-MM-dd HH:mm:ss} UTC\");\nConsole.WriteLine($\"Quote age:  {age.TotalSeconds:F1} seconds\");\n\nif (age.TotalSeconds &gt; 10)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Quote is stale (older than 10 seconds)\");\n}\nelse\n{\n    Console.WriteLine(\"\u2705 Quote is fresh\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#4-display-multiple-symbols","title":"4) Display multiple symbols","text":"<pre><code>// Show current prices for multiple symbols\nvar symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\nConsole.WriteLine(\"Current Market Prices:\");\nConsole.WriteLine(\"Symbol      Bid         Ask         Spread\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var sym in symbols)\n{\n    var tick = await acc.SymbolInfoTickAsync(sym);\n    double spread = tick.Ask - tick.Bid;\n    Console.WriteLine($\"{sym,-10}  {tick.Bid,-10:F5}  {tick.Ask,-10:F5}  {spread:F5}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolInfoTick/#5-monitor-price-with-millisecond-precision","title":"5) Monitor price with millisecond precision","text":"<pre><code>// High-precision price monitoring\nvar tick = await acc.SymbolInfoTickAsync(\"EURUSD\");\n\nvar timeMsc = DateTimeOffset.FromUnixTimeMilliseconds(tick.TimeMsc).DateTime;\n\nConsole.WriteLine($\"EURUSD Tick:\");\nConsole.WriteLine($\"  Time (ms):   {timeMsc:yyyy-MM-dd HH:mm:ss.fff} UTC\");\nConsole.WriteLine($\"  Bid:         {tick.Bid:F5}\");\nConsole.WriteLine($\"  Ask:         {tick.Ask:F5}\");\nConsole.WriteLine($\"  Last:        {tick.Last:F5}\");\nConsole.WriteLine($\"  Volume:      {tick.Volume}\");\nConsole.WriteLine($\"  Volume Real: {tick.VolumeReal:F2}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/","title":"\u2705 Checking Symbol Data Synchronization","text":"<p>Request: check if symbol data is synchronized with trade server from MT5. Verify that symbol quotes and data are up-to-date.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolIsSynchronizedAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolIsSynchronized</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolIsSynchronized(SymbolIsSynchronizedRequest) \u2192 SymbolIsSynchronizedReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolIsSynchronized(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolIsSynchronizedData&gt; SymbolIsSynchronizedAsync(\n            string symbolName,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolIsSynchronizedRequest { symbol: string }</code></p> <p>Reply message:</p> <p><code>SymbolIsSynchronizedReply { data: SymbolIsSynchronizedData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name to check (e.g., <code>\"EURUSD\"</code>) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#output-symbolissynchronizeddata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolIsSynchronizedData</code>","text":"Field Type Description <code>Synchronized</code> <code>bool</code> <code>true</code> if data are synchronized with server, <code>false</code> if not synchronized or stale"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC checking if symbol's market data is synchronized with the trade server.</li> <li>Why you need it. Ensure quotes are fresh before trading, detect connection issues, wait for data after adding symbol.</li> <li>Use case. After <code>SymbolSelectAsync()</code>, check if data is synchronized before requesting quotes or placing orders.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Verify symbol data is up-to-date before trading operations.</li> <li>Wait for synchronization after adding a symbol to Market Watch.</li> <li>Detect connection/data feed issues for specific symbols.</li> <li>Ensure quotes are fresh before calculating trading parameters.</li> <li>Diagnose why quotes might be missing or stale.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Check after <code>SymbolSelectAsync()</code> - newly added symbols may take time to sync.</li> <li>If <code>Synchronized=false</code>, symbol data might be stale or connection is poor.</li> <li>Use retry logic with delays when waiting for synchronization (e.g., after adding symbol).</li> <li>Fast operation - use short timeout (3-5s).</li> <li>Symbols not in Market Watch may always return <code>false</code>.</li> <li>During market close, some symbols may not be synchronized (normal behavior).</li> <li>Don't trade if not synchronized - quotes may be outdated.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#1-check-if-symbol-is-synchronized","title":"1) Check if symbol is synchronized","text":"<pre><code>// Check EURUSD synchronization status\nvar result = await acc.SymbolIsSynchronizedAsync(\n    symbolName: \"EURUSD\",\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nif (result.Synchronized)\n{\n    Console.WriteLine(\"\u2705 EURUSD data is synchronized\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0\ufe0f EURUSD data is NOT synchronized\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#2-wait-for-synchronization-after-adding-symbol","title":"2) Wait for synchronization after adding symbol","text":"<pre><code>// Add symbol and wait for synchronization\nvar symbol = \"GBPJPY\";\n\n// Add to Market Watch\nawait acc.SymbolSelectAsync(symbol, select: true);\nConsole.WriteLine($\"Added {symbol} to Market Watch\");\n\n// Wait for synchronization (with retries)\nbool isSynced = false;\nfor (int attempt = 0; attempt &lt; 10; attempt++)\n{\n    var result = await acc.SymbolIsSynchronizedAsync(symbol);\n    if (result.Synchronized)\n    {\n        isSynced = true;\n        break;\n    }\n\n    Console.WriteLine($\"  Waiting for sync... (attempt {attempt + 1})\");\n    await Task.Delay(500); // Wait 500ms before retry\n}\n\nif (isSynced)\n{\n    Console.WriteLine($\"\u2705 {symbol} synchronized and ready\");\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f {symbol} failed to synchronize\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#3-verify-before-trading","title":"3) Verify before trading","text":"<pre><code>// Ensure symbol is synchronized before placing order\nvar symbol = \"EURUSD\";\n\n// Check synchronization\nvar syncStatus = await acc.SymbolIsSynchronizedAsync(symbol);\n\nif (!syncStatus.Synchronized)\n{\n    Console.WriteLine($\"\u274c Cannot trade {symbol}: data not synchronized\");\n    return;\n}\n\n// Safe to get quotes and trade\nvar tick = await acc.SymbolInfoTickAsync(symbol);\nConsole.WriteLine($\"\u2705 {symbol} Bid: {tick.Bid}, Ask: {tick.Ask}\");\n// Continue with trading...\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#4-check-multiple-symbols","title":"4) Check multiple symbols","text":"<pre><code>// Verify synchronization for multiple symbols\nvar symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\nConsole.WriteLine(\"Symbol synchronization status:\");\nforeach (var sym in symbols)\n{\n    var result = await acc.SymbolIsSynchronizedAsync(sym);\n    var status = result.Synchronized ? \"\u2705\" : \"\u26a0\ufe0f\";\n    var text = result.Synchronized ? \"synced\" : \"NOT synced\";\n    Console.WriteLine($\"  {status} {sym,-10} {text}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolIsSynchronized/#5-diagnostic-check-for-connection-issues","title":"5) Diagnostic check for connection issues","text":"<pre><code>// Check if any selected symbols are not synchronized (connection issue)\nvar total = await acc.SymbolsTotalAsync(selectedOnly: true);\nint notSyncedCount = 0;\n\nfor (int i = 0; i &lt; total.Total; i++)\n{\n    var symbolData = await acc.SymbolNameAsync(i, selected: true);\n    var syncStatus = await acc.SymbolIsSynchronizedAsync(symbolData.Name);\n\n    if (!syncStatus.Synchronized)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f {symbolData.Name} not synchronized\");\n        notSyncedCount++;\n    }\n}\n\nif (notSyncedCount == 0)\n{\n    Console.WriteLine($\"\u2705 All {total.Total} symbols synchronized\");\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f {notSyncedCount} of {total.Total} symbols not synchronized\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/","title":"\u2705 Getting Symbol Name by Index","text":"<p>Request: symbol name by index from MT5. Retrieve the name of a symbol from the list (selected in Market Watch or all available).</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolNameAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolName</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolName(SymbolNameRequest) \u2192 SymbolNameReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolName(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolNameData&gt; SymbolNameAsync(\n            int index,\n            bool selected,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolNameRequest { index: int32, selected: bool }</code></p> <p>Reply message:</p> <p><code>SymbolNameReply { data: SymbolNameData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>index</code> <code>int</code> \u2705 Order number of a symbol (zero-based index) <code>selected</code> <code>bool</code> \u2705 <code>true</code> - get from Market Watch symbols, <code>false</code> - get from all available symbols <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#output-symbolnamedata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolNameData</code>","text":"Field Type Description <code>Name</code> <code>string</code> Symbol name (e.g., <code>\"EURUSD\"</code>)"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning symbol name by its index in the list.</li> <li>Why you need it. Iterate through symbols, enumerate Market Watch, discover available symbols.</li> <li>Two modes. <code>selected=true</code> \u2192 symbols in Market Watch, <code>selected=false</code> \u2192 all available symbols.</li> <li>Index-based. Use with <code>SymbolsTotalAsync()</code> to get the count first, then iterate by index.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Enumerate all symbols in Market Watch (iterate from <code>0</code> to <code>SymbolsTotal-1</code>).</li> <li>Discover all available symbols from your broker.</li> <li>Build a list of trading instruments for your application.</li> <li>Get the first/last symbol in the list.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Always call <code>SymbolsTotalAsync()</code> first to get the valid index range.</li> <li>Index is zero-based: first symbol = <code>0</code>, last symbol = <code>total - 1</code>.</li> <li>If index is out of range, you'll get an error.</li> <li>Use <code>selected=true</code> for symbols currently in Market Watch (faster, smaller list).</li> <li>Use <code>selected=false</code> to discover all symbols your broker offers.</li> <li>The order of symbols may change if Market Watch is modified during iteration.</li> <li>Fast operation - use short timeout (3-5s).</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#1-get-first-symbol-from-market-watch","title":"1) Get first symbol from Market Watch","text":"<pre><code>// Get the first symbol in Market Watch\nvar firstSymbol = await acc.SymbolNameAsync(\n    index: 0,\n    selected: true,\n    deadline: DateTime.UtcNow.AddSeconds(3));\nConsole.WriteLine($\"First symbol: {firstSymbol.Name}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#2-enumerate-all-symbols-in-market-watch","title":"2) Enumerate all symbols in Market Watch","text":"<pre><code>// Get count and iterate through all Market Watch symbols\nvar total = await acc.SymbolsTotalAsync(selectedOnly: true);\n\nConsole.WriteLine($\"Symbols in Market Watch ({total.Total}):\");\nfor (int i = 0; i &lt; total.Total; i++)\n{\n    var symbolData = await acc.SymbolNameAsync(index: i, selected: true);\n    Console.WriteLine($\"  [{i}] {symbolData.Name}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#3-get-all-available-symbols-from-broker","title":"3) Get all available symbols from broker","text":"<pre><code>// Enumerate all symbols broker offers (not just Market Watch)\nvar totalAll = await acc.SymbolsTotalAsync(selectedOnly: false);\n\nConsole.WriteLine($\"All available symbols ({totalAll.Total}):\");\nfor (int i = 0; i &lt; Math.Min(totalAll.Total, 10); i++) // Show first 10\n{\n    var symbolData = await acc.SymbolNameAsync(index: i, selected: false);\n    Console.WriteLine($\"  [{i}] {symbolData.Name}\");\n}\nConsole.WriteLine($\"... and {totalAll.Total - 10} more\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#4-build-symbol-list","title":"4) Build symbol list","text":"<pre><code>// Create a list of all symbols in Market Watch\nvar total = await acc.SymbolsTotalAsync(selectedOnly: true);\nvar symbolList = new List&lt;string&gt;();\n\nfor (int i = 0; i &lt; total.Total; i++)\n{\n    var symbolData = await acc.SymbolNameAsync(i, selected: true);\n    symbolList.Add(symbolData.Name);\n}\n\nConsole.WriteLine($\"Loaded {symbolList.Count} symbols:\");\nConsole.WriteLine(string.Join(\", \", symbolList));\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolName/#5-find-specific-symbol-by-iteration","title":"5) Find specific symbol by iteration","text":"<pre><code>// Search for a symbol by iterating (not efficient, but demonstrates usage)\nvar total = await acc.SymbolsTotalAsync(selectedOnly: true);\nstring targetSymbol = \"EURUSD\";\nint foundIndex = -1;\n\nfor (int i = 0; i &lt; total.Total; i++)\n{\n    var symbolData = await acc.SymbolNameAsync(i, selected: true);\n    if (symbolData.Name == targetSymbol)\n    {\n        foundIndex = i;\n        break;\n    }\n}\n\nif (foundIndex &gt;= 0)\n{\n    Console.WriteLine($\"\u2705 Found '{targetSymbol}' at index {foundIndex}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c '{targetSymbol}' not in Market Watch\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/","title":"\u2705 Adding/Removing Symbol from Market Watch","text":"<p>Request: select or deselect symbol in Market Watch from MT5. Add a symbol to Market Watch or remove it.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolSelectAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolSelect</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolSelect(SymbolSelectRequest) \u2192 SymbolSelectReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolSelect(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolSelectData&gt; SymbolSelectAsync(\n            string symbolName,\n            bool select,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolSelectRequest { symbol: string, select: bool }</code></p> <p>Reply message:</p> <p><code>SymbolSelectReply { data: SymbolSelectData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>symbolName</code> <code>string</code> \u2705 Symbol name (e.g., <code>\"EURUSD\"</code>) <code>select</code> <code>bool</code> \u2705 <code>true</code> - add symbol to Market Watch, <code>false</code> - remove symbol from Market Watch <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#output-symbolselectdata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolSelectData</code>","text":"Field Type Description <code>Success</code> <code>bool</code> <code>true</code> if operation succeeded, <code>false</code> if failed"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC to add/remove symbols from Market Watch.</li> <li>Why you need it. Enable symbols for trading, receive quotes, ensure symbol data is available.</li> <li>Two modes. <code>select=true</code> \u2192 add to Market Watch, <code>select=false</code> \u2192 remove from Market Watch.</li> <li>Important. Symbol cannot be removed if chart is open or there are open positions.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Add symbols to Market Watch before trading or getting quotes.</li> <li>Ensure a symbol is visible and receiving data updates.</li> <li>Clean up Market Watch by removing unused symbols.</li> <li>Prepare symbols for trading operations.</li> <li>Dynamically manage Market Watch list based on trading strategy.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Always add symbols to Market Watch before trading - many operations require the symbol to be selected.</li> <li>If <code>Success=false</code>, check: symbol might not exist, chart might be open, or positions might be active.</li> <li>Cannot remove symbol if:</li> <li>A chart for this symbol is open in MT5 terminal</li> <li>There are open positions for this symbol</li> <li>Symbol is being used by an active order</li> <li>Use <code>SymbolExistAsync()</code> first to verify symbol exists before selecting.</li> <li>Selecting an already-selected symbol returns <code>Success=true</code> (idempotent operation).</li> <li>Fast operation - use short timeout (3-5s).</li> <li>Some brokers automatically select symbols when you open positions - check with <code>SymbolsTotalAsync()</code>.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#1-add-symbol-to-market-watch","title":"1) Add symbol to Market Watch","text":"<pre><code>// Add EURUSD to Market Watch\nvar result = await acc.SymbolSelectAsync(\n    symbolName: \"EURUSD\",\n    select: true,\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nif (result.Success)\n{\n    Console.WriteLine(\"\u2705 EURUSD added to Market Watch\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c Failed to add EURUSD\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#2-remove-symbol-from-market-watch","title":"2) Remove symbol from Market Watch","text":"<pre><code>// Remove GBPJPY from Market Watch\nvar result = await acc.SymbolSelectAsync(\n    symbolName: \"GBPJPY\",\n    select: false);\n\nif (result.Success)\n{\n    Console.WriteLine(\"\u2705 GBPJPY removed from Market Watch\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0\ufe0f Cannot remove GBPJPY (chart open or positions active?)\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#3-ensure-symbol-is-available-before-trading","title":"3) Ensure symbol is available before trading","text":"<pre><code>// Ensure symbol is in Market Watch before placing order\nvar symbol = \"EURUSD\";\n\n// Check if exists\nvar exists = await acc.SymbolExistAsync(symbol);\nif (!exists.Exists)\n{\n    Console.WriteLine($\"\u274c Symbol '{symbol}' doesn't exist\");\n    return;\n}\n\n// Add to Market Watch\nvar selected = await acc.SymbolSelectAsync(symbol, select: true);\nif (!selected.Success)\n{\n    Console.WriteLine($\"\u274c Failed to add '{symbol}' to Market Watch\");\n    return;\n}\n\nConsole.WriteLine($\"\u2705 '{symbol}' ready for trading\");\n// Continue with trading operations...\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#4-add-multiple-symbols","title":"4) Add multiple symbols","text":"<pre><code>// Add a list of symbols to Market Watch\nvar symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\nConsole.WriteLine(\"Adding symbols to Market Watch:\");\nforeach (var sym in symbols)\n{\n    var result = await acc.SymbolSelectAsync(sym, select: true);\n    var status = result.Success ? \"\u2705\" : \"\u274c\";\n    Console.WriteLine($\"  {status} {sym}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolSelect/#5-toggle-symbol-visibility","title":"5) Toggle symbol visibility","text":"<pre><code>// Toggle symbol in Market Watch\nvar symbol = \"BTCUSD\";\nbool shouldAdd = true; // from user input or logic\n\nvar result = await acc.SymbolSelectAsync(symbol, select: shouldAdd);\n\nif (result.Success)\n{\n    var action = shouldAdd ? \"added to\" : \"removed from\";\n    Console.WriteLine($\"\u2705 {symbol} {action} Market Watch\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Failed to modify {symbol}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/","title":"MT5Account \u00b7 Symbol Information - Overview","text":"<p>Symbol properties, trading sessions, market data, and symbol availability. Use this page to choose the right API for accessing symbol information.</p>"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>SymbolInfoDouble - single double value from symbol (bid, ask, spread, tick size, etc.).</li> <li>SymbolInfoInteger - single integer value from symbol (digits, spread, time flags, etc.).</li> <li>SymbolInfoString - single string value from symbol (description, path, category, etc.).</li> <li>SymbolInfoTick - latest tick data for symbol (bid, ask, last, volume, time).</li> <li>SymbolsTotal - count of available symbols (all or Market Watch only).</li> <li>SymbolExist - check if symbol exists (standard or custom).</li> <li>SymbolName - get symbol name by index from list.</li> <li>SymbolSelect - add/remove symbol to/from Market Watch.</li> <li>SymbolIsSynchronized - check if symbol data is synchronized with server.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>SymbolInfo (Double/Integer/String) \u2192 grab one specific property* of a symbol.</li> <li>SymbolInfoTick \u2192 get current market prices (bid/ask) for a symbol.</li> <li>SymbolsTotal \u2192 count how many symbols are available.</li> <li>SymbolExist \u2192 verify if a symbol exists before trading.</li> <li>SymbolSelect \u2192 enable symbol for quotes and trading.</li> <li>SymbolName \u2192 iterate through symbols by index.</li> <li>SymbolIsSynchronized \u2192 ensure data is fresh before trading.</li> </ul> <p>Rule of thumb: need one property \u2192 <code>SymbolInfo*Async</code>; need current prices \u2192 <code>SymbolInfoTickAsync</code>; need symbol management \u2192 Select/Exist/IsSynchronized.</p>"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns Key inputs One numeric value (bid, ask, spread, etc.) <code>SymbolInfoDoubleAsync</code> Single <code>double</code> Symbol name + Property enum One integer value (digits, time flags, etc.) <code>SymbolInfoIntegerAsync</code> Single <code>long</code> Symbol name + Property enum One text value (description, currency, etc.) <code>SymbolInfoStringAsync</code> Single <code>string</code> Symbol name + Property enum Current market prices (bid/ask/last) <code>SymbolInfoTickAsync</code> MrpcMqlTick object Symbol name Count of available symbols <code>SymbolsTotalAsync</code> <code>int</code> Selected only (true/false) Check if symbol exists <code>SymbolExistAsync</code> Exists + IsCustom flags Symbol name Get symbol name by index <code>SymbolNameAsync</code> <code>string</code> Index + Selected flag Add/remove symbol from Market Watch <code>SymbolSelectAsync</code> Success flag Symbol name + Select flag Check if symbol data is synchronized <code>SymbolIsSynchronizedAsync</code> <code>bool</code> Symbol name"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>SymbolSelect must be called before accessing quotes for some symbols.</li> <li>Spread is in points, not pips - divide by 10 for 5-digit brokers.</li> <li>Tick size determines minimum price change - important for pending orders.</li> <li>Contract size affects lot calculations - 1 lot = contract size units.</li> <li>Digits determines price precision - use for rounding prices.</li> <li>Session times vary by broker and symbol - check trading hours.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Get current bid/ask prices\nvar tick = await account.SymbolInfoTickAsync(\"EURUSD\");\nConsole.WriteLine($\"EURUSD - Bid: {tick.Bid:F5}, Ask: {tick.Ask:F5}, Spread: {(tick.Ask - tick.Bid) * 100000:F1} points\");\n</code></pre> <pre><code>// Get symbol spread\nvar spread = await account.SymbolInfoIntegerAsync(\"EURUSD\",\n    SymbolInfoIntegerProperty.SymbolSpread);\nConsole.WriteLine($\"Spread: {spread} points\");\n</code></pre> <pre><code>// Check if symbol exists before trading\nvar existData = await account.SymbolExistAsync(\"BTCUSD\");\nif (existData.Exists)\n{\n    Console.WriteLine($\"Symbol exists! Is custom: {existData.IsCustom}\");\n}\nelse\n{\n    Console.WriteLine(\"Symbol not found!\");\n}\n</code></pre> <pre><code>// Add symbol to Market Watch\nvar success = await account.SymbolSelectAsync(\"XAUUSD\", select: true);\nif (success.Success)\n{\n    // Wait for synchronization\n    var synced = await account.SymbolIsSynchronizedAsync(\"XAUUSD\");\n    if (synced.Synchronized)\n    {\n        Console.WriteLine(\"Symbol ready for trading!\");\n    }\n}\n</code></pre> <pre><code>// Iterate through all symbols in Market Watch\nvar total = await account.SymbolsTotalAsync(selectedOnly: true);\nfor (int i = 0; i &lt; total.Total; i++)\n{\n    var symbolData = await account.SymbolNameAsync(i, selected: true);\n    Console.WriteLine($\"[{i}] {symbolData.Name}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/Symbol_Information.Overview/#see-also","title":"See also","text":"<ul> <li>Streaming: SubscribeToTicks - real-time tick updates</li> <li>Trading: OrderSend - place orders using symbol names</li> <li>Market Depth: MarketBookGet - order book for symbols</li> <li>Additional: SymbolParamsMany - get detailed symbol properties</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/","title":"\u2705 Getting Total Number of Symbols","text":"<p>Request: count of available symbols from MT5. Get the total number of symbols (all available or only selected in Market Watch).</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolsTotalAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolsTotal</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolsTotal(SymbolsTotalRequest) \u2192 SymbolsTotalReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.SymbolsTotal(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolsTotalData&gt; SymbolsTotalAsync(\n            bool selectedOnly,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolsTotalRequest { mode: bool }</code></p> <p>Reply message:</p> <p><code>SymbolsTotalReply { data: SymbolsTotalData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>selectedOnly</code> <code>bool</code> \u2705 <code>true</code> - count only symbols in Market Watch, <code>false</code> - count all available symbols <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#output-symbolstotaldata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolsTotalData</code>","text":"Field Type Description <code>Total</code> <code>int32</code> If <code>selectedOnly=true</code>, returns the number of symbols selected in Market Watch. Otherwise, total number of all symbols."},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning the count of symbols (selected or all available).</li> <li>Why you need it. Check how many symbols are available, iterate through symbols, verify Market Watch configuration.</li> <li>Two modes. <code>selectedOnly=true</code> \u2192 symbols in Market Watch, <code>selectedOnly=false</code> \u2192 all available symbols from broker.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Count how many symbols are currently in Market Watch.</li> <li>Get the total number of available symbols from your broker.</li> <li>Iterate through symbols using <code>SymbolNameAsync(index)</code> (you need the total count first).</li> <li>Verify that specific symbols are loaded in Market Watch.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Use <code>selectedOnly=true</code> to get symbols currently visible in Market Watch (actively used symbols).</li> <li>Use <code>selectedOnly=false</code> to get the total count of all symbols your broker offers.</li> <li>Combine with <code>SymbolNameAsync(index, selected)</code> to iterate through symbols.</li> <li>The count includes all symbol types: currencies, stocks, indices, commodities, etc.</li> <li>Use short per\u2011call timeout (3\u20135s) as this is a fast operation.</li> </ul>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#1-count-symbols-in-market-watch","title":"1) Count symbols in Market Watch","text":"<pre><code>// Get number of symbols currently selected in Market Watch\nvar totalSelected = await acc.SymbolsTotalAsync(\n    selectedOnly: true,\n    deadline: DateTime.UtcNow.AddSeconds(3));\nConsole.WriteLine($\"Symbols in Market Watch: {totalSelected.Total}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#2-count-all-available-symbols","title":"2) Count all available symbols","text":"<pre><code>// Get total number of symbols available from broker\nvar totalAll = await acc.SymbolsTotalAsync(selectedOnly: false);\nConsole.WriteLine($\"Total available symbols: {totalAll.Total}\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#3-compare-selected-vs-available","title":"3) Compare selected vs available","text":"<pre><code>// Show selected vs available symbols\nvar selected = await acc.SymbolsTotalAsync(selectedOnly: true);\nvar all = await acc.SymbolsTotalAsync(selectedOnly: false);\n\nConsole.WriteLine($\"Market Watch: {selected.Total} symbols\");\nConsole.WriteLine($\"Available:    {all.Total} symbols\");\nConsole.WriteLine($\"Not selected: {all.Total - selected.Total} symbols\");\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#4-iterate-through-all-selected-symbols","title":"4) Iterate through all selected symbols","text":"<pre><code>// Get count and iterate through all symbols in Market Watch\nvar total = await acc.SymbolsTotalAsync(selectedOnly: true);\n\nConsole.WriteLine($\"Symbols in Market Watch ({total.Total}):\");\nfor (int i = 0; i &lt; total.Total; i++)\n{\n    var symbolData = await acc.SymbolNameAsync(index: i, selected: true);\n    Console.WriteLine($\"  [{i}] {symbolData.Name}\");\n}\n</code></pre>"},{"location":"MT5Account/2.%20Symbol_information/SymbolsTotal/#5-verify-market-watch-is-populated","title":"5) Verify Market Watch is populated","text":"<pre><code>// Check if Market Watch has symbols before trading\nvar selected = await acc.SymbolsTotalAsync(selectedOnly: true);\n\nif (selected.Total == 0)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Market Watch is empty! Add symbols first.\");\n    return;\n}\n\nConsole.WriteLine($\"\u2705 Market Watch has {selected.Total} symbols\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/","title":"\u2705 Getting All Opened Orders &amp; Positions","text":"<p>Request: detailed information about all opened orders and positions from MT5. Get complete data for active orders and positions with sorting options.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OpenedOrdersAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>OpenedOrders</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>OpenedOrders(OpenedOrdersRequest) \u2192 OpenedOrdersReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.OpenedOrders(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OpenedOrdersData&gt; OpenedOrdersAsync(\n            BMT5_ENUM_OPENED_ORDER_SORT_TYPE sortMode = BMT5_ENUM_OPENED_ORDER_SORT_TYPE.BMT5_OPENED_ORDER_SORT_BY_OPEN_TIME_ASC,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OpenedOrdersRequest { inputSortMode: BMT5_ENUM_OPENED_ORDER_SORT_TYPE }</code></p> <p>Reply message:</p> <p><code>OpenedOrdersReply { data: OpenedOrdersData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>sortMode</code> <code>BMT5_ENUM_OPENED_ORDER_SORT_TYPE</code> \u274c Sort order for results (default: by open time ascending) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#output-openedordersdata","title":"\u2b06\ufe0f Output \u2014 <code>OpenedOrdersData</code>","text":"Field Type Description <code>OpenedOrders</code> <code>List&lt;OpenedOrderInfo&gt;</code> List of all active pending orders <code>PositionInfos</code> <code>List&lt;PositionInfo&gt;</code> List of all currently open positions"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#related-types-and-enums-from-proto","title":"\ud83e\uddf1 Related types and enums (from proto)","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_opened_order_sort_type-sort-options","title":"<code>BMT5_ENUM_OPENED_ORDER_SORT_TYPE</code> (Sort Options)","text":"Enum Value Value Description <code>BMT5_OPENED_ORDER_SORT_BY_OPEN_TIME_ASC</code> 0 Sort by open time (oldest first) <code>BMT5_OPENED_ORDER_SORT_BY_OPEN_TIME_DESC</code> 1 Sort by open time (newest first) <code>BMT5_OPENED_ORDER_SORT_BY_ORDER_TICKET_ID_ASC</code> 2 Sort by ticket ID (ascending) <code>BMT5_OPENED_ORDER_SORT_BY_ORDER_TICKET_ID_DESC</code> 3 Sort by ticket ID (descending)"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#openedorderinfo-pending-orders","title":"<code>OpenedOrderInfo</code> (Pending Orders)","text":"Field Type Description <code>Index</code> <code>uint32</code> Zero-based index in the list <code>Ticket</code> <code>ulong</code> Order ticket ID (unique identifier) <code>PriceCurrent</code> <code>double</code> Current market price for the symbol <code>PriceOpen</code> <code>double</code> Order price (trigger price for pending orders) <code>StopLimit</code> <code>double</code> StopLimit price (for STOP_LIMIT orders) <code>StopLoss</code> <code>double</code> Stop Loss price <code>TakeProfit</code> <code>double</code> Take Profit price <code>VolumeCurrent</code> <code>double</code> Current unfilled volume (lots) <code>VolumeInitial</code> <code>double</code> Initial order volume (lots) <code>MagicNumber</code> <code>long</code> Magic number (EA identifier) <code>Reason</code> <code>int32</code> Order placement reason (enum value) <code>Type</code> <code>BMT5_ENUM_ORDER_TYPE</code> Order type (Buy, Sell, BuyLimit, etc.) <code>State</code> <code>BMT5_ENUM_ORDER_STATE</code> Order state (Placed, Partial, etc.) <code>TimeExpiration</code> <code>Timestamp</code> Order expiration time <code>TimeSetup</code> <code>Timestamp</code> Order setup time (when placed) <code>TimeDone</code> <code>Timestamp</code> Order completion time (if filled/cancelled) <code>TypeFilling</code> <code>BMT5_ENUM_ORDER_TYPE_FILLING</code> Filling mode (FOK, IOC, Return, BOC) <code>TypeTime</code> <code>BMT5_ENUM_ORDER_TYPE_TIME</code> Order lifetime (GTC, DAY, SPECIFIED, SPECIFIED_DAY) <code>PositionId</code> <code>long</code> Position ID this order belongs to <code>PositionById</code> <code>long</code> Position ID for CloseBy operations <code>Symbol</code> <code>string</code> Trading symbol <code>ExternalId</code> <code>string</code> External order identifier <code>Comment</code> <code>string</code> Order comment <code>AccountLogin</code> <code>long</code> Account login number"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#positioninfo-open-positions","title":"<code>PositionInfo</code> (Open Positions)","text":"Field Type Description <code>Index</code> <code>uint32</code> Zero-based index in the list <code>Ticket</code> <code>ulong</code> Position ticket ID <code>OpenTime</code> <code>Timestamp</code> Position open time <code>Volume</code> <code>double</code> Position volume (lots) <code>PriceOpen</code> <code>double</code> Position open price <code>StopLoss</code> <code>double</code> Stop Loss price <code>TakeProfit</code> <code>double</code> Take Profit price <code>PriceCurrent</code> <code>double</code> Current market price <code>Swap</code> <code>double</code> Accumulated swap <code>Profit</code> <code>double</code> Current profit/loss <code>LastUpdateTime</code> <code>Timestamp</code> Last position update time <code>Type</code> <code>BMT5_ENUM_POSITION_TYPE</code> Position type (Buy or Sell) <code>MagicNumber</code> <code>long</code> Magic number (EA identifier) <code>Identifier</code> <code>long</code> Position identifier <code>Reason</code> <code>BMT5_ENUM_POSITION_REASON</code> Position open reason (Client, Mobile, Web, Expert) <code>Symbol</code> <code>string</code> Trading symbol <code>Comment</code> <code>string</code> Position comment <code>ExternalId</code> <code>string</code> External position identifier <code>PositionCommission</code> <code>double</code> Commission charged for position <code>AccountLogin</code> <code>long</code> Account login number"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_order_type","title":"<code>BMT5_ENUM_ORDER_TYPE</code>","text":"Enum Value Value Description <code>BMT5_ORDER_TYPE_BUY</code> 0 Market Buy order <code>BMT5_ORDER_TYPE_SELL</code> 1 Market Sell order <code>BMT5_ORDER_TYPE_BUY_LIMIT</code> 2 Buy Limit pending order <code>BMT5_ORDER_TYPE_SELL_LIMIT</code> 3 Sell Limit pending order <code>BMT5_ORDER_TYPE_BUY_STOP</code> 4 Buy Stop pending order <code>BMT5_ORDER_TYPE_SELL_STOP</code> 5 Sell Stop pending order <code>BMT5_ORDER_TYPE_BUY_STOP_LIMIT</code> 6 Upon reaching order price, Buy Limit placed at StopLimit price <code>BMT5_ORDER_TYPE_SELL_STOP_LIMIT</code> 7 Upon reaching order price, Sell Limit placed at StopLimit price <code>BMT5_ORDER_TYPE_CLOSE_BY</code> 8 Order to close position by opposite one"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_order_state","title":"<code>BMT5_ENUM_ORDER_STATE</code>","text":"Enum Value Value Description <code>BMT5_ORDER_STATE_STARTED</code> 0 Order checked, not yet accepted by broker <code>BMT5_ORDER_STATE_PLACED</code> 1 Order accepted <code>BMT5_ORDER_STATE_CANCELED</code> 2 Order canceled by client <code>BMT5_ORDER_STATE_PARTIAL</code> 3 Order partially executed <code>BMT5_ORDER_STATE_FILLED</code> 4 Order fully executed <code>BMT5_ORDER_STATE_REJECTED</code> 5 Order rejected <code>BMT5_ORDER_STATE_EXPIRED</code> 6 Order expired <code>BMT5_ORDER_STATE_REQUEST_ADD</code> 7 Order being registered (placing) <code>BMT5_ORDER_STATE_REQUEST_MODIFY</code> 8 Order being modified <code>BMT5_ORDER_STATE_REQUEST_CANCEL</code> 9 Order being deleted"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_position_type","title":"<code>BMT5_ENUM_POSITION_TYPE</code>","text":"Enum Value Value Description <code>BMT5_POSITION_TYPE_BUY</code> 0 Buy position <code>BMT5_POSITION_TYPE_SELL</code> 1 Sell position"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_position_reason","title":"<code>BMT5_ENUM_POSITION_REASON</code>","text":"Enum Value Value Description <code>BMT5_POSITION_REASON_CLIENT</code> 0 Opened from desktop terminal <code>BMT5_POSITION_REASON_MOBILE</code> 1 Opened from mobile app <code>BMT5_POSITION_REASON_WEB</code> 2 Opened from web platform <code>BMT5_POSITION_REASON_EXPERT</code> 3 Opened by EA/script"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_order_type_filling","title":"<code>BMT5_ENUM_ORDER_TYPE_FILLING</code>","text":"Enum Value Value Description <code>BMT5_ORDER_FILLING_FOK</code> 0 Fill or Kill - execute full volume or cancel <code>BMT5_ORDER_FILLING_IOC</code> 1 Immediate or Cancel - execute max available volume, cancel remainder <code>BMT5_ORDER_FILLING_RETURN</code> 2 Return - partial fills allowed, remaining volume stays as order <code>BMT5_ORDER_FILLING_BOC</code> 3 Book or Cancel - execute only if full volume available as single offer"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#bmt5_enum_order_type_time","title":"<code>BMT5_ENUM_ORDER_TYPE_TIME</code>","text":"Enum Value Value Description <code>BMT5_ORDER_TIME_GTC</code> 0 Good Till Cancel - valid until explicitly cancelled <code>BMT5_ORDER_TIME_DAY</code> 1 Good Till Day - valid until end of trading day <code>BMT5_ORDER_TIME_SPECIFIED</code> 2 Good Till Specified - valid until expiration time <code>BMT5_ORDER_TIME_SPECIFIED_DAY</code> 3 Valid till 23:59:59 of specified day"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning detailed information about all active orders and positions.</li> <li>Why you need it. Monitor open positions, check pending orders, calculate total exposure, update UI, risk management.</li> <li>Two result lists. <code>OpenedOrders</code> (pending orders) and <code>PositionInfos</code> (open positions).</li> <li>Rich data. Each object contains 19-24 fields with complete order/position details.</li> <li>Sorting options. 4 sort modes - by time or ticket ID, ascending or descending.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Get complete snapshot of all trading activity on the account.</li> <li>Display current positions and pending orders in UI.</li> <li>Calculate total exposure across all positions.</li> <li>Monitor profit/loss for all open positions.</li> <li>Check for specific pending orders before placing new ones.</li> <li>Implement risk management based on current positions.</li> <li>Update trading dashboard with real-time data.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Returns two separate lists - pending orders and open positions.</li> <li><code>OpenedOrders</code> contains only pending orders (not yet executed).</li> <li><code>PositionInfos</code> contains only open positions (already executed).</li> <li>Use <code>PositionsTotalAsync()</code> for quick count check before calling this method.</li> <li>Timestamp fields are <code>google.protobuf.Timestamp</code> - convert using <code>DateTimeOffset.FromUnixTimeSeconds()</code>.</li> <li><code>MagicNumber</code> = 0 means manually opened (not by EA).</li> <li>For netting accounts: one position per symbol (buy or sell).</li> <li>For hedging accounts: multiple positions per symbol allowed (buy + sell).</li> <li>Use short timeout (5-10s) depending on number of positions.</li> <li>Empty lists mean no pending orders or open positions.</li> <li><code>PriceCurrent</code> shows current market price for comparison with entry/target prices.</li> <li><code>Profit</code> in PositionInfo is unrealized P&amp;L (not yet closed).</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#1-get-all-positions-and-orders","title":"1) Get all positions and orders","text":"<pre><code>// Retrieve complete trading state\nvar data = await acc.OpenedOrdersAsync(\n    sortMode: BMT5_ENUM_OPENED_ORDER_SORT_TYPE.BMT5_OPENED_ORDER_SORT_BY_OPEN_TIME_ASC,\n    deadline: DateTime.UtcNow.AddSeconds(10));\n\nConsole.WriteLine($\"Open Positions:  {data.PositionInfos.Count}\");\nConsole.WriteLine($\"Pending Orders:  {data.OpenedOrders.Count}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#2-display-all-open-positions","title":"2) Display all open positions","text":"<pre><code>// Show position details\nvar data = await acc.OpenedOrdersAsync();\n\nConsole.WriteLine(\"=== OPEN POSITIONS ===\");\nConsole.WriteLine(\"Ticket      Symbol      Type  Volume   Entry      Current    Profit\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var pos in data.PositionInfos)\n{\n    var type = pos.Type == BMT5_ENUM_POSITION_TYPE.BMT5_POSITION_TYPE_BUY ? \"BUY \" : \"SELL\";\n    var openTime = DateTimeOffset.FromUnixTimeSeconds(pos.OpenTime.Seconds).DateTime;\n\n    Console.WriteLine($\"{pos.Ticket,-10}  {pos.Symbol,-10}  {type}  {pos.Volume,6:F2}  {pos.PriceOpen,8:F5}  {pos.PriceCurrent,8:F5}  {pos.Profit,8:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#3-calculate-total-profitloss","title":"3) Calculate total profit/loss","text":"<pre><code>// Sum unrealized P&amp;L across all positions\nvar data = await acc.OpenedOrdersAsync();\n\ndouble totalProfit = data.PositionInfos.Sum(p =&gt; p.Profit);\ndouble totalSwap = data.PositionInfos.Sum(p =&gt; p.Swap);\ndouble totalCommission = data.PositionInfos.Sum(p =&gt; p.PositionCommission);\n\ndouble netPL = totalProfit + totalSwap - totalCommission;\n\nConsole.WriteLine($\"Total Profit:     {totalProfit:F2}\");\nConsole.WriteLine($\"Total Swap:       {totalSwap:F2}\");\nConsole.WriteLine($\"Total Commission: {totalCommission:F2}\");\nConsole.WriteLine($\"Net P&amp;L:          {netPL:F2}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#4-list-pending-orders","title":"4) List pending orders","text":"<pre><code>// Show all pending orders\nvar data = await acc.OpenedOrdersAsync(\n    sortMode: BMT5_ENUM_OPENED_ORDER_SORT_TYPE.BMT5_OPENED_ORDER_SORT_BY_ORDER_TICKET_ID_DESC);\n\nConsole.WriteLine(\"=== PENDING ORDERS ===\");\nConsole.WriteLine(\"Ticket      Symbol      Type           Price      Volume   State\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var order in data.OpenedOrders)\n{\n    var typeName = order.Type.ToString().Replace(\"BMT5_ORDER_TYPE_\", \"\");\n    var stateName = order.State.ToString().Replace(\"BMT5_ORDER_STATE_\", \"\");\n\n    Console.WriteLine($\"{order.Ticket,-10}  {order.Symbol,-10}  {typeName,-12}  {order.PriceOpen,8:F5}  {order.VolumeInitial,6:F2}  {stateName}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#5-check-positions-for-specific-ea","title":"5) Check positions for specific EA","text":"<pre><code>// Filter positions by magic number\nvar data = await acc.OpenedOrdersAsync();\nvar eaMagic = 123456;\n\nvar eaPositions = data.PositionInfos\n    .Where(p =&gt; p.MagicNumber == eaMagic)\n    .ToList();\n\nConsole.WriteLine($\"Positions for EA {eaMagic}: {eaPositions.Count}\");\n\nforeach (var pos in eaPositions)\n{\n    Console.WriteLine($\"  {pos.Symbol} - Ticket: {pos.Ticket}, Profit: {pos.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#6-monitor-positions-by-symbol","title":"6) Monitor positions by symbol","text":"<pre><code>// Group positions by symbol\nvar data = await acc.OpenedOrdersAsync();\n\nvar bySymbol = data.PositionInfos\n    .GroupBy(p =&gt; p.Symbol)\n    .OrderByDescending(g =&gt; g.Sum(p =&gt; Math.Abs(p.Volume)));\n\nConsole.WriteLine(\"=== EXPOSURE BY SYMBOL ===\");\nConsole.WriteLine(\"Symbol      Positions  Total Volume   Net P&amp;L\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var group in bySymbol)\n{\n    var count = group.Count();\n    var totalVolume = group.Sum(p =&gt; p.Volume);\n    var totalPL = group.Sum(p =&gt; p.Profit);\n\n    Console.WriteLine($\"{group.Key,-10}  {count,8}  {totalVolume,12:F2}  {totalPL,10:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#7-check-order-expiration","title":"7) Check order expiration","text":"<pre><code>// Find orders expiring soon\nvar data = await acc.OpenedOrdersAsync();\nvar warningMinutes = 30;\n\nConsole.WriteLine($\"Orders expiring within {warningMinutes} minutes:\");\n\nforeach (var order in data.OpenedOrders)\n{\n    if (order.TimeExpiration != null &amp;&amp; order.TimeExpiration.Seconds &gt; 0)\n    {\n        var expirationTime = DateTimeOffset.FromUnixTimeSeconds(order.TimeExpiration.Seconds).DateTime;\n        var timeLeft = expirationTime - DateTime.UtcNow;\n\n        if (timeLeft.TotalMinutes &gt; 0 &amp;&amp; timeLeft.TotalMinutes &lt;= warningMinutes)\n        {\n            Console.WriteLine($\"  Ticket {order.Ticket}: {order.Symbol} expires in {timeLeft.TotalMinutes:F0} min\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrders/#8-sort-by-newest-positions-first","title":"8) Sort by newest positions first","text":"<pre><code>// Get most recent positions\nvar data = await acc.OpenedOrdersAsync(\n    sortMode: BMT5_ENUM_OPENED_ORDER_SORT_TYPE.BMT5_OPENED_ORDER_SORT_BY_OPEN_TIME_DESC);\n\nConsole.WriteLine(\"=== LATEST POSITIONS (newest first) ===\");\n\nforeach (var pos in data.PositionInfos.Take(5))\n{\n    var openTime = DateTimeOffset.FromUnixTimeSeconds(pos.OpenTime.Seconds).DateTime;\n    var type = pos.Type == BMT5_ENUM_POSITION_TYPE.BMT5_POSITION_TYPE_BUY ? \"BUY\" : \"SELL\";\n\n    Console.WriteLine($\"{openTime:yyyy-MM-dd HH:mm:ss} - {pos.Symbol} {type} {pos.Volume:F2} @ {pos.PriceOpen:F5}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/","title":"\u2705 Getting Ticket IDs of Opened Orders &amp; Positions","text":"<p>Request: list of ticket IDs for all opened orders and positions from MT5. Get lightweight snapshot with just ticket numbers (no detailed data).</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OpenedOrdersTicketsAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>OpenedOrdersTickets</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>OpenedOrdersTickets(OpenedOrdersTicketsRequest) \u2192 OpenedOrdersTicketsReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.OpenedOrdersTickets(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OpenedOrdersTicketsData&gt; OpenedOrdersTicketsAsync(\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OpenedOrdersTicketsRequest {}</code> (empty - no parameters)</p> <p>Reply message:</p> <p><code>OpenedOrdersTicketsReply { data: OpenedOrdersTicketsData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#input","title":"\ud83d\udd3d Input","text":"<p>No required parameters.</p> Parameter Type Description <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#output-openedordersticketsdata","title":"\u2b06\ufe0f Output \u2014 <code>OpenedOrdersTicketsData</code>","text":"Field Type Description <code>OpenedOrdersTickets</code> <code>List&lt;long&gt;</code> List of ticket IDs for pending orders <code>OpenedPositionTickets</code> <code>List&lt;long&gt;</code> List of ticket IDs for open positions"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning only ticket IDs of active orders and positions.</li> <li>Why you need it. Fast lightweight check for active trades, verify specific tickets exist, iterate through tickets.</li> <li>Performance advantage. Much faster than <code>OpenedOrdersAsync()</code> - returns only IDs, not full details.</li> <li>Two lists. Pending order tickets and open position tickets (separate).</li> <li>Use case. When you need to know WHICH trades exist, not the full details.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Quickly check which order/position tickets are currently active.</li> <li>Verify if a specific ticket ID still exists (before modifying/closing).</li> <li>Get list of tickets for batch operations.</li> <li>Iterate through tickets and fetch details only for specific ones.</li> <li>Monitor ticket count changes without fetching full data.</li> <li>Check if an EA's orders/positions are still active (by ticket ID).</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Much faster than <code>OpenedOrdersAsync()</code> - returns only ticket IDs (long integers).</li> <li>Use this method before fetching full details to reduce data transfer.</li> <li><code>OpenedOrdersTickets</code> contains pending orders (not yet filled).</li> <li><code>OpenedPositionTickets</code> contains open positions (already executing).</li> <li>Empty lists mean no active orders or positions.</li> <li>Ticket IDs are unique within the account.</li> <li>Use short timeout (3-5s) - this is a fast operation.</li> <li>Combine with <code>PositionSelectByTicketAsync()</code> or similar to fetch details for specific tickets.</li> <li>Good for polling - check ticket count changes without heavy data load.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#1-get-all-active-ticket-ids","title":"1) Get all active ticket IDs","text":"<pre><code>// Retrieve ticket IDs for all active trades\nvar data = await acc.OpenedOrdersTicketsAsync(\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nConsole.WriteLine($\"Pending Orders: {data.OpenedOrdersTickets.Count} tickets\");\nConsole.WriteLine($\"Open Positions: {data.OpenedPositionTickets.Count} tickets\");\n\nif (data.OpenedOrdersTickets.Count &gt; 0)\n{\n    Console.WriteLine(\"Order Tickets: \" + string.Join(\", \", data.OpenedOrdersTickets));\n}\n\nif (data.OpenedPositionTickets.Count &gt; 0)\n{\n    Console.WriteLine(\"Position Tickets: \" + string.Join(\", \", data.OpenedPositionTickets));\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#2-check-if-specific-ticket-exists","title":"2) Check if specific ticket exists","text":"<pre><code>// Verify ticket still active before modification\nvar ticketToCheck = 123456789L;\n\nvar data = await acc.OpenedOrdersTicketsAsync();\n\nbool isPendingOrder = data.OpenedOrdersTickets.Contains(ticketToCheck);\nbool isOpenPosition = data.OpenedPositionTickets.Contains(ticketToCheck);\n\nif (isPendingOrder)\n{\n    Console.WriteLine($\"\u2705 Ticket {ticketToCheck} is a pending order\");\n}\nelse if (isOpenPosition)\n{\n    Console.WriteLine($\"\u2705 Ticket {ticketToCheck} is an open position\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Ticket {ticketToCheck} not found (closed or never existed)\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#3-monitor-ticket-changes","title":"3) Monitor ticket changes","text":"<pre><code>// Poll for ticket changes (lightweight)\nList&lt;long&gt; previousOrderTickets = null;\nList&lt;long&gt; previousPositionTickets = null;\n\nwhile (true)\n{\n    var data = await acc.OpenedOrdersTicketsAsync();\n\n    // Check for new orders\n    if (previousOrderTickets != null)\n    {\n        var newOrders = data.OpenedOrdersTickets\n            .Except(previousOrderTickets)\n            .ToList();\n\n        if (newOrders.Count &gt; 0)\n        {\n            Console.WriteLine($\"\ud83d\udcdd New pending orders: {string.Join(\", \", newOrders)}\");\n        }\n\n        var cancelledOrders = previousOrderTickets\n            .Except(data.OpenedOrdersTickets)\n            .ToList();\n\n        if (cancelledOrders.Count &gt; 0)\n        {\n            Console.WriteLine($\"\u274c Cancelled orders: {string.Join(\", \", cancelledOrders)}\");\n        }\n    }\n\n    // Check for new positions\n    if (previousPositionTickets != null)\n    {\n        var newPositions = data.OpenedPositionTickets\n            .Except(previousPositionTickets)\n            .ToList();\n\n        if (newPositions.Count &gt; 0)\n        {\n            Console.WriteLine($\"\u2705 New positions: {string.Join(\", \", newPositions)}\");\n        }\n\n        var closedPositions = previousPositionTickets\n            .Except(data.OpenedPositionTickets)\n            .ToList();\n\n        if (closedPositions.Count &gt; 0)\n        {\n            Console.WriteLine($\"\ud83d\udd1a Closed positions: {string.Join(\", \", closedPositions)}\");\n        }\n    }\n\n    previousOrderTickets = data.OpenedOrdersTickets;\n    previousPositionTickets = data.OpenedPositionTickets;\n\n    await Task.Delay(2000); // Check every 2 seconds\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#4-batch-close-all-positions","title":"4) Batch close all positions","text":"<pre><code>// Get all position tickets, then close them\nvar data = await acc.OpenedOrdersTicketsAsync();\n\nif (data.OpenedPositionTickets.Count == 0)\n{\n    Console.WriteLine(\"No positions to close\");\n    return;\n}\n\nConsole.WriteLine($\"Closing {data.OpenedPositionTickets.Count} positions...\");\n\nforeach (var ticket in data.OpenedPositionTickets)\n{\n    try\n    {\n        // Close position by ticket\n        // await acc.PositionCloseAsync(ticket);\n        Console.WriteLine($\"  Closed position {ticket}\");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"  Failed to close {ticket}: {ex.Message}\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OpenedOrdersTickets/#5-count-active-trades","title":"5) Count active trades","text":"<pre><code>// Quick count of active trades\nvar data = await acc.OpenedOrdersTicketsAsync();\n\nint totalOrders = data.OpenedOrdersTickets.Count;\nint totalPositions = data.OpenedPositionTickets.Count;\nint totalActive = totalOrders + totalPositions;\n\nConsole.WriteLine($\"Active Trading Summary:\");\nConsole.WriteLine($\"  Pending Orders:  {totalOrders}\");\nConsole.WriteLine($\"  Open Positions:  {totalPositions}\");\nConsole.WriteLine($\"  Total Active:    {totalActive}\");\n\nif (totalActive == 0)\n{\n    Console.WriteLine(\"  Status: No active trades\");\n}\nelse if (totalActive &lt; 5)\n{\n    Console.WriteLine(\"  Status: Low activity\");\n}\nelse if (totalActive &lt; 20)\n{\n    Console.WriteLine(\"  Status: Moderate activity\");\n}\nelse\n{\n    Console.WriteLine(\"  Status: High activity\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/","title":"\u2705 Getting Order History","text":"<p>Request: historical orders and deals from MT5. Get detailed history of closed/cancelled orders and executed deals within a time range with pagination support.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OrderHistoryAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>OrderHistory</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>OrderHistory(OrderHistoryRequest) \u2192 OrderHistoryReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.OrderHistory(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OrdersHistoryData&gt; OrderHistoryAsync(\n            DateTime from,\n            DateTime to,\n            BMT5_ENUM_ORDER_HISTORY_SORT_TYPE sortMode = BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.BMT5_SORT_BY_OPEN_TIME_ASC,\n            int pageNumber = 0,\n            int itemsPerPage = 0,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OrderHistoryRequest { inputFrom: Timestamp, inputTo: Timestamp, inputSortMode: enum, pageNumber: int32, itemsPerPage: int32 }</code></p> <p>Reply message:</p> <p><code>OrderHistoryReply { data: OrdersHistoryData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>from</code> <code>DateTime</code> \u2705 Start of time range (server time, not UTC) <code>to</code> <code>DateTime</code> \u2705 End of time range (server time, not UTC) <code>sortMode</code> <code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> \u274c Sort order for results (default: by open time ascending) <code>pageNumber</code> <code>int</code> \u274c Page number for pagination (0-based, default: 0 = all pages) <code>itemsPerPage</code> <code>int</code> \u274c Items per page (default: 0 = no pagination, return all) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#output-ordershistorydata","title":"\u2b06\ufe0f Output \u2014 <code>OrdersHistoryData</code>","text":"Field Type Description <code>ArrayTotal</code> <code>int32</code> Total number of history items matching criteria <code>PageNumber</code> <code>int32</code> Current page number (0-based) <code>ItemsPerPage</code> <code>int32</code> Items per page setting <code>HistoryData</code> <code>List&lt;HistoryData&gt;</code> List of history records (orders + deals)"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#related-types-and-enums-from-proto","title":"\ud83e\uddf1 Related types and enums (from proto)","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#bmt5_enum_order_history_sort_type-sort-options","title":"<code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> (Sort Options)","text":"Enum Value Value Description <code>BMT5_SORT_BY_OPEN_TIME_ASC</code> 0 Sort by open time (oldest first) <code>BMT5_SORT_BY_OPEN_TIME_DESC</code> 1 Sort by open time (newest first) <code>BMT5_SORT_BY_CLOSE_TIME_ASC</code> 2 Sort by close time (oldest first) <code>BMT5_SORT_BY_CLOSE_TIME_DESC</code> 3 Sort by close time (newest first) <code>BMT5_SORT_BY_ORDER_TICKET_ID_ASC</code> 4 Sort by ticket ID (ascending) <code>BMT5_SORT_BY_ORDER_TICKET_ID_DESC</code> 5 Sort by ticket ID (descending)"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#historydata-container-for-order-deal","title":"<code>HistoryData</code> (Container for Order + Deal)","text":"Field Type Description <code>Index</code> <code>uint32</code> Zero-based index in the result list <code>HistoryOrder</code> <code>OrderHistoryData</code> Order information (may be null) <code>HistoryDeal</code> <code>DealHistoryData</code> Deal information (may be null)"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#orderhistorydata-historical-order","title":"<code>OrderHistoryData</code> (Historical Order)","text":"Field Type Description <code>Ticket</code> <code>ulong</code> Order ticket ID <code>SetupTime</code> <code>Timestamp</code> Order setup time <code>DoneTime</code> <code>Timestamp</code> Order completion time <code>State</code> <code>BMT5_ENUM_ORDER_STATE</code> Order state (Filled, Cancelled, Expired, etc.) <code>PriceCurrent</code> <code>double</code> Market price at order time <code>PriceOpen</code> <code>double</code> Order price <code>StopLimit</code> <code>double</code> StopLimit price (for STOP_LIMIT orders) <code>StopLoss</code> <code>double</code> Stop Loss price <code>TakeProfit</code> <code>double</code> Take Profit price <code>VolumeCurrent</code> <code>double</code> Remaining volume (unfilled) <code>VolumeInitial</code> <code>double</code> Initial order volume <code>MagicNumber</code> <code>long</code> Magic number (EA identifier) <code>Type</code> <code>BMT5_ENUM_ORDER_TYPE</code> Order type (Buy, Sell, BuyLimit, etc.) <code>TimeExpiration</code> <code>Timestamp</code> Order expiration time <code>TypeFilling</code> <code>BMT5_ENUM_ORDER_TYPE_FILLING</code> Filling mode (FOK, IOC, Return, BOC) <code>TypeTime</code> <code>BMT5_ENUM_ORDER_TYPE_TIME</code> Order lifetime (GTC, DAY, SPECIFIED, etc.) <code>PositionId</code> <code>ulong</code> Position ID this order belongs to <code>Symbol</code> <code>string</code> Trading symbol <code>ExternalId</code> <code>string</code> External order identifier"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#dealhistorydata-executed-deal","title":"<code>DealHistoryData</code> (Executed Deal)","text":"Field Type Description <code>Ticket</code> <code>ulong</code> Deal ticket ID <code>Profit</code> <code>double</code> Deal profit/loss <code>Commission</code> <code>double</code> Commission charged <code>Fee</code> <code>double</code> Additional fee <code>Price</code> <code>double</code> Execution price <code>StopLoss</code> <code>double</code> Stop Loss at deal time <code>TakeProfit</code> <code>double</code> Take Profit at deal time <code>Swap</code> <code>double</code> Swap charged <code>Volume</code> <code>double</code> Deal volume (lots) <code>EntryType</code> <code>BMT5_ENUM_DEAL_ENTRY_TYPE</code> Entry type (In, Out, InOut, OutBy) <code>Time</code> <code>Timestamp</code> Deal execution time <code>Type</code> <code>BMT5_ENUM_DEAL_TYPE</code> Deal type (Buy, Sell, Balance, etc.) <code>Reason</code> <code>BMT5_ENUM_DEAL_REASON</code> Deal reason (Client, Mobile, Web, Expert) <code>PositionId</code> <code>ulong</code> Position ID this deal belongs to <code>Comment</code> <code>string</code> Deal comment <code>Symbol</code> <code>string</code> Trading symbol <code>ExternalId</code> <code>string</code> External deal identifier <code>AccountLogin</code> <code>long</code> Account login number"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#bmt5_enum_deal_type","title":"<code>BMT5_ENUM_DEAL_TYPE</code>","text":"Enum Value Value Description <code>BMT5_DEAL_TYPE_BUY</code> 0 Buy deal <code>BMT5_DEAL_TYPE_SELL</code> 1 Sell deal <code>BMT5_DEAL_TYPE_BALANCE</code> 2 Balance operation <code>BMT5_DEAL_TYPE_CREDIT</code> 3 Credit operation <code>BMT5_DEAL_TYPE_CHARGE</code> 4 Additional charge <code>BMT5_DEAL_TYPE_CORRECTION</code> 5 Correction <code>BMT5_DEAL_TYPE_BONUS</code> 6 Bonus <code>BMT5_DEAL_TYPE_COMMISSION</code> 7 Additional commission <code>BMT5_DEAL_TYPE_COMMISSION_DAILY</code> 8 Daily commission <code>BMT5_DEAL_TYPE_COMMISSION_MONTHLY</code> 9 Monthly commission <code>BMT5_DEAL_TYPE_COMMISSION_AGENT_DAILY</code> 10 Daily agent commission <code>BMT5_DEAL_TYPE_COMMISSION_AGENT_MONTHLY</code> 11 Monthly agent commission <code>BMT5_DEAL_TYPE_INTEREST</code> 12 Interest rate <code>BMT5_DEAL_TYPE_BUY_CANCELED</code> 13 Canceled buy deal <code>BMT5_DEAL_TYPE_SELL_CANCELED</code> 14 Canceled sell deal"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#bmt5_enum_deal_entry_type","title":"<code>BMT5_ENUM_DEAL_ENTRY_TYPE</code>","text":"Enum Value Value Description <code>BMT5_DEAL_ENTRY_IN</code> 0 Entry into position <code>BMT5_DEAL_ENTRY_OUT</code> 1 Exit from position <code>BMT5_DEAL_ENTRY_INOUT</code> 2 Reversal (close and open opposite) <code>BMT5_DEAL_ENTRY_OUT_BY</code> 3 Close position by opposite position"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#related-enums-from-openedordersmd","title":"Related enums from <code>OpenedOrders.md</code>:","text":"<ul> <li><code>BMT5_ENUM_ORDER_TYPE</code> (9 values) - see OpenedOrders.md</li> <li><code>BMT5_ENUM_ORDER_STATE</code> (10 values) - see OpenedOrders.md</li> <li><code>BMT5_ENUM_ORDER_TYPE_FILLING</code> (4 values) - see OpenedOrders.md</li> <li><code>BMT5_ENUM_ORDER_TYPE_TIME</code> (4 values) - see OpenedOrders.md</li> <li><code>BMT5_ENUM_DEAL_REASON</code> (4 values) - see OpenedOrders.md (similar to POSITION_REASON)</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. RPC to retrieve historical orders and deals within a time range.</li> <li>Why you need it. Analyze trading history, generate reports, calculate realized P&amp;L, audit trading activity.</li> <li>Time range required. Must specify <code>from</code> and <code>to</code> dates (server time, not UTC).</li> <li>Pagination support. Can retrieve large histories in pages using <code>pageNumber</code> and <code>itemsPerPage</code>.</li> <li>Two data types. Each <code>HistoryData</code> contains order info + corresponding deal info.</li> <li>6 sort modes. Sort by open time, close time, or ticket ID (ascending/descending).</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Generate trading history reports for a specific period.</li> <li>Calculate total realized profit/loss for a time range.</li> <li>Analyze closed positions and cancelled orders.</li> <li>Audit trading activity (who, when, what).</li> <li>Export trading history to external systems.</li> <li>Track EA performance over time (filter by magic number).</li> <li>Verify executed deals match expected orders.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>CRITICAL: <code>from</code> and <code>to</code> are server time, not UTC. Use <code>AccountSummaryData.ServerTime</code> to get current server time.</li> <li>Pagination: Set <code>pageNumber=0, itemsPerPage=0</code> to get all results (no pagination).</li> <li>Large datasets: For long time ranges, use pagination to avoid timeouts.</li> <li>Each <code>HistoryData</code> may contain order only, deal only, or both.</li> <li>Order = instruction placed (pending order that was filled/cancelled/expired).</li> <li>Deal = actual execution (buy/sell transaction that happened).</li> <li>One order can generate multiple deals (partial fills).</li> <li><code>ArrayTotal</code> shows total items matching criteria, not just current page.</li> <li>Use <code>BMT5_SORT_BY_CLOSE_TIME_DESC</code> to get most recent closed trades first.</li> <li>Filter by <code>MagicNumber</code> in your code to get EA-specific history.</li> <li><code>Profit</code> in <code>DealHistoryData</code> is realized P&amp;L (trade already closed).</li> <li><code>Commission</code>, <code>Fee</code>, and <code>Swap</code> are separate from Profit.</li> <li>Use longer timeout (10-30s) for large time ranges.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#1-get-last-7-days-history","title":"1) Get last 7 days history","text":"<pre><code>// Retrieve trading history for last week\nvar serverTime = DateTime.UtcNow; // Should get from AccountSummaryData.ServerTime\nvar from = serverTime.AddDays(-7);\nvar to = serverTime;\n\nvar history = await acc.OrderHistoryAsync(\n    from: from,\n    to: to,\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.BMT5_SORT_BY_CLOSE_TIME_DESC,\n    deadline: DateTime.UtcNow.AddSeconds(15));\n\nConsole.WriteLine($\"Total history items: {history.ArrayTotal}\");\nConsole.WriteLine($\"Retrieved: {history.HistoryData.Count} items\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#2-calculate-total-realized-pl","title":"2) Calculate total realized P&amp;L","text":"<pre><code>// Sum profits from all closed deals\nvar from = new DateTime(2024, 1, 1); // Server time\nvar to = DateTime.UtcNow;\n\nvar history = await acc.OrderHistoryAsync(from, to);\n\ndouble totalProfit = 0;\ndouble totalCommission = 0;\ndouble totalSwap = 0;\n\nforeach (var item in history.HistoryData)\n{\n    if (item.HistoryDeal != null)\n    {\n        var deal = item.HistoryDeal;\n\n        // Only count trading deals (Buy/Sell)\n        if (deal.Type == BMT5_ENUM_DEAL_TYPE.BMT5_DEAL_TYPE_BUY ||\n            deal.Type == BMT5_ENUM_DEAL_TYPE.BMT5_DEAL_TYPE_SELL)\n        {\n            totalProfit += deal.Profit;\n            totalCommission += deal.Commission;\n            totalSwap += deal.Swap;\n        }\n    }\n}\n\ndouble netPL = totalProfit - totalCommission + totalSwap;\n\nConsole.WriteLine($\"Realized Profit:  {totalProfit:F2}\");\nConsole.WriteLine($\"Total Commission: {totalCommission:F2}\");\nConsole.WriteLine($\"Total Swap:       {totalSwap:F2}\");\nConsole.WriteLine($\"Net P&amp;L:          {netPL:F2}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#3-list-closed-positions","title":"3) List closed positions","text":"<pre><code>// Show closed trades\nvar history = await acc.OrderHistoryAsync(\n    from: DateTime.UtcNow.AddDays(-30),\n    to: DateTime.UtcNow,\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.BMT5_SORT_BY_CLOSE_TIME_DESC);\n\nConsole.WriteLine(\"=== CLOSED POSITIONS (Last 30 Days) ===\");\nConsole.WriteLine(\"Date                Symbol      Type    Volume   Price      Profit\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var item in history.HistoryData)\n{\n    if (item.HistoryDeal != null)\n    {\n        var deal = item.HistoryDeal;\n\n        if (deal.Type == BMT5_ENUM_DEAL_TYPE.BMT5_DEAL_TYPE_BUY ||\n            deal.Type == BMT5_ENUM_DEAL_TYPE.BMT5_DEAL_TYPE_SELL)\n        {\n            var time = DateTimeOffset.FromUnixTimeSeconds(deal.Time.Seconds).DateTime;\n            var type = deal.Type == BMT5_ENUM_DEAL_TYPE.BMT5_DEAL_TYPE_BUY ? \"BUY \" : \"SELL\";\n\n            Console.WriteLine($\"{time:yyyy-MM-dd HH:mm}  {deal.Symbol,-10}  {type}  {deal.Volume,6:F2}  {deal.Price,8:F5}  {deal.Profit,8:F2}\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#4-pagination-example","title":"4) Pagination example","text":"<pre><code>// Retrieve large history in pages\nvar from = DateTime.UtcNow.AddMonths(-6);\nvar to = DateTime.UtcNow;\nvar itemsPerPage = 100;\nvar currentPage = 0;\nvar totalProcessed = 0;\n\nwhile (true)\n{\n    var history = await acc.OrderHistoryAsync(\n        from: from,\n        to: to,\n        pageNumber: currentPage,\n        itemsPerPage: itemsPerPage);\n\n    Console.WriteLine($\"Page {currentPage + 1}: {history.HistoryData.Count} items\");\n\n    if (history.HistoryData.Count == 0)\n        break;\n\n    // Process this page\n    foreach (var item in history.HistoryData)\n    {\n        // ... process item ...\n        totalProcessed++;\n    }\n\n    // Check if this was the last page\n    if (history.HistoryData.Count &lt; itemsPerPage)\n        break;\n\n    currentPage++;\n}\n\nConsole.WriteLine($\"Total processed: {totalProcessed} items\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/OrderHistory/#5-filter-by-ea-magic-number","title":"5) Filter by EA magic number","text":"<pre><code>// Get history for specific EA\nvar eaMagic = 123456L;\nvar history = await acc.OrderHistoryAsync(\n    from: DateTime.UtcNow.AddDays(-7),\n    to: DateTime.UtcNow);\n\nvar eaOrders = history.HistoryData\n    .Where(h =&gt; h.HistoryOrder != null &amp;&amp; h.HistoryOrder.MagicNumber == eaMagic)\n    .ToList();\n\nConsole.WriteLine($\"Orders from EA {eaMagic}: {eaOrders.Count}\");\n\nforeach (var item in eaOrders)\n{\n    var order = item.HistoryOrder;\n    var setupTime = DateTimeOffset.FromUnixTimeSeconds(order.SetupTime.Seconds).DateTime;\n    var state = order.State.ToString().Replace(\"BMT5_ORDER_STATE_\", \"\");\n\n    Console.WriteLine($\"  {setupTime:yyyy-MM-dd HH:mm} - Ticket {order.Ticket}: {order.Symbol} {state}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/","title":"MT5Account \u00b7 Positions &amp; Orders Information - Overview","text":"<p>Open positions, pending orders, order history, and position history. Use this page to choose the right API for accessing trading activity.</p>"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>PositionsTotal - count of currently open positions.</li> <li>OpenedOrders - detailed list of all open positions and pending orders.</li> <li>OpenedOrdersTickets - lightweight list of tickets only (no full details).</li> <li>OrderHistory - historical orders and deals within time range (with pagination).</li> <li>PositionsHistory - closed positions within time range (with pagination).</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>PositionsTotal \u2192 quick count of how many positions are open right now.</li> <li>OpenedOrders \u2192 full details of all active positions + pending orders (24 fields per order!).</li> <li>OpenedOrdersTickets \u2192 just ticket IDs for positions/orders (fast, lightweight).</li> <li>OrderHistory \u2192 browse past orders and deals with time filter and pagination.</li> <li>PositionsHistory \u2192 browse closed positions with profit/loss info.</li> </ul> <p>Rule of thumb: need quick count \u2192 <code>PositionsTotalAsync</code>; need full details \u2192 <code>OpenedOrdersAsync</code>; need just tickets \u2192 <code>OpenedOrdersTicketsAsync</code>; need history \u2192 OrderHistory/PositionsHistory.</p>"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns Key inputs Just count of open positions <code>PositionsTotalAsync</code> <code>int</code> (none) Full details of positions + pending orders <code>OpenedOrdersAsync</code> List of positions + orders Sort mode (optional) Just ticket IDs (lightweight) <code>OpenedOrdersTicketsAsync</code> Two lists of tickets (none) Historical orders and deals <code>OrderHistoryAsync</code> Paginated order history Time range + pagination params Closed positions with P/L <code>PositionsHistoryAsync</code> List of closed positions Time range + pagination params"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>PositionInfo has 20 fields including profit, swap, commission, magic number.</li> <li>OpenedOrderInfo has 24 fields including state, type, volumes, expiration.</li> <li>Tickets are unique identifiers - use them to modify/close positions.</li> <li>History is paginated - use PageNumber and ItemsPerPage for large datasets.</li> <li>Sort modes affect order of results - choose based on your use case.</li> <li>Magic numbers help identify EA-placed orders vs manual trades.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Quick check: how many positions are open?\nvar totalData = await account.PositionsTotalAsync();\nConsole.WriteLine($\"Open positions: {totalData.TotalPositions}\");\n</code></pre> <pre><code>// Get full details of all positions and orders\nvar data = await account.OpenedOrdersAsync();\nforeach (var position in data.PositionInfos)\n{\n    Console.WriteLine($\"Position #{position.Ticket} {position.Symbol} - P/L: ${position.Profit:F2}\");\n}\nforeach (var order in data.OpenedOrders)\n{\n    Console.WriteLine($\"Pending Order #{order.Ticket} {order.Symbol} @ {order.PriceOpen:F5}\");\n}\n</code></pre> <pre><code>// Get just ticket IDs (fast and lightweight)\nvar tickets = await account.OpenedOrdersTicketsAsync();\nConsole.WriteLine($\"Position tickets: {string.Join(\", \", tickets.OpenedPositionTickets)}\");\nConsole.WriteLine($\"Order tickets: {string.Join(\", \", tickets.OpenedOrdersTickets)}\");\n</code></pre> <pre><code>// Get order history for last 7 days\nvar from = DateTime.Now.AddDays(-7);\nvar to = DateTime.Now;\nvar history = await account.OrderHistoryAsync(from, to,\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc);\n\nConsole.WriteLine($\"Total history records: {history.ArrayTotal}\");\nforeach (var record in history.HistoryData)\n{\n    if (record.HistoryDeal != null)\n    {\n        Console.WriteLine($\"Deal #{record.HistoryDeal.Ticket} - Profit: ${record.HistoryDeal.Profit:F2}\");\n    }\n}\n</code></pre> <pre><code>// Get closed positions history\nvar from = DateTime.Now.AddDays(-30);\nvar to = DateTime.Now;\nvar closedPositions = await account.PositionsHistoryAsync(from, to);\n\nforeach (var pos in closedPositions.HistoryPositions)\n{\n    Console.WriteLine($\"Closed: {pos.Symbol} - P/L: ${pos.Profit:F2}, Duration: {pos.CloseTime.ToDateTime() - pos.OpenTime.ToDateTime()}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/Position_Orders_Information.Overview/#see-also","title":"See also","text":"<ul> <li>Trading: OrderSend - open new positions</li> <li>Trading: OrderModify - modify existing orders/positions</li> <li>Trading: OrderClose - close positions</li> <li>Streaming: OnTrade - real-time position/order updates</li> <li>Streaming: OnPositionsAndPendingOrdersTickets - real-time ticket updates</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/","title":"\u2705 Getting Positions History","text":"<p>Request: historical closed positions from MT5. Get aggregated view of closed positions (not individual orders/deals) with P&amp;L summary.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.PositionsHistoryAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>PositionsHistory</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>PositionsHistory(PositionsHistoryRequest) \u2192 PositionsHistoryReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.PositionsHistory(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;PositionsHistoryData&gt; PositionsHistoryAsync(\n            AH_ENUM_POSITIONS_HISTORY_SORT_TYPE sortType = AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AH_POSITION_OPEN_TIME_ASC,\n            DateTime? positionOpenTimeFrom = null,\n            DateTime? positionOpenTimeTo = null,\n            int? pageNumber = null,\n            int? itemsPerPage = null,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>PositionsHistoryRequest { sort_type: enum, position_open_time_from: Timestamp?, position_open_time_to: Timestamp?, page_number: int32?, items_per_page: int32? }</code></p> <p>Reply message:</p> <p><code>PositionsHistoryReply { data: PositionsHistoryData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Required Description <code>sortType</code> <code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> \u274c Sort order for results (default: by open time ascending) <code>positionOpenTimeFrom</code> <code>DateTime?</code> \u274c Filter: minimum position open time (server time) <code>positionOpenTimeTo</code> <code>DateTime?</code> \u274c Filter: maximum position open time (server time) <code>pageNumber</code> <code>int?</code> \u274c Page number for pagination (0-based, null = no pagination) <code>itemsPerPage</code> <code>int?</code> \u274c Items per page (null = no pagination, return all) <code>deadline</code> <code>DateTime?</code> \u274c Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> \u274c Cooperative cancel for the call/retry loop"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#output-positionshistorydata","title":"\u2b06\ufe0f Output \u2014 <code>PositionsHistoryData</code>","text":"Field Type Description <code>HistoryPositions</code> <code>List&lt;PositionHistoryInfo&gt;</code> List of closed positions"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#related-types-and-enums-from-proto","title":"\ud83e\uddf1 Related types and enums (from proto)","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#ah_enum_positions_history_sort_type-sort-options","title":"<code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> (Sort Options)","text":"Enum Value Value Description <code>AH_POSITION_OPEN_TIME_ASC</code> 0 Sort by open time (oldest first) <code>AH_POSITION_OPEN_TIME_DESC</code> 1 Sort by open time (newest first) <code>AH_POSITION_TICKET_ASC</code> 2 Sort by ticket ID (ascending) <code>AH_POSITION_TICKET_DESC</code> 3 Sort by ticket ID (descending)"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#positionhistoryinfo-closed-position-summary","title":"<code>PositionHistoryInfo</code> (Closed Position Summary)","text":"Field Type Description <code>Index</code> <code>int32</code> Zero-based index in the result list <code>PositionTicket</code> <code>ulong</code> Position ticket ID <code>OrderType</code> <code>AH_ENUM_POSITIONS_HISTORY_ORDER_TYPE</code> Position type (Buy, Sell, etc.) <code>OpenTime</code> <code>Timestamp</code> Position open time <code>CloseTime</code> <code>Timestamp</code> Position close time <code>Volume</code> <code>double</code> Position volume (lots) <code>OpenPrice</code> <code>double</code> Entry price <code>ClosePrice</code> <code>double</code> Exit price <code>StopLoss</code> <code>double</code> Stop Loss price (at close) <code>TakeProfit</code> <code>double</code> Take Profit price (at close) <code>MarketValue</code> <code>double</code> Market value of position <code>Commission</code> <code>double</code> Total commission charged <code>Fee</code> <code>double</code> Additional fees <code>Profit</code> <code>double</code> Net profit/loss (realized) <code>Swap</code> <code>double</code> Swap charged/earned <code>Comment</code> <code>string</code> Position comment <code>Symbol</code> <code>string</code> Trading symbol <code>Magic</code> <code>long</code> Magic number (EA identifier)"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#ah_enum_positions_history_order_type","title":"<code>AH_ENUM_POSITIONS_HISTORY_ORDER_TYPE</code>","text":"Enum Value Value Description <code>AH_ORDER_TYPE_BUY</code> 0 Market Buy order <code>AH_ORDER_TYPE_SELL</code> 1 Market Sell order <code>AH_ORDER_TYPE_BUY_LIMIT</code> 2 Buy Limit pending order <code>AH_ORDER_TYPE_SELL_LIMIT</code> 3 Sell Limit pending order <code>AH_ORDER_TYPE_BUY_STOP</code> 4 Buy Stop pending order <code>AH_ORDER_TYPE_SELL_STOP</code> 5 Sell Stop pending order <code>AH_ORDER_TYPE_BUY_STOP_LIMIT</code> 6 Upon reaching order price, Buy Limit placed at StopLimit price <code>AH_ORDER_TYPE_SELL_STOP_LIMIT</code> 7 Upon reaching order price, Sell Limit placed at StopLimit price <code>AH_ORDER_TYPE_CLOSE_BY</code> 8 Order to close position by opposite one"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. RPC to retrieve closed positions aggregated by position ticket.</li> <li>Why you need it. Simpler than <code>OrderHistoryAsync()</code> - returns positions (not individual orders/deals).</li> <li>Key difference. <code>OrderHistory</code> = raw orders + deals. <code>PositionsHistory</code> = aggregated closed positions.</li> <li>One record per position. Each <code>PositionHistoryInfo</code> represents one complete position lifecycle (open \u2192 close).</li> <li>Optional filtering. Can filter by position open time range.</li> <li>Pagination support. Handle large histories efficiently.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Get clean list of closed positions (not raw orders/deals).</li> <li>Calculate total P&amp;L for closed positions.</li> <li>Analyze trading performance by position.</li> <li>Generate position-based reports (not order-based).</li> <li>Track EA performance (filter by magic number).</li> <li>Display closed trades in UI (simpler than parsing OrderHistory).</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Position-centric view - each record is one complete position (open to close).</li> <li>Contrast with <code>OrderHistoryAsync()</code> which returns individual orders and deals.</li> <li>Time filters are for position open time (not close time).</li> <li>Use <code>null</code> for time filters to get all closed positions.</li> <li><code>Profit</code> includes all P&amp;L from position open to close (net result).</li> <li><code>Commission</code>, <code>Fee</code>, and <code>Swap</code> are separate from Profit (not included).</li> <li>Net P&amp;L = <code>Profit - Commission - Fee + Swap</code> (Swap can be positive or negative).</li> <li>For netting accounts: positions are netted per symbol.</li> <li>For hedging accounts: multiple positions per symbol possible.</li> <li>Use <code>sortType</code> to get most recent positions first: <code>AH_POSITION_OPEN_TIME_DESC</code>.</li> <li>Filter by <code>Magic</code> in your code to get EA-specific positions.</li> <li>Use pagination for large datasets (months/years of trading).</li> <li>Much faster than <code>OrderHistoryAsync()</code> for position-level analysis.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#1-get-all-closed-positions","title":"1) Get all closed positions","text":"<pre><code>// Retrieve all closed positions (no time filter)\nvar positions = await acc.PositionsHistoryAsync(\n    sortType: AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AH_POSITION_OPEN_TIME_DESC,\n    deadline: DateTime.UtcNow.AddSeconds(10));\n\nConsole.WriteLine($\"Total closed positions: {positions.HistoryPositions.Count}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#2-get-positions-from-last-30-days","title":"2) Get positions from last 30 days","text":"<pre><code>// Filter by position open time\nvar from = DateTime.UtcNow.AddDays(-30); // Server time\nvar to = DateTime.UtcNow;\n\nvar positions = await acc.PositionsHistoryAsync(\n    positionOpenTimeFrom: from,\n    positionOpenTimeTo: to,\n    sortType: AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AH_POSITION_OPEN_TIME_DESC);\n\nConsole.WriteLine($\"Positions from last 30 days: {positions.HistoryPositions.Count}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#3-calculate-total-realized-pl","title":"3) Calculate total realized P&amp;L","text":"<pre><code>// Sum all closed position profits\nvar positions = await acc.PositionsHistoryAsync();\n\ndouble totalProfit = 0;\ndouble totalCommission = 0;\ndouble totalSwap = 0;\ndouble totalFee = 0;\n\nforeach (var pos in positions.HistoryPositions)\n{\n    totalProfit += pos.Profit;\n    totalCommission += pos.Commission;\n    totalSwap += pos.Swap;\n    totalFee += pos.Fee;\n}\n\ndouble netPL = totalProfit - totalCommission - totalFee + totalSwap;\n\nConsole.WriteLine($\"Total Profit:     {totalProfit:F2}\");\nConsole.WriteLine($\"Total Commission: {totalCommission:F2}\");\nConsole.WriteLine($\"Total Fee:        {totalFee:F2}\");\nConsole.WriteLine($\"Total Swap:       {totalSwap:F2}\");\nConsole.WriteLine($\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\nConsole.WriteLine($\"Net P&amp;L:          {netPL:F2}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#4-display-closed-positions-table","title":"4) Display closed positions table","text":"<pre><code>// Show recent closed positions\nvar positions = await acc.PositionsHistoryAsync(\n    sortType: AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AH_POSITION_OPEN_TIME_DESC,\n    positionOpenTimeFrom: DateTime.UtcNow.AddDays(-7));\n\nConsole.WriteLine(\"=== CLOSED POSITIONS (Last 7 Days) ===\");\nConsole.WriteLine(\"Ticket      Symbol      Type  Volume   Open       Close      Profit\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var pos in positions.HistoryPositions)\n{\n    var type = pos.OrderType == AH_ENUM_POSITIONS_HISTORY_ORDER_TYPE.AH_ORDER_TYPE_BUY ? \"BUY \" : \"SELL\";\n    var openTime = DateTimeOffset.FromUnixTimeSeconds(pos.OpenTime.Seconds).DateTime;\n\n    Console.WriteLine($\"{pos.PositionTicket,-10}  {pos.Symbol,-10}  {type}  {pos.Volume,6:F2}  {pos.OpenPrice,8:F5}  {pos.ClosePrice,8:F5}  {pos.Profit,8:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#5-analyze-winning-vs-losing-positions","title":"5) Analyze winning vs losing positions","text":"<pre><code>// Calculate win rate\nvar positions = await acc.PositionsHistoryAsync(\n    positionOpenTimeFrom: DateTime.UtcNow.AddMonths(-1));\n\nint winners = 0;\nint losers = 0;\ndouble winningPL = 0;\ndouble losingPL = 0;\n\nforeach (var pos in positions.HistoryPositions)\n{\n    double netPL = pos.Profit - pos.Commission - pos.Fee + pos.Swap;\n\n    if (netPL &gt; 0)\n    {\n        winners++;\n        winningPL += netPL;\n    }\n    else if (netPL &lt; 0)\n    {\n        losers++;\n        losingPL += netPL;\n    }\n}\n\nint total = winners + losers;\ndouble winRate = total &gt; 0 ? (double)winners / total * 100 : 0;\ndouble avgWin = winners &gt; 0 ? winningPL / winners : 0;\ndouble avgLoss = losers &gt; 0 ? losingPL / losers : 0;\n\nConsole.WriteLine($\"Trading Statistics (Last Month):\");\nConsole.WriteLine($\"  Total Positions:  {total}\");\nConsole.WriteLine($\"  Winners:          {winners} ({winRate:F1}%)\");\nConsole.WriteLine($\"  Losers:           {losers}\");\nConsole.WriteLine($\"  Average Win:      {avgWin:F2}\");\nConsole.WriteLine($\"  Average Loss:     {avgLoss:F2}\");\nConsole.WriteLine($\"  Profit Factor:    {(Math.Abs(losingPL) &gt; 0 ? winningPL / Math.Abs(losingPL) : 0):F2}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#6-filter-by-ea-magic-number","title":"6) Filter by EA magic number","text":"<pre><code>// Get positions for specific EA\nvar eaMagic = 123456L;\nvar positions = await acc.PositionsHistoryAsync();\n\nvar eaPositions = positions.HistoryPositions\n    .Where(p =&gt; p.Magic == eaMagic)\n    .ToList();\n\ndouble eaPL = eaPositions.Sum(p =&gt; p.Profit - p.Commission - p.Fee + p.Swap);\n\nConsole.WriteLine($\"EA {eaMagic} Performance:\");\nConsole.WriteLine($\"  Closed Positions: {eaPositions.Count}\");\nConsole.WriteLine($\"  Net P&amp;L:          {eaPL:F2}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#7-group-by-symbol","title":"7) Group by symbol","text":"<pre><code>// Analyze performance by symbol\nvar positions = await acc.PositionsHistoryAsync(\n    positionOpenTimeFrom: DateTime.UtcNow.AddMonths(-3));\n\nvar bySymbol = positions.HistoryPositions\n    .GroupBy(p =&gt; p.Symbol)\n    .Select(g =&gt; new\n    {\n        Symbol = g.Key,\n        Count = g.Count(),\n        TotalPL = g.Sum(p =&gt; p.Profit - p.Commission - p.Fee + p.Swap),\n        AvgPL = g.Average(p =&gt; p.Profit - p.Commission - p.Fee + p.Swap)\n    })\n    .OrderByDescending(x =&gt; x.TotalPL);\n\nConsole.WriteLine(\"=== PERFORMANCE BY SYMBOL ===\");\nConsole.WriteLine(\"Symbol      Trades    Total P&amp;L    Avg P&amp;L\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var item in bySymbol)\n{\n    Console.WriteLine($\"{item.Symbol,-10}  {item.Count,5}  {item.TotalPL,12:F2}  {item.AvgPL,10:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsHistory/#8-pagination-for-large-histories","title":"8) Pagination for large histories","text":"<pre><code>// Retrieve large history in pages\nvar itemsPerPage = 50;\nvar currentPage = 0;\nvar allPositions = new List&lt;PositionHistoryInfo&gt;();\n\nwhile (true)\n{\n    var positions = await acc.PositionsHistoryAsync(\n        pageNumber: currentPage,\n        itemsPerPage: itemsPerPage,\n        sortType: AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AH_POSITION_OPEN_TIME_DESC);\n\n    Console.WriteLine($\"Page {currentPage + 1}: {positions.HistoryPositions.Count} positions\");\n\n    if (positions.HistoryPositions.Count == 0)\n        break;\n\n    allPositions.AddRange(positions.HistoryPositions);\n\n    if (positions.HistoryPositions.Count &lt; itemsPerPage)\n        break; // Last page\n\n    currentPage++;\n}\n\nConsole.WriteLine($\"Total positions retrieved: {allPositions.Count}\");\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/","title":"\u2705 Getting Total Number of Open Positions","text":"<p>Request: count of open positions from MT5. Get the total number of currently open positions on the account.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.PositionsTotalAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.TradeFunctions</code></li> <li>Proto definition: <code>PositionsTotal</code> (defined in <code>mt5-term-api-trade-functions.proto</code>)</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.TradeFunctions</code></li> <li>Method: <code>PositionsTotal(google.protobuf.Empty) \u2192 PositionsTotalReply</code></li> <li>Low\u2011level client (generated): <code>TradeFunctions.PositionsTotal(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;PositionsTotalData&gt; PositionsTotalAsync(\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>google.protobuf.Empty {}</code> (no parameters)</p> <p>Reply message:</p> <p><code>PositionsTotalReply { data: PositionsTotalData }</code> or <code>{ error: Error }</code></p>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#input","title":"\ud83d\udd3d Input","text":"<p>No required parameters.</p> Parameter Type Description <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#output-positionstotaldata","title":"\u2b06\ufe0f Output \u2014 <code>PositionsTotalData</code>","text":"Field Type Description <code>TotalPositions</code> <code>int32</code> Total number of currently open positions"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Single RPC returning the count of open positions.</li> <li>Why you need it. Check if account has open positions, verify positions were opened/closed, iterate through positions.</li> <li>Fast check. Lightweight operation to quickly see if there are any open trades.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use this method when you need to:</p> <ul> <li>Check if there are any open positions before performing operations.</li> <li>Verify that a position was successfully opened (count increases).</li> <li>Confirm that a position was closed (count decreases).</li> <li>Determine if you need to fetch detailed position information.</li> <li>Monitor position count for risk management.</li> <li>Iterate through positions using count + index (with other methods).</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Returns only open positions, not pending orders.</li> <li>Count includes positions across all symbols.</li> <li>Use <code>OpenedOrdersAsync()</code> to get detailed information about each position.</li> <li>Fast operation - use short timeout (3-5s).</li> <li>For hedging accounts, same symbol can have multiple positions (buy + sell).</li> <li>For netting accounts, one symbol = one net position (buy or sell, not both).</li> <li>Does not include closed/historical positions.</li> </ul>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#1-check-if-account-has-open-positions","title":"1) Check if account has open positions","text":"<pre><code>// Quick check for open positions\nvar result = await acc.PositionsTotalAsync(\n    deadline: DateTime.UtcNow.AddSeconds(3));\n\nif (result.TotalPositions &gt; 0)\n{\n    Console.WriteLine($\"\u2705 Account has {result.TotalPositions} open position(s)\");\n}\nelse\n{\n    Console.WriteLine(\"No open positions\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#2-verify-position-was-opened","title":"2) Verify position was opened","text":"<pre><code>// Count before opening position\nvar beforeCount = await acc.PositionsTotalAsync();\nConsole.WriteLine($\"Positions before: {beforeCount.TotalPositions}\");\n\n// Open a position...\n// await acc.OrderSendAsync(...);\n\n// Count after\nvar afterCount = await acc.PositionsTotalAsync();\nConsole.WriteLine($\"Positions after:  {afterCount.TotalPositions}\");\n\nif (afterCount.TotalPositions &gt; beforeCount.TotalPositions)\n{\n    Console.WriteLine(\"\u2705 Position opened successfully\");\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#3-monitor-for-position-changes","title":"3) Monitor for position changes","text":"<pre><code>// Poll for position count changes\nint previousCount = -1;\n\nwhile (true)\n{\n    var current = await acc.PositionsTotalAsync();\n\n    if (current.TotalPositions != previousCount)\n    {\n        Console.WriteLine($\"Position count changed: {previousCount} \u2192 {current.TotalPositions}\");\n        previousCount = current.TotalPositions;\n    }\n\n    await Task.Delay(1000); // Check every second\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#4-wait-for-all-positions-to-close","title":"4) Wait for all positions to close","text":"<pre><code>// Wait until all positions are closed\nConsole.WriteLine(\"Waiting for all positions to close...\");\n\nwhile (true)\n{\n    var result = await acc.PositionsTotalAsync();\n\n    if (result.TotalPositions == 0)\n    {\n        Console.WriteLine(\"\u2705 All positions closed\");\n        break;\n    }\n\n    Console.WriteLine($\"  {result.TotalPositions} position(s) still open...\");\n    await Task.Delay(2000);\n}\n</code></pre>"},{"location":"MT5Account/3.%20Position_Orders_Information/PositionsTotal/#5-check-before-trading-operations","title":"5) Check before trading operations","text":"<pre><code>// Verify position limits before opening new position\nvar maxPositions = 10; // Your risk limit\n\nvar current = await acc.PositionsTotalAsync();\n\nif (current.TotalPositions &gt;= maxPositions)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Max positions reached ({current.TotalPositions}/{maxPositions})\");\n    Console.WriteLine(\"Cannot open new position\");\n    return;\n}\n\nConsole.WriteLine($\"\u2705 Can open position ({current.TotalPositions}/{maxPositions})\");\n// Proceed with trading...\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/","title":"\u2705 Calculating Required Margin (<code>OrderCalcMarginAsync</code>)","text":"<p>Request: Calculate the margin required to open a trade with given parameters on MT5. Returns required margin in account currency.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OrderCalcMarginAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.TradeFunctions</code></li> <li>Proto definition: <code>OrderCalcMargin</code> (defined in <code>mt5-term-api-trade-functions.proto</code>)</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.TradeFunctions</code></li> <li>Method: <code>OrderCalcMargin(OrderCalcMarginRequest) \u2192 OrderCalcMarginReply</code></li> <li>Low\u2011level client (generated): <code>TradeFunctions.TradeFunctionsClient.OrderCalcMargin(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OrderCalcMarginData&gt; OrderCalcMarginAsync(\n            OrderCalcMarginRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OrderCalcMarginRequest { symbol, order_type, volume, open_price }</code></p> <p>Reply message:</p> <p><code>OrderCalcMarginReply { data: OrderCalcMarginData }</code></p>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>OrderCalcMarginRequest</code> Protobuf request with symbol, order type, volume, price <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#ordercalcmarginrequest","title":"<code>OrderCalcMarginRequest</code>","text":"Field Type Description <code>Symbol</code> <code>string</code> Trading symbol (<code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>, etc.) <code>OrderType</code> <code>ENUM_ORDER_TYPE_TF</code> Order type (Buy, Sell, BuyLimit, SellStop, etc.) <code>Volume</code> <code>double</code> Trade volume in lots (respect symbol min/max/step) <code>OpenPrice</code> <code>double</code> Planned open price (use current Bid/Ask for market)"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#output-ordercalcmargindata","title":"\u2b06\ufe0f Output \u2014 <code>OrderCalcMarginData</code>","text":"Field Type Description <code>Margin</code> <code>double</code> Required margin in account currency"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#enum_order_type_tf","title":"<code>ENUM_ORDER_TYPE_TF</code>","text":"<ul> <li><code>OrderTypeTfBuy</code> \u2014 Market Buy order</li> <li><code>OrderTypeTfSell</code> \u2014 Market Sell order</li> <li><code>OrderTypeTfBuyLimit</code> \u2014 Buy Limit pending order</li> <li><code>OrderTypeTfSellLimit</code> \u2014 Sell Limit pending order</li> <li><code>OrderTypeTfBuyStop</code> \u2014 Buy Stop pending order</li> <li><code>OrderTypeTfSellStop</code> \u2014 Sell Stop pending order</li> <li><code>OrderTypeTfBuyStopLimit</code> \u2014 Buy Stop Limit order</li> <li><code>OrderTypeTfSellStopLimit</code> \u2014 Sell Stop Limit order</li> <li><code>OrderTypeTfCloseBy</code> \u2014 Close position by opposite one</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Calculates required margin for a planned trade with given symbol, order type, volume and price.</li> <li>Why you need it. Validate free margin before sending orders; implement dynamic position sizing based on risk %.</li> <li>Sanity check. If <code>Margin</code> \u2264 <code>AccountFreeMargin</code> \u2192 trade is feasible.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to calculate margin requirements:</p> <ul> <li>Check if planned lot size is feasible.</li> <li>Implement risk\u2011based lot sizing (e.g. \"2% of balance per trade\").</li> <li>Pre\u2011compute margin impact for basket trades.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Server calculation: Margin depends on leverage, contract size, account currency, broker settings. Let MT5 server calculate it.</li> <li>Market orders: Use current Bid/Ask as <code>OpenPrice</code> (Buy \u2192 ask, Sell \u2192 bid).</li> <li>Same parameters: Pass same <code>OrderType</code>/<code>Volume</code>/<code>OpenPrice</code> that you'll use in <code>OrderSendAsync</code>.</li> <li>Combine with OrderCheck: Use <code>OrderCalcMargin</code> for margin impact, <code>OrderCheck</code> for full trade validation.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#1-basic-margin-calculation-for-a-market-buy","title":"1) Basic margin calculation for a market BUY","text":"<pre><code>// acc \u2014 connected MT5Account\n\n// Get current tick for default symbol\nvar tick = await acc.SymbolInfoTickAsync(Constants.DefaultSymbol);\n\nvar margin = await acc.OrderCalcMarginAsync(new OrderCalcMarginRequest\n{\n    Symbol    = Constants.DefaultSymbol,\n    OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n    Volume    = Constants.DefaultVolume,\n    OpenPrice = tick.Ask\n});\n\nConsole.WriteLine($\"Required margin: {margin.Margin:F2}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#2-check-if-we-have-enough-free-margin-for-a-planned-trade","title":"2) Check if we have enough free margin for a planned trade","text":"<pre><code>async Task&lt;bool&gt; HasEnoughMarginAsync(MT5Account acc, string symbol, double lots)\n{\n    var tick = await acc.SymbolInfoTickAsync(symbol);\n\n    var margin = await acc.OrderCalcMarginAsync(new OrderCalcMarginRequest\n    {\n        Symbol    = symbol,\n        OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n        Volume    = lots,\n        OpenPrice = tick.Ask\n    });\n\n    var accountInfo = await acc.AccountSummaryAsync();\n    var freeMargin  = accountInfo.FreeMargin;\n\n    Console.WriteLine($\"Free margin: {freeMargin:F2}, required: {margin.Margin:F2}\");\n\n    return freeMargin &gt;= margin.Margin;\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCalcMargin/#3-simple-riskbased-lot-sizing","title":"3) Simple risk\u2011based lot sizing","text":"<pre><code>// Example: risk up to 2% of balance on this trade\n\nasync Task&lt;double&gt; CalculateLotsByRiskAsync(MT5Account acc, string symbol, double stopLossPoints, double riskPercent)\n{\n    var account = await acc.AccountSummaryAsync();\n    var balance = account.Balance;\n\n    var tick = await acc.SymbolInfoTickAsync(symbol);\n\n    // Start with 0.01 lot and scale up while margin is acceptable\n    double lotStep = 0.01;\n    double lots    = lotStep;\n\n    while (true)\n    {\n        var marginData = await acc.OrderCalcMarginAsync(new OrderCalcMarginRequest\n        {\n            Symbol    = symbol,\n            OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n            Volume    = lots,\n            OpenPrice = tick.Ask\n        });\n\n        // Simple cap: margin must not exceed (riskPercent of balance * 10) for example\n        if (marginData.Margin &gt; balance * (riskPercent / 100.0) * 10.0)\n            break;\n\n        lots += lotStep;\n    }\n\n    // Round down to broker\u2019s volume step in production code\n    return Math.Max(lotStep, lots - lotStep);\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/","title":"\u2705 Validating Trade Requests (<code>OrderCheckAsync</code>)","text":"<p>Request: Run a dry\u2011run check of a trade request on MT5. The server simulates the trade and returns balance / equity / margin impact without actually placing an order.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OrderCheckAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.TradeFunctions</code></li> <li>Proto definition: <code>OrderCheck</code> (defined in <code>mt5-term-api-trade-functions.proto</code>)</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.TradeFunctions</code></li> <li>Method: <code>OrderCheck(OrderCheckRequest) \u2192 OrderCheckReply</code></li> <li>Low\u2011level client (generated): <code>TradeFunctions.TradeFunctionsClient.OrderCheck(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OrderCheckData&gt; OrderCheckAsync(\n            OrderCheckRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OrderCheckRequest { mql_trade_request: MrpcMqlTradeRequest }</code></p> <p>Reply message:</p> <p><code>OrderCheckReply { data: OrderCheckData }</code></p>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>OrderCheckRequest</code> Protobuf request wrapping <code>MrpcMqlTradeRequest</code> <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#mrpcmqltraderequest-core-trade-description","title":"<code>MrpcMqlTradeRequest</code> \u2014 Core trade description","text":"Field Type Description <code>Action</code> <code>MRPC_ENUM_TRADE_REQUEST_ACTIONS</code> Trade operation type (deal, pending order, etc.) <code>ExpertAdvisorMagicNumber</code> <code>ulong</code> EA magic number (use <code>0</code> for manual trades) <code>Order</code> <code>ulong</code> Order ticket (for modify/remove operations) <code>Symbol</code> <code>string</code> Trading symbol, e.g. <code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code> <code>Volume</code> <code>double</code> Volume in lots (must respect symbol min/max/step) <code>Price</code> <code>double</code> Price for validation. Use current Bid/Ask for market <code>StopLimit</code> <code>double</code> StopLimit price (for StopLimit orders) <code>StopLoss</code> <code>double</code> Stop Loss level (optional) <code>TakeProfit</code> <code>double</code> Take Profit level (optional) <code>Deviation</code> <code>ulong</code> Max price deviation in points (optional) <code>OrderType</code> <code>ENUM_ORDER_TYPE_TF</code> Order type: Buy, Sell, BuyLimit, SellStop, etc. <code>TypeFilling</code> <code>MRPC_ENUM_ORDER_TYPE_FILLING</code> Filling mode: FOK, IOC, Return, BOC <code>TypeTime</code> <code>MRPC_ENUM_ORDER_TYPE_TIME</code> Time\u2011in\u2011force: GTC, Day, Specified <code>Expiration</code> <code>Timestamp</code> Expiration time (for ORDER_TIME_SPECIFIED) <code>Comment</code> <code>string</code> Order comment (optional) <code>Position</code> <code>ulong</code> Position ticket (for position operations) <code>PositionBy</code> <code>ulong</code> Opposite position ticket (for close-by)"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#output-ordercheckdata","title":"\u2b06\ufe0f Output \u2014 <code>OrderCheckData</code>","text":"Field Type Description <code>MqlTradeCheckResult.ReturnedCode</code> <code>uint</code> Reply code (0 = OK, other = rejected/error) <code>MqlTradeCheckResult.BalanceAfterDeal</code> <code>double</code> Simulated balance after the trade <code>MqlTradeCheckResult.EquityAfterDeal</code> <code>double</code> Simulated equity after the trade <code>MqlTradeCheckResult.Profit</code> <code>double</code> Simulated floating profit <code>MqlTradeCheckResult.Margin</code> <code>double</code> Required margin for the trade <code>MqlTradeCheckResult.FreeMargin</code> <code>double</code> Simulated free margin after the trade <code>MqlTradeCheckResult.MarginLevel</code> <code>double</code> Margin level after the trade (percent) <code>MqlTradeCheckResult.Comment</code> <code>string</code> Human\u2011readable explanation for <code>ReturnedCode</code>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#enum_order_type_tf","title":"<code>ENUM_ORDER_TYPE_TF</code>","text":"<ul> <li><code>OrderTypeTfBuy</code> \u2014 Market Buy order</li> <li><code>OrderTypeTfSell</code> \u2014 Market Sell order</li> <li><code>OrderTypeTfBuyLimit</code> \u2014 Buy Limit pending order</li> <li><code>OrderTypeTfSellLimit</code> \u2014 Sell Limit pending order</li> <li><code>OrderTypeTfBuyStop</code> \u2014 Buy Stop pending order</li> <li><code>OrderTypeTfSellStop</code> \u2014 Sell Stop pending order</li> <li><code>OrderTypeTfBuyStopLimit</code> \u2014 Buy Stop Limit order</li> <li><code>OrderTypeTfSellStopLimit</code> \u2014 Sell Stop Limit order</li> <li><code>OrderTypeTfCloseBy</code> \u2014 Close position by opposite one</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#mrpc_enum_order_type_filling","title":"<code>MRPC_ENUM_ORDER_TYPE_FILLING</code>","text":"<ul> <li><code>OrderFillingFok</code> \u2014 Fill\u2011or\u2011Kill (execute full volume or cancel)</li> <li><code>OrderFillingIoc</code> \u2014 Immediate\u2011or\u2011Cancel (execute available volume, cancel rest)</li> <li><code>OrderFillingReturn</code> \u2014 Return (partial fill allowed, rest remains active)</li> <li><code>OrderFillingBoc</code> \u2014 Book\u2011or\u2011Cancel (place in DOM, don't execute immediately)</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#mrpc_enum_order_type_time","title":"<code>MRPC_ENUM_ORDER_TYPE_TIME</code>","text":"<ul> <li><code>OrderTimeGtc</code> \u2014 Good\u2011Till\u2011Cancelled</li> <li><code>OrderTimeDay</code> \u2014 Good till current trade day</li> <li><code>OrderTimeSpecified</code> \u2014 Good till expiration time</li> <li><code>OrderTimeSpecifiedDay</code> \u2014 Good till 23:59:59 of specified day</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#mrpc_enum_trade_request_actions","title":"<code>MRPC_ENUM_TRADE_REQUEST_ACTIONS</code>","text":"<ul> <li><code>TradeActionDeal</code> \u2014 Place market order for immediate execution</li> <li><code>TradeActionPending</code> \u2014 Place pending order</li> <li><code>TradeActionSltp</code> \u2014 Modify SL/TP of opened position</li> <li><code>TradeActionModify</code> \u2014 Modify pending order parameters</li> <li><code>TradeActionRemove</code> \u2014 Delete pending order</li> <li><code>TradeActionCloseBy</code> \u2014 Close position by opposite one</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Dry\u2011run validation of a trade request. Returns simulated balance/equity/margin impact without placing a real order.</li> <li>Why you need it. Catch errors (\"not enough money\", wrong lot sizes, bad prices) before calling <code>OrderSendAsync</code>.</li> <li>Sanity check. If <code>ReturnedCode == 0</code> and <code>Comment</code> says \"OK\" \u2192 trade can proceed.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to validate trades before execution:</p> <ul> <li>Pre\u2011trade risk checks (margin level, lot size).</li> <li>Debug strategy behavior on new brokers.</li> <li>Prevent \"not enough money\" errors.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Broker support: Some brokers don't support <code>OrderCheck</code>. Server returns error \u2192 <code>ApiExceptionMT5</code>. This is a broker limitation.</li> <li>\u26a0\ufe0f MetaQuotes-Demo server limitation: On MetaQuotes-Demo broker, OrderCheck returns success (code 0) but all margin/balance/equity values are <code>-0.00</code> (negative zeros). The server accepts the request but doesn't simulate real values. Use <code>OrderCalcMarginAsync()</code> instead for margin calculations on this broker.</li> <li>Market orders: Use current Bid/Ask as <code>Price</code> (Buy \u2192 ask, Sell \u2192 bid).</li> <li>Respect symbol limits: Check <code>SymbolVolumeMin/Max/Step</code> before calling.</li> <li>Short deadline: 5\u201310 seconds is enough. Exotic symbols may be slower.</li> <li>Alternative: If OrderCheck returns zeros or doesn't work, use <code>OrderCalcMarginAsync()</code> which is simpler and more reliable across brokers.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#1-basic-market-buy-validation","title":"1) Basic market BUY validation","text":"<pre><code>// acc \u2014 an already connected MT5Account instance\n\n// Get minimal lot for the symbol\nvar volumeMin = await acc.SymbolInfoDoubleAsync(\n    \"EURUSD\",\n    SymbolInfoDoublePropertyType.SymbolVolumeMin);\n\nvar symbol = \"EURUSD\";\nvar minLot = volumeMin.Value;\n\n// Current ask price (get from your quote feed)\ndouble ask = /* current ask price here */;\n\n// Build trade request\nvar tradeRequest = new MrpcMqlTradeRequest\n{\n    Action = MRPC_ENUM_TRADE_REQUEST_ACTIONS.TradeActionDeal,\n    Symbol = symbol,\n    Volume = minLot,\n    Price = ask,\n    StopLoss = 0.0,\n    TakeProfit = 0.0,\n    OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n    TypeFilling = MRPC_ENUM_ORDER_TYPE_FILLING.OrderFillingFok,\n    TypeTime = MRPC_ENUM_ORDER_TYPE_TIME.OrderTimeGtc,\n    ExpertAdvisorMagicNumber = 12345\n};\n\nvar checkRequest = new OrderCheckRequest\n{\n    MqlTradeRequest = tradeRequest\n};\n\nvar checkResult = await acc.OrderCheckAsync(\n    checkRequest,\n    deadline: DateTime.UtcNow.AddSeconds(10));\n\nvar result = checkResult?.MqlTradeCheckResult;\nif (result == null)\n{\n    Console.WriteLine(\"OrderCheck returned no data.\");\n}\nelse\n{\n    Console.WriteLine($\"Return code:      {result.ReturnedCode}\");\n    Console.WriteLine($\"Balance after:    {result.BalanceAfterDeal:F2}\");\n    Console.WriteLine($\"Equity after:     {result.EquityAfterDeal:F2}\");\n    Console.WriteLine($\"Required margin:  {result.Margin:F2}\");\n    Console.WriteLine($\"Free margin:      {result.FreeMargin:F2}\");\n    Console.WriteLine($\"Margin level:     {result.MarginLevel:F2}%\");\n    Console.WriteLine($\"Comment:          {result.Comment}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#2-send-order-only-if-the-check-passes","title":"2) Send order only if the check passes","text":"<pre><code>async Task&lt;bool&gt; TrySendBuyAsync(MT5Account acc, string symbol, double lots)\n{\n    double ask = /* current ask price */;\n\n    var tradeRequest = new MrpcMqlTradeRequest\n    {\n        Action = MRPC_ENUM_TRADE_REQUEST_ACTIONS.TradeActionDeal,\n        Symbol = symbol,\n        Volume = lots,\n        Price = ask,\n        OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n        TypeFilling = MRPC_ENUM_ORDER_TYPE_FILLING.OrderFillingFok,\n        TypeTime = MRPC_ENUM_ORDER_TYPE_TIME.OrderTimeGtc,\n        ExpertAdvisorMagicNumber = 202501\n    };\n\n    var check = await acc.OrderCheckAsync(new OrderCheckRequest\n    {\n        MqlTradeRequest = tradeRequest\n    });\n\n    var result = check?.MqlTradeCheckResult;\n    if (result == null)\n        throw new Exception(\"OrderCheck returned null result\");\n\n    var isOk = result.ReturnedCode == 0; // or your own mapping\n\n    if (isOk)\n    {\n        // Now we can safely send the order\n        var sendResult = await acc.OrderSendAsync(new OrderSendRequest\n        {\n            MqlTradeRequest = tradeRequest\n        });\n\n        Console.WriteLine($\"Order sent, result: {sendResult.ReturnedCode}\");\n        return true;\n    }\n\n    Console.WriteLine($\"Order rejected by OrderCheck: {result.ReturnedCode} / {result.Comment}\");\n    return false;\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderCheck/#3-simple-risk-rule-by-margin-level","title":"3) Simple risk rule by margin level","text":"<pre><code>// Example: do not trade if margin level after the deal falls below 200%\n\nvar check = await acc.OrderCheckAsync(new OrderCheckRequest\n{\n    MqlTradeRequest = new MrpcMqlTradeRequest\n    {\n        Action = MRPC_ENUM_TRADE_REQUEST_ACTIONS.TradeActionDeal,\n        Symbol = \"XAUUSD\",\n        Volume = 0.10,\n        Price = /* current ask */,\n        OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n        TypeFilling = MRPC_ENUM_ORDER_TYPE_FILLING.OrderFillingFok,\n        TypeTime = MRPC_ENUM_ORDER_TYPE_TIME.OrderTimeGtc\n    }\n});\n\nvar r = check.MqlTradeCheckResult;\n\nif (r.MarginLevel &lt; 200.0)\n{\n    Console.WriteLine($\"Risk rule triggered: margin level would drop to {r.MarginLevel:F2}%\");\n    // Skip trading here\n}\nelse\n{\n    Console.WriteLine(\"Margin level OK, you may proceed with OrderSendAsync.\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/","title":"\u2705 Closing Orders and Positions (<code>OrderCloseAsync</code>)","text":"<p>Request: Close an open position or cancel a pending order on MT5.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OrderCloseAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.TradingHelper</code></li> <li>Proto definition: <code>OrderClose</code> (defined in <code>mt5-term-api-trading-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.TradingHelper</code></li> <li>Method: <code>OrderClose(OrderCloseRequest) \u2192 OrderCloseReply</code></li> <li>Low\u2011level client (generated): <code>TradingHelper.TradingHelperClient.OrderClose(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OrderCloseData&gt; OrderCloseAsync(\n            OrderCloseRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OrderCloseRequest { ticket, volume, slippage }</code></p> <p>Reply message:</p> <p><code>OrderCloseReply { data: OrderCloseData }</code></p>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>OrderCloseRequest</code> Protobuf request with close parameters <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#ordercloserequest","title":"<code>OrderCloseRequest</code>","text":"Field Type Description <code>Ticket</code> <code>ulong</code> Position or pending order ticket REQUIRED <code>Volume</code> <code>double</code> Volume to close (for partial close; use <code>0</code> for full close) <code>Slippage</code> <code>int</code> Max price slippage in points (for market positions)"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#output-orderclosedata","title":"\u2b06\ufe0f Output \u2014 <code>OrderCloseData</code>","text":"Field Type Description <code>ReturnedCode</code> <code>uint</code> Operation return code (10009 = success) <code>ReturnedStringCode</code> <code>string</code> String representation of return code <code>ReturnedCodeDescription</code> <code>string</code> Human-readable description <code>CloseMode</code> <code>MRPC_ORDER_CLOSE_MODE</code> Close mode (market/partial/pending)"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#mrpc_order_close_mode","title":"<code>MRPC_ORDER_CLOSE_MODE</code>","text":"<ul> <li><code>MrpcMarketOrderClose</code> \u2014 Full market position close</li> <li><code>MrpcMarketOrderPartialClose</code> \u2014 Partial market position close</li> <li><code>MrpcPendingOrderRemove</code> \u2014 Pending order cancellation</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Closes open market positions (full or partial) or cancels pending orders.</li> <li>Why you need it. Exit trades, take profits, cut losses, cancel unfilled pending orders.</li> <li>Sanity check. If <code>ReturnedCode == 10009</code> \u2192 close/cancel successful. Check <code>CloseMode</code> for operation type.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to exit trades:</p> <ul> <li>Close entire position (full close).</li> <li>Close part of position (partial close).</li> <li>Cancel pending orders.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Return codes: 10009 = success. Other codes indicate errors (invalid ticket, market closed, etc.).</li> <li>Full vs Partial: Set <code>Volume = 0</code> for full close. Set specific volume (e.g., <code>0.01</code>) for partial close.</li> <li>Pending orders: For pending orders, <code>Volume</code> is ignored. Order is simply cancelled.</li> <li>Slippage: For market positions, allows price deviation. Higher slippage = higher chance of execution.</li> <li>CloseMode: Check this field to confirm operation type (full/partial/pending).</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#1-close-entire-position","title":"1) Close entire position","text":"<pre><code>// acc \u2014 connected MT5Account\n// positionTicket \u2014 ticket from OrderSendAsync or OpenedOrdersAsync\n\nvar result = await acc.OrderCloseAsync(new OrderCloseRequest\n{\n    Ticket = positionTicket,\n    Volume = 0,  // 0 = close entire position\n    Slippage = 10\n});\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2713 Position closed: {result.CloseMode}\");\n}\nelse\n{\n    Console.WriteLine($\"\u2717 Close failed: {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#2-partial-position-close","title":"2) Partial position close","text":"<pre><code>// Close half of 0.10 lot position (close 0.05 lots)\nvar result = await acc.OrderCloseAsync(new OrderCloseRequest\n{\n    Ticket = positionTicket,\n    Volume = 0.05,  // Partial close: 0.05 lots\n    Slippage = 10\n});\n\nif (result.CloseMode == MRPC_ORDER_CLOSE_MODE.MrpcMarketOrderPartialClose)\n{\n    Console.WriteLine(\"\u2713 Partial close successful\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#3-cancel-pending-order","title":"3) Cancel pending order","text":"<pre><code>// pendingOrderTicket \u2014 ticket of pending order\n\nvar result = await acc.OrderCloseAsync(new OrderCloseRequest\n{\n    Ticket = pendingOrderTicket,\n    Volume = 0  // Volume ignored for pending orders\n});\n\nif (result.CloseMode == MRPC_ORDER_CLOSE_MODE.MrpcPendingOrderRemove)\n{\n    Console.WriteLine(\"\u2713 Pending order cancelled\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#4-close-all-positions-for-a-symbol","title":"4) Close all positions for a symbol","text":"<pre><code>var openOrders = await acc.OpenedOrdersAsync();\nvar eurusdPositions = openOrders.Positions.Where(p =&gt; p.Symbol == \"EURUSD\");\n\nforeach (var position in eurusdPositions)\n{\n    var result = await acc.OrderCloseAsync(new OrderCloseRequest\n    {\n        Ticket = (ulong)position.Ticket,\n        Volume = 0,\n        Slippage = 10\n    });\n\n    Console.WriteLine($\"Position {position.Ticket}: {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#5-close-position-with-error-handling","title":"5) Close position with error handling","text":"<pre><code>try\n{\n    var result = await acc.OrderCloseAsync(\n        new OrderCloseRequest\n        {\n            Ticket = positionTicket,\n            Volume = 0,\n            Slippage = 20\n        },\n        deadline: DateTime.UtcNow.AddSeconds(10));\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2713 Closed: {result.CloseMode}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0 Server returned: {result.ReturnedCodeDescription}\");\n    }\n}\ncatch (Grpc.Core.RpcException ex)\n{\n    Console.WriteLine($\"\u2717 gRPC error: {ex.Status}\");\n}\ncatch (ApiExceptionMT5 ex)\n{\n    Console.WriteLine($\"\u2717 API error: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderClose/#6-close-position-with-volume-validation","title":"6) Close position with volume validation","text":"<pre><code>// Get position info first\nvar positions = await acc.OpenedOrdersAsync();\nvar position = positions.Positions.FirstOrDefault(p =&gt; p.Ticket == positionTicket);\n\nif (position != null)\n{\n    var volumeToClose = 0.01; // Want to close 0.01 lots\n\n    if (volumeToClose &gt;= position.Volume)\n    {\n        // Close entire position if requested volume &gt;= position volume\n        volumeToClose = 0;\n    }\n\n    var result = await acc.OrderCloseAsync(new OrderCloseRequest\n    {\n        Ticket = (ulong)position.Ticket,\n        Volume = volumeToClose,\n        Slippage = 10\n    });\n\n    Console.WriteLine($\"Close result: {result.ReturnedCodeDescription}\");\n    Console.WriteLine($\"Mode: {result.CloseMode}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/","title":"\u2705 Modifying Orders and Positions (<code>OrderModifyAsync</code>)","text":"<p>Request: Modify SL/TP of an open position or modify parameters of a pending order on MT5.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OrderModifyAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.TradingHelper</code></li> <li>Proto definition: <code>OrderModify</code> (defined in <code>mt5-term-api-trading-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.TradingHelper</code></li> <li>Method: <code>OrderModify(OrderModifyRequest) \u2192 OrderModifyReply</code></li> <li>Low\u2011level client (generated): <code>TradingHelper.TradingHelperClient.OrderModify(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OrderModifyData&gt; OrderModifyAsync(\n            OrderModifyRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OrderModifyRequest { ticket, stop_loss, take_profit, ... }</code></p> <p>Reply message:</p> <p><code>OrderModifyReply { data: OrderModifyData }</code></p>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>OrderModifyRequest</code> Protobuf request with modification parameters <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#ordermodifyrequest","title":"<code>OrderModifyRequest</code>","text":"Field Type Description <code>Ticket</code> <code>ulong</code> Position or pending order ticket REQUIRED <code>StopLoss</code> <code>double</code> New Stop Loss level (for positions and pending orders) <code>TakeProfit</code> <code>double</code> New Take Profit level (for positions and pending orders) <code>Price</code> <code>double</code> New price (ONLY for pending orders) <code>ExpirationTimeType</code> <code>TMT5_ENUM_ORDER_TYPE_TIME</code> Expiration type (ONLY for pending orders) <code>ExpirationTime</code> <code>Timestamp</code> Expiration time (ONLY for pending orders) <code>StopLimit</code> <code>double</code> New stop limit (ONLY for pending StopLimit orders)"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#output-ordermodifydata","title":"\u2b06\ufe0f Output \u2014 <code>OrderModifyData</code>","text":"Field Type Description <code>ReturnedCode</code> <code>uint</code> Operation return code (10009 = success) <code>Deal</code> <code>ulong</code> Deal ticket if executed <code>Order</code> <code>ulong</code> Order ticket <code>Volume</code> <code>double</code> Confirmed volume <code>Price</code> <code>double</code> Confirmed price <code>Bid</code> <code>double</code> Current Bid price <code>Ask</code> <code>double</code> Current Ask price <code>Comment</code> <code>string</code> Broker comment (error description) <code>RequestId</code> <code>uint</code> Request ID from terminal <code>RetCodeExternal</code> <code>int</code> External trading system return code <code>ReturnedStringCode</code> <code>string</code> String representation of return code <code>ReturnedCodeDescription</code> <code>string</code> Human-readable description"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#tmt5_enum_order_type_time","title":"<code>TMT5_ENUM_ORDER_TYPE_TIME</code>","text":"<ul> <li><code>Tmt5OrderTimeGtc</code> \u2014 Good\u2011Till\u2011Cancelled</li> <li><code>Tmt5OrderTimeDay</code> \u2014 Good till current trade day</li> <li><code>Tmt5OrderTimeSpecified</code> \u2014 Good till expiration time</li> <li><code>Tmt5OrderTimeSpecifiedDay</code> \u2014 Good till 23:59:59 of specified day</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Modifies SL/TP of open positions or changes parameters of pending orders (price, expiration, stop limit).</li> <li>Why you need it. Adjust risk levels, move to breakeven, update pending order prices.</li> <li>Sanity check. If <code>ReturnedCode == 10009</code> \u2192 modification successful.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to update trade parameters:</p> <ul> <li>Modify SL/TP of open positions.</li> <li>Change pending order price/expiration.</li> <li>Move stops to breakeven.</li> <li>Adjust trailing stops manually.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Return codes: 10009 = success. Other codes indicate errors (invalid stops, market closed, etc.).</li> <li>Position vs Pending: Use same <code>Ticket</code> for both positions and pending orders. Server determines type automatically.</li> <li>Stop levels: Broker enforces minimum distance from current price (<code>SYMBOL_TRADE_STOPS_LEVEL</code>). Check before modifying.</li> <li>Partial parameters: Set only fields you want to change. Leave others as <code>0</code> or <code>null</code>.</li> <li>Price field: Only for pending orders. Ignored for open positions.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#1-modify-sltp-of-open-position","title":"1) Modify SL/TP of open position","text":"<pre><code>// acc \u2014 connected MT5Account\n// positionTicket \u2014 ticket from OrderSendAsync or OpenedOrdersAsync\n\nvar result = await acc.OrderModifyAsync(new OrderModifyRequest\n{\n    Ticket = positionTicket,\n    StopLoss = 1.1050,\n    TakeProfit = 1.1150\n});\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2713 Position modified: SL={result.Price}\");\n}\nelse\n{\n    Console.WriteLine($\"\u2717 Modification failed: {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#2-move-position-to-breakeven","title":"2) Move position to breakeven","text":"<pre><code>// Get current position\nvar positions = await acc.OpenedOrdersAsync();\nvar position = positions.Positions.First();\n\n// Get entry price from position\nvar entryPrice = position.PriceOpen;\n\nvar result = await acc.OrderModifyAsync(new OrderModifyRequest\n{\n    Ticket = (ulong)position.Ticket,\n    StopLoss = entryPrice,  // Move SL to entry price\n    TakeProfit = position.TakeProfit  // Keep existing TP\n});\n\nConsole.WriteLine($\"Moved to breakeven: {result.ReturnedCodeDescription}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#3-remove-sltp-set-to-zero","title":"3) Remove SL/TP (set to zero)","text":"<pre><code>var result = await acc.OrderModifyAsync(new OrderModifyRequest\n{\n    Ticket = positionTicket,\n    StopLoss = 0,    // Remove SL\n    TakeProfit = 0   // Remove TP\n});\n\nConsole.WriteLine($\"Removed SL/TP: {result.ReturnedCodeDescription}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#4-modify-pending-order-price","title":"4) Modify pending order price","text":"<pre><code>// pendingOrderTicket \u2014 ticket of pending Buy Limit order\n\nvar tick = await acc.SymbolInfoTickAsync(\"EURUSD\");\nvar newPrice = tick.Bid - 0.0020; // 20 pips below current\n\nvar result = await acc.OrderModifyAsync(new OrderModifyRequest\n{\n    Ticket = pendingOrderTicket,\n    Price = newPrice,\n    StopLoss = newPrice - 0.0010,\n    TakeProfit = newPrice + 0.0030\n});\n\nConsole.WriteLine($\"Pending order updated: {result.ReturnedCodeDescription}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#5-change-pending-order-expiration","title":"5) Change pending order expiration","text":"<pre><code>var result = await acc.OrderModifyAsync(new OrderModifyRequest\n{\n    Ticket = pendingOrderTicket,\n    ExpirationTimeType = TMT5_ENUM_ORDER_TYPE_TIME.Tmt5OrderTimeSpecified,\n    ExpirationTime = Google.Protobuf.WellKnownTypes.Timestamp.FromDateTime(\n        DateTime.UtcNow.AddDays(1))\n});\n\nConsole.WriteLine($\"Order expires in 1 day: {result.ReturnedCodeDescription}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderModify/#6-trailing-stop-example-manual","title":"6) Trailing stop example (manual)","text":"<pre><code>// Simple trailing stop: if position in profit &gt;= 30 pips, move SL to +10 pips\nvar positions = await acc.OpenedOrdersAsync();\nvar position = positions.Positions.FirstOrDefault(p =&gt; p.Symbol == \"EURUSD\");\n\nif (position != null)\n{\n    var currentProfit = position.Profit;\n    var currentPrice = position.Type == 0 ? position.PriceCurrent : position.PriceCurrent; // Bid for Buy, Ask for Sell\n    var entryPrice = position.PriceOpen;\n\n    var profitPips = Math.Abs(currentPrice - entryPrice) * 10000;\n\n    if (profitPips &gt;= 30)\n    {\n        var newSL = position.Type == 0\n            ? entryPrice + 0.0010  // Buy: SL 10 pips above entry\n            : entryPrice - 0.0010; // Sell: SL 10 pips below entry\n\n        var result = await acc.OrderModifyAsync(new OrderModifyRequest\n        {\n            Ticket = (ulong)position.Ticket,\n            StopLoss = newSL,\n            TakeProfit = position.TakeProfit\n        });\n\n        Console.WriteLine($\"Trailing stop updated: {result.ReturnedCodeDescription}\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/","title":"\u2705 Sending Trade Orders (<code>OrderSendAsync</code>)","text":"<p>Request: Send a market or pending order to MT5. Opens positions, places pending orders with specified parameters.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.OrderSendAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.TradingHelper</code></li> <li>Proto definition: <code>OrderSend</code> (defined in <code>mt5-term-api-trading-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.TradingHelper</code></li> <li>Method: <code>OrderSend(OrderSendRequest) \u2192 OrderSendReply</code></li> <li>Low\u2011level client (generated): <code>TradingHelper.TradingHelperClient.OrderSend(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;OrderSendData&gt; OrderSendAsync(\n            OrderSendRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OrderSendRequest { symbol, operation, volume, ... }</code></p> <p>Reply message:</p> <p><code>OrderSendReply { data: OrderSendData }</code></p>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>OrderSendRequest</code> Protobuf request with trade parameters <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#ordersendrequest","title":"<code>OrderSendRequest</code>","text":"Field Type Description <code>Symbol</code> <code>string</code> Trading symbol (<code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>, etc.) REQUIRED <code>Operation</code> <code>TMT5_ENUM_ORDER_TYPE</code> Order type: Buy, Sell, BuyLimit, etc. REQUIRED <code>Volume</code> <code>double</code> Volume in lots (respect symbol min/max/step) REQUIRED <code>Price</code> <code>double</code> Price (for pending orders; use current Bid/Ask for market) <code>Slippage</code> <code>ulong</code> Max price deviation in points (optional) <code>StopLoss</code> <code>double</code> Stop Loss level (optional) <code>TakeProfit</code> <code>double</code> Take Profit level (optional) <code>Comment</code> <code>string</code> Order comment (optional) <code>ExpertId</code> <code>ulong</code> EA magic number (use <code>0</code> for manual trades) <code>StopLimitPrice</code> <code>double</code> StopLimit price (for StopLimit orders) <code>ExpirationTimeType</code> <code>TMT5_ENUM_ORDER_TYPE_TIME</code> Order expiration type (GTC, Day, Specified) <code>ExpirationTime</code> <code>Timestamp</code> Expiration time (for TIME_SPECIFIED orders)"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#output-ordersenddata","title":"\u2b06\ufe0f Output \u2014 <code>OrderSendData</code>","text":"Field Type Description <code>ReturnedCode</code> <code>uint</code> Operation return code (10009 = success) <code>Deal</code> <code>ulong</code> Deal ticket if executed <code>Order</code> <code>ulong</code> Order ticket if placed (pending orders) <code>Volume</code> <code>double</code> Confirmed deal volume <code>Price</code> <code>double</code> Confirmed deal price <code>Bid</code> <code>double</code> Current Bid price at execution <code>Ask</code> <code>double</code> Current Ask price at execution <code>Comment</code> <code>string</code> Broker comment (error description) <code>RequestId</code> <code>uint</code> Request ID from terminal <code>RetCodeExternal</code> <code>int</code> External trading system return code <code>ReturnedStringCode</code> <code>string</code> String representation of return code <code>ReturnedCodeDescription</code> <code>string</code> Human-readable description"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#tmt5_enum_order_type","title":"<code>TMT5_ENUM_ORDER_TYPE</code>","text":"<ul> <li><code>Tmt5OrderTypeBuy</code> \u2014 Market Buy order</li> <li><code>Tmt5OrderTypeSell</code> \u2014 Market Sell order</li> <li><code>Tmt5OrderTypeBuyLimit</code> \u2014 Buy Limit pending order</li> <li><code>Tmt5OrderTypeSellLimit</code> \u2014 Sell Limit pending order</li> <li><code>Tmt5OrderTypeBuyStop</code> \u2014 Buy Stop pending order</li> <li><code>Tmt5OrderTypeSellStop</code> \u2014 Sell Stop pending order</li> <li><code>Tmt5OrderTypeBuyStopLimit</code> \u2014 Buy Stop Limit order</li> <li><code>Tmt5OrderTypeSellStopLimit</code> \u2014 Sell Stop Limit order</li> <li><code>Tmt5OrderTypeCloseBy</code> \u2014 Close position by opposite one</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#tmt5_enum_order_type_time","title":"<code>TMT5_ENUM_ORDER_TYPE_TIME</code>","text":"<ul> <li><code>Tmt5OrderTimeGtc</code> \u2014 Good\u2011Till\u2011Cancelled</li> <li><code>Tmt5OrderTimeDay</code> \u2014 Good till current trade day</li> <li><code>Tmt5OrderTimeSpecified</code> \u2014 Good till expiration time</li> <li><code>Tmt5OrderTimeSpecifiedDay</code> \u2014 Good till 23:59:59 of specified day</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Sends trade orders to MT5 server. Opens market positions or places pending orders with specified parameters.</li> <li>Why you need it. Main method for executing trades. All trading operations start here.</li> <li>Sanity check. If <code>ReturnedCode == 10009</code> \u2192 order executed successfully. Check <code>Deal</code> or <code>Order</code> ticket.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to execute trades:</p> <ul> <li>Open market positions (Buy/Sell).</li> <li>Place pending orders (Limit/Stop/StopLimit).</li> <li>Set initial SL/TP levels.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Return codes: 10009 = success. Other codes indicate errors (insufficient margin, invalid price, etc.).</li> <li>Market orders: Don't set <code>Price</code> \u2014 server uses current Bid/Ask automatically.</li> <li>Pending orders: Must specify <code>Price</code>. For StopLimit orders also set <code>StopLimitPrice</code>.</li> <li>Slippage: For market orders, allows price deviation. Broker may reject if market moved too much.</li> <li>Volume limits: Always check <code>SymbolVolumeMin/Max/Step</code> before calling.</li> <li>Magic number: Use unique <code>ExpertId</code> per strategy for tracking.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#1-basic-market-buy-order","title":"1) Basic market BUY order","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.OrderSendAsync(new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,\n    Volume = 0.01\n});\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2713 Position opened: Deal #{result.Deal}, Price: {result.Price}\");\n}\nelse\n{\n    Console.WriteLine($\"\u2717 Order failed: {result.ReturnedCodeDescription}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#2-market-buy-with-sltp","title":"2) Market BUY with SL/TP","text":"<pre><code>var tick = await acc.SymbolInfoTickAsync(\"EURUSD\");\n\nvar result = await acc.OrderSendAsync(new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,\n    Volume = 0.01,\n    StopLoss = tick.Ask - 0.0010,    // 10 pips below\n    TakeProfit = tick.Ask + 0.0020,  // 20 pips above\n    Comment = \"Buy with SL/TP\"\n});\n\nConsole.WriteLine($\"Order: {result.ReturnedCodeDescription}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#3-pending-buy-limit-order","title":"3) Pending Buy Limit order","text":"<pre><code>var tick = await acc.SymbolInfoTickAsync(\"EURUSD\");\nvar limitPrice = tick.Bid - 0.0010; // 10 pips below current price\n\nvar result = await acc.OrderSendAsync(new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuyLimit,\n    Volume = 0.01,\n    Price = limitPrice,\n    ExpirationTimeType = TMT5_ENUM_ORDER_TYPE_TIME.Tmt5OrderTimeGtc,\n    Comment = \"Buy Limit pending\"\n});\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2713 Pending order placed: Order #{result.Order}\");\n}\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#4-buy-stop-limit-order","title":"4) Buy Stop Limit order","text":"<pre><code>var tick = await acc.SymbolInfoTickAsync(\"XAUUSD\");\n\nvar result = await acc.OrderSendAsync(new OrderSendRequest\n{\n    Symbol = \"XAUUSD\",\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuyStopLimit,\n    Volume = 0.01,\n    Price = tick.Ask + 5.0,          // Activation price (stop)\n    StopLimitPrice = tick.Ask + 4.0, // Limit order price after activation\n    StopLoss = tick.Ask + 3.0,\n    TakeProfit = tick.Ask + 10.0,\n    ExpirationTimeType = TMT5_ENUM_ORDER_TYPE_TIME.Tmt5OrderTimeGtc\n});\n\nConsole.WriteLine($\"StopLimit order: {result.ReturnedCodeDescription}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/OrderSend/#5-with-ea-magic-number-and-expiration","title":"5) With EA magic number and expiration","text":"<pre><code>var result = await acc.OrderSendAsync(new OrderSendRequest\n{\n    Symbol = \"GBPUSD\",\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeSellLimit,\n    Volume = 0.01,\n    Price = 1.2550,\n    ExpertId = 202501,  // EA magic number\n    ExpirationTimeType = TMT5_ENUM_ORDER_TYPE_TIME.Tmt5OrderTimeSpecified,\n    ExpirationTime = Google.Protobuf.WellKnownTypes.Timestamp.FromDateTime(\n        DateTime.UtcNow.AddHours(4))\n});\n\nConsole.WriteLine($\"Order expires in 4 hours. Ticket: {result.Order}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/","title":"MT5Account \u00b7 Trading Operations - Overview","text":"<p>Place orders, modify positions, close trades, check orders, and calculate margin. Use this page to choose the right API for trading operations.</p>"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>OrderSend - place market or pending orders (buy, sell, limit, stop, stop-limit).</li> <li>OrderModify - modify existing orders or positions (price, SL, TP, expiration).</li> <li>OrderClose - close positions (full or partial).</li> <li>OrderCheck - validate order before sending (check margin, free margin, etc.).</li> <li>OrderCalcMargin - calculate required margin for an order.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>OrderSend \u2192 the main trading method - opens positions, places pending orders.</li> <li>OrderModify \u2192 change SL/TP levels, order prices, or expiration times.</li> <li>OrderClose \u2192 close positions (with optional partial close).</li> <li>OrderCheck \u2192 pre-flight check before sending order (validates margin, volume, etc.).</li> <li>OrderCalcMargin \u2192 calculate how much margin you need before trading.</li> </ul> <p>Rule of thumb: always use <code>OrderCheckAsync</code> or <code>OrderCalcMarginAsync</code> before sending large orders to avoid margin errors.</p>"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns Key inputs Open position or place pending order <code>OrderSendAsync</code> OrderSendData (ticket, deal, code) Symbol, operation, volume, price, SL/TP Modify existing order/position <code>OrderModifyAsync</code> Success code Ticket, new price, SL, TP, expiration Close position (full or partial) <code>OrderCloseAsync</code> Success code Ticket, volume, slippage Validate order before sending <code>OrderCheckAsync</code> Check result (margin, profit, errors) MqlTradeRequest object Calculate required margin <code>OrderCalcMarginAsync</code> Margin value Symbol, order type, volume, price"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>OrderSend return code <code>10009</code> (TRADE_RETCODE_DONE) = success.</li> <li>Slippage in points - set reasonable value (5-10 points typical).</li> <li>Stop Loss/Take Profit must respect symbol's STOPLEVEL (minimum distance from price).</li> <li>Volume must be within symbol's min/max lot size and step.</li> <li>OrderCheck doesn't actually place order - just validates parameters.</li> <li>Partial close - specify volume less than position size.</li> <li>Expiration only works for TIME_SPECIFIED order type.</li> </ul>"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Place market buy order\nvar request = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,\n    Volume = 0.1,\n    StopLoss = 1.08500,\n    TakeProfit = 1.09500,\n    Comment = \"My trade\"\n};\nvar result = await account.OrderSendAsync(request);\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Order placed! Ticket: {result.Order}, Deal: {result.Deal}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Error: {result.Comment}\");\n}\n</code></pre> <pre><code>// Modify position - update SL/TP\nvar modifyResult = await account.OrderModifyAsync(new OrderModifyRequest\n{\n    Ticket = 123456789,\n    StopLoss = 1.08000,\n    TakeProfit = 1.10000\n});\nConsole.WriteLine($\"Modify result: {modifyResult.ReturnedCode}\");\n</code></pre> <pre><code>// Close position\nvar closeResult = await account.OrderCloseAsync(new OrderCloseRequest\n{\n    Ticket = 123456789,\n    Volume = 0.1,  // Full volume\n    Slippage = 10   // 10 points\n});\nConsole.WriteLine($\"Close result: {closeResult.ReturnedCode}\");\n</code></pre> <pre><code>// Check order before sending\nvar tradeRequest = new MrpcMqlTradeRequest\n{\n    Action = MRPC_ENUM_TRADE_REQUEST_ACTIONS.TradeActionDeal,\n    Symbol = \"EURUSD\",\n    Volume = 1.0,\n    OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n    Price = 1.09000\n};\nvar checkResult = await account.OrderCheckAsync(new OrderCheckRequest\n{\n    MqlTradeRequest = tradeRequest\n});\nvar checkData = checkResult.MqlTradeCheckResult;\nConsole.WriteLine($\"Margin needed: ${checkData.Margin:F2}, Free margin after: ${checkData.FreeMargin:F2}\");\n</code></pre> <pre><code>// Calculate margin for 1 lot EURUSD\nvar marginData = await account.OrderCalcMarginAsync(\n    symbol: \"EURUSD\",\n    orderType: ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n    volume: 1.0,\n    openPrice: 1.09000\n);\nConsole.WriteLine($\"Required margin: ${marginData.Margin:F2}\");\n</code></pre>"},{"location":"MT5Account/4.%20Trading_Operattons/Trading_Operations.Overview/#see-also","title":"See also","text":"<ul> <li>Positions: OpenedOrders - view current positions before modifying</li> <li>Account: AccountSummary - check free margin before trading</li> <li>Symbols: SymbolInfoDouble - get current bid/ask prices</li> <li>Streaming: SubscribeToTradeTransaction - real-time trade events</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/","title":"\u2705 Subscribe to Market Depth (<code>MarketBookAddAsync</code>)","text":"<p>Request: Subscribe to Depth of Market (DOM) updates for a symbol on MT5. Opens access to order book data.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.MarketBookAddAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>MarketBookAdd</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>MarketBookAdd(MarketBookAddRequest) \u2192 MarketBookAddReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.MarketInfoClient.MarketBookAdd(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;MarketBookAddData&gt; MarketBookAddAsync(\n            string symbol,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>MarketBookAddRequest { symbol }</code></p> <p>Reply message:</p> <p><code>MarketBookAddReply { data: MarketBookAddData }</code></p>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (e.g., <code>\"EURUSD\"</code>, <code>\"BTCUSD\"</code>) <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#output-marketbookadddata","title":"\u2b06\ufe0f Output \u2014 <code>MarketBookAddData</code>","text":"Field Type Description <code>OpenedSuccessfully</code> <code>bool</code> <code>true</code> if subscription opened successfully"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Opens Depth of Market subscription for a symbol. Required before calling <code>MarketBookGetAsync</code>.</li> <li>Why you need it. Access order book data (bid/ask levels, volumes). Required for DOM-based strategies.</li> <li>Sanity check. If <code>OpenedSuccessfully == true</code> \u2192 can now call <code>MarketBookGetAsync</code>.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to access market depth data:</p> <ul> <li>Subscribe to order book updates.</li> <li>Enable DOM data retrieval via <code>MarketBookGetAsync</code>.</li> <li>Analyze bid/ask liquidity levels.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Broker support: Not all brokers provide DOM data. Forex brokers typically don't offer it for currency pairs.</li> <li>Symbol availability: DOM usually available for futures, stocks, some crypto. Rare for Forex spot.</li> <li>Subscription required: Must call this before <code>MarketBookGetAsync</code>, otherwise get empty data.</li> <li>Resource usage: Keep subscriptions minimal. Unsubscribe with <code>MarketBookReleaseAsync</code> when done.</li> <li>Return value: If <code>false</code>, broker doesn't provide DOM for this symbol.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#1-basic-dom-subscription","title":"1) Basic DOM subscription","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.MarketBookAddAsync(\"BTCUSD\");\n\nif (result.OpenedSuccessfully)\n{\n    Console.WriteLine(\"\u2713 DOM subscription opened for BTCUSD\");\n\n    // Now can call MarketBookGetAsync\n    var domData = await acc.MarketBookGetAsync(\"BTCUSD\");\n    Console.WriteLine($\"DOM entries: {domData.MqlBookInfos.Count}\");\n}\nelse\n{\n    Console.WriteLine(\"\u2717 DOM not available for BTCUSD\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#2-subscribe-with-error-handling","title":"2) Subscribe with error handling","text":"<pre><code>try\n{\n    var result = await acc.MarketBookAddAsync(\n        \"EURUSD\",\n        deadline: DateTime.UtcNow.AddSeconds(5));\n\n    if (!result.OpenedSuccessfully)\n    {\n        Console.WriteLine(\"\u26a0 Broker doesn't provide DOM for EURUSD\");\n    }\n}\ncatch (Grpc.Core.RpcException ex) when (ex.StatusCode == Grpc.Core.StatusCode.DeadlineExceeded)\n{\n    Console.WriteLine(\"\u2717 DOM subscription timeout (broker may not support it)\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#3-subscribe-to-multiple-symbols","title":"3) Subscribe to multiple symbols","text":"<pre><code>var symbols = new[] { \"BTCUSD\", \"ETHUSD\", \"XAUUSD\" };\n\nforeach (var symbol in symbols)\n{\n    var result = await acc.MarketBookAddAsync(symbol);\n\n    Console.WriteLine($\"{symbol}: {(result.OpenedSuccessfully ? \"\u2713 Subscribed\" : \"\u2717 Not available\")}\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#4-subscribe-and-immediately-check-data","title":"4) Subscribe and immediately check data","text":"<pre><code>var symbol = \"ES\"; // E-mini S&amp;P 500 futures\n\nvar subResult = await acc.MarketBookAddAsync(symbol);\n\nif (subResult.OpenedSuccessfully)\n{\n    // Wait a moment for data to populate\n    await Task.Delay(100);\n\n    var domData = await acc.MarketBookGetAsync(symbol);\n\n    if (domData.MqlBookInfos.Count &gt; 0)\n    {\n        Console.WriteLine($\"\u2713 DOM active with {domData.MqlBookInfos.Count} price levels\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u26a0 Subscription opened but no data yet\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookAdd/#5-conditional-subscription-check-if-symbol-exists-first","title":"5) Conditional subscription (check if symbol exists first)","text":"<pre><code>var symbol = \"BTCUSD\";\n\n// First check if symbol exists\nvar symbolExists = await acc.SymbolExistAsync(symbol);\n\nif (symbolExists.Exist)\n{\n    var result = await acc.MarketBookAddAsync(symbol);\n\n    if (result.OpenedSuccessfully)\n    {\n        Console.WriteLine($\"\u2713 DOM subscription opened for {symbol}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0 Symbol exists but DOM not available\");\n    }\n}\nelse\n{\n    Console.WriteLine($\"\u2717 Symbol {symbol} not found\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/","title":"\u2705 Get Market Depth Data (<code>MarketBookGetAsync</code>)","text":"<p>Request: Get current Depth of Market (order book) snapshot for a subscribed symbol on MT5.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.MarketBookGetAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>MarketBookGet</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>MarketBookGet(MarketBookGetRequest) \u2192 MarketBookGetReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.MarketInfoClient.MarketBookGet(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;MarketBookGetData&gt; MarketBookGetAsync(\n            string symbol,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>MarketBookGetRequest { symbol }</code></p> <p>Reply message:</p> <p><code>MarketBookGetReply { data: MarketBookGetData }</code></p>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (must be subscribed via <code>MarketBookAddAsync</code>) <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#output-marketbookgetdata","title":"\u2b06\ufe0f Output \u2014 <code>MarketBookGetData</code>","text":"Field Type Description <code>MqlBookInfos</code> <code>List&lt;MrpcMqlBookInfo&gt;</code> Array of DOM entries (price levels)"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#mrpcmqlbookinfo-dom-entry-structure","title":"<code>MrpcMqlBookInfo</code> \u2014 DOM entry structure","text":"Field Type Description <code>Type</code> <code>BookType</code> Order type (Sell, Buy, SellMarket, BuyMarket) <code>Price</code> <code>double</code> Price level <code>Volume</code> <code>long</code> Volume at this price (in contracts/lots) <code>VolumeReal</code> <code>double</code> Real volume at this price"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#booktype","title":"<code>BookType</code>","text":"<ul> <li><code>Sell</code> (0) \u2014 Sell order (Offer/Ask side)</li> <li><code>Buy</code> (1) \u2014 Buy order (Bid side)</li> <li><code>SellMarket</code> (2) \u2014 Sell market order</li> <li><code>BuyMarket</code> (3) \u2014 Buy market order</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Returns current order book snapshot with bid/ask price levels and volumes.</li> <li>Why you need it. Analyze liquidity, identify support/resistance, implement DOM-based strategies.</li> <li>Sanity check. If <code>MqlBookInfos.Count &gt; 0</code> \u2192 DOM data available. Empty list = no data or not subscribed.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to analyze order book:</p> <ul> <li>Get bid/ask price levels.</li> <li>Analyze liquidity distribution.</li> <li>Identify large orders (support/resistance).</li> <li>Implement order flow strategies.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Subscription required: Must call <code>MarketBookAddAsync</code> first, otherwise get empty list.</li> <li>Snapshot data: Returns current state at call time. For real-time updates use streaming (SubscribeToBookEvent).</li> <li>Price sorting: Entries typically sorted by price (best bid/ask first). Verify sorting in your code.</li> <li>Empty result: If <code>MqlBookInfos</code> is empty, either not subscribed or broker doesn't provide DOM.</li> <li>Broker limitations: Most Forex brokers don't provide DOM. Available mainly for futures, stocks, crypto.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#1-basic-dom-retrieval","title":"1) Basic DOM retrieval","text":"<pre><code>// acc \u2014 connected MT5Account\n// Symbol must be subscribed via MarketBookAddAsync first\n\nvar domData = await acc.MarketBookGetAsync(\"BTCUSD\");\n\nConsole.WriteLine($\"DOM entries: {domData.MqlBookInfos.Count}\");\n\nforeach (var entry in domData.MqlBookInfos.Take(10))\n{\n    var side = entry.Type == BookType.BookTypeBuy ? \"BID\" : \"ASK\";\n    Console.WriteLine($\"{side} | Price: {entry.Price:F2} | Volume: {entry.VolumeReal:F4}\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#2-analyze-best-bidask","title":"2) Analyze best bid/ask","text":"<pre><code>var domData = await acc.MarketBookGetAsync(\"ETHUSD\");\n\nif (domData.MqlBookInfos.Count &gt; 0)\n{\n    var bids = domData.MqlBookInfos\n        .Where(e =&gt; e.Type == BookType.BookTypeBuy)\n        .OrderByDescending(e =&gt; e.Price);\n\n    var asks = domData.MqlBookInfos\n        .Where(e =&gt; e.Type == BookType.BookTypeSell)\n        .OrderBy(e =&gt; e.Price);\n\n    var bestBid = bids.FirstOrDefault();\n    var bestAsk = asks.FirstOrDefault();\n\n    if (bestBid != null &amp;&amp; bestAsk != null)\n    {\n        var spread = bestAsk.Price - bestBid.Price;\n        Console.WriteLine($\"Best Bid: {bestBid.Price} | Best Ask: {bestAsk.Price} | Spread: {spread}\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#3-find-large-orders-liquidity-analysis","title":"3) Find large orders (liquidity analysis)","text":"<pre><code>var domData = await acc.MarketBookGetAsync(\"ES\"); // E-mini S&amp;P 500\n\n// Find orders with volume &gt; 100 contracts\nvar largeOrders = domData.MqlBookInfos\n    .Where(e =&gt; e.Volume &gt; 100)\n    .OrderByDescending(e =&gt; e.Volume);\n\nConsole.WriteLine(\"Large orders (potential support/resistance):\");\nforeach (var order in largeOrders.Take(5))\n{\n    var side = order.Type == BookType.BookTypeBuy ? \"BID\" : \"ASK\";\n    Console.WriteLine($\"{side} | Price: {order.Price} | Volume: {order.Volume}\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#4-calculate-total-liquidity-by-side","title":"4) Calculate total liquidity by side","text":"<pre><code>var domData = await acc.MarketBookGetAsync(\"XAUUSD\");\n\nvar totalBidVolume = domData.MqlBookInfos\n    .Where(e =&gt; e.Type == BookType.BookTypeBuy)\n    .Sum(e =&gt; e.VolumeReal);\n\nvar totalAskVolume = domData.MqlBookInfos\n    .Where(e =&gt; e.Type == BookType.BookTypeSell)\n    .Sum(e =&gt; e.VolumeReal);\n\nvar bidAskRatio = totalBidVolume / (totalAskVolume &gt; 0 ? totalAskVolume : 1);\n\nConsole.WriteLine($\"Total Bid Liquidity: {totalBidVolume:F2}\");\nConsole.WriteLine($\"Total Ask Liquidity: {totalAskVolume:F2}\");\nConsole.WriteLine($\"Bid/Ask Ratio: {bidAskRatio:F2}\");\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#5-continuous-dom-monitoring-polling","title":"5) Continuous DOM monitoring (polling)","text":"<pre><code>var symbol = \"BTCUSD\";\n\n// Subscribe first\nvar subResult = await acc.MarketBookAddAsync(symbol);\nif (!subResult.OpenedSuccessfully)\n{\n    Console.WriteLine(\"DOM not available\");\n    return;\n}\n\n// Poll DOM every second for 10 iterations\nfor (int i = 0; i &lt; 10; i++)\n{\n    var domData = await acc.MarketBookGetAsync(symbol);\n\n    if (domData.MqlBookInfos.Count &gt; 0)\n    {\n        var bestBid = domData.MqlBookInfos\n            .Where(e =&gt; e.Type == BookType.BookTypeBuy)\n            .MaxBy(e =&gt; e.Price);\n\n        var bestAsk = domData.MqlBookInfos\n            .Where(e =&gt; e.Type == BookType.BookTypeSell)\n            .MinBy(e =&gt; e.Price);\n\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Bid: {bestBid?.Price} | Ask: {bestAsk?.Price}\");\n    }\n\n    await Task.Delay(1000); // Wait 1 second\n}\n\n// Unsubscribe when done\nawait acc.MarketBookReleaseAsync(symbol);\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookGet/#6-dom-based-entry-strategy-example","title":"6) DOM-based entry strategy (example)","text":"<pre><code>// Simple strategy: Enter when large order appears near current price\nvar domData = await acc.MarketBookGetAsync(\"ES\");\nvar currentPrice = (await acc.SymbolInfoTickAsync(\"ES\")).Bid;\n\nvar nearbyLargeOrders = domData.MqlBookInfos\n    .Where(e =&gt; Math.Abs(e.Price - currentPrice) &lt; 5.0) // Within 5 points\n    .Where(e =&gt; e.Volume &gt; 200) // Large order\n    .ToList();\n\nif (nearbyLargeOrders.Any())\n{\n    Console.WriteLine($\"\u26a0 {nearbyLargeOrders.Count} large order(s) near price {currentPrice}\");\n\n    foreach (var order in nearbyLargeOrders)\n    {\n        var side = order.Type == BookType.BookTypeBuy ? \"Support\" : \"Resistance\";\n        Console.WriteLine($\"{side} at {order.Price} with volume {order.Volume}\");\n    }\n\n    // Implement your entry logic here\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/","title":"\u2705 Unsubscribe from Market Depth (<code>MarketBookReleaseAsync</code>)","text":"<p>Request: Unsubscribe from Depth of Market (DOM) updates for a symbol on MT5. Closes DOM subscription and frees resources.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.MarketBookReleaseAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>MarketBookRelease</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>MarketBookRelease(MarketBookReleaseRequest) \u2192 MarketBookReleaseReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.MarketInfoClient.MarketBookRelease(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;MarketBookReleaseData&gt; MarketBookReleaseAsync(\n            string symbol,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>MarketBookReleaseRequest { symbol }</code></p> <p>Reply message:</p> <p><code>MarketBookReleaseReply { data: MarketBookReleaseData }</code></p>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>symbol</code> <code>string</code> Symbol name (previously subscribed via <code>MarketBookAddAsync</code>) <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#output-marketbookreleasedata","title":"\u2b06\ufe0f Output \u2014 <code>MarketBookReleaseData</code>","text":"Field Type Description <code>ClosedSuccessfully</code> <code>bool</code> <code>true</code> if unsubscription successful"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Closes DOM subscription for a symbol. Stops receiving order book updates and frees resources.</li> <li>Why you need it. Clean up subscriptions when done. Reduce server/terminal load by unsubscribing unused symbols.</li> <li>Sanity check. If <code>ClosedSuccessfully == true</code> \u2192 subscription closed. Can no longer get DOM via <code>MarketBookGetAsync</code>.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to clean up DOM subscriptions:</p> <ul> <li>Free terminal/server resources.</li> <li>Stop receiving DOM updates for unused symbols.</li> <li>Proper cleanup before shutdown.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Resource management: Always unsubscribe when done to avoid resource leaks.</li> <li>Multiple symbols: Call separately for each subscribed symbol.</li> <li>Already unsubscribed: Returns <code>true</code> even if symbol wasn't subscribed.</li> <li>No penalty: Safe to call multiple times for same symbol.</li> <li>Cleanup order: Unsubscribe before disconnecting from MT5.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#1-basic-unsubscribe","title":"1) Basic unsubscribe","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.MarketBookReleaseAsync(\"BTCUSD\");\n\nif (result.ClosedSuccessfully)\n{\n    Console.WriteLine(\"\u2713 DOM subscription closed for BTCUSD\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0 Failed to close DOM subscription\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#2-subscribe-use-then-unsubscribe-pattern","title":"2) Subscribe, use, then unsubscribe pattern","text":"<pre><code>var symbol = \"ETHUSD\";\n\n// 1. Subscribe\nvar subResult = await acc.MarketBookAddAsync(symbol);\nif (!subResult.OpenedSuccessfully)\n{\n    Console.WriteLine(\"DOM not available\");\n    return;\n}\n\ntry\n{\n    // 2. Use DOM data\n    var domData = await acc.MarketBookGetAsync(symbol);\n    Console.WriteLine($\"DOM entries: {domData.MqlBookInfos.Count}\");\n\n    // Process DOM data...\n}\nfinally\n{\n    // 3. Always unsubscribe (cleanup)\n    var releaseResult = await acc.MarketBookReleaseAsync(symbol);\n    Console.WriteLine($\"Cleanup: {releaseResult.ClosedSuccessfully}\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#3-unsubscribe-from-multiple-symbols","title":"3) Unsubscribe from multiple symbols","text":"<pre><code>var symbols = new[] { \"BTCUSD\", \"ETHUSD\", \"XAUUSD\" };\n\nforeach (var symbol in symbols)\n{\n    var result = await acc.MarketBookReleaseAsync(symbol);\n    Console.WriteLine($\"{symbol}: {(result.ClosedSuccessfully ? \"\u2713 Unsubscribed\" : \"\u2717 Failed\")}\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#4-using-statement-pattern-automatic-cleanup","title":"4) Using statement pattern (automatic cleanup)","text":"<pre><code>async Task UseDomData(MT5Account acc, string symbol)\n{\n    // Subscribe\n    var subResult = await acc.MarketBookAddAsync(symbol);\n    if (!subResult.OpenedSuccessfully)\n        return;\n\n    try\n    {\n        // Use DOM\n        for (int i = 0; i &lt; 5; i++)\n        {\n            var domData = await acc.MarketBookGetAsync(symbol);\n            Console.WriteLine($\"Iteration {i}: {domData.MqlBookInfos.Count} entries\");\n            await Task.Delay(1000);\n        }\n    }\n    finally\n    {\n        // Cleanup\n        await acc.MarketBookReleaseAsync(symbol);\n    }\n}\n\n// Call\nawait UseDomData(acc, \"BTCUSD\");\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#5-graceful-shutdown-with-error-handling","title":"5) Graceful shutdown with error handling","text":"<pre><code>var subscribedSymbols = new List&lt;string&gt; { \"ES\", \"NQ\", \"YM\" };\n\n// Subscribe to all\nforeach (var symbol in subscribedSymbols)\n{\n    await acc.MarketBookAddAsync(symbol);\n}\n\n// ... use DOM data ...\n\n// Graceful shutdown: unsubscribe from all\nConsole.WriteLine(\"Shutting down, cleaning up DOM subscriptions...\");\n\nforeach (var symbol in subscribedSymbols)\n{\n    try\n    {\n        var result = await acc.MarketBookReleaseAsync(\n            symbol,\n            deadline: DateTime.UtcNow.AddSeconds(3));\n\n        if (result.ClosedSuccessfully)\n        {\n            Console.WriteLine($\"\u2713 {symbol} unsubscribed\");\n        }\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"\u26a0 {symbol} unsubscribe failed: {ex.Message}\");\n    }\n}\n\nConsole.WriteLine(\"Cleanup complete\");\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/MarketBookRelease/#6-conditional-unsubscribe-check-if-subscribed-first","title":"6) Conditional unsubscribe (check if subscribed first)","text":"<pre><code>var symbol = \"BTCUSD\";\n\n// Try to get DOM data first\ntry\n{\n    var domData = await acc.MarketBookGetAsync(symbol);\n\n    if (domData.MqlBookInfos.Count &gt; 0)\n    {\n        // Has data, so was subscribed\n        var result = await acc.MarketBookReleaseAsync(symbol);\n        Console.WriteLine($\"\u2713 Unsubscribed from {symbol}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0 {symbol} not subscribed or no data\");\n    }\n}\ncatch\n{\n    Console.WriteLine($\"\u26a0 {symbol} not subscribed\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/","title":"MT5Account \u00b7 Market Depth (DOM) - Overview","text":"<p>Depth of Market (Order Book) data - bid/ask price levels with volumes. Use this page to choose the right API for DOM operations.</p>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>MarketBookAdd - subscribe to DOM updates for a symbol.</li> <li>MarketBookGet - get current order book snapshot.</li> <li>MarketBookRelease - unsubscribe from DOM updates.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>MarketBookAdd \u2192 open subscription to order book (required first step).</li> <li>MarketBookGet \u2192 fetch current bid/ask levels with volumes.</li> <li>MarketBookRelease \u2192 close subscription when done (free resources).</li> </ul> <p>Important: Most Forex brokers don't provide DOM data. Available mainly for futures, stocks, and some crypto symbols.</p> <p>Workflow: <code>MarketBookAddAsync</code> \u2192 <code>MarketBookGetAsync</code> (repeatedly) \u2192 <code>MarketBookReleaseAsync</code> when done.</p>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns Key inputs Subscribe to order book <code>MarketBookAddAsync</code> Success flag Symbol name Get current order book snapshot <code>MarketBookGetAsync</code> List of price levels Symbol name (must be subscribed) Unsubscribe from order book <code>MarketBookReleaseAsync</code> Success flag Symbol name"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>Broker support: Not all brokers provide DOM. Forex spot pairs rarely have DOM.</li> <li>Subscription required: Must call <code>MarketBookAddAsync</code> before <code>MarketBookGetAsync</code>.</li> <li>Price levels: Each level shows price, volume, and type (Buy/Sell/Market).</li> <li>Volume is in contracts/lots, not in currency.</li> <li>Real-time updates: For streaming DOM use SubscribeToBookEvent (if available).</li> <li>Resource management: Always call <code>MarketBookReleaseAsync</code> when done.</li> </ul>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Subscribe to DOM\nvar addResult = await account.MarketBookAddAsync(\"EURUSD\");\nif (addResult.OpenedSuccessfully)\n{\n    Console.WriteLine(\"\u2705 DOM subscription opened\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c DOM not available for this symbol\");\n    return;\n}\n</code></pre> <pre><code>// Get order book snapshot\nvar bookData = await account.MarketBookGetAsync(\"EURUSD\");\nif (bookData.MqlBookInfos.Any())\n{\n    Console.WriteLine(\"Order Book:\");\n    foreach (var entry in bookData.MqlBookInfos)\n    {\n        var side = entry.Type == BookType.Buy ? \"BID\" : \"ASK\";\n        Console.WriteLine($\"{side} {entry.Price:F5} | Volume: {entry.VolumeReal:F2}\");\n    }\n}\nelse\n{\n    Console.WriteLine(\"No DOM data available\");\n}\n</code></pre> <pre><code>// Analyze liquidity at price levels\nvar bookData = await account.MarketBookGetAsync(\"BTCUSD\");\nvar bids = bookData.MqlBookInfos.Where(x =&gt; x.Type == BookType.Buy).ToList();\nvar asks = bookData.MqlBookInfos.Where(x =&gt; x.Type == BookType.Sell).ToList();\n\nvar bidVolume = bids.Sum(x =&gt; x.VolumeReal);\nvar askVolume = asks.Sum(x =&gt; x.VolumeReal);\n\nConsole.WriteLine($\"Total Bid Volume: {bidVolume:F2}, Total Ask Volume: {askVolume:F2}\");\nConsole.WriteLine($\"Bid/Ask Ratio: {(bidVolume / askVolume):F2}\");\n</code></pre> <pre><code>// Unsubscribe when done\nvar releaseResult = await account.MarketBookReleaseAsync(\"EURUSD\");\nif (releaseResult.ClosedSuccessfully)\n{\n    Console.WriteLine(\"\u2705 DOM subscription closed\");\n}\n</code></pre> <pre><code>// Full workflow with error handling\ntry\n{\n    var symbol = \"XAUUSD\";\n\n    // 1. Subscribe\n    var added = await account.MarketBookAddAsync(symbol);\n    if (!added.OpenedSuccessfully)\n    {\n        Console.WriteLine($\"DOM not available for {symbol}\");\n        return;\n    }\n\n    // 2. Get data (can be called multiple times)\n    for (int i = 0; i &lt; 10; i++)\n    {\n        var book = await account.MarketBookGetAsync(symbol);\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Levels: {book.MqlBookInfos.Count}\");\n        await Task.Delay(1000);\n    }\n\n    // 3. Unsubscribe\n    await account.MarketBookReleaseAsync(symbol);\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"Error: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Account/5.%20Market_Depth%28DOM%29/Market_Depth.Overview/#see-also","title":"See also","text":"<ul> <li>Symbols: SymbolInfoTick - get bid/ask prices without DOM</li> <li>Symbols: SymbolExist - check if symbol exists before subscribing</li> <li>Trading: OrderSend - place orders based on DOM analysis</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/","title":"MT5Account \u00b7 Additional Methods - Overview","text":"<p>Advanced symbol information, trading sessions, margin rates, tick values, and batch operations. Use this page for specialized symbol analysis.</p>"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>SymbolInfoMarginRate - margin requirements (initial &amp; maintenance) for order types.</li> <li>SymbolInfoSessionQuote - quote session times for specific day and symbol.</li> <li>SymbolInfoSessionTrade - trade session times for specific day and symbol.</li> <li>SymbolParamsMany - detailed parameters for multiple symbols (112 fields per symbol!).</li> <li>TickValueWithSize - tick values and contract sizes for multiple symbols in one call.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>SymbolInfoMarginRate \u2192 find out margin requirements before trading different order types.</li> <li>SymbolInfoSession* (Quote/Trade) \u2192 check when market is open for quotes or trading.</li> <li>SymbolParamsMany \u2192 get everything about symbols (bid, ask, spread, volumes, margins, sessions, etc.).</li> <li>TickValueWithSize \u2192 batch-fetch pip values and contract sizes for risk calculations.</li> </ul> <p>These are advanced methods - most traders only need basic SymbolInfo methods. Use these for: - Risk management calculations - Trading time validation - Multi-symbol analysis - Detailed symbol research</p>"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns Key inputs Margin rates for order type <code>SymbolInfoMarginRateAsync</code> Initial + Maintenance rates Symbol + Order type Quote session times <code>SymbolInfoSessionQuoteAsync</code> Session start/end times Symbol + Day + Session index Trade session times <code>SymbolInfoSessionTradeAsync</code> Session start/end times Symbol + Day + Session index Detailed symbol info (112 fields!) <code>SymbolParamsManyAsync</code> SymbolParameters objects Optional: symbol filter, pagination Tick values for multiple symbols <code>TickValueWithSizeAsync</code> Tick values + contract sizes List of symbol names"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>Margin rates differ by order type (Buy vs Sell may have different rates).</li> <li>Session times are in seconds from 00:00 - extract hours/minutes.</li> <li>Multiple sessions possible per day (e.g., pre-market, regular, after-hours).</li> <li>SymbolParamsMany returns 112 fields - filter what you need.</li> <li>Tick value helps convert points to account currency for P/L calculations.</li> <li>Contract size determines lot size (1 lot = contract size units of base currency).</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Get margin requirements for Buy order\nvar marginData = await account.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n{\n    Symbol = \"EURUSD\",\n    OrderType = ENUM_ORDER_TYPE.OrderTypeBuy\n});\nConsole.WriteLine($\"Initial Margin Rate: {marginData.InitialMarginRate:F2}\");\nConsole.WriteLine($\"Maintenance Margin Rate: {marginData.MaintenanceMarginRate:F2}\");\n</code></pre> <pre><code>// Check if market is open for trading (Monday session 0)\nvar sessionData = await account.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n{\n    Symbol = \"EURUSD\",\n    DayOfWeek = DayOfWeek.Monday,\n    SessionIndex = 0\n});\nvar from = sessionData.From.ToDateTime();\nvar to = sessionData.To.ToDateTime();\nConsole.WriteLine($\"Monday trading session: {from:HH:mm} - {to:HH:mm}\");\n</code></pre> <pre><code>// Get detailed info for multiple symbols\nvar symbolsData = await account.SymbolParamsManyAsync(new SymbolParamsManyRequest\n{\n    // Optional: filter by symbol name\n    // SymbolName = \"EUR\",  // Returns symbols containing \"EUR\"\n    ItemsPerPage = 10,\n    PageNumber = 0\n});\n\nforeach (var symbol in symbolsData.SymbolInfos)\n{\n    Console.WriteLine($\"{symbol.Name}: Bid={symbol.Bid:F5}, Ask={symbol.Ask:F5}, \" +\n                      $\"Spread={symbol.Spread} pts, Volume={symbol.VolumeReal:F2}\");\n}\nConsole.WriteLine($\"Total symbols: {symbolsData.SymbolsTotal}\");\n</code></pre> <pre><code>// Calculate pip value for multiple symbols at once\nvar tickData = await account.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { \"EURUSD\", \"GBPUSD\", \"USDJPY\" }\n});\n\nforeach (var symbolInfo in tickData.SymbolTickSizeInfos)\n{\n    Console.WriteLine($\"{symbolInfo.Name}:\");\n    Console.WriteLine($\"  Tick Value: ${symbolInfo.TradeTickValue:F2}\");\n    Console.WriteLine($\"  Tick Size: {symbolInfo.TradeTickSize:F5}\");\n    Console.WriteLine($\"  Contract Size: {symbolInfo.TradeContractSize:F0}\");\n    Console.WriteLine($\"  Pip Value (Profit): ${symbolInfo.TradeTickValueProfit:F2}\");\n    Console.WriteLine($\"  Pip Value (Loss): ${symbolInfo.TradeTickValueLoss:F2}\");\n}\n</code></pre> <pre><code>// Check if XAUUSD is available for trading now\nvar now = DateTime.Now;\nvar sessionData = await account.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n{\n    Symbol = \"XAUUSD\",\n    DayOfWeek = now.DayOfWeek,\n    SessionIndex = 0  // First session of the day\n});\n\nvar sessionStart = sessionData.From.ToDateTime();\nvar sessionEnd = sessionData.To.ToDateTime();\nvar currentTime = TimeSpan.Parse(now.ToString(\"HH:mm:ss\"));\n\nif (currentTime &gt;= sessionStart.TimeOfDay &amp;&amp; currentTime &lt;= sessionEnd.TimeOfDay)\n{\n    Console.WriteLine(\"\u2705 Market is OPEN for trading\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Market CLOSED - Opens at {sessionStart:HH:mm}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/Additional_Methods.Overview/#see-also","title":"See also","text":"<ul> <li>Basic Symbol Info: SymbolInfoDouble/Integer/String - simpler methods</li> <li>Trading: OrderCalcMargin - calculate margin for specific order</li> <li>Account: AccountSummary - check available margin</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/","title":"\u2705 Get Margin Requirements (<code>SymbolInfoMarginRateAsync</code>)","text":"<p>Request: Get margin rates (initial and maintenance) for a symbol and order type on MT5.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoMarginRateAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoMarginRate</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoMarginRate(SymbolInfoMarginRateRequest) \u2192 SymbolInfoMarginRateReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.MarketInfoClient.SymbolInfoMarginRate(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolInfoMarginRateData&gt; SymbolInfoMarginRateAsync(\n            SymbolInfoMarginRateRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoMarginRateRequest { symbol, order_type }</code></p> <p>Reply message:</p> <p><code>SymbolInfoMarginRateReply { data: SymbolInfoMarginRateData }</code></p>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>SymbolInfoMarginRateRequest</code> Protobuf request with symbol and order type <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#symbolinfomarginraterequest","title":"<code>SymbolInfoMarginRateRequest</code>","text":"Field Type Description <code>Symbol</code> <code>string</code> Symbol name (e.g., <code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>) REQUIRED <code>OrderType</code> <code>ENUM_ORDER_TYPE</code> Order type (Buy, Sell, BuyLimit, etc.) REQUIRED"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#output-symbolinfomarginratedata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolInfoMarginRateData</code>","text":"Field Type Description <code>MaintenanceMarginRate</code> <code>double</code> Maintenance margin rate (minimum to maintain 1 lot open position) <code>InitialMarginRate</code> <code>double</code> Initial margin rate (security deposit for 1 lot deal)"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#enum_order_type","title":"<code>ENUM_ORDER_TYPE</code>","text":"<ul> <li><code>OrderTypeBuy</code> \u2014 Market Buy order</li> <li><code>OrderTypeSell</code> \u2014 Market Sell order</li> <li><code>OrderTypeBuyLimit</code> \u2014 Buy Limit pending order</li> <li><code>OrderTypeSellLimit</code> \u2014 Sell Limit pending order</li> <li><code>OrderTypeBuyStop</code> \u2014 Buy Stop pending order</li> <li><code>OrderTypeSellStop</code> \u2014 Sell Stop pending order</li> <li><code>OrderTypeBuyStopLimit</code> \u2014 Buy Stop Limit pending order</li> <li><code>OrderTypeSellStopLimit</code> \u2014 Sell Stop Limit pending order</li> <li><code>OrderTypeCloseBy</code> \u2014 Order to close position by opposite one</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Returns margin rates for opening and maintaining positions. Rates are multipliers for calculating required margin.</li> <li>Why you need it. Calculate required margin before trading, implement risk management, validate available margin for new positions.</li> <li>Sanity check. If <code>InitialMarginRate &gt; 0</code> \u2192 valid margin data. Multiply by symbol's initial/maintenance margin to get actual margin requirement.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to calculate margin requirements:</p> <ul> <li>Determine margin needed to open a position.</li> <li>Calculate maintenance margin for risk management.</li> <li>Validate if account has sufficient margin.</li> <li>Compare margin requirements across symbols/order types.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Margin calculation: Actual margin = Rate \u00d7 Symbol's InitialMargin (or MaintenanceMargin).</li> <li>Order type matters: Margin rates can differ between Buy and Sell for some symbols (especially exotic pairs).</li> <li>Initial vs Maintenance: Initial margin is locked when opening. Maintenance margin determines when stop-out occurs.</li> <li>Symbol-specific: Different symbols have different base margin values. This method returns the rate multiplier.</li> <li>Use with SymbolInfo: Combine with <code>SymbolInfoDouble</code> to get symbol's base margin values.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#1-basic-margin-rate-retrieval","title":"1) Basic margin rate retrieval","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n{\n    Symbol = \"EURUSD\",\n    OrderType = ENUM_ORDER_TYPE.OrderTypeBuy\n});\n\nConsole.WriteLine($\"Initial margin rate: {result.InitialMarginRate}\");\nConsole.WriteLine($\"Maintenance margin rate: {result.MaintenanceMarginRate}\");\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#2-calculate-required-margin-for-position","title":"2) Calculate required margin for position","text":"<pre><code>var symbol = \"XAUUSD\";\nvar lots = 0.10;\n\n// Get margin rates\nvar marginRates = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n{\n    Symbol = symbol,\n    OrderType = ENUM_ORDER_TYPE.OrderTypeBuy\n});\n\n// Get symbol margin info (using SymbolInfoDouble)\n// Assuming you have method to get SYMBOL_MARGIN_INITIAL\nvar baseMargin = 100.0; // Example: $100 base margin for 1 lot\n\nvar requiredMargin = lots * baseMargin * marginRates.InitialMarginRate;\n\nConsole.WriteLine($\"Required margin for {lots} lots: ${requiredMargin:F2}\");\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#3-compare-buy-vs-sell-margin-requirements","title":"3) Compare Buy vs Sell margin requirements","text":"<pre><code>var symbol = \"USDJPY\";\n\nvar buyMargin = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n{\n    Symbol = symbol,\n    OrderType = ENUM_ORDER_TYPE.OrderTypeBuy\n});\n\nvar sellMargin = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n{\n    Symbol = symbol,\n    OrderType = ENUM_ORDER_TYPE.OrderTypeSell\n});\n\nConsole.WriteLine($\"Buy - Initial: {buyMargin.InitialMarginRate}, Maintenance: {buyMargin.MaintenanceMarginRate}\");\nConsole.WriteLine($\"Sell - Initial: {sellMargin.InitialMarginRate}, Maintenance: {sellMargin.MaintenanceMarginRate}\");\n\nif (buyMargin.InitialMarginRate != sellMargin.InitialMarginRate)\n{\n    Console.WriteLine(\"\u26a0 Asymmetric margin requirements detected\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#4-check-if-account-can-open-position","title":"4) Check if account can open position","text":"<pre><code>var symbol = \"BTCUSD\";\nvar lots = 0.05;\n\n// Get account equity\nvar account = await acc.AccountSummaryAsync();\nvar availableMargin = account.AccountEquity;\n\n// Get margin rates\nvar marginRates = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n{\n    Symbol = symbol,\n    OrderType = ENUM_ORDER_TYPE.OrderTypeBuy\n});\n\n// Calculate required margin (simplified example)\nvar baseMargin = 1000.0; // Example base margin\nvar requiredMargin = lots * baseMargin * marginRates.InitialMarginRate;\n\nif (availableMargin &gt;= requiredMargin)\n{\n    Console.WriteLine($\"\u2713 Can open {lots} lots (need ${requiredMargin:F2}, have ${availableMargin:F2})\");\n}\nelse\n{\n    Console.WriteLine($\"\u2717 Insufficient margin (need ${requiredMargin:F2}, have ${availableMargin:F2})\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#5-margin-rates-for-all-order-types","title":"5) Margin rates for all order types","text":"<pre><code>var symbol = \"EURUSD\";\n\nvar orderTypes = new[]\n{\n    ENUM_ORDER_TYPE.OrderTypeBuy,\n    ENUM_ORDER_TYPE.OrderTypeSell,\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    ENUM_ORDER_TYPE.OrderTypeSellLimit,\n    ENUM_ORDER_TYPE.OrderTypeBuyStop,\n    ENUM_ORDER_TYPE.OrderTypeSellStop\n};\n\nConsole.WriteLine($\"Margin rates for {symbol}:\\n\");\n\nforeach (var orderType in orderTypes)\n{\n    try\n    {\n        var result = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n        {\n            Symbol = symbol,\n            OrderType = orderType\n        });\n\n        Console.WriteLine($\"{orderType,-25} Initial: {result.InitialMarginRate:F4}  Maintenance: {result.MaintenanceMarginRate:F4}\");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"{orderType,-25} Error: {ex.Message}\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoMarginRate/#6-risk-management-calculate-stop-out-level","title":"6) Risk management: calculate stop-out level","text":"<pre><code>var symbol = \"XAUUSD\";\nvar lots = 0.10;\n\n// Get current position info\nvar positions = await acc.OpenedOrdersAsync();\nvar position = positions.Positions.FirstOrDefault(p =&gt; p.Symbol == symbol);\n\nif (position != null)\n{\n    // Get maintenance margin rate\n    var marginRates = await acc.SymbolInfoMarginRateAsync(new SymbolInfoMarginRateRequest\n    {\n        Symbol = symbol,\n        OrderType = position.Type == 0 ? ENUM_ORDER_TYPE.OrderTypeBuy : ENUM_ORDER_TYPE.OrderTypeSell\n    });\n\n    // Calculate maintenance margin requirement\n    var baseMargin = 1000.0; // Example\n    var maintenanceMargin = position.Volume * baseMargin * marginRates.MaintenanceMarginRate;\n\n    // Get account info\n    var account = await acc.AccountSummaryAsync();\n\n    // Calculate margin level\n    var marginLevel = (account.AccountEquity / maintenanceMargin) * 100;\n\n    Console.WriteLine($\"Position maintenance margin: ${maintenanceMargin:F2}\");\n    Console.WriteLine($\"Current equity: ${account.AccountEquity:F2}\");\n    Console.WriteLine($\"Margin level: {marginLevel:F2}%\");\n\n    if (marginLevel &lt; 50)\n    {\n        Console.WriteLine(\"\u26a0 WARNING: Close to stop-out level!\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/","title":"\u2705 Get Quote Session Times (<code>SymbolInfoSessionQuoteAsync</code>)","text":"<p>Request: Get beginning and end times for a quoting session of a specified symbol and day of week on MT5.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoSessionQuoteAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoSessionQuote</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoSessionQuote(SymbolInfoSessionQuoteRequest) \u2192 SymbolInfoSessionQuoteReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.MarketInfoClient.SymbolInfoSessionQuote(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolInfoSessionQuoteData&gt; SymbolInfoSessionQuoteAsync(\n            SymbolInfoSessionQuoteRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoSessionQuoteRequest { symbol, day_of_week, session_index }</code></p> <p>Reply message:</p> <p><code>SymbolInfoSessionQuoteReply { data: SymbolInfoSessionQuoteData }</code></p>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>SymbolInfoSessionQuoteRequest</code> Protobuf request with session parameters <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#symbolinfosessionquoterequest","title":"<code>SymbolInfoSessionQuoteRequest</code>","text":"Field Type Description <code>Symbol</code> <code>string</code> Symbol name (e.g., <code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>) REQUIRED <code>DayOfWeek</code> <code>DayOfWeek</code> Day of the week (Sunday, Monday, etc.) REQUIRED <code>SessionIndex</code> <code>uint32</code> Session index (starts from 0). Most symbols have 1-2 sessions/day"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#output-symbolinfosessionquotedata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolInfoSessionQuoteData</code>","text":"Field Type Description <code>From</code> <code>Timestamp</code> Session beginning time (seconds from 00:00, date should be ignored) <code>To</code> <code>Timestamp</code> Session end time (seconds from 00:00, date should be ignored)"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#dayofweek","title":"<code>DayOfWeek</code>","text":"<ul> <li><code>Sunday</code> \u2014 Sunday (0)</li> <li><code>Monday</code> \u2014 Monday (1)</li> <li><code>Tuesday</code> \u2014 Tuesday (2)</li> <li><code>Wednesday</code> \u2014 Wednesday (3)</li> <li><code>Thursday</code> \u2014 Thursday (4)</li> <li><code>Friday</code> \u2014 Friday (5)</li> <li><code>Saturday</code> \u2014 Saturday (6)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Returns quoting session hours for a symbol on a specific day of week. Quoting sessions determine when price updates are available.</li> <li>Why you need it. Check if quotes are available at specific times, schedule quote-dependent strategies, understand symbol's market hours.</li> <li>Sanity check. If <code>From</code> &lt; <code>To</code> \u2192 valid session. Time is in seconds from midnight. Ignore date component, use only time-of-day.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to understand quoting hours:</p> <ul> <li>Check when symbol receives price updates.</li> <li>Determine if quotes are available at current time.</li> <li>Schedule strategies around quoting sessions.</li> <li>Understand market hours for different symbols.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Quote vs Trade sessions: Quoting sessions show when prices are updated. Trading sessions (SymbolInfoSessionTrade) show when trades can be executed.</li> <li>Session index: Starts from 0. Most symbols have 1 session per day. Some (like futures) may have multiple sessions.</li> <li>Time format: Returned timestamps represent time-of-day only. Date component should be ignored.</li> <li>Extract time: Use <code>timestamp.ToDateTime().TimeOfDay</code> to get time as TimeSpan.</li> <li>Weekend sessions: Some symbols have no quoting sessions on weekends (Saturday/Sunday).</li> <li>Error handling: If session index doesn't exist, server may return error or invalid data.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#1-basic-quote-session-retrieval","title":"1) Basic quote session retrieval","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n{\n    Symbol = \"EURUSD\",\n    DayOfWeek = DayOfWeek.Monday,\n    SessionIndex = 0\n});\n\nvar fromTime = result.From.ToDateTime().TimeOfDay;\nvar toTime = result.To.ToDateTime().TimeOfDay;\n\nConsole.WriteLine($\"EURUSD Monday quote session: {fromTime} - {toTime}\");\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#2-get-all-quote-sessions-for-a-day","title":"2) Get all quote sessions for a day","text":"<pre><code>var symbol = \"ES\"; // E-mini S&amp;P 500 futures\nvar day = DayOfWeek.Wednesday;\n\nConsole.WriteLine($\"{symbol} quote sessions for {day}:\\n\");\n\nfor (uint sessionIndex = 0; sessionIndex &lt; 10; sessionIndex++)\n{\n    try\n    {\n        var result = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n        {\n            Symbol = symbol,\n            DayOfWeek = day,\n            SessionIndex = sessionIndex\n        });\n\n        var fromTime = result.From.ToDateTime().TimeOfDay;\n        var toTime = result.To.ToDateTime().TimeOfDay;\n\n        Console.WriteLine($\"Session {sessionIndex}: {fromTime} - {toTime}\");\n    }\n    catch\n    {\n        // No more sessions\n        break;\n    }\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#3-check-if-quotes-are-available-now","title":"3) Check if quotes are available now","text":"<pre><code>var symbol = \"XAUUSD\";\nvar now = DateTime.UtcNow;\nvar currentDay = (DayOfWeek)((int)now.DayOfWeek); // Convert to proto DayOfWeek\nvar currentTime = now.TimeOfDay;\n\nbool quotesAvailable = false;\n\n// Check all sessions for current day\nfor (uint sessionIndex = 0; sessionIndex &lt; 5; sessionIndex++)\n{\n    try\n    {\n        var result = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n        {\n            Symbol = symbol,\n            DayOfWeek = currentDay,\n            SessionIndex = sessionIndex\n        });\n\n        var fromTime = result.From.ToDateTime().TimeOfDay;\n        var toTime = result.To.ToDateTime().TimeOfDay;\n\n        if (currentTime &gt;= fromTime &amp;&amp; currentTime &lt;= toTime)\n        {\n            quotesAvailable = true;\n            Console.WriteLine($\"\u2713 {symbol} quotes available (session {sessionIndex}: {fromTime} - {toTime})\");\n            break;\n        }\n    }\n    catch\n    {\n        break;\n    }\n}\n\nif (!quotesAvailable)\n{\n    Console.WriteLine($\"\u2717 {symbol} quotes not available at {currentTime}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#4-get-quote-hours-for-entire-week","title":"4) Get quote hours for entire week","text":"<pre><code>var symbol = \"BTCUSD\";\n\nConsole.WriteLine($\"Weekly quote schedule for {symbol}:\\n\");\n\nvar days = new[]\n{\n    DayOfWeek.Sunday,\n    DayOfWeek.Monday,\n    DayOfWeek.Tuesday,\n    DayOfWeek.Wednesday,\n    DayOfWeek.Thursday,\n    DayOfWeek.Friday,\n    DayOfWeek.Saturday\n};\n\nforeach (var day in days)\n{\n    Console.WriteLine($\"{day}:\");\n\n    bool hasSession = false;\n    for (uint sessionIndex = 0; sessionIndex &lt; 5; sessionIndex++)\n    {\n        try\n        {\n            var result = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n            {\n                Symbol = symbol,\n                DayOfWeek = day,\n                SessionIndex = sessionIndex\n            });\n\n            var fromTime = result.From.ToDateTime().TimeOfDay;\n            var toTime = result.To.ToDateTime().TimeOfDay;\n\n            Console.WriteLine($\"  Session {sessionIndex}: {fromTime:hh\\\\:mm} - {toTime:hh\\\\:mm}\");\n            hasSession = true;\n        }\n        catch\n        {\n            break;\n        }\n    }\n\n    if (!hasSession)\n    {\n        Console.WriteLine(\"  No quote sessions\");\n    }\n\n    Console.WriteLine();\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#5-calculate-time-until-next-quote-session","title":"5) Calculate time until next quote session","text":"<pre><code>var symbol = \"EURUSD\";\nvar now = DateTime.UtcNow;\nvar currentDay = (DayOfWeek)((int)now.DayOfWeek);\nvar currentTime = now.TimeOfDay;\n\n// Try to find next session\nTimeSpan? timeUntilNextSession = null;\n\nfor (int dayOffset = 0; dayOffset &lt; 7; dayOffset++)\n{\n    var checkDay = (DayOfWeek)(((int)currentDay + dayOffset) % 7);\n\n    for (uint sessionIndex = 0; sessionIndex &lt; 5; sessionIndex++)\n    {\n        try\n        {\n            var result = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n            {\n                Symbol = symbol,\n                DayOfWeek = checkDay,\n                SessionIndex = sessionIndex\n            });\n\n            var fromTime = result.From.ToDateTime().TimeOfDay;\n\n            // If same day, check if session hasn't started yet\n            if (dayOffset == 0 &amp;&amp; fromTime &gt; currentTime)\n            {\n                timeUntilNextSession = fromTime - currentTime;\n                break;\n            }\n            // If different day, use first session of that day\n            else if (dayOffset &gt; 0)\n            {\n                timeUntilNextSession = TimeSpan.FromDays(dayOffset) + fromTime - currentTime;\n                break;\n            }\n        }\n        catch\n        {\n            break;\n        }\n    }\n\n    if (timeUntilNextSession.HasValue)\n        break;\n}\n\nif (timeUntilNextSession.HasValue)\n{\n    Console.WriteLine($\"Next {symbol} quote session starts in: {timeUntilNextSession.Value.TotalHours:F1} hours\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionQuote/#6-compare-quote-sessions-across-symbols","title":"6) Compare quote sessions across symbols","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"USDJPY\", \"XAUUSD\", \"BTCUSD\" };\nvar day = DayOfWeek.Monday;\n\nConsole.WriteLine($\"Quote sessions for {day}:\\n\");\n\nforeach (var symbol in symbols)\n{\n    try\n    {\n        var result = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n        {\n            Symbol = symbol,\n            DayOfWeek = day,\n            SessionIndex = 0\n        });\n\n        var fromTime = result.From.ToDateTime().TimeOfDay;\n        var toTime = result.To.ToDateTime().TimeOfDay;\n        var duration = toTime - fromTime;\n\n        Console.WriteLine($\"{symbol,-10} {fromTime:hh\\\\:mm} - {toTime:hh\\\\:mm} (duration: {duration.TotalHours:F1}h)\");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"{symbol,-10} Error: {ex.Message}\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/","title":"\u2705 Get Trade Session Times (<code>SymbolInfoSessionTradeAsync</code>)","text":"<p>Request: Get beginning and end times for a trading session of a specified symbol and day of week on MT5.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolInfoSessionTradeAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.MarketInfo</code></li> <li>Proto definition: <code>SymbolInfoSessionTrade</code> (defined in <code>mt5-term-api-market-info.proto</code>)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.MarketInfo</code></li> <li>Method: <code>SymbolInfoSessionTrade(SymbolInfoSessionTradeRequest) \u2192 SymbolInfoSessionTradeReply</code></li> <li>Low\u2011level client (generated): <code>MarketInfo.MarketInfoClient.SymbolInfoSessionTrade(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolInfoSessionTradeData&gt; SymbolInfoSessionTradeAsync(\n            SymbolInfoSessionTradeRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolInfoSessionTradeRequest { symbol, day_of_week, session_index }</code></p> <p>Reply message:</p> <p><code>SymbolInfoSessionTradeReply { data: SymbolInfoSessionTradeData }</code></p>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>SymbolInfoSessionTradeRequest</code> Protobuf request with session parameters <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#symbolinfosessiontraderequest","title":"<code>SymbolInfoSessionTradeRequest</code>","text":"Field Type Description <code>Symbol</code> <code>string</code> Symbol name (e.g., <code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>) REQUIRED <code>DayOfWeek</code> <code>DayOfWeek</code> Day of the week (Sunday, Monday, etc.) REQUIRED <code>SessionIndex</code> <code>uint32</code> Session index (starts from 0). Most symbols have 1-2 sessions/day"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#output-symbolinfosessiontradedata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolInfoSessionTradeData</code>","text":"Field Type Description <code>From</code> <code>Timestamp</code> Session beginning time (seconds from 00:00, date should be ignored) <code>To</code> <code>Timestamp</code> Session end time (seconds from 00:00, date should be ignored)"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#dayofweek","title":"<code>DayOfWeek</code>","text":"<ul> <li><code>Sunday</code> \u2014 Sunday (0)</li> <li><code>Monday</code> \u2014 Monday (1)</li> <li><code>Tuesday</code> \u2014 Tuesday (2)</li> <li><code>Wednesday</code> \u2014 Wednesday (3)</li> <li><code>Thursday</code> \u2014 Thursday (4)</li> <li><code>Friday</code> \u2014 Friday (5)</li> <li><code>Saturday</code> \u2014 Saturday (6)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Returns trading session hours for a symbol on a specific day of week. Trading sessions determine when orders can be executed.</li> <li>Why you need it. Check if trading is allowed at specific times, schedule strategies around trading sessions, avoid placing orders outside market hours.</li> <li>Sanity check. If <code>From</code> &lt; <code>To</code> \u2192 valid session. Time is in seconds from midnight. Ignore date component, use only time-of-day.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to understand trading hours:</p> <ul> <li>Check when symbol can be traded.</li> <li>Determine if market is open at current time.</li> <li>Schedule trading strategies around market hours.</li> <li>Avoid placing orders outside trading sessions.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Trade vs Quote sessions: Trading sessions show when orders can be executed. Quoting sessions (SymbolInfoSessionQuote) show when prices are updated. Quote sessions are usually wider than trade sessions.</li> <li>Session index: Starts from 0. Most symbols have 1 session per day. Some (like futures) may have multiple sessions (e.g., day session + evening session).</li> <li>Time format: Returned timestamps represent time-of-day only. Date component should be ignored.</li> <li>Extract time: Use <code>timestamp.ToDateTime().TimeOfDay</code> to get time as TimeSpan.</li> <li>Weekend trading: Most Forex symbols don't trade on weekends (Saturday/Sunday). Some crypto symbols trade 24/7.</li> <li>Error handling: If session index doesn't exist, server may return error or invalid data.</li> <li>Broker-specific: Trading hours can vary by broker. Some brokers extend/restrict standard market hours.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#1-basic-trade-session-retrieval","title":"1) Basic trade session retrieval","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n{\n    Symbol = \"EURUSD\",\n    DayOfWeek = DayOfWeek.Monday,\n    SessionIndex = 0\n});\n\nvar fromTime = result.From.ToDateTime().TimeOfDay;\nvar toTime = result.To.ToDateTime().TimeOfDay;\n\nConsole.WriteLine($\"EURUSD Monday trading session: {fromTime} - {toTime}\");\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#2-get-all-trade-sessions-for-a-day","title":"2) Get all trade sessions for a day","text":"<pre><code>var symbol = \"ES\"; // E-mini S&amp;P 500 futures\nvar day = DayOfWeek.Wednesday;\n\nConsole.WriteLine($\"{symbol} trading sessions for {day}:\\n\");\n\nfor (uint sessionIndex = 0; sessionIndex &lt; 10; sessionIndex++)\n{\n    try\n    {\n        var result = await acc.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n        {\n            Symbol = symbol,\n            DayOfWeek = day,\n            SessionIndex = sessionIndex\n        });\n\n        var fromTime = result.From.ToDateTime().TimeOfDay;\n        var toTime = result.To.ToDateTime().TimeOfDay;\n\n        Console.WriteLine($\"Session {sessionIndex}: {fromTime} - {toTime}\");\n    }\n    catch\n    {\n        // No more sessions\n        break;\n    }\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#3-check-if-market-is-open-now","title":"3) Check if market is open now","text":"<pre><code>var symbol = \"XAUUSD\";\nvar now = DateTime.UtcNow;\nvar currentDay = (DayOfWeek)((int)now.DayOfWeek); // Convert to proto DayOfWeek\nvar currentTime = now.TimeOfDay;\n\nbool marketOpen = false;\n\n// Check all sessions for current day\nfor (uint sessionIndex = 0; sessionIndex &lt; 5; sessionIndex++)\n{\n    try\n    {\n        var result = await acc.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n        {\n            Symbol = symbol,\n            DayOfWeek = currentDay,\n            SessionIndex = sessionIndex\n        });\n\n        var fromTime = result.From.ToDateTime().TimeOfDay;\n        var toTime = result.To.ToDateTime().TimeOfDay;\n\n        if (currentTime &gt;= fromTime &amp;&amp; currentTime &lt;= toTime)\n        {\n            marketOpen = true;\n            Console.WriteLine($\"\u2713 {symbol} market OPEN (session {sessionIndex}: {fromTime} - {toTime})\");\n            break;\n        }\n    }\n    catch\n    {\n        break;\n    }\n}\n\nif (!marketOpen)\n{\n    Console.WriteLine($\"\u2717 {symbol} market CLOSED at {currentTime}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#4-get-trading-hours-for-entire-week","title":"4) Get trading hours for entire week","text":"<pre><code>var symbol = \"BTCUSD\";\n\nConsole.WriteLine($\"Weekly trading schedule for {symbol}:\\n\");\n\nvar days = new[]\n{\n    DayOfWeek.Sunday,\n    DayOfWeek.Monday,\n    DayOfWeek.Tuesday,\n    DayOfWeek.Wednesday,\n    DayOfWeek.Thursday,\n    DayOfWeek.Friday,\n    DayOfWeek.Saturday\n};\n\nforeach (var day in days)\n{\n    Console.WriteLine($\"{day}:\");\n\n    bool hasSession = false;\n    for (uint sessionIndex = 0; sessionIndex &lt; 5; sessionIndex++)\n    {\n        try\n        {\n            var result = await acc.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n            {\n                Symbol = symbol,\n                DayOfWeek = day,\n                SessionIndex = sessionIndex\n            });\n\n            var fromTime = result.From.ToDateTime().TimeOfDay;\n            var toTime = result.To.ToDateTime().TimeOfDay;\n\n            Console.WriteLine($\"  Session {sessionIndex}: {fromTime:hh\\\\:mm} - {toTime:hh\\\\:mm}\");\n            hasSession = true;\n        }\n        catch\n        {\n            break;\n        }\n    }\n\n    if (!hasSession)\n    {\n        Console.WriteLine(\"  Market closed\");\n    }\n\n    Console.WriteLine();\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#5-time-until-market-opens","title":"5) Time until market opens","text":"<pre><code>var symbol = \"EURUSD\";\nvar now = DateTime.UtcNow;\nvar currentDay = (DayOfWeek)((int)now.DayOfWeek);\nvar currentTime = now.TimeOfDay;\n\n// Try to find next trading session\nTimeSpan? timeUntilOpen = null;\nstring nextSessionDay = \"\";\n\nfor (int dayOffset = 0; dayOffset &lt; 7; dayOffset++)\n{\n    var checkDay = (DayOfWeek)(((int)currentDay + dayOffset) % 7);\n\n    for (uint sessionIndex = 0; sessionIndex &lt; 5; sessionIndex++)\n    {\n        try\n        {\n            var result = await acc.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n            {\n                Symbol = symbol,\n                DayOfWeek = checkDay,\n                SessionIndex = sessionIndex\n            });\n\n            var fromTime = result.From.ToDateTime().TimeOfDay;\n\n            // If same day, check if session hasn't started yet\n            if (dayOffset == 0 &amp;&amp; fromTime &gt; currentTime)\n            {\n                timeUntilOpen = fromTime - currentTime;\n                nextSessionDay = checkDay.ToString();\n                break;\n            }\n            // If different day, use first session of that day\n            else if (dayOffset &gt; 0)\n            {\n                timeUntilOpen = TimeSpan.FromDays(dayOffset) + fromTime - currentTime;\n                nextSessionDay = checkDay.ToString();\n                break;\n            }\n        }\n        catch\n        {\n            break;\n        }\n    }\n\n    if (timeUntilOpen.HasValue)\n        break;\n}\n\nif (timeUntilOpen.HasValue)\n{\n    Console.WriteLine($\"{symbol} market opens in: {timeUntilOpen.Value.TotalHours:F1} hours ({nextSessionDay})\");\n}\nelse\n{\n    Console.WriteLine($\"{symbol} market is currently open or schedule unavailable\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolInfoSessionTrade/#6-compare-quote-vs-trade-sessions","title":"6) Compare quote vs trade sessions","text":"<pre><code>var symbol = \"XAUUSD\";\nvar day = DayOfWeek.Monday;\n\nvar quoteSession = await acc.SymbolInfoSessionQuoteAsync(new SymbolInfoSessionQuoteRequest\n{\n    Symbol = symbol,\n    DayOfWeek = day,\n    SessionIndex = 0\n});\n\nvar tradeSession = await acc.SymbolInfoSessionTradeAsync(new SymbolInfoSessionTradeRequest\n{\n    Symbol = symbol,\n    DayOfWeek = day,\n    SessionIndex = 0\n});\n\nvar quoteFrom = quoteSession.From.ToDateTime().TimeOfDay;\nvar quoteTo = quoteSession.To.ToDateTime().TimeOfDay;\nvar tradeFrom = tradeSession.From.ToDateTime().TimeOfDay;\nvar tradeTo = tradeSession.To.ToDateTime().TimeOfDay;\n\nConsole.WriteLine($\"{symbol} {day} sessions:\\n\");\nConsole.WriteLine($\"Quote session: {quoteFrom} - {quoteTo} ({(quoteTo - quoteFrom).TotalHours:F1}h)\");\nConsole.WriteLine($\"Trade session: {tradeFrom} - {tradeTo} ({(tradeTo - tradeFrom).TotalHours:F1}h)\");\n\nif (quoteFrom &lt; tradeFrom || quoteTo &gt; tradeTo)\n{\n    Console.WriteLine(\"\\n\u26a0 Quote session is wider than trade session (pre/post-market quotes available)\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/","title":"\u2705 Get Detailed Symbol Parameters (<code>SymbolParamsManyAsync</code>)","text":"<p>Request: Get full information about symbol and its group for one or multiple symbols on MT5. Returns comprehensive symbol properties.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.SymbolParamsManyAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>SymbolParamsMany</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>SymbolParamsMany(SymbolParamsManyRequest) \u2192 SymbolParamsManyReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.AccountHelperClient.SymbolParamsMany(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;SymbolParamsManyData&gt; SymbolParamsManyAsync(\n            SymbolParamsManyRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>SymbolParamsManyRequest { symbol_name, sort_type, page_number, items_per_page }</code></p> <p>Reply message:</p> <p><code>SymbolParamsManyReply { data: SymbolParamsManyData }</code></p>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>SymbolParamsManyRequest</code> Protobuf request with filtering and pagination <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#symbolparamsmanyrequest","title":"<code>SymbolParamsManyRequest</code>","text":"Field Type Description <code>SymbolName</code> <code>string</code> (optional) Filter by symbol name (e.g., <code>\"EURUSD\"</code>). Omit for all symbols <code>SortType</code> <code>AH_SYMBOL_PARAMS_MANY_SORT_TYPE</code> Sort order (optional) <code>PageNumber</code> <code>int32</code> (optional) Page number for pagination (0-based) <code>ItemsPerPage</code> <code>int32</code> (optional) Number of items per page (0 = all items)"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#output-symbolparamsmanydata","title":"\u2b06\ufe0f Output \u2014 <code>SymbolParamsManyData</code>","text":"Field Type Description <code>SymbolInfos</code> <code>List&lt;SymbolParameters&gt;</code> Array of detailed symbol parameters <code>SymbolsTotal</code> <code>int32</code> Total number of symbols matching filter <code>PageNumber</code> <code>int32</code> (optional) Current page number <code>ItemsPerPage</code> <code>int32</code> (optional) Items per page"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#symbolparameters-detailed-symbol-information-112-fields","title":"<code>SymbolParameters</code> \u2014 Detailed symbol information (112 fields)","text":"<p>Price fields:</p> Field Type Description <code>Name</code> <code>string</code> Symbol name <code>Bid</code> <code>double</code> Current Bid price <code>BidHigh</code> <code>double</code> Highest Bid of the day <code>BidLow</code> <code>double</code> Lowest Bid of the day <code>Ask</code> <code>double</code> Current Ask price <code>AskHigh</code> <code>double</code> Highest Ask of the day <code>AskLow</code> <code>double</code> Lowest Ask of the day <code>Last</code> <code>double</code> Last deal price <code>LastHigh</code> <code>double</code> Highest Last price of day <code>LastLow</code> <code>double</code> Lowest Last price of day <p>Volume fields:</p> Field Type Description <code>VolumeReal</code> <code>double</code> Real volume <code>VolumeHighReal</code> <code>double</code> Maximum real volume of the day <code>VolumeLowReal</code> <code>double</code> Minimum real volume of the day <code>Volume</code> <code>int64</code> Volume (integer) <code>VolumeHigh</code> <code>int64</code> Maximum volume of the day <code>VolumeLow</code> <code>int64</code> Minimum volume of the day <p>Trade parameters:</p> Field Type Description <code>Point</code> <code>double</code> Point size (minimum price change) <code>TradeTickValue</code> <code>double</code> Tick value <code>TradeTickValueProfit</code> <code>double</code> Tick value for profit calculation <code>TradeTickValueLoss</code> <code>double</code> Tick value for loss calculation <code>TradeTickSize</code> <code>double</code> Tick size <code>TradeContractSize</code> <code>double</code> Contract size <code>VolumeMin</code> <code>double</code> Minimum volume for a deal <code>VolumeMax</code> <code>double</code> Maximum volume for a deal <code>VolumeStep</code> <code>double</code> Volume step <code>VolumeLimit</code> <code>double</code> Maximum allowed aggregate volume <p>Swap fields:</p> Field Type Description <code>SwapLong</code> <code>double</code> Long swap value <code>SwapShort</code> <code>double</code> Short swap value <code>SwapSunday</code> <code>double</code> Sunday swap <code>SwapMonday</code> <code>double</code> Monday swap <code>SwapTuesday</code> <code>double</code> Tuesday swap <code>SwapWednesday</code> <code>double</code> Wednesday swap (often triple) <code>SwapThursday</code> <code>double</code> Thursday swap <code>SwapFriday</code> <code>double</code> Friday swap <code>SwapSaturday</code> <code>double</code> Saturday swap <p>Margin fields:</p> Field Type Description <code>MarginInitial</code> <code>double</code> Initial margin <code>MarginMaintenance</code> <code>double</code> Maintenance margin <code>MarginHedged</code> <code>double</code> Hedged margin <p>Session fields:</p> Field Type Description <code>SessionVolume</code> <code>double</code> Total volume for current session <code>SessionTurnover</code> <code>double</code> Total turnover for current session <code>SessionInterest</code> <code>double</code> Total interest for current session <code>SessionBuyOrdersVolume</code> <code>double</code> Buy orders volume in session <code>SessionSellOrdersVolume</code> <code>double</code> Sell orders volume in session <code>SessionOpen</code> <code>double</code> Session open price <code>SessionClose</code> <code>double</code> Session close price <code>SessionAw</code> <code>double</code> Average weighted price <code>SessionPriceSettlement</code> <code>double</code> Settlement price <code>SessionPriceLimitMin</code> <code>double</code> Minimum price limit <code>SessionPriceLimitMax</code> <code>double</code> Maximum price limit <code>SessionDeals</code> <code>int64</code> Number of deals in session <code>SessionBuyOrders</code> <code>int64</code> Number of buy orders in session <code>SessionSellOrders</code> <code>int64</code> Number of sell orders in session <p>Options/Greeks fields:</p> Field Type Description <code>OptionStrike</code> <code>double</code> Strike price for options <code>PriceChange</code> <code>double</code> Price change <code>PriceVolatility</code> <code>double</code> Volatility <code>PriceTheoretical</code> <code>double</code> Theoretical option price <code>PriceDelta</code> <code>double</code> Option Delta <code>PriceTheta</code> <code>double</code> Option Theta <code>PriceGamma</code> <code>double</code> Option Gamma <code>PriceVega</code> <code>double</code> Option Vega <code>PriceRho</code> <code>double</code> Option Rho <code>PriceOmega</code> <code>double</code> Option Omega <code>PriceSensitivity</code> <code>double</code> Price sensitivity <p>Symbol properties:</p> Field Type Description <code>Sector</code> <code>BMT5_ENUM_SYMBOL_SECTOR</code> Sector (Basic Materials, Energy, etc) <code>Industry</code> <code>BMT5_ENUM_SYMBOL_INDUSTRY</code> Industry classification <code>Custom</code> <code>bool</code> Is custom symbol <code>BackgroundColor</code> <code>string</code> Background color <code>ChartMode</code> <code>BMT5_ENUM_SYMBOL_CHART_MODE</code> Chart mode (Bid or Last) <code>Exist</code> <code>bool</code> Symbol exists <code>Select</code> <code>bool</code> Symbol selected in MarketWatch <code>SubscriptionDelay</code> <code>int32</code> Subscription delay in seconds <code>Visible</code> <code>bool</code> Symbol visible in MarketWatch <code>Digits</code> <code>int32</code> Digits after decimal point <code>SpreadFloat</code> <code>bool</code> Floating spread <code>Spread</code> <code>int32</code> Current spread in points <code>TicksBookDepth</code> <code>int32</code> Market depth <p>Time fields:</p> Field Type Description <code>Time</code> <code>Timestamp</code> Last quote time <code>TimeMsc</code> <code>int64</code> Last quote time in milliseconds <code>StartTime</code> <code>Timestamp</code> Symbol start time <code>ExpirationTime</code> <code>Timestamp</code> Symbol expiration time <p>Trading modes:</p> Field Type Description <code>TradeCalcMode</code> <code>BMT5_ENUM_SYMBOL_CALC_MODE</code> Profit/margin calculation mode <code>TradeMode</code> <code>BMT5_ENUM_SYMBOL_TRADE_MODE</code> Trading mode (Full, LongOnly, etc) <code>TradeStopsLevel</code> <code>int32</code> Minimum distance for stops (points) <code>TradeFreezeLevel</code> <code>int32</code> Freeze level (points) <code>TradeExeMode</code> <code>BMT5_ENUM_SYMBOL_TRADE_EXECUTION</code> Execution mode <code>SwapMode</code> <code>BMT5_ENUM_SYMBOL_SWAP_MODE</code> Swap calculation mode <code>SwapRollover3days</code> <code>BMT5_ENUM_DAY_OF_WEEK</code> Day of triple swap rollover <p>Order/Fill modes:</p> Field Type Description <code>MarginHedgedUseLeg</code> <code>bool</code> Use hedged margin for legs <code>ExpirationMode</code> <code>int32</code> Allowed expiration modes (flags) <code>FillingMode</code> <code>List&lt;BMT5_ENUM_ORDER_TYPE_FILLING&gt;</code> Allowed filling modes <code>OrderMode</code> <code>BMT5_ENUM_ORDER_TYPE</code> Allowed order types <code>OrderGtcMode</code> <code>BMT5_ENUM_SYMBOL_ORDER_GTC_MODE</code> GTC mode <code>OptionMode</code> <code>BMT5_ENUM_SYMBOL_OPTION_MODE</code> Option type (European/American) <code>OptionRight</code> <code>BMT5_ENUM_SYMBOL_OPTION_RIGHT</code> Option right (Call/Put) <p>String properties:</p> Field Type Description <code>Basis</code> <code>string</code> Underlying asset for derivatives <code>Category</code> <code>string</code> Symbol category <code>Country</code> <code>string</code> Country <code>SectorName</code> <code>string</code> Sector name <code>IndustryName</code> <code>string</code> Industry name <code>CurrencyBase</code> <code>string</code> Base currency <code>CurrencyProfit</code> <code>string</code> Profit currency <code>CurrencyMargin</code> <code>string</code> Margin currency <code>Bank</code> <code>string</code> Liquidity provider <code>SymDescription</code> <code>string</code> Symbol description <code>Exchange</code> <code>string</code> Exchange name <code>Formula</code> <code>string</code> Custom symbol formula <code>Isin</code> <code>string</code> ISIN code <code>Page</code> <code>string</code> Web page URL <code>Path</code> <code>string</code> Path in symbol tree"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#ah_symbol_params_many_sort_type-sort-order","title":"<code>AH_SYMBOL_PARAMS_MANY_SORT_TYPE</code> (Sort Order)","text":"Enum Value Description <code>AhParamsManySortTypeSymbolNameAsc</code> Sort by symbol name ascending (A-Z) <code>AhParamsManySortTypeSymbolNameDesc</code> Sort by symbol name descending (Z-A) <code>AhParamsManySortTypeMqlIndexAsc</code> Sort by MQL index ascending <code>AhParamsManySortTypeMqlIndexDesc</code> Sort by MQL index descending"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_sector-market-sectors","title":"<code>BMT5_ENUM_SYMBOL_SECTOR</code> (Market Sectors)","text":"Enum Value Description <code>BMT5_SECTOR_UNDEFINED</code> Undefined sector <code>BMT5_SECTOR_BASIC_MATERIALS</code> Basic materials <code>BMT5_SECTOR_COMMUNICATION_SERVICES</code> Communication services <code>BMT5_SECTOR_CONSUMER_CYCLICAL</code> Consumer cyclical <code>BMT5_SECTOR_CONSUMER_DEFENSIVE</code> Consumer defensive <code>BMT5_SECTOR_CURRENCY</code> Currencies (Forex) <code>BMT5_SECTOR_CURRENCY_CRYPTO</code> Cryptocurrencies <code>BMT5_SECTOR_ENERGY</code> Energy <code>BMT5_SECTOR_FINANCIAL</code> Finance <code>BMT5_SECTOR_HEALTHCARE</code> Healthcare <code>BMT5_SECTOR_INDUSTRIALS</code> Industrials <code>BMT5_SECTOR_REAL_ESTATE</code> Real estate <code>BMT5_SECTOR_TECHNOLOGY</code> Technology <code>BMT5_SECTOR_UTILITIES</code> Utilities"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_industry-industry-classifications-152-values","title":"<code>BMT5_ENUM_SYMBOL_INDUSTRY</code> (Industry Classifications - 152 values)","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#basic-materials-15-values","title":"Basic Materials (15 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_UNDEFINED</code> Undefined <code>BMT5_INDUSTRY_AGRICULTURAL_INPUTS</code> Agricultural inputs <code>BMT5_INDUSTRY_ALUMINIUM</code> Aluminium <code>BMT5_INDUSTRY_BUILDING_MATERIALS</code> Building materials <code>BMT5_INDUSTRY_CHEMICALS</code> Chemicals <code>BMT5_INDUSTRY_COKING_COAL</code> Coking coal <code>BMT5_INDUSTRY_COPPER</code> Copper <code>BMT5_INDUSTRY_GOLD</code> Gold <code>BMT5_INDUSTRY_LUMBER_WOOD</code> Lumber and wood production <code>BMT5_INDUSTRY_INDUSTRIAL_METALS</code> Other industrial metals and mining <code>BMT5_INDUSTRY_PRECIOUS_METALS</code> Other precious metals and mining <code>BMT5_INDUSTRY_PAPER</code> Paper and paper products <code>BMT5_INDUSTRY_SILVER</code> Silver <code>BMT5_INDUSTRY_SPECIALTY_CHEMICALS</code> Specialty chemicals <code>BMT5_INDUSTRY_STEEL</code> Steel"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#communication-services-7-values","title":"Communication Services (7 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_ADVERTISING</code> Advertising agencies <code>BMT5_INDUSTRY_BROADCASTING</code> Broadcasting <code>BMT5_INDUSTRY_GAMING_MULTIMEDIA</code> Electronic gaming and multimedia <code>BMT5_INDUSTRY_ENTERTAINMENT</code> Entertainment <code>BMT5_INDUSTRY_INTERNET_CONTENT</code> Internet content and information <code>BMT5_INDUSTRY_PUBLISHING</code> Publishing <code>BMT5_INDUSTRY_TELECOM</code> Telecom services"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#consumer-cyclical-23-values","title":"Consumer Cyclical (23 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_APPAREL_MANUFACTURING</code> Apparel manufacturing <code>BMT5_INDUSTRY_APPAREL_RETAIL</code> Apparel retail <code>BMT5_INDUSTRY_AUTO_MANUFACTURERS</code> Auto manufacturers <code>BMT5_INDUSTRY_AUTO_PARTS</code> Auto parts <code>BMT5_INDUSTRY_AUTO_DEALERSHIP</code> Auto and truck dealerships <code>BMT5_INDUSTRY_DEPARTMENT_STORES</code> Department stores <code>BMT5_INDUSTRY_FOOTWEAR_ACCESSORIES</code> Footwear and accessories <code>BMT5_INDUSTRY_FURNISHINGS</code> Furnishing, fixtures and appliances <code>BMT5_INDUSTRY_GAMBLING</code> Gambling <code>BMT5_INDUSTRY_HOME_IMPROV_RETAIL</code> Home improvement retail <code>BMT5_INDUSTRY_INTERNET_RETAIL</code> Internet retail <code>BMT5_INDUSTRY_LEISURE</code> Leisure <code>BMT5_INDUSTRY_LODGING</code> Lodging <code>BMT5_INDUSTRY_LUXURY_GOODS</code> Luxury goods <code>BMT5_INDUSTRY_PACKAGING_CONTAINERS</code> Packaging and containers <code>BMT5_INDUSTRY_PERSONAL_SERVICES</code> Personal services <code>BMT5_INDUSTRY_RECREATIONAL_VEHICLES</code> Recreational vehicles <code>BMT5_INDUSTRY_RESIDENT_CONSTRUCTION</code> Residential construction <code>BMT5_INDUSTRY_RESORTS_CASINOS</code> Resorts and casinos <code>BMT5_INDUSTRY_RESTAURANTS</code> Restaurants <code>BMT5_INDUSTRY_SPECIALTY_RETAIL</code> Specialty retail <code>BMT5_INDUSTRY_TEXTILE_MANUFACTURING</code> Textile manufacturing <code>BMT5_INDUSTRY_TRAVEL_SERVICES</code> Travel services"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#consumer-defensive-12-values","title":"Consumer Defensive (12 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_BEVERAGES_BREWERS</code> Beverages - Brewers <code>BMT5_INDUSTRY_BEVERAGES_NON_ALCO</code> Beverages - Non-alcoholic <code>BMT5_INDUSTRY_BEVERAGES_WINERIES</code> Beverages - Wineries and distilleries <code>BMT5_INDUSTRY_CONFECTIONERS</code> Confectioners <code>BMT5_INDUSTRY_DISCOUNT_STORES</code> Discount stores <code>BMT5_INDUSTRY_EDUCATION_TRAINIG</code> Education and training services <code>BMT5_INDUSTRY_FARM_PRODUCTS</code> Farm products <code>BMT5_INDUSTRY_FOOD_DISTRIBUTION</code> Food distribution <code>BMT5_INDUSTRY_GROCERY_STORES</code> Grocery stores <code>BMT5_INDUSTRY_HOUSEHOLD_PRODUCTS</code> Household and personal products <code>BMT5_INDUSTRY_PACKAGED_FOODS</code> Packaged foods <code>BMT5_INDUSTRY_TOBACCO</code> Tobacco"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#energy-8-values","title":"Energy (8 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_OIL_GAS_DRILLING</code> Oil and gas drilling <code>BMT5_INDUSTRY_OIL_GAS_EP</code> Oil and gas extraction and processing <code>BMT5_INDUSTRY_OIL_GAS_EQUIPMENT</code> Oil and gas equipment and services <code>BMT5_INDUSTRY_OIL_GAS_INTEGRATED</code> Oil and gas integrated <code>BMT5_INDUSTRY_OIL_GAS_MIDSTREAM</code> Oil and gas midstream <code>BMT5_INDUSTRY_OIL_GAS_REFINING</code> Oil and gas refining and marketing <code>BMT5_INDUSTRY_THERMAL_COAL</code> Thermal coal <code>BMT5_INDUSTRY_URANIUM</code> Uranium"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#financial-19-values","title":"Financial (19 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_EXCHANGE_TRADED_FUND</code> Exchange traded fund <code>BMT5_INDUSTRY_ASSETS_MANAGEMENT</code> Assets management <code>BMT5_INDUSTRY_BANKS_DIVERSIFIED</code> Banks - Diversified <code>BMT5_INDUSTRY_BANKS_REGIONAL</code> Banks - Regional <code>BMT5_INDUSTRY_CAPITAL_MARKETS</code> Capital markets <code>BMT5_INDUSTRY_CLOSE_END_FUND_DEBT</code> Closed-End fund - Debt <code>BMT5_INDUSTRY_CLOSE_END_FUND_EQUITY</code> Closed-end fund - Equity <code>BMT5_INDUSTRY_CLOSE_END_FUND_FOREIGN</code> Closed-end fund - Foreign <code>BMT5_INDUSTRY_CREDIT_SERVICES</code> Credit services <code>BMT5_INDUSTRY_FINANCIAL_CONGLOMERATE</code> Financial conglomerates <code>BMT5_INDUSTRY_FINANCIAL_DATA_EXCHANGE</code> Financial data and stock exchange <code>BMT5_INDUSTRY_INSURANCE_BROKERS</code> Insurance brokers <code>BMT5_INDUSTRY_INSURANCE_DIVERSIFIED</code> Insurance - Diversified <code>BMT5_INDUSTRY_INSURANCE_LIFE</code> Insurance - Life <code>BMT5_INDUSTRY_INSURANCE_PROPERTY</code> Insurance - Property and casualty <code>BMT5_INDUSTRY_INSURANCE_REINSURANCE</code> Insurance - Reinsurance <code>BMT5_INDUSTRY_INSURANCE_SPECIALTY</code> Insurance - Specialty <code>BMT5_INDUSTRY_MORTGAGE_FINANCE</code> Mortgage finance <code>BMT5_INDUSTRY_SHELL_COMPANIES</code> Shell companies"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#healthcare-11-values","title":"Healthcare (11 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_BIOTECHNOLOGY</code> Biotechnology <code>BMT5_INDUSTRY_DIAGNOSTICS_RESEARCH</code> Diagnostics and research <code>BMT5_INDUSTRY_DRUGS_MANUFACTURERS</code> Drugs manufacturers - general <code>BMT5_INDUSTRY_DRUGS_MANUFACTURERS_SPEC</code> Drugs manufacturers - Specialty and generic <code>BMT5_INDUSTRY_HEALTHCARE_PLANS</code> Healthcare plans <code>BMT5_INDUSTRY_HEALTH_INFORMATION</code> Health information services <code>BMT5_INDUSTRY_MEDICAL_FACILITIES</code> Medical care facilities <code>BMT5_INDUSTRY_MEDICAL_DEVICES</code> Medical devices <code>BMT5_INDUSTRY_MEDICAL_DISTRIBUTION</code> Medical distribution <code>BMT5_INDUSTRY_MEDICAL_INSTRUMENTS</code> Medical instruments and supplies <code>BMT5_INDUSTRY_PHARM_RETAILERS</code> Pharmaceutical retailers"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#industrials-25-values","title":"Industrials (25 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_AEROSPACE_DEFENSE</code> Aerospace and defense <code>BMT5_INDUSTRY_AIRLINES</code> Airlines <code>BMT5_INDUSTRY_AIRPORTS_SERVICES</code> Airports and air services <code>BMT5_INDUSTRY_BUILDING_PRODUCTS</code> Building products and equipment <code>BMT5_INDUSTRY_BUSINESS_EQUIPMENT</code> Business equipment and supplies <code>BMT5_INDUSTRY_CONGLOMERATES</code> Conglomerates <code>BMT5_INDUSTRY_CONSULTING_SERVICES</code> Consulting services <code>BMT5_INDUSTRY_ELECTRICAL_EQUIPMENT</code> Electrical equipment and parts <code>BMT5_INDUSTRY_ENGINEERING_CONSTRUCTION</code> Engineering and construction <code>BMT5_INDUSTRY_FARM_HEAVY_MACHINERY</code> Farm and heavy construction machinery <code>BMT5_INDUSTRY_INDUSTRIAL_DISTRIBUTION</code> Industrial distribution <code>BMT5_INDUSTRY_INFRASTRUCTURE_OPERATIONS</code> Infrastructure operations <code>BMT5_INDUSTRY_FREIGHT_LOGISTICS</code> Integrated freight and logistics <code>BMT5_INDUSTRY_MARINE_SHIPPING</code> Marine shipping <code>BMT5_INDUSTRY_METAL_FABRICATION</code> Metal fabrication <code>BMT5_INDUSTRY_POLLUTION_CONTROL</code> Pollution and treatment controls <code>BMT5_INDUSTRY_RAILROADS</code> Railroads <code>BMT5_INDUSTRY_RENTAL_LEASING</code> Rental and leasing services <code>BMT5_INDUSTRY_SECURITY_PROTECTION</code> Security and protection services <code>BMT5_INDUSTRY_SPEALITY_BUSINESS_SERVICES</code> Specialty business services <code>BMT5_INDUSTRY_SPEALITY_MACHINERY</code> Specialty industrial machinery <code>BMT5_INDUSTRY_STUFFING_EMPLOYMENT</code> Staffing and employment services <code>BMT5_INDUSTRY_TOOLS_ACCESSORIES</code> Tools and accessories <code>BMT5_INDUSTRY_TRUCKING</code> Trucking <code>BMT5_INDUSTRY_WASTE_MANAGEMENT</code> Waste management"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#real-estate-12-values","title":"Real Estate (12 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_REAL_ESTATE_DEVELOPMENT</code> Real estate - Development <code>BMT5_INDUSTRY_REAL_ESTATE_DIVERSIFIED</code> Real estate - Diversified <code>BMT5_INDUSTRY_REAL_ESTATE_SERVICES</code> Real estate services <code>BMT5_INDUSTRY_REIT_DIVERSIFIED</code> REIT - Diversified <code>BMT5_INDUSTRY_REIT_HEALTCARE</code> REIT - Healthcare facilities <code>BMT5_INDUSTRY_REIT_HOTEL_MOTEL</code> REIT - Hotel and motel <code>BMT5_INDUSTRY_REIT_INDUSTRIAL</code> REIT - Industrial <code>BMT5_INDUSTRY_REIT_MORTAGE</code> REIT - Mortgage <code>BMT5_INDUSTRY_REIT_OFFICE</code> REIT - Office <code>BMT5_INDUSTRY_REIT_RESIDENTAL</code> REIT - Residential <code>BMT5_INDUSTRY_REIT_RETAIL</code> REIT - Retail <code>BMT5_INDUSTRY_REIT_SPECIALITY</code> REIT - Specialty"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#technology-12-values","title":"Technology (12 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_COMMUNICATION_EQUIPMENT</code> Communication equipment <code>BMT5_INDUSTRY_COMPUTER_HARDWARE</code> Computer hardware <code>BMT5_INDUSTRY_CONSUMER_ELECTRONICS</code> Consumer electronics <code>BMT5_INDUSTRY_ELECTRONIC_COMPONENTS</code> Electronic components <code>BMT5_INDUSTRY_ELECTRONIC_DISTRIBUTION</code> Electronics and computer distribution <code>BMT5_INDUSTRY_IT_SERVICES</code> Information technology services <code>BMT5_INDUSTRY_SCIENTIFIC_INSTRUMENTS</code> Scientific and technical instruments <code>BMT5_INDUSTRY_SEMICONDUCTOR_EQUIPMENT</code> Semiconductor equipment and materials <code>BMT5_INDUSTRY_SEMICONDUCTORS</code> Semiconductors <code>BMT5_INDUSTRY_SOFTWARE_APPLICATION</code> Software - Application <code>BMT5_INDUSTRY_SOFTWARE_INFRASTRUCTURE</code> Software - Infrastructure <code>BMT5_INDUSTRY_SOLAR</code> Solar"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#utilities-6-values","title":"Utilities (6 values)","text":"Enum Value Description <code>BMT5_INDUSTRY_UTILITIES_DIVERSIFIED</code> Utilities - Diversified <code>BMT5_INDUSTRY_UTILITIES_POWERPRODUCERS</code> Utilities - Independent power producers <code>BMT5_INDUSTRY_UTILITIES_RENEWABLE</code> Utilities - Renewable <code>BMT5_INDUSTRY_UTILITIES_REGULATED_ELECTRIC</code> Utilities - Regulated electric <code>BMT5_INDUSTRY_UTILITIES_REGULATED_GAS</code> Utilities - Regulated gas <code>BMT5_INDUSTRY_UTILITIES_REGULATED_WATER</code> Utilities - Regulated water"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_chart_mode-chart-display-mode","title":"<code>BMT5_ENUM_SYMBOL_CHART_MODE</code> (Chart Display Mode)","text":"Enum Value Description <code>BMT5_SYMBOL_CHART_MODE_BID</code> Chart based on Bid prices <code>BMT5_SYMBOL_CHART_MODE_LAST</code> Chart based on Last deal prices"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_calc_mode-profitmargin-calculation-mode","title":"<code>BMT5_ENUM_SYMBOL_CALC_MODE</code> (Profit/Margin Calculation Mode)","text":"Enum Value Description Formula <code>BMT5_SYMBOL_CALC_MODE_FOREX</code> Forex mode Margin: <code>Lots * Contract_Size / Leverage * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_FOREX_NO_LEVERAGE</code> Forex without leverage Margin: <code>Lots * Contract_Size * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_FUTURES</code> Futures Margin: <code>Lots * InitialMargin * Margin_Rate</code>Profit: <code>(close_price - open_price) * TickPrice / TickSize * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_CFD</code> CFD Margin: <code>Lots * ContractSize * MarketPrice * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_CFDINDEX</code> CFD index Margin: <code>(Lots * ContractSize * MarketPrice) * TickPrice / TickSize * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_CFDLEVERAGE</code> CFD with leverage Margin: <code>(Lots * ContractSize * MarketPrice) / Leverage * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_EXCH_STOCKS</code> Exchange stocks Margin: <code>Lots * ContractSize * LastPrice * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_EXCH_FUTURES</code> Exchange futures Margin: <code>Lots * InitialMargin * Margin_Rate</code> or <code>Lots * MaintenanceMargin * Margin_Rate</code>Profit: <code>(close_price - open_price) * Lots * TickPrice / TickSize</code> <code>BMT5_SYMBOL_CALC_MODE_EXCH_FUTURES_FORTS</code> FORTS futures Complex formula with MarginDiscount <code>BMT5_SYMBOL_CALC_MODE_EXCH_BONDS</code> Exchange bonds Margin: <code>Lots * ContractSize * FaceValue * open_price / 100</code>Profit: <code>Lots * close_price * FaceValue * Contract_Size + AccruedInterest * Lots * ContractSize</code> <code>BMT5_SYMBOL_CALC_MODE_EXCH_STOCKS_MOEX</code> MOEX stocks Margin: <code>Lots * ContractSize * LastPrice * Margin_Rate</code>Profit: <code>(close_price - open_price) * Contract_Size * Lots</code> <code>BMT5_SYMBOL_CALC_MODE_EXCH_BONDS_MOEX</code> MOEX bonds Margin: <code>Lots * ContractSize * FaceValue * open_price / 100</code>Profit: <code>Lots * close_price * FaceValue * Contract_Size + AccruedInterest * Lots * ContractSize</code>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_trade_mode-trading-permissions","title":"<code>BMT5_ENUM_SYMBOL_TRADE_MODE</code> (Trading Permissions)","text":"Enum Value Description <code>BMT5_SYMBOL_TRADE_MODE_DISABLED</code> Trade is disabled for the symbol <code>BMT5_SYMBOL_TRADE_MODE_LONGONLY</code> Allowed only long positions (BUY) <code>BMT5_SYMBOL_TRADE_MODE_SHORTONLY</code> Allowed only short positions (SELL) <code>BMT5_SYMBOL_TRADE_MODE_CLOSEONLY</code> Allowed only position close operations <code>BMT5_SYMBOL_TRADE_MODE_FULL</code> No trade restrictions"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_trade_execution-order-execution-mode","title":"<code>BMT5_ENUM_SYMBOL_TRADE_EXECUTION</code> (Order Execution Mode)","text":"Enum Value Description <code>BMT5_SYMBOL_TRADE_EXECUTION_REQUEST</code> Execution by request <code>BMT5_SYMBOL_TRADE_EXECUTION_INSTANT</code> Instant execution <code>BMT5_SYMBOL_TRADE_EXECUTION_MARKET</code> Market execution <code>BMT5_SYMBOL_TRADE_EXECUTION_EXCHANGE</code> Exchange execution"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_swap_mode-swap-calculation-mode","title":"<code>BMT5_ENUM_SYMBOL_SWAP_MODE</code> (Swap Calculation Mode)","text":"Enum Value Description <code>BMT5_SYMBOL_SWAP_MODE_DISABLED</code> Swaps disabled (no swaps) <code>BMT5_SYMBOL_SWAP_MODE_POINTS</code> Swaps charged in points <code>BMT5_SYMBOL_SWAP_MODE_CURRENCY_SYMBOL</code> Swaps charged in money in base currency of the symbol <code>BMT5_SYMBOL_SWAP_MODE_CURRENCY_MARGIN</code> Swaps charged in money in margin currency of the symbol <code>BMT5_SYMBOL_SWAP_MODE_CURRENCY_DEPOSIT</code> Swaps charged in money, in client deposit currency <code>BMT5_SYMBOL_SWAP_MODE_CURRENCY_PROFIT</code> Swaps charged in money in profit calculation currency <code>BMT5_SYMBOL_SWAP_MODE_INTEREST_CURRENT</code> Swaps charged as annual interest from current price (360 days) <code>BMT5_SYMBOL_SWAP_MODE_INTEREST_OPEN</code> Swaps charged as annual interest from open price (360 days) <code>BMT5_SYMBOL_SWAP_MODE_REOPEN_CURRENT</code> Swaps by reopening positions at close price +/- points <code>BMT5_SYMBOL_SWAP_MODE_REOPEN_BID</code> Swaps by reopening positions at Bid price +/- points"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_day_of_week-day-of-week","title":"<code>BMT5_ENUM_DAY_OF_WEEK</code> (Day of Week)","text":"Enum Value Description <code>BMT5_SUNDAY</code> Sunday <code>BMT5_MONDAY</code> Monday <code>BMT5_TUESDAY</code> Tuesday <code>BMT5_WEDNESDAY</code> Wednesday (often triple swap day) <code>BMT5_THURSDAY</code> Thursday <code>BMT5_FRIDAY</code> Friday <code>BMT5_SATURDAY</code> Saturday"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_order_gtc_mode-order-lifetime-mode","title":"<code>BMT5_ENUM_SYMBOL_ORDER_GTC_MODE</code> (Order Lifetime Mode)","text":"Enum Value Description <code>BMT5_SYMBOL_ORDERS_GTC</code> Pending orders and SL/TP valid until explicit cancellation (Good-Till-Cancelled) <code>BMT5_SYMBOL_ORDERS_DAILY</code> Orders valid during one trading day. All SL/TP and pending orders deleted at day end <code>BMT5_SYMBOL_ORDERS_DAILY_EXCLUDING_STOPS</code> Only pending orders deleted at day end. SL/TP levels preserved"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_option_mode-option-exercise-type","title":"<code>BMT5_ENUM_SYMBOL_OPTION_MODE</code> (Option Exercise Type)","text":"Enum Value Description <code>BMT5_SYMBOL_OPTION_MODE_EUROPEAN</code> European option - can only be exercised on expiration date <code>BMT5_SYMBOL_OPTION_MODE_AMERICAN</code> American option - can be exercised any trading day before expiry"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_symbol_option_right-option-type","title":"<code>BMT5_ENUM_SYMBOL_OPTION_RIGHT</code> (Option Type)","text":"Enum Value Description <code>BMT5_SYMBOL_OPTION_RIGHT_CALL</code> Call option - right to BUY at strike price <code>BMT5_SYMBOL_OPTION_RIGHT_PUT</code> Put option - right to SELL at strike price"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_order_type_filling-order-filling-policy","title":"<code>BMT5_ENUM_ORDER_TYPE_FILLING</code> (Order Filling Policy)","text":"Enum Value Description <code>BMT5_ORDER_FILLING_FOK</code> Fill or Kill - order must be executed in full or not at all <code>BMT5_ORDER_FILLING_IOC</code> Immediate or Cancel - execute max available volume, cancel remainder <code>BMT5_ORDER_FILLING_BOC</code> Book or Cancel - place order in order book (not implemented in most brokers) <code>BMT5_ORDER_FILLING_RETURN</code> Return - partial fills allowed, remainder stays as pending order"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#bmt5_enum_order_type-order-types","title":"<code>BMT5_ENUM_ORDER_TYPE</code> (Order Types)","text":"Enum Value Description <code>BMT5_ORDER_TYPE_BUY</code> Market Buy order <code>BMT5_ORDER_TYPE_SELL</code> Market Sell order <code>BMT5_ORDER_TYPE_BUY_LIMIT</code> Buy Limit pending order (buy below current price) <code>BMT5_ORDER_TYPE_SELL_LIMIT</code> Sell Limit pending order (sell above current price) <code>BMT5_ORDER_TYPE_BUY_STOP</code> Buy Stop pending order (buy above current price, breakout) <code>BMT5_ORDER_TYPE_SELL_STOP</code> Sell Stop pending order (sell below current price, breakdown) <code>BMT5_ORDER_TYPE_BUY_STOP_LIMIT</code> Buy Stop Limit - at stop price, place Buy Limit at StopLimit price <code>BMT5_ORDER_TYPE_SELL_STOP_LIMIT</code> Sell Stop Limit - at stop price, place Sell Limit at StopLimit price <code>BMT5_ORDER_TYPE_CLOSE_BY</code> Close By - close position by opposite position"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Returns comprehensive symbol information (112 fields) for one or multiple symbols. Single endpoint for all symbol properties.</li> <li>Why you need it. Get complete symbol specifications, analyze trading conditions, compare multiple symbols, access all symbol metadata in one call.</li> <li>Sanity check. If <code>SymbolsTotal &gt; 0</code> \u2192 data available. Check <code>SymbolInfos.Count</code> for actual returned symbols. Use pagination for large result sets.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to get comprehensive symbol data:</p> <ul> <li>Get all symbol properties in one call.</li> <li>Compare trading conditions across symbols.</li> <li>Analyze contract specifications.</li> <li>Filter and sort symbols by various criteria.</li> <li>Access swap schedules, margins, session data.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Comprehensive data: Returns 112 fields per symbol. Use only what you need to reduce processing overhead.</li> <li>Pagination: Use <code>PageNumber</code> and <code>ItemsPerPage</code> for large symbol lists to reduce memory usage.</li> <li>Filtering: Set <code>SymbolName</code> to get specific symbol. Omit to get all symbols.</li> <li>Sorting: Use <code>SortType</code> to order results by name or MQL index.</li> <li>Performance: Requesting all symbols can be slow. Filter when possible.</li> <li>Null values: Some fields may be 0 or empty if broker doesn't provide that data.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#1-get-all-parameters-for-single-symbol","title":"1) Get all parameters for single symbol","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.SymbolParamsManyAsync(new SymbolParamsManyRequest\n{\n    SymbolName = \"EURUSD\"\n});\n\nif (result.SymbolInfos.Count &gt; 0)\n{\n    var symbol = result.SymbolInfos[0];\n\n    Console.WriteLine($\"Symbol: {symbol.Name}\");\n    Console.WriteLine($\"Bid: {symbol.Bid}, Ask: {symbol.Ask}\");\n    Console.WriteLine($\"Spread: {symbol.Spread} points\");\n    Console.WriteLine($\"Contract size: {symbol.TradeContractSize}\");\n    Console.WriteLine($\"Min volume: {symbol.VolumeMin}, Max: {symbol.VolumeMax}, Step: {symbol.VolumeStep}\");\n    Console.WriteLine($\"Stops level: {symbol.TradeStopsLevel} points\");\n    Console.WriteLine($\"Swap long: {symbol.SwapLong}, short: {symbol.SwapShort}\");\n    Console.WriteLine($\"Digits: {symbol.Digits}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#2-get-all-available-symbols-paginated","title":"2) Get all available symbols (paginated)","text":"<pre><code>int pageSize = 50;\nint currentPage = 0;\n\nwhile (true)\n{\n    var result = await acc.SymbolParamsManyAsync(new SymbolParamsManyRequest\n    {\n        PageNumber = currentPage,\n        ItemsPerPage = pageSize,\n        SortType = AH_SYMBOL_PARAMS_MANY_SORT_TYPE.AhParamsManySortTypeSymbolNameAsc\n    });\n\n    Console.WriteLine($\"\\nPage {currentPage + 1} ({result.SymbolInfos.Count} symbols):\");\n\n    foreach (var symbol in result.SymbolInfos)\n    {\n        Console.WriteLine($\"  {symbol.Name,-15} Bid: {symbol.Bid,10:F5}  Ask: {symbol.Ask,10:F5}  Spread: {symbol.Spread,3}\");\n    }\n\n    // Check if more pages\n    if ((currentPage + 1) * pageSize &gt;= result.SymbolsTotal)\n        break;\n\n    currentPage++;\n}\n\nConsole.WriteLine($\"\\nTotal symbols: {result.SymbolsTotal}\");\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#3-find-symbols-with-lowest-spreads","title":"3) Find symbols with lowest spreads","text":"<pre><code>var result = await acc.SymbolParamsManyAsync(new SymbolParamsManyRequest());\n\nvar lowSpreadSymbols = result.SymbolInfos\n    .Where(s =&gt; s.Spread &gt; 0) // Exclude symbols with no spread data\n    .OrderBy(s =&gt; s.Spread)\n    .Take(10);\n\nConsole.WriteLine(\"Top 10 symbols with lowest spreads:\\n\");\n\nforeach (var symbol in lowSpreadSymbols)\n{\n    Console.WriteLine($\"{symbol.Name,-15} Spread: {symbol.Spread,3} points ({symbol.Spread * symbol.Point:F5})\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#4-analyze-swap-conditions","title":"4) Analyze swap conditions","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\nConsole.WriteLine(\"Swap analysis:\\n\");\n\nforeach (var symbolName in symbols)\n{\n    var result = await acc.SymbolParamsManyAsync(new SymbolParamsManyRequest\n    {\n        SymbolName = symbolName\n    });\n\n    if (result.SymbolInfos.Count &gt; 0)\n    {\n        var s = result.SymbolInfos[0];\n\n        Console.WriteLine($\"{s.Name}:\");\n        Console.WriteLine($\"  Long swap:  {s.SwapLong:F2}\");\n        Console.WriteLine($\"  Short swap: {s.SwapShort:F2}\");\n        Console.WriteLine($\"  Triple swap day: {s.SwapRollover3days}\");\n        Console.WriteLine($\"  Swap mode: {s.SwapMode}\");\n        Console.WriteLine();\n    }\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#5-compare-trading-conditions-across-symbols","title":"5) Compare trading conditions across symbols","text":"<pre><code>var result = await acc.SymbolParamsManyAsync(new SymbolParamsManyRequest());\n\n// Filter major Forex pairs\nvar forexPairs = result.SymbolInfos\n    .Where(s =&gt; s.Name.Contains(\"USD\") &amp;&amp; s.Name.Length == 6)\n    .ToList();\n\nConsole.WriteLine(\"Forex pairs trading conditions:\\n\");\nConsole.WriteLine($\"{\"Symbol\",-10} {\"Spread\",-8} {\"Min Lot\",-10} {\"Max Lot\",-10} {\"Stop Level\",-12}\");\nConsole.WriteLine(new string('-', 60));\n\nforeach (var symbol in forexPairs.OrderBy(s =&gt; s.Name))\n{\n    Console.WriteLine($\"{symbol.Name,-10} {symbol.Spread,-8} {symbol.VolumeMin,-10:F2} {symbol.VolumeMax,-10:F2} {symbol.TradeStopsLevel,-12}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/SymbolParamsMany/#6-get-session-information-for-symbol","title":"6) Get session information for symbol","text":"<pre><code>var result = await acc.SymbolParamsManyAsync(new SymbolParamsManyRequest\n{\n    SymbolName = \"BTCUSD\"\n});\n\nif (result.SymbolInfos.Count &gt; 0)\n{\n    var s = result.SymbolInfos[0];\n\n    Console.WriteLine($\"Session info for {s.Name}:\\n\");\n    Console.WriteLine($\"Session volume: {s.SessionVolume}\");\n    Console.WriteLine($\"Session turnover: {s.SessionTurnover}\");\n    Console.WriteLine($\"Session deals: {s.SessionDeals}\");\n    Console.WriteLine($\"Session buy orders: {s.SessionBuyOrders}\");\n    Console.WriteLine($\"Session sell orders: {s.SessionSellOrders}\");\n    Console.WriteLine($\"Session open: {s.SessionOpen}\");\n    Console.WriteLine($\"Session close: {s.SessionClose}\");\n    Console.WriteLine($\"Buy volume: {s.SessionBuyOrdersVolume}\");\n    Console.WriteLine($\"Sell volume: {s.SessionSellOrdersVolume}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/","title":"\u2705 Get Tick Values for Multiple Symbols (<code>TickValueWithSizeAsync</code>)","text":"<p>Request: Get tick values and sizes for multiple symbols in a single call on MT5. Returns tick value, profit/loss tick values, tick size, and contract size.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Account.TickValueWithSizeAsync(...)</code> (from NuGet package <code>MetaRPC.MT5</code>)</li> <li>gRPC service: <code>mt5_term_api.AccountHelper</code></li> <li>Proto definition: <code>TickValueWithSize</code> (defined in <code>mt5-term-api-account-helper.proto</code>)</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.AccountHelper</code></li> <li>Method: <code>TickValueWithSize(TickValueWithSizeRequest) \u2192 TickValueWithSizeReply</code></li> <li>Low\u2011level client (generated): <code>AccountHelper.AccountHelperClient.TickValueWithSize(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper (your class):</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Account\n    {\n        public async Task&lt;TickValueWithSizeData&gt; TickValueWithSizeAsync(\n            TickValueWithSizeRequest request,\n            DateTime? deadline = null,\n            CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>TickValueWithSizeRequest { symbol_names }</code></p> <p>Reply message:</p> <p><code>TickValueWithSizeReply { data: TickValueWithSizeData }</code></p>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>request</code> <code>TickValueWithSizeRequest</code> Protobuf request with array of symbol names <code>deadline</code> <code>DateTime?</code> Absolute per\u2011call UTC deadline \u2192 converted to timeout <code>cancellationToken</code> <code>CancellationToken</code> Cooperative cancel for the call/retry loop"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#tickvaluewithsizerequest","title":"<code>TickValueWithSizeRequest</code>","text":"Field Type Description <code>SymbolNames</code> <code>List&lt;string&gt;</code> Array of symbol names (e.g., <code>[\"EURUSD\", \"XAUUSD\"]</code>)"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#output-tickvaluewithsizedata","title":"\u2b06\ufe0f Output \u2014 <code>TickValueWithSizeData</code>","text":"Field Type Description <code>SymbolTickSizeInfos</code> <code>List&lt;TickSizeSymbol&gt;</code> Array of tick information for each symbol"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#ticksizesymbol-tick-value-information","title":"<code>TickSizeSymbol</code> \u2014 Tick value information","text":"Field Type Description <code>Index</code> <code>int32</code> Symbol index in request array <code>Name</code> <code>string</code> Symbol name <code>TradeTickValue</code> <code>double</code> Tick value (cost of 1 tick for 1 lot) <code>TradeTickValueProfit</code> <code>double</code> Tick value for profit calculation <code>TradeTickValueLoss</code> <code>double</code> Tick value for loss calculation <code>TradeTickSize</code> <code>double</code> Tick size (minimum price change) <code>TradeContractSize</code> <code>double</code> Contract size (volume for 1 standard lot)"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Batch endpoint to get tick values and contract sizes for multiple symbols in one call.</li> <li>Why you need it. Calculate P&amp;L in account currency, determine pip value, analyze trading costs across multiple symbols efficiently.</li> <li>Sanity check. If <code>SymbolTickSizeInfos.Count &gt; 0</code> \u2192 data available. Check <code>Index</code> to match symbols with request order.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it to get tick value data:</p> <ul> <li>Calculate profit/loss in account currency.</li> <li>Determine pip/tick value for risk management.</li> <li>Batch-fetch tick data for multiple symbols.</li> <li>Calculate position sizing based on tick value.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Batch optimization: More efficient than calling individual symbol info methods multiple times.</li> <li>Tick value vs Tick size: Tick size is the minimum price change. Tick value is the monetary value of that change for 1 lot.</li> <li>Profit vs Loss tick value: Some symbols have asymmetric tick values for long/short positions.</li> <li>Contract size: Used to convert volume (lots) to actual units (e.g., 100,000 for Forex).</li> <li>Account currency: Tick values are returned in account currency.</li> <li>Use Index: Match results to request using <code>Index</code> field, especially if some symbols fail.</li> </ul>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#1-get-tick-values-for-single-symbol","title":"1) Get tick values for single symbol","text":"<pre><code>// acc \u2014 connected MT5Account\n\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { \"EURUSD\" }\n});\n\nif (result.SymbolTickSizeInfos.Count &gt; 0)\n{\n    var tick = result.SymbolTickSizeInfos[0];\n\n    Console.WriteLine($\"Symbol: {tick.Name}\");\n    Console.WriteLine($\"Tick value: {tick.TradeTickValue:F2}\");\n    Console.WriteLine($\"Tick value (profit): {tick.TradeTickValueProfit:F2}\");\n    Console.WriteLine($\"Tick value (loss): {tick.TradeTickValueLoss:F2}\");\n    Console.WriteLine($\"Tick size: {tick.TradeTickSize:F5}\");\n    Console.WriteLine($\"Contract size: {tick.TradeContractSize:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#2-get-tick-values-for-multiple-symbols-batch","title":"2) Get tick values for multiple symbols (batch)","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\", \"BTCUSD\" };\n\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { symbols }\n});\n\nConsole.WriteLine($\"Tick values for {result.SymbolTickSizeInfos.Count} symbols:\\n\");\n\nforeach (var tick in result.SymbolTickSizeInfos)\n{\n    Console.WriteLine($\"{tick.Name,-10} Tick value: ${tick.TradeTickValue,8:F2}  Tick size: {tick.TradeTickSize,10:F5}  Contract: {tick.TradeContractSize,10:F0}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#3-calculate-pip-value-for-forex-pairs","title":"3) Calculate pip value for Forex pairs","text":"<pre><code>var forexPairs = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"USDCHF\" };\n\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { forexPairs }\n});\n\nConsole.WriteLine(\"Pip values (for 1 standard lot):\\n\");\n\nforeach (var tick in result.SymbolTickSizeInfos)\n{\n    // For most Forex pairs, 1 pip = 10 ticks (0.0001 for 4-digit pairs, 0.01 for JPY pairs)\n    var pipValue = tick.TradeTickValue * 10;\n\n    Console.WriteLine($\"{tick.Name,-10} 1 pip = ${pipValue:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#4-calculate-pl-for-position","title":"4) Calculate P&amp;L for position","text":"<pre><code>var symbol = \"XAUUSD\";\nvar lots = 0.10;\nvar entryPrice = 2000.00;\nvar currentPrice = 2010.00;\n\n// Get tick value\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { symbol }\n});\n\nif (result.SymbolTickSizeInfos.Count &gt; 0)\n{\n    var tick = result.SymbolTickSizeInfos[0];\n\n    // Calculate price change in ticks\n    var priceChange = currentPrice - entryPrice;\n    var ticksChanged = priceChange / tick.TradeTickSize;\n\n    // Calculate P&amp;L\n    var profitLoss = ticksChanged * tick.TradeTickValueProfit * lots;\n\n    Console.WriteLine($\"Symbol: {tick.Name}\");\n    Console.WriteLine($\"Entry: {entryPrice}, Current: {currentPrice}\");\n    Console.WriteLine($\"Price change: {priceChange} ({ticksChanged} ticks)\");\n    Console.WriteLine($\"P&amp;L for {lots} lots: ${profitLoss:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#5-position-sizing-based-on-risk","title":"5) Position sizing based on risk","text":"<pre><code>var symbol = \"EURUSD\";\nvar accountBalance = 10000.0; // $10,000\nvar riskPercent = 1.0; // Risk 1% per trade\nvar stopLossPips = 50; // 50 pip stop loss\n\n// Get tick value\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { symbol }\n});\n\nif (result.SymbolTickSizeInfos.Count &gt; 0)\n{\n    var tick = result.SymbolTickSizeInfos[0];\n\n    // Calculate pip value (1 pip = 10 ticks for most pairs)\n    var pipValue = tick.TradeTickValue * 10;\n\n    // Calculate risk amount\n    var riskAmount = accountBalance * (riskPercent / 100.0);\n\n    // Calculate lot size\n    var lotSize = riskAmount / (stopLossPips * pipValue);\n\n    // Round to valid lot size (e.g., 0.01 step)\n    lotSize = Math.Round(lotSize, 2);\n\n    Console.WriteLine($\"Account: ${accountBalance:F2}\");\n    Console.WriteLine($\"Risk: {riskPercent}% (${riskAmount:F2})\");\n    Console.WriteLine($\"Stop loss: {stopLossPips} pips\");\n    Console.WriteLine($\"Pip value (1 lot): ${pipValue:F2}\");\n    Console.WriteLine($\"Recommended lot size: {lotSize:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#6-compare-tick-values-across-symbol-types","title":"6) Compare tick values across symbol types","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"XAUUSD\", \"BTCUSD\", \"ES\", \"NQ\" };\n\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { symbols }\n});\n\nConsole.WriteLine(\"Tick value comparison:\\n\");\nConsole.WriteLine($\"{\"Symbol\",-10} {\"Tick Value\",-12} {\"Tick Size\",-12} {\"Contract Size\",-15}\");\nConsole.WriteLine(new string('-', 60));\n\nforeach (var tick in result.SymbolTickSizeInfos)\n{\n    Console.WriteLine($\"{tick.Name,-10} ${tick.TradeTickValue,-12:F2} {tick.TradeTickSize,-12:F5} {tick.TradeContractSize,-15:F0}\");\n}\n\nConsole.WriteLine(\"\\nNotes:\");\nConsole.WriteLine(\"- Forex (EURUSD): Contract size 100,000, tick size 0.00001\");\nConsole.WriteLine(\"- Gold (XAUUSD): Contract size 100, tick size varies\");\nConsole.WriteLine(\"- Crypto (BTCUSD): Contract size varies by broker\");\nConsole.WriteLine(\"- Futures (ES/NQ): Contract size and tick size vary by contract\");\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#7-calculate-margin-requirement-using-tick-values","title":"7) Calculate margin requirement using tick values","text":"<pre><code>var symbol = \"XAUUSD\";\nvar lots = 1.0;\n\n// Get tick values\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { symbol }\n});\n\nif (result.SymbolTickSizeInfos.Count &gt; 0)\n{\n    var tick = result.SymbolTickSizeInfos[0];\n\n    // Get current price (assuming you have it from SymbolInfoTick)\n    var currentPrice = 2000.0; // Example\n\n    // Calculate position value\n    var positionValue = lots * tick.TradeContractSize * currentPrice;\n\n    Console.WriteLine($\"Symbol: {tick.Name}\");\n    Console.WriteLine($\"Lots: {lots}\");\n    Console.WriteLine($\"Contract size: {tick.TradeContractSize}\");\n    Console.WriteLine($\"Current price: ${currentPrice}\");\n    Console.WriteLine($\"Position value: ${positionValue:F2}\");\n    Console.WriteLine($\"\\nNote: Actual margin depends on leverage and margin requirements\");\n}\n</code></pre>"},{"location":"MT5Account/6.%20Addittional_Methods/TickValueWithSize/#8-validate-tick-value-asymmetry","title":"8) Validate tick value asymmetry","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"USDJPY\", \"XAUUSD\" };\n\nvar result = await acc.TickValueWithSizeAsync(new TickValueWithSizeRequest\n{\n    SymbolNames = { symbols }\n});\n\nConsole.WriteLine(\"Checking for asymmetric tick values:\\n\");\n\nforeach (var tick in result.SymbolTickSizeInfos)\n{\n    var isSymmetric = Math.Abs(tick.TradeTickValueProfit - tick.TradeTickValueLoss) &lt; 0.0001;\n\n    Console.WriteLine($\"{tick.Name,-10}:\");\n    Console.WriteLine($\"  Profit tick value: ${tick.TradeTickValueProfit:F2}\");\n    Console.WriteLine($\"  Loss tick value:   ${tick.TradeTickValueLoss:F2}\");\n    Console.WriteLine($\"  Status: {(isSymmetric ? \"Symmetric\" : \"\u26a0 Asymmetric - long/short have different pip values\")}\");\n    Console.WriteLine();\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/","title":"\u2705 Subscribe to Position/Order Tickets Snapshots (<code>OnPositionsAndPendingOrdersTicketsAsync</code>)","text":"<p>Stream: Periodic snapshots of all position and pending order tickets on MT5. Returns list of active tickets at specified interval.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Service.OnPositionsAndPendingOrdersTicketsAsync(...)</code> (from class <code>MT5Service</code>)</li> <li>gRPC service: <code>mt5_term_api.SubscriptionService</code></li> <li>Proto definition: <code>OnPositionsAndPendingOrdersTickets</code> (defined in <code>mt5-term-api-subscriptions.proto</code>)</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.SubscriptionService</code></li> <li>Method: <code>OnPositionsAndPendingOrdersTickets(OnPositionsAndPendingOrdersTicketsRequest) \u2192 stream OnPositionsAndPendingOrdersTicketsReply</code></li> <li>Low\u2011level client (generated): <code>SubscriptionService.SubscriptionServiceClient.OnPositionsAndPendingOrdersTickets(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper:</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Service\n    {\n        public async IAsyncEnumerable&lt;OnPositionsAndPendingOrdersTicketsData&gt; OnPositionsAndPendingOrdersTicketsAsync(\n            int intervalMs = 1000,\n            [EnumeratorCancellation] CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OnPositionsAndPendingOrdersTicketsRequest { timer_period_milliseconds }</code></p> <p>Reply message (stream):</p> <p><code>OnPositionsAndPendingOrdersTicketsReply { data: OnPositionsAndPendingOrdersTicketsData }</code></p>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>intervalMs</code> <code>int</code> Update interval in milliseconds (default: 1000ms = 1 second) <code>cancellationToken</code> <code>CancellationToken</code> Token to stop the stream"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#output-onpositionsandpendingordersticketsdata-stream","title":"\u2b06\ufe0f Output \u2014 <code>OnPositionsAndPendingOrdersTicketsData</code> (stream)","text":"Field Type Description <code>PositionTickets</code> <code>List&lt;uint64&gt;</code> Array of all open position tickets <code>PendingOrderTickets</code> <code>List&lt;uint64&gt;</code> Array of all pending order tickets <code>ServerTime</code> <code>Timestamp</code> Server time of snapshot <code>TerminalInstanceGuidId</code> <code>string</code> Terminal instance ID"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Periodic polling-based stream that returns lists of all active position and pending order tickets. Lightweight snapshot of account activity.</li> <li>Why you need it. Quick overview of open positions/orders, detect when positions open/close, monitor account activity without full position details.</li> <li>Sanity check. Stream sends updates every <code>intervalMs</code> milliseconds. Compare ticket lists between updates to detect opens/closes.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for lightweight account monitoring:</p> <ul> <li>Quick check of open positions and pending orders.</li> <li>Detect position opens/closes by comparing tickets.</li> <li>Monitor number of active positions.</li> <li>Lightweight alternative to full position data.</li> <li>Build watchlists of active tickets.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Polling-based: Polls at fixed interval (default 1000ms = 1 second). Not event-driven.</li> <li>Tickets only: Returns only ticket numbers, not full position/order details. Use <code>OpenedOrdersAsync()</code> to get full details.</li> <li>Lightweight: Very efficient - minimal data transfer. Use for quick checks.</li> <li>Comparison logic: Compare ticket arrays between snapshots to detect changes.</li> <li>Use cases: 1s interval for monitoring, 5s for dashboards, 100ms for high-frequency checks.</li> <li>Server time: Each snapshot includes server time for synchronization.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#1-basic-ticket-monitoring","title":"1) Basic ticket monitoring","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(30)); // Monitor for 30 seconds\n\ntry\n{\n    await foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(\n        intervalMs: 1000,\n        cts.Token))\n    {\n        Console.WriteLine($\"[{snapshot.ServerTime.ToDateTime():HH:mm:ss}] \" +\n                         $\"Positions: {snapshot.PositionTickets.Count} | \" +\n                         $\"Pending: {snapshot.PendingOrderTickets.Count}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#2-detect-position-openscloses","title":"2) Detect position opens/closes","text":"<pre><code>var cts = new CancellationTokenSource();\nHashSet&lt;ulong&gt;? previousPositionTickets = null;\n\nawait foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 1000, cts.Token))\n{\n    var currentTickets = new HashSet&lt;ulong&gt;(snapshot.PositionTickets);\n\n    if (previousPositionTickets != null)\n    {\n        // Detect new positions\n        var newPositions = currentTickets.Except(previousPositionTickets);\n        foreach (var ticket in newPositions)\n        {\n            Console.WriteLine($\"\ud83c\udd95 New position opened: #{ticket}\");\n        }\n\n        // Detect closed positions\n        var closedPositions = previousPositionTickets.Except(currentTickets);\n        foreach (var ticket in closedPositions)\n        {\n            Console.WriteLine($\"\u2705 Position closed: #{ticket}\");\n        }\n    }\n\n    previousPositionTickets = currentTickets;\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#3-monitor-pending-order-placementcancellation","title":"3) Monitor pending order placement/cancellation","text":"<pre><code>var cts = new CancellationTokenSource();\nHashSet&lt;ulong&gt;? previousPendingTickets = null;\n\nawait foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 1000, cts.Token))\n{\n    var currentTickets = new HashSet&lt;ulong&gt;(snapshot.PendingOrderTickets);\n\n    if (previousPendingTickets != null)\n    {\n        // Detect new pending orders\n        var newOrders = currentTickets.Except(previousPendingTickets);\n        foreach (var ticket in newOrders)\n        {\n            Console.WriteLine($\"\ud83d\udcdd New pending order placed: #{ticket}\");\n        }\n\n        // Detect cancelled/executed pending orders\n        var removedOrders = previousPendingTickets.Except(currentTickets);\n        foreach (var ticket in removedOrders)\n        {\n            Console.WriteLine($\"\u274c Pending order removed: #{ticket}\");\n        }\n    }\n\n    previousPendingTickets = currentTickets;\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#4-count-based-monitoring","title":"4) Count-based monitoring","text":"<pre><code>var maxPositions = 5;\nvar cts = new CancellationTokenSource();\n\nawait foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 1000, cts.Token))\n{\n    var posCount = snapshot.PositionTickets.Count;\n    var pendingCount = snapshot.PendingOrderTickets.Count;\n\n    Console.WriteLine($\"[{snapshot.ServerTime.ToDateTime():HH:mm:ss}] \" +\n                     $\"Positions: {posCount}/{maxPositions} | Pending: {pendingCount}\");\n\n    if (posCount &gt;= maxPositions)\n    {\n        Console.WriteLine($\"\u26a0 WARNING: Maximum position limit ({maxPositions}) reached!\");\n    }\n\n    if (posCount == 0 &amp;&amp; pendingCount == 0)\n    {\n        Console.WriteLine(\"\u2713 No open positions or pending orders\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#5-track-position-activity-rate","title":"5) Track position activity rate","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromMinutes(1)); // Track for 1 minute\n\nint totalOpens = 0;\nint totalCloses = 0;\nHashSet&lt;ulong&gt;? previousTickets = null;\n\ntry\n{\n    await foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 1000, cts.Token))\n    {\n        if (previousTickets != null)\n        {\n            var currentTickets = new HashSet&lt;ulong&gt;(snapshot.PositionTickets);\n\n            var opens = currentTickets.Except(previousTickets).Count();\n            var closes = previousTickets.Except(currentTickets).Count();\n\n            totalOpens += opens;\n            totalCloses += closes;\n\n            if (opens &gt; 0 || closes &gt; 0)\n            {\n                Console.WriteLine($\"Activity: +{opens} opened, -{closes} closed\");\n            }\n        }\n\n        previousTickets = new HashSet&lt;ulong&gt;(snapshot.PositionTickets);\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine($\"\\n1-minute statistics:\");\n    Console.WriteLine($\"  Total positions opened: {totalOpens}\");\n    Console.WriteLine($\"  Total positions closed: {totalCloses}\");\n    Console.WriteLine($\"  Net change: {totalOpens - totalCloses}\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#6-simple-dashboard","title":"6) Simple dashboard","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 2000, cts.Token))\n{\n    Console.Clear();\n    Console.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\n    Console.WriteLine(\"      ACCOUNT ACTIVITY DASHBOARD       \");\n    Console.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\n    Console.WriteLine();\n\n    Console.WriteLine($\"Server Time:       {snapshot.ServerTime.ToDateTime():yyyy-MM-dd HH:mm:ss}\");\n    Console.WriteLine($\"Open Positions:    {snapshot.PositionTickets.Count}\");\n    Console.WriteLine($\"Pending Orders:    {snapshot.PendingOrderTickets.Count}\");\n    Console.WriteLine();\n\n    if (snapshot.PositionTickets.Count &gt; 0)\n    {\n        Console.WriteLine(\"Position Tickets:\");\n        foreach (var ticket in snapshot.PositionTickets.Take(10))\n        {\n            Console.WriteLine($\"  \u2022 #{ticket}\");\n        }\n        if (snapshot.PositionTickets.Count &gt; 10)\n        {\n            Console.WriteLine($\"  ... and {snapshot.PositionTickets.Count - 10} more\");\n        }\n    }\n\n    Console.WriteLine();\n    Console.WriteLine($\"Last update: {DateTime.Now:HH:mm:ss}\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#7-alert-on-first-position-open","title":"7) Alert on first position open","text":"<pre><code>var cts = new CancellationTokenSource();\nbool alerted = false;\n\nawait foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 500, cts.Token))\n{\n    if (!alerted &amp;&amp; snapshot.PositionTickets.Count &gt; 0)\n    {\n        Console.WriteLine($\"\ud83d\udd14 ALERT: First position detected!\");\n        Console.WriteLine($\"   Ticket: #{snapshot.PositionTickets[0]}\");\n        Console.WriteLine($\"   Time: {snapshot.ServerTime.ToDateTime():HH:mm:ss}\");\n\n        alerted = true;\n        cts.Cancel(); // Stop monitoring after first position\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#8-combine-with-full-position-data","title":"8) Combine with full position data","text":"<pre><code>// acc \u2014 MT5Account instance for full data\n// svc \u2014 MT5Service instance for streaming\n\nvar cts = new CancellationTokenSource();\n\nawait foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 2000, cts.Token))\n{\n    Console.WriteLine($\"\\nSnapshot at {snapshot.ServerTime.ToDateTime():HH:mm:ss}:\");\n    Console.WriteLine($\"Found {snapshot.PositionTickets.Count} position(s)\");\n\n    if (snapshot.PositionTickets.Count &gt; 0)\n    {\n        // Get full details for all positions\n        var fullData = await acc.OpenedOrdersAsync();\n\n        Console.WriteLine(\"\\nPosition Details:\");\n        foreach (var position in fullData.Positions)\n        {\n            Console.WriteLine($\"  #{position.Ticket}: {position.Symbol} \" +\n                             $\"{position.Volume} lots @ {position.PriceOpen} \" +\n                             $\"(P/L: ${position.Profit:F2})\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnPositionsAndPendingOrdersTickets/#9-high-frequency-check-100ms-polling","title":"9) High-frequency check (100ms polling)","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(10)); // 10 seconds of HF monitoring\n\nint snapshotCount = 0;\n\ntry\n{\n    await foreach (var snapshot in svc.OnPositionsAndPendingOrdersTicketsAsync(intervalMs: 100, cts.Token))\n    {\n        snapshotCount++;\n\n        Console.WriteLine($\"[{snapshotCount,4}] \" +\n                         $\"Pos: {snapshot.PositionTickets.Count,2} | \" +\n                         $\"Pending: {snapshot.PendingOrderTickets.Count,2}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine($\"\\nCollected {snapshotCount} snapshots in 10 seconds\");\n    Console.WriteLine($\"Average rate: {snapshotCount / 10.0:F1} snapshots/second\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/","title":"\u2705 Subscribe to Trade Events (<code>OnTradeAsync</code>)","text":"<p>Stream: Real-time trade execution and closure events on MT5. Continuously sends notifications when orders are filled, positions opened/closed, or orders modified.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Service.OnTradeAsync(...)</code> (from class <code>MT5Service</code>)</li> <li>gRPC service: <code>mt5_term_api.SubscriptionService</code></li> <li>Proto definition: <code>OnTrade</code> (defined in <code>mt5-term-api-subscriptions.proto</code>)</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.SubscriptionService</code></li> <li>Method: <code>OnTrade(OnTradeRequest) \u2192 stream OnTradeReply</code></li> <li>Low\u2011level client (generated): <code>SubscriptionService.SubscriptionServiceClient.OnTrade(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper:</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Service\n    {\n        public async IAsyncEnumerable&lt;OnTradeData&gt; OnTradeAsync(\n            [EnumeratorCancellation] CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OnTradeRequest {}</code> (empty)</p> <p>Reply message (stream):</p> <p><code>OnTradeReply { data: OnTradeData }</code></p>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>cancellationToken</code> <code>CancellationToken</code> Token to stop the stream"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#output-ontradedata-stream","title":"\u2b06\ufe0f Output \u2014 <code>OnTradeData</code> (stream)","text":"Field Type Description <code>Type</code> <code>MT5_SUB_ENUM_EVENT_GROUP_TYPE</code> Event group type <code>EventData</code> <code>OnTradeEventData</code> Trade event details <code>AccountInfo</code> <code>OnEventAccountInfo</code> Current account state <code>TerminalInstanceGuidId</code> <code>string</code> Terminal instance ID"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#ontradeeventdata-complete-trade-event-information","title":"<code>OnTradeEventData</code> \u2014 Complete trade event information","text":"Field Type Description <code>NewOrders</code> <code>List&lt;OnTradeOrderInfo&gt;</code> Newly placed orders <code>DisappearedOrders</code> <code>List&lt;OnTradeOrderInfo&gt;</code> Orders that were removed/cancelled <code>StateChangedOrders</code> <code>List&lt;OnTradeOrderStateChange&gt;</code> Orders with state changes <code>NewHistoryOrders</code> <code>List&lt;OnTradeHistoryOrderInfo&gt;</code> New orders in history (executed/cancelled) <code>DisappearedHistoryOrders</code> <code>List&lt;OnTradeHistoryOrderInfo&gt;</code> History orders that disappeared <code>UpdatedHistoryOrders</code> <code>List&lt;OnTradeHistoryOrderUpdate&gt;</code> History orders that were updated <code>NewHistoryDeals</code> <code>List&lt;OnTradeHistoryDealInfo&gt;</code> New deals in history <code>DisappearedHistoryDeals</code> <code>List&lt;OnTradeHistoryDealInfo&gt;</code> History deals that disappeared <code>UpdatedHistoryDeals</code> <code>List&lt;OnTradeHistoryDealUpdate&gt;</code> History deals that were updated <code>NewPositions</code> <code>List&lt;OnTradePositionInfo&gt;</code> Newly opened positions <code>DisappearedPositions</code> <code>List&lt;OnTradePositionInfo&gt;</code> Positions that were closed <code>UpdatedPositions</code> <code>List&lt;OnTradePositionUpdate&gt;</code> Positions that were modified"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#ontradepositioninfo-position-information","title":"<code>OnTradePositionInfo</code> \u2014 Position information","text":"Field Type Description <code>Index</code> <code>int32</code> Position index <code>Ticket</code> <code>int64</code> Position ticket <code>Type</code> <code>SUB_ENUM_POSITION_TYPE</code> Position type (Buy/Sell) <code>PositionTime</code> <code>Timestamp</code> Position open time <code>LastUpdateTime</code> <code>Timestamp</code> Last update time <code>PriceOpen</code> <code>double</code> Open price <code>Profit</code> <code>double</code> Current profit <code>Sl</code> <code>double</code> Stop Loss <code>Tp</code> <code>double</code> Take Profit <code>Volume</code> <code>double</code> Position volume <code>Swap</code> <code>double</code> Swap charges <code>Comment</code> <code>string</code> Position comment <code>Symbol</code> <code>string</code> Symbol name <code>Magic</code> <code>int64</code> Magic number <code>PriceCurrent</code> <code>double</code> Current price <code>AccountLogin</code> <code>int64</code> Account login <code>Reason</code> <code>SUB_ENUM_POSITION_REASON</code> Position open reason <code>FromPendingOrder</code> <code>bool</code> Opened from pending order"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#ontradeorderinfo-order-information","title":"<code>OnTradeOrderInfo</code> \u2014 Order information","text":"Field Type Description <code>Index</code> <code>int32</code> Order index <code>Ticket</code> <code>int64</code> Order ticket <code>State</code> <code>SUB_ENUM_ORDER_STATE</code> Order state <code>SetupTimeMsc</code> <code>int64</code> Setup time (milliseconds) <code>StopLoss</code> <code>double</code> Stop Loss <code>TakeProfit</code> <code>double</code> Take Profit <code>StopLimit</code> <code>double</code> Stop Limit price <code>PriceCurrent</code> <code>double</code> Current price <code>TimeExpiration</code> <code>Timestamp</code> Expiration time <code>TimeType</code> <code>SUB_ENUM_ORDER_TYPE_TIME</code> Time type (GTC, Day, etc) <code>Comment</code> <code>string</code> Order comment <code>Symbol</code> <code>string</code> Symbol name <code>Magic</code> <code>int64</code> Magic number <code>PriceOpen</code> <code>double</code> Open price <code>SetupTime</code> <code>Timestamp</code> Setup time <code>TimeExpirationSeconds</code> <code>int64</code> Expiration (seconds) <code>VolumeCurrent</code> <code>double</code> Current volume <code>VolumeInitial</code> <code>double</code> Initial volume <code>AccountLogin</code> <code>int64</code> Account login <code>OrderType</code> <code>SUB_ENUM_ORDER_TYPE</code> Order type <code>OrderTypeFilling</code> <code>SUB_ENUM_ORDER_TYPE_FILLING</code> Filling mode <code>OrderReason</code> <code>SUB_ENUM_ORDER_REASON</code> Order reason <code>PositionId</code> <code>int64</code> Position ID <code>PositionById</code> <code>int64</code> Opposite position ID"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#ontradehistorydealinfo-history-deal-information","title":"<code>OnTradeHistoryDealInfo</code> \u2014 History deal information","text":"Field Type Description <code>Index</code> <code>int32</code> Deal index <code>Ticket</code> <code>uint64</code> Deal ticket <code>OrderTicket</code> <code>int64</code> Order ticket <code>Type</code> <code>SUB_ENUM_DEAL_TYPE</code> Deal type <code>DealTime</code> <code>Timestamp</code> Deal execution time <code>Entry</code> <code>SUB_ENUM_DEAL_ENTRY</code> Deal entry (In/Out/InOut/OutBy) <code>DealPositionId</code> <code>int64</code> Position ID <code>Commission</code> <code>double</code> Commission <code>Fee</code> <code>double</code> Fee <code>Price</code> <code>double</code> Execution price <code>Profit</code> <code>double</code> Profit <code>Sl</code> <code>double</code> Stop Loss <code>Tp</code> <code>double</code> Take Profit <code>Volume</code> <code>double</code> Deal volume <code>Comment</code> <code>string</code> Deal comment <code>Symbol</code> <code>string</code> Symbol name <code>Swap</code> <code>double</code> Swap <code>Reason</code> <code>SUB_ENUM_DEAL_REASON</code> Deal reason <code>Magic</code> <code>int64</code> Magic number <code>AccountLogin</code> <code>int64</code> Account login"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#oneventaccountinfo-account-state-snapshot","title":"<code>OnEventAccountInfo</code> \u2014 Account state snapshot","text":"Field Type Description <code>Balance</code> <code>double</code> Account balance <code>Credit</code> <code>double</code> Account credit <code>Equity</code> <code>double</code> Account equity <code>Margin</code> <code>double</code> Used margin <code>FreeMargin</code> <code>double</code> Free margin <code>Profit</code> <code>double</code> Current profit <code>MarginLevel</code> <code>double</code> Margin level (%) <code>Login</code> <code>int64</code> Account login"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#mt5_sub_enum_event_group_type-event-group-type","title":"<code>MT5_SUB_ENUM_EVENT_GROUP_TYPE</code> (Event Group Type)","text":"Enum Value Description <code>OrderProfit</code> Position profit event <code>OrderUpdate</code> Order update event"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_position_type-position-type","title":"<code>SUB_ENUM_POSITION_TYPE</code> (Position Type)","text":"Enum Value Description <code>SubPositionTypeBuy</code> Buy position <code>SubPositionTypeSell</code> Sell position"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_position_reason-position-open-reason","title":"<code>SUB_ENUM_POSITION_REASON</code> (Position Open Reason)","text":"Enum Value Description <code>SUB_POSITION_REASON_CLIENT</code> Position opened from desktop terminal <code>SUB_POSITION_REASON_MOBILE</code> Position opened from mobile app <code>SUB_POSITION_REASON_WEB</code> Position opened from web platform <code>SUB_POSITION_REASON_EXPERT</code> Position opened by Expert Advisor"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_order_state-order-state","title":"<code>SUB_ENUM_ORDER_STATE</code> (Order State)","text":"Enum Value Description <code>SubOrderStateStarted</code> Order checked, not yet accepted by broker <code>SubOrderStatePlaced</code> Order accepted <code>SubOrderStateCanceled</code> Order canceled by client <code>SubOrderStatePartial</code> Order partially executed <code>SubOrderStateFilled</code> Order fully executed <code>SubOrderStateRejected</code> Order rejected <code>SubOrderStateExpired</code> Order expired <code>SubOrderStateRequestAdd</code> Order is being registered (placing to the trading system) <code>SubOrderStateRequestModify</code> Order is being modified (changing its parameters) <code>SubOrderStateRequestCancel</code> Order is being deleted (deleting from the trading system)"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_order_type_time-order-time-type","title":"<code>SUB_ENUM_ORDER_TYPE_TIME</code> (Order Time Type)","text":"Enum Value Description <code>SUB_ORDER_TIME_GTC</code> Good till cancel order <code>SUB_ORDER_TIME_DAY</code> Good till current trade day order <code>SUB_ORDER_TIME_SPECIFIED</code> Good till expired order <code>SUB_ORDER_TIME_SPECIFIED_DAY</code> The order will be effective till 23:59:59 of the specified day"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_order_type-order-type","title":"<code>SUB_ENUM_ORDER_TYPE</code> (Order Type)","text":"Enum Value Description <code>SUB_ORDER_TYPE_BUY</code> Market buy order <code>SUB_ORDER_TYPE_SELL</code> Market sell order <code>SUB_ORDER_TYPE_BUY_LIMIT</code> Buy Limit pending order <code>SUB_ORDER_TYPE_SELL_LIMIT</code> Sell Limit pending order <code>SUB_ORDER_TYPE_BUY_STOP</code> Buy Stop pending order <code>SUB_ORDER_TYPE_SELL_STOP</code> Sell Stop pending order <code>SUB_ORDER_TYPE_BUY_STOP_LIMIT</code> Buy Stop Limit pending order <code>SUB_ORDER_TYPE_SELL_STOP_LIMIT</code> Sell Stop Limit pending order <code>SUB_ORDER_TYPE_CLOSE_BY</code> Close by opposite position order"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_order_type_filling-order-filling-mode","title":"<code>SUB_ENUM_ORDER_TYPE_FILLING</code> (Order Filling Mode)","text":"Enum Value Description <code>SUB_ORDER_FILLING_FOK</code> Fill or Kill - order must be filled completely or canceled <code>SUB_ORDER_FILLING_IOC</code> Immediate or Cancel - partial fills allowed, remainder canceled <code>SUB_ORDER_FILLING_BOC</code> Book or Cancel - order can only be placed in the order book <code>SUB_ORDER_FILLING_RETURN</code> Return - used for market orders on exchange"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_order_reason-order-reason","title":"<code>SUB_ENUM_ORDER_REASON</code> (Order Reason)","text":"Enum Value Description <code>SUB_ORDER_REASON_CLIENT</code> Order placed from desktop terminal <code>SUB_ORDER_REASON_MOBILE</code> Order placed from mobile app <code>SUB_ORDER_REASON_WEB</code> Order placed from web platform <code>SUB_ORDER_REASON_EXPERT</code> Order placed by Expert Advisor <code>SUB_ORDER_REASON_SL</code> Order triggered by Stop Loss <code>SUB_ORDER_REASON_TP</code> Order triggered by Take Profit <code>SUB_ORDER_REASON_SO</code> Order triggered by Stop Out"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_deal_type-deal-type","title":"<code>SUB_ENUM_DEAL_TYPE</code> (Deal Type)","text":"Enum Value Description <code>SubDealTypeBuy</code> Buy deal <code>SubDealTypeSell</code> Sell deal <code>SubDealTypeBalance</code> Balance operation <code>SubDealTypeCredit</code> Credit operation <code>SUB_DEAL_TYPE_CHARGE</code> Additional charge <code>SUB_DEAL_TYPE_CORRECTION</code> Correction <code>SUB_DEAL_TYPE_BONUS</code> Bonus <code>SUB_DEAL_TYPE_COMMISSION</code> Additional commission <code>SUB_DEAL_TYPE_COMMISSION_DAILY</code> Daily commission <code>SUB_DEAL_TYPE_COMMISSION_MONTHLY</code> Monthly commission <code>SUB_DEAL_TYPE_COMMISSION_AGENT_DAILY</code> Daily agent commission <code>SUB_DEAL_TYPE_COMMISSION_AGENT_MONTHLY</code> Monthly agent commission <code>SUB_DEAL_TYPE_INTEREST</code> Interest rate <code>SUB_DEAL_TYPE_BUY_CANCELED</code> Canceled buy deal <code>SUB_DEAL_TYPE_SELL_CANCELED</code> Canceled sell deal"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_deal_entry-deal-entry-direction","title":"<code>SUB_ENUM_DEAL_ENTRY</code> (Deal Entry Direction)","text":"Enum Value Description <code>SubDealEntryIn</code> Entry in (opening position) <code>SubDealEntryOut</code> Entry out (closing position) <code>SubDealEntryInout</code> Reverse (reversing position) <code>SubDealEntryOutBy</code> Close a position by an opposite one"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#sub_enum_deal_reason-deal-reason","title":"<code>SUB_ENUM_DEAL_REASON</code> (Deal Reason)","text":"Enum Value Description <code>SUB_DEAL_REASON_CLIENT</code> Deal executed from desktop terminal <code>SUB_DEAL_REASON_MOBILE</code> Deal executed from mobile app <code>SUB_DEAL_REASON_WEB</code> Deal executed from web platform <code>SUB_DEAL_REASON_EXPERT</code> Deal executed by Expert Advisor <code>SUB_DEAL_REASON_SL</code> Deal executed by Stop Loss <code>SUB_DEAL_REASON_TP</code> Deal executed by Take Profit <code>SUB_DEAL_REASON_SO</code> Deal executed by Stop Out <code>SUB_DEAL_REASON_ROLLOVER</code> Deal executed due to rollover <code>SUB_DEAL_REASON_VMARGIN</code> Deal executed due to variation margin <code>SUB_DEAL_REASON_SPLIT</code> Deal executed due to split <code>SUB_DEAL_REASON_CORPORATE_ACTION</code> Deal executed due to corporate action"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Real-time notifications for all trade-related events: order placement, execution, position opens/closes, modifications.</li> <li>Why you need it. Monitor trade execution in real-time, track position lifecycle, build event-driven systems without polling.</li> <li>Sanity check. Check <code>EventData</code> arrays to see what changed: <code>NewPositions</code>, <code>DisappearedPositions</code>, <code>NewHistoryDeals</code>, etc.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for real-time trade monitoring:</p> <ul> <li>Monitor order execution as it happens.</li> <li>Track position opens and closes.</li> <li>Detect SL/TP hits immediately.</li> <li>Build trade journaling systems.</li> <li>React to trade events in real-time.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Comprehensive events: Includes orders, positions, deals, and history. Filter arrays you need.</li> <li>Delta updates: Each event shows what changed since last update.</li> <li>Account snapshot: Includes current account state with each event.</li> <li>Performance: Events arrive immediately when trades execute. Keep processing fast.</li> <li>Comparison with OnTradeTransaction: <code>OnTrade</code> is simpler, focused on trades. <code>OnTradeTransaction</code> is more detailed with full transaction lifecycle.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#1-monitor-new-positions","title":"1) Monitor new positions","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar cts = new CancellationTokenSource();\n\ntry\n{\n    await foreach (var trade in svc.OnTradeAsync(cts.Token))\n    {\n        foreach (var position in trade.EventData.NewPositions)\n        {\n            Console.WriteLine($\"\ud83c\udd95 New position opened:\");\n            Console.WriteLine($\"  Ticket: #{position.Ticket}\");\n            Console.WriteLine($\"  Symbol: {position.Symbol}\");\n            Console.WriteLine($\"  Type: {position.Type}\");\n            Console.WriteLine($\"  Volume: {position.Volume}\");\n            Console.WriteLine($\"  Price: {position.PriceOpen}\");\n            Console.WriteLine();\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#2-monitor-position-closes","title":"2) Monitor position closes","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var trade in svc.OnTradeAsync(cts.Token))\n{\n    foreach (var position in trade.EventData.DisappearedPositions)\n    {\n        var profitSign = position.Profit &gt;= 0 ? \"+\" : \"\";\n\n        Console.WriteLine($\"\u2705 Position closed:\");\n        Console.WriteLine($\"  Ticket: #{position.Ticket}\");\n        Console.WriteLine($\"  Symbol: {position.Symbol}\");\n        Console.WriteLine($\"  Profit: {profitSign}${position.Profit:F2}\");\n        Console.WriteLine($\"  Swap: ${position.Swap:F2}\");\n        Console.WriteLine();\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#3-track-all-trade-activity","title":"3) Track all trade activity","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var trade in svc.OnTradeAsync(cts.Token))\n{\n    var e = trade.EventData;\n\n    if (e.NewOrders.Count &gt; 0)\n        Console.WriteLine($\"\ud83d\udcdd {e.NewOrders.Count} new order(s) placed\");\n\n    if (e.NewPositions.Count &gt; 0)\n        Console.WriteLine($\"\ud83c\udd95 {e.NewPositions.Count} position(s) opened\");\n\n    if (e.DisappearedPositions.Count &gt; 0)\n        Console.WriteLine($\"\u2705 {e.DisappearedPositions.Count} position(s) closed\");\n\n    if (e.NewHistoryDeals.Count &gt; 0)\n        Console.WriteLine($\"\ud83d\udcbc {e.NewHistoryDeals.Count} new deal(s) in history\");\n\n    if (e.UpdatedPositions.Count &gt; 0)\n        Console.WriteLine($\"\ud83d\udd04 {e.UpdatedPositions.Count} position(s) modified\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#4-log-trade-executions","title":"4) Log trade executions","text":"<pre><code>var cts = new CancellationTokenSource();\nvar logFile = \"trade_executions.csv\";\n\n// Write CSV header\nFile.WriteAllText(logFile, \"Timestamp,Ticket,Symbol,Type,Volume,Price,Profit\\n\");\n\nawait foreach (var trade in svc.OnTradeAsync(cts.Token))\n{\n    foreach (var deal in trade.EventData.NewHistoryDeals)\n    {\n        var timestamp = DateTime.UtcNow;\n        var logEntry = $\"{timestamp:yyyy-MM-dd HH:mm:ss},\" +\n                      $\"{deal.Ticket},\" +\n                      $\"{deal.Symbol},\" +\n                      $\"{deal.Type},\" +\n                      $\"{deal.Volume},\" +\n                      $\"{deal.Price},\" +\n                      $\"{deal.Profit}\\n\";\n\n        File.AppendAllText(logFile, logEntry);\n        Console.WriteLine($\"Deal logged: {deal.Ticket} on {deal.Symbol}\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#5-monitor-account-balance-changes","title":"5) Monitor account balance changes","text":"<pre><code>var cts = new CancellationTokenSource();\ndouble? previousBalance = null;\n\nawait foreach (var trade in svc.OnTradeAsync(cts.Token))\n{\n    var currentBalance = trade.AccountInfo.Balance;\n\n    if (previousBalance.HasValue &amp;&amp; currentBalance != previousBalance)\n    {\n        var change = currentBalance - previousBalance.Value;\n        var sign = change &gt;= 0 ? \"+\" : \"\";\n\n        Console.WriteLine($\"\ud83d\udcb0 Balance changed: ${previousBalance:F2} \u2192 ${currentBalance:F2} ({sign}${change:F2})\");\n    }\n\n    previousBalance = currentBalance;\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#6-detect-sltp-modifications","title":"6) Detect SL/TP modifications","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var trade in svc.OnTradeAsync(cts.Token))\n{\n    foreach (var update in trade.EventData.UpdatedPositions)\n    {\n        var prev = update.PreviousPosition;\n        var curr = update.CurrentPosition;\n\n        if (prev.Sl != curr.Sl)\n        {\n            Console.WriteLine($\"\ud83d\udd04 Position #{curr.Ticket} SL modified:\");\n            Console.WriteLine($\"   {prev.Sl} \u2192 {curr.Sl}\");\n        }\n\n        if (prev.Tp != curr.Tp)\n        {\n            Console.WriteLine($\"\ud83d\udd04 Position #{curr.Ticket} TP modified:\");\n            Console.WriteLine($\"   {prev.Tp} \u2192 {curr.Tp}\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/OnTrade/#7-real-time-trade-statistics","title":"7) Real-time trade statistics","text":"<pre><code>var cts = new CancellationTokenSource();\n\nint totalTrades = 0;\nint winningTrades = 0;\nint losingTrades = 0;\ndouble totalProfit = 0;\n\nawait foreach (var trade in svc.OnTradeAsync(cts.Token))\n{\n    foreach (var deal in trade.EventData.NewHistoryDeals)\n    {\n        // Count only entry/exit deals (not balance operations)\n        if (deal.Entry == SUB_ENUM_DEAL_ENTRY.SubDealEntryOut)\n        {\n            totalTrades++;\n            totalProfit += deal.Profit;\n\n            if (deal.Profit &gt;= 0)\n                winningTrades++;\n            else\n                losingTrades++;\n\n            var winRate = totalTrades &gt; 0 ? (winningTrades * 100.0 / totalTrades) : 0;\n\n            Console.WriteLine($\"\\n\ud83d\udcca Trade Statistics:\");\n            Console.WriteLine($\"   Total trades: {totalTrades}\");\n            Console.WriteLine($\"   Wins: {winningTrades} | Losses: {losingTrades}\");\n            Console.WriteLine($\"   Win rate: {winRate:F1}%\");\n            Console.WriteLine($\"   Total P/L: ${totalProfit:F2}\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/","title":"MT5Account \u00b7 Streaming Methods - Overview","text":"<p>Real-time continuous data streams: ticks, trade events, position updates, and account changes. Use this page for event-driven applications.</p> <p>\ud83d\udcd6 IMPORTANT: Complete Streaming &amp; Subscription Guide - Read this first! Learn how to properly manage streams, prevent memory leaks, and choose the right pattern (7 complete examples from simple to production-ready).</p>"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/#what-lives-here","title":"\ud83d\udcc1 What lives here","text":"<ul> <li>SubscribeToTicks - real-time tick stream for multiple symbols (bid/ask updates).</li> <li>SubscribeToTradeTransaction - trade events stream (orders, deals, position changes).</li> <li>SubscribeToPositionProfit - position P/L updates (profit changes in real-time).</li> <li>OnTrade - comprehensive trade events (positions, orders, deals with full details).</li> <li>OnPositionsAndPendingOrdersTickets - periodic ticket snapshots (lightweight polling).</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/#plain-english","title":"\ud83e\udded Plain English","text":"<ul> <li>SubscribeToTicks \u2192 live price feed for multiple symbols (like a price ticker).</li> <li>SubscribeToTradeTransaction \u2192 get notified when orders execute, positions change, etc.</li> <li>SubscribeToPositionProfit \u2192 watch profit/loss changes in real-time.</li> <li>OnTrade \u2192 full details of all trading events (new positions, closed orders, etc.).</li> <li>OnPositionsAndPendingOrdersTickets \u2192 lightweight periodic updates of active tickets.</li> </ul> <p>Streaming = <code>await foreach</code> - these methods return <code>IAsyncEnumerable&lt;T&gt;</code>. Use with async loops and <code>CancellationToken</code>.</p>"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/#quick-choose","title":"Quick choose","text":"If you need\u2026 Use Returns (stream) Key inputs Real-time price ticks <code>OnSymbolTickAsync</code> Tick data for symbols Array of symbol names Trade transaction events <code>OnTradeTransactionAsync</code> Trade events (orders, deals) (none) Position profit updates <code>OnPositionProfitAsync</code> P/L changes (new/updated/closed) Update interval + ignore empty flag Comprehensive trade events <code>OnTradeAsync</code> Full trade event details (none) Periodic ticket snapshots <code>OnPositionsAndPendingOrdersTicketsAsync</code> Lists of tickets Update interval"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/#crossrefs-gotchas","title":"\u274c Cross\u2011refs &amp; gotchas","text":"<ul> <li>Cancellation: Always use <code>CancellationToken</code> to stop streams gracefully.</li> <li><code>await foreach</code>: Required syntax for processing streaming data.</li> <li>Error handling: Wrap in try-catch for <code>OperationCanceledException</code>.</li> <li>Buffering: Streams may buffer events - process quickly to avoid delays.</li> <li>Automatic reconnection: All streaming methods have built-in <code>ExecuteWithReconnect</code> - connection issues handled automatically.</li> <li>Performance: Ticks for multiple symbols = high volume, ensure fast processing.</li> <li>Memory safety: MT5Account has built-in cleanup (<code>finally { stream?.Dispose() }</code>), but still use <code>CancellationToken</code> for graceful shutdown.</li> </ul> <p>\ud83d\udca1 See GRPC_STREAM_MANAGEMENT.md for complete guide with 7 patterns, best practices, and production examples!</p>"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/#minimal-snippets","title":"\ud83d\udfe2 Minimal snippets","text":"<pre><code>// Real-time tick stream for multiple symbols\nvar cts = new CancellationTokenSource();\ntry\n{\n    await foreach (var tickData in account.OnSymbolTickAsync(\n        new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" }, cts.Token))\n    {\n        var tick = tickData.SymbolTick;\n        Console.WriteLine($\"[{tick.Time.ToDateTime():HH:mm:ss}] {tick.Symbol}: \" +\n                          $\"Bid={tick.Bid:F5}, Ask={tick.Ask:F5}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre> <pre><code>// Trade transaction events (orders, deals)\nvar cts = new CancellationTokenSource();\ntry\n{\n    await foreach (var tradeEvent in account.OnTradeTransactionAsync(cts.Token))\n    {\n        Console.WriteLine($\"Event Type: {tradeEvent.Type}\");\n\n        if (tradeEvent.TradeTransaction != null)\n        {\n            var tx = tradeEvent.TradeTransaction;\n            Console.WriteLine($\"Transaction: {tx.Type} - Order #{tx.OrderTicket}, \" +\n                              $\"Symbol: {tx.Symbol}, Price: {tx.Price:F5}\");\n        }\n\n        if (tradeEvent.TradeResult != null)\n        {\n            var result = tradeEvent.TradeResult;\n            Console.WriteLine($\"Result: Code={result.TradeReturnCode}, \" +\n                              $\"Deal #{result.DealTicket}, Order #{result.OrderTicket}\");\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Transaction stream stopped\");\n}\n</code></pre> <pre><code>// Position profit updates (real-time P/L)\nvar cts = new CancellationTokenSource();\ntry\n{\n    await foreach (var profitUpdate in account.OnPositionProfitAsync(\n        intervalMs: 500, ignoreEmptyData: true, cts.Token))\n    {\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Profit Update:\");\n\n        foreach (var pos in profitUpdate.NewPositions)\n        {\n            Console.WriteLine($\"  NEW: {pos.PositionSymbol} #{pos.Ticket} - P/L: ${pos.Profit:F2}\");\n        }\n\n        foreach (var pos in profitUpdate.UpdatedPositions)\n        {\n            Console.WriteLine($\"  UPD: {pos.PositionSymbol} #{pos.Ticket} - P/L: ${pos.Profit:F2}\");\n        }\n\n        foreach (var pos in profitUpdate.DeletedPositions)\n        {\n            Console.WriteLine($\"  DEL: {pos.PositionSymbol} #{pos.Ticket} - Final P/L: ${pos.Profit:F2}\");\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Profit stream stopped\");\n}\n</code></pre> <pre><code>// Periodic ticket snapshots (lightweight)\nvar cts = new CancellationTokenSource(TimeSpan.FromSeconds(30)); // Auto-stop after 30s\ntry\n{\n    await foreach (var snapshot in account.OnPositionsAndPendingOrdersTicketsAsync(\n        intervalMs: 1000, cts.Token))\n    {\n        Console.WriteLine($\"[{snapshot.ServerTime.ToDateTime():HH:mm:ss}] \" +\n                          $\"Positions: {snapshot.PositionTickets.Count}, \" +\n                          $\"Orders: {snapshot.PendingOrderTickets.Count}\");\n\n        if (snapshot.PositionTickets.Any())\n        {\n            Console.WriteLine($\"  Position tickets: {string.Join(\", \", snapshot.PositionTickets)}\");\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Ticket stream stopped\");\n}\n</code></pre> <pre><code>// Comprehensive trade events with full details\nvar cts = new CancellationTokenSource();\ntry\n{\n    await foreach (var tradeData in account.OnTradeAsync(cts.Token))\n    {\n        var events = tradeData.EventData;\n\n        foreach (var pos in events.NewPositions)\n        {\n            Console.WriteLine($\"NEW Position: {pos.PositionSymbol} #{pos.PositionTicket} @ {pos.PriceOpen:F5}\");\n        }\n\n        foreach (var order in events.NewOrders)\n        {\n            Console.WriteLine($\"NEW Order: {order.OrderSymbol} #{order.OrderTicket} - {order.OrderType}\");\n        }\n\n        foreach (var deal in events.NewHistoryDeals)\n        {\n            Console.WriteLine($\"NEW Deal: #{deal.Ticket} - Profit: ${deal.Profit:F2}\");\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Trade stream stopped\");\n}\n</code></pre> <pre><code>// Stop stream after condition met\nvar cts = new CancellationTokenSource();\nvar maxProfit = 100.0;\n\ntry\n{\n    await foreach (var profitUpdate in account.OnPositionProfitAsync(\n        intervalMs: 500, ignoreEmptyData: true, cts.Token))\n    {\n        var totalProfit = profitUpdate.UpdatedPositions.Sum(p =&gt; p.Profit);\n        Console.WriteLine($\"Total Profit: ${totalProfit:F2}\");\n\n        if (totalProfit &gt;= maxProfit)\n        {\n            Console.WriteLine($\"\u2705 Target profit ${maxProfit} reached! Stopping stream...\");\n            cts.Cancel();\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped by target condition\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/Streaming_Methods.Overview/#see-also","title":"See also","text":"<ul> <li>\ud83d\udcd6 GRPC Stream Management Guide - Complete guide to streaming (MUST READ!)</li> <li>Request/Reply: OpenedOrders - one-time snapshot vs continuous stream</li> <li>Request/Reply: SymbolInfoTick - single tick vs tick stream</li> <li>Account: AccountSummary - account snapshot</li> <li>Trading: OrderSend - place orders based on stream events</li> <li>MT5Sugar Helpers: ReadTicks &amp; ReadTrades - Bounded streaming (recommended!)</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/","title":"\u2705 Subscribe to Position Profit Updates (<code>OnPositionProfitAsync</code>)","text":"<p>Stream: Periodic snapshots of position profit/loss on MT5. Returns profit updates for all open positions at specified interval.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Service.OnPositionProfitAsync(...)</code> (from class <code>MT5Service</code>)</li> <li>gRPC service: <code>mt5_term_api.SubscriptionService</code></li> <li>Proto definition: <code>OnPositionProfit</code> (defined in <code>mt5-term-api-subscriptions.proto</code>)</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.SubscriptionService</code></li> <li>Method: <code>OnPositionProfit(OnPositionProfitRequest) \u2192 stream OnPositionProfitReply</code></li> <li>Low\u2011level client (generated): <code>SubscriptionService.SubscriptionServiceClient.OnPositionProfit(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper:</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Service\n    {\n        public async IAsyncEnumerable&lt;OnPositionProfitData&gt; OnPositionProfitAsync(\n            int intervalMs = 1000,\n            bool ignoreEmpty = false,\n            [EnumeratorCancellation] CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OnPositionProfitRequest { timer_period_milliseconds, ignore_empty_data }</code></p> <p>Reply message (stream):</p> <p><code>OnPositionProfitReply { data: OnPositionProfitData }</code></p>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>intervalMs</code> <code>int</code> Update interval in milliseconds (default: 1000ms = 1 second) <code>ignoreEmpty</code> <code>bool</code> Skip events when no positions exist (default: false) <code>cancellationToken</code> <code>CancellationToken</code> Token to stop the stream"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#output-onpositionprofitdata-stream","title":"\u2b06\ufe0f Output \u2014 <code>OnPositionProfitData</code> (stream)","text":"Field Type Description <code>Type</code> <code>MT5_SUB_ENUM_EVENT_GROUP_TYPE</code> Event group type <code>NewPositions</code> <code>List&lt;OnPositionProfitPositionInfo&gt;</code> Newly opened positions since last update <code>UpdatedPositions</code> <code>List&lt;OnPositionProfitPositionInfo&gt;</code> Positions with changed profit <code>DeletedPositions</code> <code>List&lt;OnPositionProfitPositionInfo&gt;</code> Closed positions since last update <code>AccountInfo</code> <code>OnEventAccountInfo</code> Current account state <code>TerminalInstanceGuidId</code> <code>string</code> Terminal instance ID"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#onpositionprofitpositioninfo-position-profit-information","title":"<code>OnPositionProfitPositionInfo</code> \u2014 Position profit information","text":"Field Type Description <code>Index</code> <code>int32</code> Position index <code>Ticket</code> <code>int64</code> Position ticket <code>Profit</code> <code>double</code> Current profit/loss <code>PositionSymbol</code> <code>string</code> Symbol name"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#oneventaccountinfo-account-state-snapshot","title":"<code>OnEventAccountInfo</code> \u2014 Account state snapshot","text":"Field Type Description <code>Balance</code> <code>double</code> Account balance <code>Credit</code> <code>double</code> Account credit <code>Equity</code> <code>double</code> Account equity <code>Margin</code> <code>double</code> Used margin <code>FreeMargin</code> <code>double</code> Free margin <code>Profit</code> <code>double</code> Total current profit <code>MarginLevel</code> <code>double</code> Margin level (%) <code>Login</code> <code>int64</code> Account login"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#mt5_sub_enum_event_group_type","title":"<code>MT5_SUB_ENUM_EVENT_GROUP_TYPE</code>","text":"<ul> <li><code>OrderProfit</code> \u2014 Position profit event</li> <li><code>OrderUpdate</code> \u2014 Order update event</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Periodic polling-based stream that sends profit snapshots at specified interval. Shows new/updated/closed positions since last update.</li> <li>Why you need it. Real-time P&amp;L monitoring, drawdown alerts, profit targeting, risk management dashboards.</li> <li>Sanity check. Stream sends updates every <code>intervalMs</code> milliseconds. Check <code>NewPositions</code>, <code>UpdatedPositions</code>, <code>DeletedPositions</code> arrays for changes.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for real-time profit monitoring:</p> <ul> <li>Real-time P/L dashboards.</li> <li>Profit/loss alerts and notifications.</li> <li>Drawdown monitoring.</li> <li>Equity curve tracking.</li> <li>Automated profit-taking strategies.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Polling-based: Unlike tick streams, this polls at fixed interval. Default 1000ms (1 second).</li> <li>Delta updates: Each event shows what changed since last update (new, updated, deleted positions).</li> <li>Empty events: If <code>ignoreEmpty = false</code>, receives events even when no positions open. Set <code>true</code> to skip empty updates.</li> <li>Account snapshot: Each event includes complete account state (balance, equity, margin, etc.).</li> <li>Profit calculation: Profit includes both unrealized P/L and swap charges.</li> <li>Performance: Lower frequency = less CPU usage. Adjust <code>intervalMs</code> based on needs.</li> <li>Use cases: 1s interval for monitoring, 100ms for high-frequency strategies, 5s for dashboards.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#1-basic-profit-monitoring","title":"1) Basic profit monitoring","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar cts = new CancellationTokenSource();\n\ntry\n{\n    await foreach (var profitUpdate in svc.OnPositionProfitAsync(\n        intervalMs: 1000,\n        ignoreEmpty: true,\n        cts.Token))\n    {\n        Console.WriteLine($\"Total account profit: ${profitUpdate.AccountInfo.Profit:F2}\");\n        Console.WriteLine($\"  Equity: ${profitUpdate.AccountInfo.Equity:F2}\");\n        Console.WriteLine($\"  Margin Level: {profitUpdate.AccountInfo.MarginLevel:F2}%\");\n        Console.WriteLine();\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#2-monitor-individual-position-profits","title":"2) Monitor individual position profits","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 500, cts.Token))\n{\n    // Show all currently profitable positions\n    foreach (var pos in update.UpdatedPositions)\n    {\n        var status = pos.Profit &gt;= 0 ? \"\ud83d\udfe2\" : \"\ud83d\udd34\";\n        Console.WriteLine($\"{status} Position #{pos.Ticket} ({pos.PositionSymbol}): ${pos.Profit:F2}\");\n    }\n\n    // Show newly opened positions\n    foreach (var pos in update.NewPositions)\n    {\n        Console.WriteLine($\"\ud83c\udd95 New position #{pos.Ticket} opened on {pos.PositionSymbol}\");\n    }\n\n    // Show closed positions\n    foreach (var pos in update.DeletedPositions)\n    {\n        Console.WriteLine($\"\u2705 Position #{pos.Ticket} closed with ${pos.Profit:F2}\");\n    }\n\n    Console.WriteLine();\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#3-profit-alert-system","title":"3) Profit alert system","text":"<pre><code>var targetProfit = 100.0; // Alert when account profit reaches $100\nvar cts = new CancellationTokenSource();\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 1000, cts.Token))\n{\n    var totalProfit = update.AccountInfo.Profit;\n\n    Console.WriteLine($\"Current profit: ${totalProfit:F2}\");\n\n    if (totalProfit &gt;= targetProfit)\n    {\n        Console.WriteLine($\"\\n\ud83c\udfaf PROFIT TARGET REACHED: ${totalProfit:F2}!\");\n        Console.WriteLine(\"Consider closing positions to lock in profits.\");\n\n        // Stop monitoring\n        cts.Cancel();\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#4-drawdown-monitoring","title":"4) Drawdown monitoring","text":"<pre><code>var cts = new CancellationTokenSource();\nvar maxDrawdown = -50.0; // Stop if drawdown exceeds $50\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 1000, cts.Token))\n{\n    var currentProfit = update.AccountInfo.Profit;\n\n    if (currentProfit &lt; maxDrawdown)\n    {\n        Console.WriteLine($\"\u26a0 DRAWDOWN ALERT: ${currentProfit:F2}!\");\n        Console.WriteLine($\"Maximum allowed drawdown (${maxDrawdown}) exceeded.\");\n        Console.WriteLine(\"STOP TRADING AND REVIEW POSITIONS.\");\n\n        // Could automatically close all positions here\n        cts.Cancel();\n    }\n    else\n    {\n        Console.WriteLine($\"P/L: ${currentProfit:F2} (OK)\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#5-track-equity-curve","title":"5) Track equity curve","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromMinutes(5)); // Monitor for 5 minutes\n\nvar equityHistory = new List&lt;(DateTime Time, double Equity)&gt;();\n\ntry\n{\n    await foreach (var update in svc.OnPositionProfitAsync(intervalMs: 1000, cts.Token))\n    {\n        var equity = update.AccountInfo.Equity;\n        equityHistory.Add((DateTime.UtcNow, equity));\n\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Equity: ${equity:F2}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine($\"\\nEquity curve collected ({equityHistory.Count} data points):\");\n\n    var startEquity = equityHistory.First().Equity;\n    var endEquity = equityHistory.Last().Equity;\n    var maxEquity = equityHistory.Max(e =&gt; e.Equity);\n    var minEquity = equityHistory.Min(e =&gt; e.Equity);\n\n    Console.WriteLine($\"  Start: ${startEquity:F2}\");\n    Console.WriteLine($\"  End: ${endEquity:F2}\");\n    Console.WriteLine($\"  Change: ${endEquity - startEquity:F2}\");\n    Console.WriteLine($\"  Max: ${maxEquity:F2}\");\n    Console.WriteLine($\"  Min: ${minEquity:F2}\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#6-real-time-pl-dashboard","title":"6) Real-time P/L dashboard","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 1000, cts.Token))\n{\n    Console.Clear();\n    Console.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\n    Console.WriteLine(\"          REAL-TIME P/L DASHBOARD          \");\n    Console.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\n    Console.WriteLine();\n\n    var acc = update.AccountInfo;\n\n    Console.WriteLine($\"Balance:      ${acc.Balance,12:F2}\");\n    Console.WriteLine($\"Equity:       ${acc.Equity,12:F2}\");\n    Console.WriteLine($\"Profit:       ${acc.Profit,12:F2}\");\n    Console.WriteLine($\"Margin:       ${acc.Margin,12:F2}\");\n    Console.WriteLine($\"Free Margin:  ${acc.FreeMargin,12:F2}\");\n    Console.WriteLine($\"Margin Level: {acc.MarginLevel,12:F2}%\");\n    Console.WriteLine();\n\n    Console.WriteLine(\"Active Positions:\");\n    Console.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\n    foreach (var pos in update.UpdatedPositions)\n    {\n        var profitSign = pos.Profit &gt;= 0 ? \"+\" : \"\";\n        var color = pos.Profit &gt;= 0 ? \"\ud83d\udfe2\" : \"\ud83d\udd34\";\n\n        Console.WriteLine($\"{color} #{pos.Ticket,-10} {pos.PositionSymbol,-8} {profitSign}${pos.Profit,10:F2}\");\n    }\n\n    Console.WriteLine();\n    Console.WriteLine($\"Last update: {DateTime.Now:HH:mm:ss}\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#7-automated-profit-taking","title":"7) Automated profit-taking","text":"<pre><code>var targetProfitPerPosition = 10.0; // Take profit at $10 per position\nvar cts = new CancellationTokenSource();\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 500, cts.Token))\n{\n    foreach (var pos in update.UpdatedPositions)\n    {\n        if (pos.Profit &gt;= targetProfitPerPosition)\n        {\n            Console.WriteLine($\"\ud83c\udfaf Position #{pos.Ticket} reached target profit: ${pos.Profit:F2}\");\n            Console.WriteLine($\"   Closing position...\");\n\n            // Close position (would need MT5Account instance)\n            // await account.OrderCloseAsync(new OrderCloseRequest { Ticket = (ulong)pos.Ticket, Volume = 0 });\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#8-margin-level-monitoring-with-alerts","title":"8) Margin level monitoring with alerts","text":"<pre><code>var warningLevel = 150.0; // Warn if margin level drops below 150%\nvar dangerLevel = 100.0;  // Alert if below 100%\n\nvar cts = new CancellationTokenSource();\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 1000, cts.Token))\n{\n    var marginLevel = update.AccountInfo.MarginLevel;\n\n    Console.Write($\"Margin Level: {marginLevel:F2}% \");\n\n    if (marginLevel &lt; dangerLevel)\n    {\n        Console.WriteLine(\"\ud83d\udd34 DANGER - STOP OUT RISK!\");\n    }\n    else if (marginLevel &lt; warningLevel)\n    {\n        Console.WriteLine(\"\u26a0 WARNING - Low margin\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u2705 OK\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToPositionProfit/#9-position-count-monitoring","title":"9) Position count monitoring","text":"<pre><code>var maxPositions = 5;\nvar cts = new CancellationTokenSource();\n\nawait foreach (var update in svc.OnPositionProfitAsync(intervalMs: 1000, cts.Token))\n{\n    var positionCount = update.UpdatedPositions.Count + update.NewPositions.Count;\n\n    Console.WriteLine($\"Active positions: {positionCount}/{maxPositions}\");\n\n    if (positionCount &gt;= maxPositions)\n    {\n        Console.WriteLine($\"\u26a0 Maximum position limit ({maxPositions}) reached!\");\n    }\n\n    // Show new positions\n    if (update.NewPositions.Count &gt; 0)\n    {\n        Console.WriteLine($\"  \ud83c\udd95 {update.NewPositions.Count} new position(s) opened\");\n    }\n\n    // Show closed positions\n    if (update.DeletedPositions.Count &gt; 0)\n    {\n        Console.WriteLine($\"  \u2705 {update.DeletedPositions.Count} position(s) closed\");\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/","title":"\u2705 Subscribe to Real-Time Tick Data (<code>OnSymbolTickAsync</code>)","text":"<p>Stream: Real-time price tick updates for specified symbols on MT5. Returns continuous stream of bid/ask prices as they change.</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Service.OnSymbolTickAsync(...)</code> (from class <code>MT5Service</code>)</li> <li>gRPC service: <code>mt5_term_api.SubscriptionService</code></li> <li>Proto definition: <code>OnSymbolTick</code> (defined in <code>mt5-term-api-subscriptions.proto</code>)</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.SubscriptionService</code></li> <li>Method: <code>OnSymbolTick(OnSymbolTickRequest) \u2192 stream OnSymbolTickReply</code></li> <li>Low\u2011level client (generated): <code>SubscriptionService.SubscriptionServiceClient.OnSymbolTick(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper:</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Service\n    {\n        public async IAsyncEnumerable&lt;OnSymbolTickData&gt; OnSymbolTickAsync(\n            string[] symbols,\n            [EnumeratorCancellation] CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OnSymbolTickRequest { symbol_names }</code> Reply message (stream): <code>OnSymbolTickReply { data: OnSymbolTickData }</code></p>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>symbols</code> <code>string[]</code> Array of symbol names (e.g., <code>[\"EURUSD\", \"GBPUSD\"]</code>) <code>cancellationToken</code> <code>CancellationToken</code> Token to stop the stream"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#output-onsymboltickdata-stream","title":"\u2b06\ufe0f Output \u2014 <code>OnSymbolTickData</code> (stream)","text":"Field Type Description <code>SymbolTick</code> <code>MrpcSubscriptionMqlTick</code> Tick data for symbol <code>TerminalInstanceGuidId</code> <code>string</code> Terminal instance ID"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#mrpcsubscriptionmqltick-tick-structure","title":"<code>MrpcSubscriptionMqlTick</code> \u2014 Tick structure","text":"Field Type Description <code>Time</code> <code>Timestamp</code> Time of last price update (UTC timestamp) <code>Bid</code> <code>double</code> Current Bid price <code>Ask</code> <code>double</code> Current Ask price <code>Last</code> <code>double</code> Price of last deal <code>Volume</code> <code>uint64</code> Volume for current Last price <code>TimeMsc</code> <code>int64</code> Time of price update in milliseconds <code>Flags</code> <code>uint32</code> Tick flags <code>VolumeReal</code> <code>double</code> Real volume with greater accuracy <code>Symbol</code> <code>string</code> Symbol name"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Real-time streaming of price ticks. Continuously sends bid/ask updates as prices change on server.</li> <li>Why you need it. Build real-time price monitoring, tick charts, high-frequency strategies, market scanners.</li> <li>Sanity check. Stream runs until cancelled. Use <code>CancellationToken</code> to stop. Handle <code>OperationCanceledException</code> when stopping.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for real-time price monitoring:</p> <ul> <li>Real-time price displays and charts.</li> <li>High-frequency trading strategies.</li> <li>Market scanners monitoring multiple symbols.</li> <li>Price alert systems.</li> <li>Tick-by-tick data collection.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Streaming model: Use <code>await foreach</code> to process events. Stream runs continuously until cancelled.</li> <li>Cancellation: Always use <code>CancellationToken</code> to stop stream gracefully. Call <code>cts.Cancel()</code> or <code>cts.CancelAfter(timeout)</code>.</li> <li>Multiple symbols: Can subscribe to multiple symbols in one stream. Ticks arrive as they happen for any subscribed symbol.</li> <li>Performance: Ticks arrive in real-time. Keep processing logic fast to avoid blocking stream.</li> <li>Error handling: Wrap in try-catch. Handle <code>OperationCanceledException</code> (normal when stopping).</li> <li>Parallel streams: Can run multiple streams in parallel using <code>Task.WhenAll()</code>.</li> <li>Time format: <code>TimeMsc</code> is Unix timestamp in milliseconds. Convert using <code>DateTimeOffset.FromUnixTimeMilliseconds()</code>.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#1-basic-tick-streaming","title":"1) Basic tick streaming","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(10)); // Stop after 10 seconds\n\ntry\n{\n    await foreach (var tick in svc.OnSymbolTickAsync(new[] { \"EURUSD\" }, cts.Token))\n    {\n        var t = tick.SymbolTick;\n        Console.WriteLine($\"{t.Symbol}: Bid={t.Bid:F5} | Ask={t.Ask:F5}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#2-monitor-multiple-symbols","title":"2) Monitor multiple symbols","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\nvar cts = new CancellationTokenSource();\n\nawait foreach (var tick in svc.OnSymbolTickAsync(symbols, cts.Token))\n{\n    var t = tick.SymbolTick;\n    var time = DateTimeOffset.FromUnixTimeMilliseconds(t.TimeMsc).DateTime;\n\n    Console.WriteLine($\"[{time:HH:mm:ss.fff}] {t.Symbol,-7} | Bid: {t.Bid:F5} | Ask: {t.Ask:F5} | Spread: {(t.Ask - t.Bid):F5}\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#3-price-alert-system","title":"3) Price alert system","text":"<pre><code>var symbol = \"XAUUSD\";\nvar alertLevel = 2000.0;\n\nvar cts = new CancellationTokenSource();\n\nawait foreach (var tick in svc.OnSymbolTickAsync(new[] { symbol }, cts.Token))\n{\n    var t = tick.SymbolTick;\n\n    if (t.Bid &gt;= alertLevel)\n    {\n        Console.WriteLine($\"\u26a0 ALERT: {symbol} reached ${alertLevel}!\");\n        Console.WriteLine($\"   Bid: {t.Bid:F2} | Ask: {t.Ask:F2}\");\n\n        // Stop stream after alert\n        cts.Cancel();\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#4-collect-tick-data-with-limit","title":"4) Collect tick data with limit","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\" };\nvar maxTicks = 100;\nvar tickCount = 0;\n\nvar cts = new CancellationTokenSource();\n\nawait foreach (var tick in svc.OnSymbolTickAsync(symbols, cts.Token))\n{\n    tickCount++;\n    var t = tick.SymbolTick;\n\n    Console.WriteLine($\"Tick #{tickCount}: {t.Symbol} @ {t.Bid:F5}\");\n\n    if (tickCount &gt;= maxTicks)\n    {\n        Console.WriteLine($\"Collected {maxTicks} ticks, stopping...\");\n        break; // Exit loop (stream stops automatically)\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#5-calculate-spread-statistics","title":"5) Calculate spread statistics","text":"<pre><code>var symbol = \"EURUSD\";\nvar spreads = new List&lt;double&gt;();\nvar cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(60)); // Collect for 1 minute\n\ntry\n{\n    await foreach (var tick in svc.OnSymbolTickAsync(new[] { symbol }, cts.Token))\n    {\n        var t = tick.SymbolTick;\n        var spread = (t.Ask - t.Bid) * 100000; // Spread in pips (for 5-digit pairs)\n\n        spreads.Add(spread);\n\n        if (spreads.Count % 10 == 0)\n        {\n            var avgSpread = spreads.Average();\n            var minSpread = spreads.Min();\n            var maxSpread = spreads.Max();\n\n            Console.WriteLine($\"Spreads: Avg={avgSpread:F1} | Min={minSpread:F1} | Max={maxSpread:F1} pips\");\n        }\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine($\"\\nFinal statistics ({spreads.Count} ticks):\");\n    Console.WriteLine($\"  Average spread: {spreads.Average():F2} pips\");\n    Console.WriteLine($\"  Min spread: {spreads.Min():F2} pips\");\n    Console.WriteLine($\"  Max spread: {spreads.Max():F2} pips\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#6-run-multiple-streams-in-parallel","title":"6) Run multiple streams in parallel","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(30));\n\n// Task 1: Monitor EURUSD\nvar task1 = Task.Run(async () =&gt;\n{\n    await foreach (var tick in svc.OnSymbolTickAsync(new[] { \"EURUSD\" }, cts.Token))\n    {\n        Console.WriteLine($\"[EUR] {tick.SymbolTick.Bid:F5}\");\n    }\n}, cts.Token);\n\n// Task 2: Monitor GBPUSD\nvar task2 = Task.Run(async () =&gt;\n{\n    await foreach (var tick in svc.OnSymbolTickAsync(new[] { \"GBPUSD\" }, cts.Token))\n    {\n        Console.WriteLine($\"[GBP] {tick.SymbolTick.Bid:F5}\");\n    }\n}, cts.Token);\n\ntry\n{\n    await Task.WhenAll(task1, task2);\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"All streams stopped\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#7-using-readticks-extension-helper-convenience-wrapper","title":"7) Using ReadTicks extension helper (convenience wrapper)","text":"<pre><code>// Extension method with built-in limits\nint maxEvents = 20;\nint durationSec = 5;\n\nawait foreach (var tick in svc.ReadTicks(\n    symbols: new[] { \"EURUSD\", \"GBPUSD\" },\n    maxEvents: maxEvents,\n    durationSec: durationSec))\n{\n    var t = tick.SymbolTick;\n    Console.WriteLine($\"{t.Symbol}: {t.Bid:F5}\");\n\n    // Stream automatically stops after 20 events OR 5 seconds (whichever comes first)\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTicks/#8-tick-based-trading-signal","title":"8) Tick-based trading signal","text":"<pre><code>var symbol = \"EURUSD\";\nvar cts = new CancellationTokenSource();\n\ndouble? previousBid = null;\nint consecutiveUps = 0;\n\nawait foreach (var tick in svc.OnSymbolTickAsync(new[] { symbol }, cts.Token))\n{\n    var t = tick.SymbolTick;\n\n    if (previousBid.HasValue)\n    {\n        if (t.Bid &gt; previousBid)\n        {\n            consecutiveUps++;\n\n            if (consecutiveUps &gt;= 5)\n            {\n                Console.WriteLine($\"\ud83d\udfe2 BUY SIGNAL: {symbol} price increased {consecutiveUps} ticks in a row\");\n                consecutiveUps = 0; // Reset counter\n            }\n        }\n        else\n        {\n            consecutiveUps = 0;\n        }\n    }\n\n    previousBid = t.Bid;\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/","title":"\u2705 Subscribe to Trade Transaction Events (<code>OnTradeTransactionAsync</code>)","text":"<p>Stream: Real-time trade transaction notifications on MT5. Continuously sends events for all trade operations (orders, deals, position changes).</p> <p>API Information:</p> <ul> <li>SDK wrapper: <code>MT5Service.OnTradeTransactionAsync(...)</code> (from class <code>MT5Service</code>)</li> <li>gRPC service: <code>mt5_term_api.SubscriptionService</code></li> <li>Proto definition: <code>OnTradeTransaction</code> (defined in <code>mt5-term-api-subscriptions.proto</code>)</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#rpc","title":"RPC","text":"<ul> <li>Service: <code>mt5_term_api.SubscriptionService</code></li> <li>Method: <code>OnTradeTransaction(OnTradeTransactionRequest) \u2192 stream OnTradeTransactionReply</code></li> <li>Low\u2011level client (generated): <code>SubscriptionService.SubscriptionServiceClient.OnTradeTransaction(request, headers, deadline, cancellationToken)</code></li> <li>SDK wrapper:</li> </ul> <pre><code>namespace mt5_term_api\n{\n    public class MT5Service\n    {\n        public async IAsyncEnumerable&lt;OnTradeTransactionData&gt; OnTradeTransactionAsync(\n            [EnumeratorCancellation] CancellationToken cancellationToken = default);\n    }\n}\n</code></pre> <p>Request message:</p> <p><code>OnTradeTransactionRequest {}</code> (empty)</p> <p>Reply message (stream):</p> <p><code>OnTradeTransactionReply { data: OnTradeTransactionData }</code></p>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>cancellationToken</code> <code>CancellationToken</code> Token to stop the stream"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#output-ontradetransactiondata-stream","title":"\u2b06\ufe0f Output \u2014 <code>OnTradeTransactionData</code> (stream)","text":"Field Type Description <code>Type</code> <code>MT5_SUB_ENUM_EVENT_GROUP_TYPE</code> Event group type <code>TradeTransaction</code> <code>MqlTradeTransaction</code> Transaction details <code>TradeRequest</code> <code>MqlTradeRequest</code> Trade request that triggered transaction <code>TradeResult</code> <code>MqlTradeResult</code> Result of trade request <code>TerminalInstanceGuidId</code> <code>string</code> Terminal instance ID <code>AccountInfo</code> <code>OnEventAccountInfo</code> Current account state"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#mqltradetransaction-transaction-details","title":"<code>MqlTradeTransaction</code> \u2014 Transaction details","text":"Field Type Description <code>DealTicket</code> <code>uint64</code> Deal ticket (if deal was executed) <code>OrderTicket</code> <code>uint64</code> Order ticket <code>Symbol</code> <code>string</code> Symbol name <code>Type</code> <code>SUB_ENUM_TRADE_TRANSACTION_TYPE</code> Transaction type (OrderAdd, DealAdd, etc) <code>OrderType</code> <code>SUB_ENUM_ORDER_TYPE</code> Order type (Buy, Sell, BuyLimit, etc) <code>OrderState</code> <code>SUB_ENUM_ORDER_STATE</code> Order state (Placed, Filled, etc) <code>DealType</code> <code>SUB_ENUM_DEAL_TYPE</code> Deal type (Buy, Sell, etc) <code>OrderTimeType</code> <code>SUB_ENUM_ORDER_TYPE_TIME</code> Order expiration type <code>OrderExpirationTime</code> <code>Timestamp</code> Order expiration time <code>Price</code> <code>double</code> Price <code>PriceTriggerStopLimit</code> <code>double</code> Stop limit activation price <code>PriceStopLoss</code> <code>double</code> Stop Loss level <code>PriceTakeProfit</code> <code>double</code> Take Profit level <code>Volume</code> <code>double</code> Volume in lots <code>PositionTicket</code> <code>uint64</code> Position ticket <code>PositionByOppositePosition</code> <code>uint64</code> Opposite position ticket (for CloseBy)"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#mqltraderequest-request-that-triggered-transaction","title":"<code>MqlTradeRequest</code> \u2014 Request that triggered transaction","text":"Field Type Description <code>TradeOperationType</code> <code>SUB_ENUM_TRADE_REQUEST_ACTIONS</code> Trade operation (Deal, Pending, etc) <code>Magic</code> <code>uint64</code> Expert Advisor ID (magic number) <code>OrderTicket</code> <code>uint64</code> Order ticket <code>Symbol</code> <code>string</code> Symbol name <code>RequestedDealVolumeLots</code> <code>double</code> Requested volume in lots <code>Price</code> <code>double</code> Price <code>StopLimit</code> <code>double</code> StopLimit level <code>StopLoss</code> <code>double</code> Stop Loss level <code>TakeProfit</code> <code>double</code> Take Profit level <code>Deviation</code> <code>uint64</code> Max deviation from requested price <code>OrderType</code> <code>SUB_ENUM_ORDER_TYPE</code> Order type <code>OrderTypeFilling</code> <code>SUB_ENUM_ORDER_TYPE_FILLING</code> Order filling mode <code>TypeTime</code> <code>SUB_ENUM_ORDER_TYPE_TIME</code> Order expiration type <code>OrderExpirationTime</code> <code>Timestamp</code> Order expiration time <code>OrderComment</code> <code>string</code> Order comment <code>PositionTicket</code> <code>uint64</code> Position ticket <code>PositionByOppositePosition</code> <code>uint64</code> Opposite position ticket"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#mqltraderesult-result-of-trade-operation","title":"<code>MqlTradeResult</code> \u2014 Result of trade operation","text":"Field Type Description <code>TradeReturnIntCode</code> <code>uint32</code> Return code (10009 = success) <code>TradeReturnCode</code> <code>MqlErrorTradeCode</code> Error code enum <code>DealTicket</code> <code>uint64</code> Deal ticket (if executed) <code>OrderTicket</code> <code>uint64</code> Order ticket (if placed) <code>DealVolume</code> <code>double</code> Deal volume confirmed by broker <code>DealPrice</code> <code>double</code> Deal price confirmed by broker <code>CurrentBid</code> <code>double</code> Current Bid price <code>CurrentAsk</code> <code>double</code> Current Ask price <code>BrokerCommentToOperation</code> <code>string</code> Broker comment <code>TerminalDispatchRequestId</code> <code>uint32</code> Request ID from terminal <code>ReturnCodeExternal</code> <code>int32</code> External system return code"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#oneventaccountinfo-account-state-snapshot","title":"<code>OnEventAccountInfo</code> \u2014 Account state snapshot","text":"Field Type Description <code>Balance</code> <code>double</code> Account balance <code>Credit</code> <code>double</code> Account credit <code>Equity</code> <code>double</code> Account equity <code>Margin</code> <code>double</code> Used margin <code>FreeMargin</code> <code>double</code> Free margin <code>Profit</code> <code>double</code> Current profit <code>MarginLevel</code> <code>double</code> Margin level (%) <code>Login</code> <code>int64</code> Account login"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#related-enums-from-proto","title":"\ud83e\uddf1 Related enums (from proto)","text":""},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#sub_enum_trade_transaction_type","title":"<code>SUB_ENUM_TRADE_TRANSACTION_TYPE</code>","text":"<ul> <li><code>SubTradeTransactionOrderAdd</code> \u2014 Adding new order</li> <li><code>SubTradeTransactionOrderUpdate</code> \u2014 Updating order</li> <li><code>SubTradeTransactionOrderDelete</code> \u2014 Removing order</li> <li><code>SubTradeTransactionDealAdd</code> \u2014 Adding deal to history</li> <li><code>SubTradeTransactionDealUpdate</code> \u2014 Updating deal in history</li> <li><code>SubTradeTransactionDealDelete</code> \u2014 Deleting deal from history</li> <li><code>SubTradeTransactionHistoryAdd</code> \u2014 Adding order to history</li> <li><code>SubTradeTransactionHistoryUpdate</code> \u2014 Changing order in history</li> <li><code>SubTradeTransactionHistoryDelete</code> \u2014 Deleting order from history</li> <li><code>SubTradeTransactionPosition</code> \u2014 Position change (not from deal)</li> <li><code>SubTradeTransactionRequest</code> \u2014 Trade request processed notification</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#sub_enum_trade_request_actions","title":"<code>SUB_ENUM_TRADE_REQUEST_ACTIONS</code>","text":"<ul> <li><code>SubTradeActionUndefined</code> \u2014 Undefined</li> <li><code>SubTradeActionDeal</code> \u2014 Market order execution</li> <li><code>SubTradeActionPending</code> \u2014 Place pending order</li> <li><code>SubTradeActionSltp</code> \u2014 Modify SL/TP</li> <li><code>SubTradeActionModify</code> \u2014 Modify order parameters</li> <li><code>SubTradeActionRemove</code> \u2014 Remove pending order</li> <li><code>SubTradeActionCloseBy</code> \u2014 Close position by opposite</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#mt5_sub_enum_event_group_type","title":"<code>MT5_SUB_ENUM_EVENT_GROUP_TYPE</code>","text":"<ul> <li><code>OrderProfit</code> \u2014 Position profit event</li> <li><code>OrderUpdate</code> \u2014 Order update event</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Real-time notifications for all trade operations. Tracks complete order lifecycle from placement to execution/cancellation.</li> <li>Why you need it. Monitor order execution in real-time, track trade history as it happens, build event-driven trading systems.</li> <li>Sanity check. Stream runs continuously. Check <code>Type</code> field to determine transaction type. Use <code>TradeResult.TradeReturnIntCode</code> to verify success (10009).</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for real-time trade monitoring:</p> <ul> <li>Track order execution in real-time.</li> <li>Monitor complete order lifecycle.</li> <li>Build event-driven trading strategies.</li> <li>Log all trade operations.</li> <li>React to trade events immediately.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Comprehensive events: Receives ALL trade events (orders, deals, position changes). Filter by <code>Type</code> to process only needed events.</li> <li>Transaction types: Most common: <code>OrderAdd</code> (new order), <code>DealAdd</code> (order filled), <code>HistoryAdd</code> (order moved to history).</li> <li>Return codes: Check <code>TradeResult.TradeReturnIntCode</code>. 10009 = success, other codes = errors.</li> <li>Account snapshot: Each event includes current account state (<code>AccountInfo</code>). Useful for margin monitoring.</li> <li>Request details: <code>TradeRequest</code> shows what was requested. <code>TradeResult</code> shows what actually happened.</li> <li>Performance: Events arrive frequently during active trading. Keep processing logic fast.</li> <li>Error handling: Wrap in try-catch. Handle <code>OperationCanceledException</code> when stopping.</li> </ul>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#1-basic-transaction-monitoring","title":"1) Basic transaction monitoring","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar cts = new CancellationTokenSource();\n\ntry\n{\n    await foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n    {\n        Console.WriteLine($\"Transaction type: {tx.TradeTransaction.Type}\");\n        Console.WriteLine($\"  Symbol: {tx.TradeTransaction.Symbol}\");\n        Console.WriteLine($\"  Order: {tx.TradeTransaction.OrderTicket}\");\n        Console.WriteLine($\"  State: {tx.TradeTransaction.OrderState}\");\n        Console.WriteLine();\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream stopped\");\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#2-monitor-order-fills-only","title":"2) Monitor order fills only","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    // Filter for deal additions (order fills)\n    if (tx.TradeTransaction.Type == SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionDealAdd)\n    {\n        var t = tx.TradeTransaction;\n        Console.WriteLine($\"\u2713 Order filled:\");\n        Console.WriteLine($\"  Deal #{t.DealTicket}\");\n        Console.WriteLine($\"  Symbol: {t.Symbol}\");\n        Console.WriteLine($\"  Type: {t.DealType}\");\n        Console.WriteLine($\"  Volume: {t.Volume} lots\");\n        Console.WriteLine($\"  Price: {t.Price}\");\n        Console.WriteLine();\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#3-track-order-lifecycle","title":"3) Track order lifecycle","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    var t = tx.TradeTransaction;\n\n    switch (t.Type)\n    {\n        case SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionOrderAdd:\n            Console.WriteLine($\"\ud83c\udd95 New order #{t.OrderTicket} placed for {t.Symbol}\");\n            break;\n\n        case SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionOrderUpdate:\n            Console.WriteLine($\"\ud83d\udd04 Order #{t.OrderTicket} updated: {t.OrderState}\");\n            break;\n\n        case SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionDealAdd:\n            Console.WriteLine($\"\u2705 Order #{t.OrderTicket} filled: {t.Volume} lots @ {t.Price}\");\n            break;\n\n        case SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionOrderDelete:\n            Console.WriteLine($\"\u274c Order #{t.OrderTicket} cancelled/removed\");\n            break;\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#4-monitor-account-state-on-each-trade","title":"4) Monitor account state on each trade","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    // Only process deal executions\n    if (tx.TradeTransaction.Type == SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionDealAdd)\n    {\n        var acc = tx.AccountInfo;\n\n        Console.WriteLine($\"Trade executed:\");\n        Console.WriteLine($\"  Balance: ${acc.Balance:F2}\");\n        Console.WriteLine($\"  Equity: ${acc.Equity:F2}\");\n        Console.WriteLine($\"  Margin: ${acc.Margin:F2}\");\n        Console.WriteLine($\"  Free Margin: ${acc.FreeMargin:F2}\");\n        Console.WriteLine($\"  Margin Level: {acc.MarginLevel:F2}%\");\n        Console.WriteLine($\"  Profit: ${acc.Profit:F2}\");\n        Console.WriteLine();\n\n        // Alert if margin level low\n        if (acc.MarginLevel &lt; 100)\n        {\n            Console.WriteLine($\"\u26a0 WARNING: Low margin level ({acc.MarginLevel:F2}%)!\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#5-log-all-trade-operations","title":"5) Log all trade operations","text":"<pre><code>var cts = new CancellationTokenSource();\nvar logFile = \"trade_log.txt\";\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    var t = tx.TradeTransaction;\n    var timestamp = DateTime.UtcNow;\n\n    var logEntry = $\"[{timestamp:yyyy-MM-dd HH:mm:ss}] \" +\n                   $\"Type: {t.Type} | \" +\n                   $\"Symbol: {t.Symbol} | \" +\n                   $\"Order: {t.OrderTicket} | \" +\n                   $\"State: {t.OrderState} | \" +\n                   $\"Volume: {t.Volume}\";\n\n    File.AppendAllText(logFile, logEntry + Environment.NewLine);\n    Console.WriteLine(logEntry);\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#6-check-trade-request-results","title":"6) Check trade request results","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    // Process request completion events\n    if (tx.TradeTransaction.Type == SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionRequest)\n    {\n        var result = tx.TradeResult;\n        var request = tx.TradeRequest;\n\n        if (result.TradeReturnIntCode == 10009)\n        {\n            Console.WriteLine($\"\u2713 Trade request successful:\");\n            Console.WriteLine($\"  Operation: {request.TradeOperationType}\");\n            Console.WriteLine($\"  Symbol: {request.Symbol}\");\n            Console.WriteLine($\"  Order: #{result.OrderTicket}\");\n            if (result.DealTicket &gt; 0)\n            {\n                Console.WriteLine($\"  Deal: #{result.DealTicket}\");\n                Console.WriteLine($\"  Fill price: {result.DealPrice}\");\n            }\n        }\n        else\n        {\n            Console.WriteLine($\"\u2717 Trade request failed:\");\n            Console.WriteLine($\"  Code: {result.TradeReturnIntCode}\");\n            Console.WriteLine($\"  Comment: {result.BrokerCommentToOperation}\");\n        }\n        Console.WriteLine();\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#7-position-change-notifications","title":"7) Position change notifications","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    // Monitor position changes\n    if (tx.TradeTransaction.Type == SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionPosition)\n    {\n        var t = tx.TradeTransaction;\n\n        Console.WriteLine($\"\ud83d\udcca Position changed:\");\n        Console.WriteLine($\"  Position: #{t.PositionTicket}\");\n        Console.WriteLine($\"  Symbol: {t.Symbol}\");\n        Console.WriteLine($\"  Volume: {t.Volume}\");\n        Console.WriteLine($\"  SL: {t.PriceStopLoss}\");\n        Console.WriteLine($\"  TP: {t.PriceTakeProfit}\");\n        Console.WriteLine();\n    }\n}\n</code></pre>"},{"location":"MT5Account/7.%20Streaming_Methods/SubscribeToTradeTransaction/#8-stop-loss-take-profit-hit-detection","title":"8) Stop-loss / Take-profit hit detection","text":"<pre><code>var cts = new CancellationTokenSource();\n\nawait foreach (var tx in svc.OnTradeTransactionAsync(cts.Token))\n{\n    if (tx.TradeTransaction.Type == SUB_ENUM_TRADE_TRANSACTION_TYPE.SubTradeTransactionDealAdd)\n    {\n        var dealType = tx.TradeTransaction.DealType;\n\n        // Check if position was closed by SL/TP\n        if (dealType == SUB_ENUM_DEAL_TYPE.SubDealTypeBuy ||\n            dealType == SUB_ENUM_DEAL_TYPE.SubDealTypeSell)\n        {\n            var t = tx.TradeTransaction;\n\n            Console.WriteLine($\"Position closed:\");\n            Console.WriteLine($\"  Symbol: {t.Symbol}\");\n            Console.WriteLine($\"  Exit price: {t.Price}\");\n\n            // Check if it was SL or TP hit (would need additional context to determine)\n            if (tx.AccountInfo.Profit &lt; 0)\n            {\n                Console.WriteLine($\"  \u274c Loss: ${tx.AccountInfo.Profit:F2} (likely SL hit)\");\n            }\n            else\n            {\n                Console.WriteLine($\"  \u2705 Profit: ${tx.AccountInfo.Profit:F2} (likely TP hit)\");\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Service/Account_Convenience_Methods/","title":"MT5Service - Account Convenience Methods","text":"<p>10 convenient methods for quick access to account properties without <code>.Value</code> unwrapping</p>"},{"location":"MT5Service/Account_Convenience_Methods/#why-these-methods-exist","title":"\ud83c\udfaf Why These Methods Exist","text":"<p>Problem: In MT5Account, every call returns a <code>Data</code> object that needs unwrapping: <pre><code>var data = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountBalance);\ndouble balance = data.Value;  // \u2190 unwrapping required!\n</code></pre></p> <p>Solution: MT5Service provides direct methods that return values immediately: <pre><code>double balance = await service.GetBalanceAsync();  // \u2705 ready!\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 Less code (1 line instead of 2)</li> <li>\u2705 No <code>.Value</code> ceremony</li> <li>\u2705 Readable method names (<code>GetBalance</code> vs <code>AccountInfoDouble(BALANCE)</code>)</li> <li>\u2705 Fewer errors (can't forget <code>.Value</code>)</li> </ul>"},{"location":"MT5Service/Account_Convenience_Methods/#all-10-methods","title":"\ud83d\udccb All 10 Methods","text":"Method Returns Low-Level Equivalent <code>GetBalanceAsync()</code> Account balance <code>AccountInfoDoubleAsync(AccountBalance)</code> <code>GetEquityAsync()</code> Equity (balance + floating P/L) <code>AccountInfoDoubleAsync(AccountEquity)</code> <code>GetMarginAsync()</code> Used margin <code>AccountInfoDoubleAsync(AccountMargin)</code> <code>GetFreeMarginAsync()</code> Free margin <code>AccountInfoDoubleAsync(AccountMarginFree)</code> <code>GetProfitAsync()</code> Current floating profit/loss <code>AccountInfoDoubleAsync(AccountProfit)</code> <code>GetLoginAsync()</code> Account number (login) <code>AccountInfoIntegerAsync(AccountLogin)</code> <code>GetLeverageAsync()</code> Leverage ratio <code>AccountInfoIntegerAsync(AccountLeverage)</code> <code>GetAccountNameAsync()</code> Account owner name <code>AccountInfoStringAsync(AccountName)</code> <code>GetServerNameAsync()</code> MT5 server name <code>AccountInfoStringAsync(AccountServer)</code> <code>GetCurrencyAsync()</code> Account currency <code>AccountInfoStringAsync(AccountCurrency)</code>"},{"location":"MT5Service/Account_Convenience_Methods/#usage-examples","title":"\ud83d\udca1 Usage Examples","text":""},{"location":"MT5Service/Account_Convenience_Methods/#example-1-checking-balance-and-equity","title":"Example 1: Checking Balance and Equity","text":"<pre><code>// \u274c BEFORE (MT5Account) - 4 lines:\nvar balanceData = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountBalance);\ndouble balance = balanceData.Value;\nvar equityData = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountEquity);\ndouble equity = equityData.Value;\n\n// \u2705 AFTER (MT5Service) - 2 lines:\ndouble balance = await service.GetBalanceAsync();\ndouble equity = await service.GetEquityAsync();\n\nConsole.WriteLine($\"Balance: ${balance:F2}, Equity: ${equity:F2}\");\n</code></pre>"},{"location":"MT5Service/Account_Convenience_Methods/#example-2-calculating-margin-level","title":"Example 2: Calculating Margin Level","text":"<pre><code>// \u274c BEFORE (MT5Account) - 6 lines with unwrapping:\nvar equityData = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountEquity);\ndouble equity = equityData.Value;\nvar marginData = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountMargin);\ndouble margin = marginData.Value;\ndouble marginLevel = (margin &gt; 0) ? (equity / margin * 100) : 0;\nConsole.WriteLine($\"Margin Level: {marginLevel:F2}%\");\n\n// \u2705 AFTER (MT5Service) - 3 lines, no ceremony:\ndouble equity = await service.GetEquityAsync();\ndouble margin = await service.GetMarginAsync();\ndouble marginLevel = (margin &gt; 0) ? (equity / margin * 100) : 0;\nConsole.WriteLine($\"Margin Level: {marginLevel:F2}%\");\n</code></pre> <p>Code reduction: 50% (6 lines \u2192 3 lines)</p>"},{"location":"MT5Service/Account_Convenience_Methods/#example-3-checking-free-margin-before-opening-position","title":"Example 3: Checking Free Margin Before Opening Position","text":"<pre><code>// \u274c BEFORE (MT5Account):\nvar freeMarginData = await account.AccountInfoDoubleAsync(\n    AccountInfoDoublePropertyType.AccountMarginFree);\ndouble freeMargin = freeMarginData.Value;\n\nif (freeMargin &gt;= 100.0)\n{\n    // Can open position\n}\n\n// \u2705 AFTER (MT5Service):\ndouble freeMargin = await service.GetFreeMarginAsync();\n\nif (freeMargin &gt;= 100.0)\n{\n    // Can open position\n}\n</code></pre> <p>Readability: Intent is clear from the first line!</p>"},{"location":"MT5Service/Account_Convenience_Methods/#example-4-displaying-account-information","title":"Example 4: Displaying Account Information","text":"<pre><code>// \u274c BEFORE (MT5Account) - 12 lines:\nvar loginData = await account.AccountInfoIntegerAsync(AccountInfoIntegerPropertyType.AccountLogin);\nlong login = loginData.Value;\nvar nameData = await account.AccountInfoStringAsync(AccountInfoStringPropertyType.AccountName);\nstring name = nameData.Value;\nvar serverData = await account.AccountInfoStringAsync(AccountInfoStringPropertyType.AccountServer);\nstring server = serverData.Value;\nvar currencyData = await account.AccountInfoStringAsync(AccountInfoStringPropertyType.AccountCurrency);\nstring currency = currencyData.Value;\nvar leverageData = await account.AccountInfoIntegerAsync(AccountInfoIntegerPropertyType.AccountLeverage);\nlong leverage = leverageData.Value;\n\nConsole.WriteLine($\"Account: {login} ({name})\");\nConsole.WriteLine($\"Server: {server}, Currency: {currency}, Leverage: 1:{leverage}\");\n\n// \u2705 AFTER (MT5Service) - 6 lines:\nlong login = await service.GetLoginAsync();\nstring name = await service.GetAccountNameAsync();\nstring server = await service.GetServerNameAsync();\nstring currency = await service.GetCurrencyAsync();\nlong leverage = await service.GetLeverageAsync();\n\nConsole.WriteLine($\"Account: {login} ({name})\");\nConsole.WriteLine($\"Server: {server}, Currency: {currency}, Leverage: 1:{leverage}\");\n</code></pre> <p>Code reduction: 50% (12 lines \u2192 6 lines)</p>"},{"location":"MT5Service/Account_Convenience_Methods/#example-5-monitoring-current-profit","title":"Example 5: Monitoring Current Profit","text":"<pre><code>// \u274c BEFORE (MT5Account):\nvar profitData = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountProfit);\ndouble profit = profitData.Value;\n\nif (profit &gt; 0)\n    Console.WriteLine($\"\u2705 Profit: +${profit:F2}\");\nelse\n    Console.WriteLine($\"\u274c Loss: ${profit:F2}\");\n\n// \u2705 AFTER (MT5Service):\ndouble profit = await service.GetProfitAsync();\n\nif (profit &gt; 0)\n    Console.WriteLine($\"\u2705 Profit: +${profit:F2}\");\nelse\n    Console.WriteLine($\"\u274c Loss: ${profit:F2}\");\n</code></pre> <p>Clean: One line for data retrieval, rest is business logic.</p>"},{"location":"MT5Service/Account_Convenience_Methods/#example-6-parallel-retrieval-of-all-account-metrics","title":"Example 6: Parallel Retrieval of All Account Metrics","text":"<pre><code>// \u2705 All methods are async - can run in parallel!\nvar balanceTask = service.GetBalanceAsync();\nvar equityTask = service.GetEquityAsync();\nvar marginTask = service.GetMarginAsync();\nvar freeMarginTask = service.GetFreeMarginAsync();\nvar profitTask = service.GetProfitAsync();\n\nawait Task.WhenAll(balanceTask, equityTask, marginTask, freeMarginTask, profitTask);\n\nConsole.WriteLine($\"Balance:      ${balanceTask.Result:F2}\");\nConsole.WriteLine($\"Equity:       ${equityTask.Result:F2}\");\nConsole.WriteLine($\"Margin:       ${marginTask.Result:F2}\");\nConsole.WriteLine($\"Free Margin:  ${freeMarginTask.Result:F2}\");\nConsole.WriteLine($\"Profit:       ${profitTask.Result:F2}\");\n</code></pre> <p>Performance: All requests execute concurrently!</p>"},{"location":"MT5Service/Account_Convenience_Methods/#example-7-validating-account-before-trading","title":"Example 7: Validating Account Before Trading","text":"<pre><code>// Check essential account parameters\nvar leverage = await service.GetLeverageAsync();\nvar currency = await service.GetCurrencyAsync();\nvar freeMargin = await service.GetFreeMarginAsync();\n\nif (leverage &lt; 100)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Warning: Low leverage, large margin required!\");\n}\n\nif (currency != \"USD\")\n{\n    Console.WriteLine($\"\u2139\ufe0f Account currency: {currency} (not USD)\");\n}\n\nif (freeMargin &lt; 500.0)\n{\n    Console.WriteLine(\"\u274c Not enough free margin to trade!\");\n    return;\n}\n\nConsole.WriteLine(\"\u2705 Account ready for trading!\");\n</code></pre>"},{"location":"MT5Service/Account_Convenience_Methods/#key-benefits","title":"\ud83d\udd11 Key Benefits","text":"Aspect MT5Account (Low-Level) MT5Service (Convenience) Code 2 lines per value 1 line per value Readability <code>AccountInfoDoubleAsync(AccountBalance)</code> <code>GetBalanceAsync()</code> Unwrapping Always need <code>.Value</code> \u274c Not needed Errors Can forget <code>.Value</code> \u2705 Impossible Write Speed Slower \u2705 Faster Maintenance Harder \u2705 Easier"},{"location":"MT5Service/Account_Convenience_Methods/#code-reduction-statistics","title":"\ud83d\udcca Code Reduction Statistics","text":"Task Lines (MT5Account) Lines (MT5Service) Reduction Get 1 value 2 1 50% Get 5 values 10 5 50% Display account info 12 6 50% Calculate margin level 6 3 50% <p>Average reduction: 50% for account operations!</p>"},{"location":"MT5Service/Account_Convenience_Methods/#when-to-use","title":"\ud83c\udf93 When to Use","text":""},{"location":"MT5Service/Account_Convenience_Methods/#use-mt5service-when","title":"\u2705 Use MT5Service when:","text":"<ul> <li>Need to quickly get account property value</li> <li>Writing trading bot or strategy</li> <li>Development speed matters</li> <li>Want clean, readable code</li> </ul>"},{"location":"MT5Service/Account_Convenience_Methods/#use-mt5account-when","title":"\u26a0\ufe0f Use MT5Account when:","text":"<ul> <li>Need exotic properties (no convenience method available)</li> <li>Require full control over low-level API</li> <li>Building custom wrapper on top of MT5Account</li> </ul>"},{"location":"MT5Service/Account_Convenience_Methods/#see-also","title":"\ud83d\udd17 See Also","text":"<ul> <li>MT5Service Overview - Complete description of MT5Service improvements</li> <li>Symbol Convenience Methods - Convenient methods for symbols</li> <li>Trading Convenience Methods - Simplified trading methods</li> <li>MT5Account - Low-level API reference</li> </ul>"},{"location":"MT5Service/Account_Convenience_Methods/#summary","title":"\ud83d\udca1 Summary","text":"<p>10 methods that make account operations 2x faster and 2x cleaner. No ceremony, no <code>.Value</code> - just what you need!</p> <pre><code>// It's simple:\nvar balance = await service.GetBalanceAsync();\nvar equity = await service.GetEquityAsync();\nvar profit = await service.GetProfitAsync();\n\nConsole.WriteLine($\"Balance: ${balance:F2}, Equity: ${equity:F2}, P/L: ${profit:F2}\");\n</code></pre> <p>Write less, do more! \ud83d\ude80</p>"},{"location":"MT5Service/History_Convenience_Methods/","title":"MT5Service - History Convenience Methods","text":"<p>3 simplified history methods with sensible defaults for common scenarios</p>"},{"location":"MT5Service/History_Convenience_Methods/#why-these-methods-exist","title":"\ud83c\udfaf Why These Methods Exist","text":"<p>Problem: Getting order history in MT5Account requires many parameters: <pre><code>var history = await account.OrderHistoryAsync(\n    from: DateTime.UtcNow.AddDays(-7),\n    to: DateTime.UtcNow,\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc,\n    pageNumber: 0,\n    itemsPerPage: 100,\n    deadline: null,\n    cancellationToken: default);\n</code></pre> 7 parameters just to get last week's orders!</p> <p>Solution: MT5Service provides simplified methods with defaults: <pre><code>var history = await service.GetRecentOrdersAsync(days: 7);\nvar today = await service.GetTodayOrdersAsync();\n</code></pre></p> <p>Simple, clear intent!</p> <p>Benefits:</p> <ul> <li>\u2705 Sensible defaults (no need to specify every parameter)</li> <li>\u2705 Clear method names (<code>GetTodayOrders</code> vs manual date calculation)</li> <li>\u2705 Less code for common scenarios</li> <li>\u2705 Built-in boolean check for trading permissions</li> </ul>"},{"location":"MT5Service/History_Convenience_Methods/#all-3-history-methods","title":"\ud83d\udccb All 3 History Methods","text":"Method What It Does Default Parameters <code>GetRecentOrdersAsync(days, limit)</code> Get orders from last N days 7 days, 100 orders, sorted by close time desc <code>GetTodayOrdersAsync()</code> Get today's orders only 1 day, 1000 orders, sorted by close time desc <code>IsTradingAllowedAsync()</code> Check if trading is enabled Returns bool (1 = allowed)"},{"location":"MT5Service/History_Convenience_Methods/#usage-examples","title":"\ud83d\udca1 Usage Examples","text":""},{"location":"MT5Service/History_Convenience_Methods/#example-1-get-recent-orders-last-7-days","title":"Example 1: Get Recent Orders (Last 7 Days)","text":"<pre><code>// \u274c BEFORE (MT5Account) - 7 parameters:\nvar history = await account.OrderHistoryAsync(\n    from: DateTime.UtcNow.AddDays(-7),\n    to: DateTime.UtcNow,\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc,\n    pageNumber: 0,\n    itemsPerPage: 100,\n    deadline: null,\n    cancellationToken: default);\n\n// \u2705 AFTER (MT5Service) - 1 parameter:\nvar history = await service.GetRecentOrdersAsync(days: 7);\n\n// Display results\nforeach (var order in history.ClosedOrders)\n{\n    Console.WriteLine($\"[{order.TimeClose.ToDateTime():yyyy-MM-dd HH:mm:ss}] \" +\n                      $\"{order.OrderSymbol} {order.OrderType} \" +\n                      $\"Vol: {order.OrderVolumeCurrent} \" +\n                      $\"P/L: ${order.Profit:F2}\");\n}\n</code></pre> <p>Code reduction: 86% (7 parameters \u2192 1 parameter)</p>"},{"location":"MT5Service/History_Convenience_Methods/#example-2-get-todays-orders","title":"Example 2: Get Today's Orders","text":"<pre><code>// \u274c BEFORE (MT5Account):\nvar history = await account.OrderHistoryAsync(\n    from: DateTime.UtcNow.Date,                // Start of today (UTC)\n    to: DateTime.UtcNow,                       // Now\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc,\n    pageNumber: 0,\n    itemsPerPage: 1000,\n    deadline: null,\n    cancellationToken: default);\n\n// \u2705 AFTER (MT5Service):\nvar history = await service.GetTodayOrdersAsync();\n\nConsole.WriteLine($\"Today's orders: {history.ClosedOrders.Count}\");\n</code></pre> <p>Readability: Intent is crystal clear!</p>"},{"location":"MT5Service/History_Convenience_Methods/#example-3-custom-date-range-still-available","title":"Example 3: Custom Date Range (Still Available!)","text":"<pre><code>// You can still customize if needed:\nvar lastMonth = await service.GetRecentOrdersAsync(days: 30, limit: 500);\nvar lastWeek = await service.GetRecentOrdersAsync(days: 7, limit: 100);\nvar yesterday = await service.GetRecentOrdersAsync(days: 1, limit: 50);\n\nConsole.WriteLine($\"Last month: {lastMonth.ClosedOrders.Count} orders\");\nConsole.WriteLine($\"Last week:  {lastWeek.ClosedOrders.Count} orders\");\nConsole.WriteLine($\"Yesterday:  {yesterday.ClosedOrders.Count} orders\");\n</code></pre> <p>Flexibility: Defaults work for 90% of cases, but customizable when needed!</p>"},{"location":"MT5Service/History_Convenience_Methods/#example-4-checking-trading-permissions","title":"Example 4: Checking Trading Permissions","text":"<pre><code>// \u274c BEFORE (MT5Account) - unwrapping + comparison:\nvar allowedData = await account.AccountInfoIntegerAsync(\n    AccountInfoIntegerPropertyType.AccountTradeAllowed);\nbool tradingAllowed = allowedData.Value == 1;\n\nif (!tradingAllowed)\n{\n    Console.WriteLine(\"\u274c Trading not allowed on this account!\");\n    return;\n}\n\n// \u2705 AFTER (MT5Service) - direct boolean:\nbool tradingAllowed = await service.IsTradingAllowedAsync();\n\nif (!tradingAllowed)\n{\n    Console.WriteLine(\"\u274c Trading not allowed on this account!\");\n    return;\n}\n\nConsole.WriteLine(\"\u2705 Trading is enabled\");\n</code></pre> <p>Simplicity: Boolean check, no unwrapping, no comparison!</p>"},{"location":"MT5Service/History_Convenience_Methods/#example-5-daily-trading-report","title":"Example 5: Daily Trading Report","text":"<pre><code>// Generate report of today's trading activity\nvar today = await service.GetTodayOrdersAsync();\n\ndouble totalProfit = 0;\nint winningTrades = 0;\nint losingTrades = 0;\n\nforeach (var order in today.ClosedOrders)\n{\n    totalProfit += order.Profit;\n\n    if (order.Profit &gt; 0)\n        winningTrades++;\n    else if (order.Profit &lt; 0)\n        losingTrades++;\n}\n\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\nConsole.WriteLine(\"       Today's Trading Report      \");\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\nConsole.WriteLine($\"Total Trades:    {today.ClosedOrders.Count}\");\nConsole.WriteLine($\"Winning Trades:  {winningTrades}\");\nConsole.WriteLine($\"Losing Trades:   {losingTrades}\");\nConsole.WriteLine($\"Win Rate:        {(double)winningTrades / today.ClosedOrders.Count * 100:F1}%\");\nConsole.WriteLine($\"Total P/L:       ${totalProfit:F2}\");\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#example-6-recent-performance-analysis","title":"Example 6: Recent Performance Analysis","text":"<pre><code>// Analyze last 7 days performance by symbol\nvar recent = await service.GetRecentOrdersAsync(days: 7);\n\nvar symbolStats = recent.ClosedOrders\n    .GroupBy(o =&gt; o.OrderSymbol)\n    .Select(g =&gt; new\n    {\n        Symbol = g.Key,\n        Trades = g.Count(),\n        TotalProfit = g.Sum(o =&gt; o.Profit),\n        AvgProfit = g.Average(o =&gt; o.Profit),\n        WinRate = g.Count(o =&gt; o.Profit &gt; 0) / (double)g.Count() * 100\n    })\n    .OrderByDescending(s =&gt; s.TotalProfit);\n\nConsole.WriteLine(\"Last 7 Days - Performance by Symbol:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\nforeach (var stat in symbolStats)\n{\n    Console.WriteLine($\"{stat.Symbol,-10} \" +\n                      $\"Trades: {stat.Trades,3} \" +\n                      $\"P/L: ${stat.TotalProfit,8:F2} \" +\n                      $\"Avg: ${stat.AvgProfit,7:F2} \" +\n                      $\"Win%: {stat.WinRate,5:F1}%\");\n}\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#example-7-pre-trade-check-combined-with-other-methods","title":"Example 7: Pre-Trade Check (Combined with Other Methods)","text":"<pre><code>// Complete pre-trade validation\npublic async Task&lt;bool&gt; CanTradeAsync()\n{\n    // 1. Check trading is enabled\n    bool tradingAllowed = await service.IsTradingAllowedAsync();\n    if (!tradingAllowed)\n    {\n        Console.WriteLine(\"\u274c Trading not allowed on account\");\n        return false;\n    }\n\n    // 2. Check account has free margin\n    double freeMargin = await service.GetFreeMarginAsync();\n    if (freeMargin &lt; 100.0)\n    {\n        Console.WriteLine($\"\u274c Insufficient free margin: ${freeMargin:F2}\");\n        return false;\n    }\n\n    // 3. Check daily loss limit\n    var today = await service.GetTodayOrdersAsync();\n    double todayProfit = today.ClosedOrders.Sum(o =&gt; o.Profit);\n    if (todayProfit &lt; -500.0)\n    {\n        Console.WriteLine($\"\u274c Daily loss limit reached: ${todayProfit:F2}\");\n        return false;\n    }\n\n    // 4. Check daily trade limit\n    if (today.ClosedOrders.Count &gt;= 50)\n    {\n        Console.WriteLine($\"\u274c Daily trade limit reached: {today.ClosedOrders.Count}\");\n        return false;\n    }\n\n    Console.WriteLine(\"\u2705 All checks passed, ready to trade!\");\n    return true;\n}\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#example-8-export-recent-orders-to-csv","title":"Example 8: Export Recent Orders to CSV","text":"<pre><code>// Export last 30 days to CSV file\nvar history = await service.GetRecentOrdersAsync(days: 30, limit: 1000);\n\nusing (var writer = new StreamWriter(\"trading_history.csv\"))\n{\n    // Header\n    writer.WriteLine(\"CloseTime,Symbol,Type,Volume,OpenPrice,ClosePrice,Profit,Comment\");\n\n    // Data rows\n    foreach (var order in history.ClosedOrders)\n    {\n        writer.WriteLine($\"{order.TimeClose.ToDateTime():yyyy-MM-dd HH:mm:ss},\" +\n                         $\"{order.OrderSymbol},\" +\n                         $\"{order.OrderType},\" +\n                         $\"{order.OrderVolumeCurrent},\" +\n                         $\"{order.PriceOpen},\" +\n                         $\"{order.PriceCurrent},\" +\n                         $\"{order.Profit},\" +\n                         $\"\\\"{order.OrderComment}\\\"\");\n    }\n}\n\nConsole.WriteLine($\"\u2705 Exported {history.ClosedOrders.Count} orders to trading_history.csv\");\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#key-benefits","title":"\ud83d\udd11 Key Benefits","text":"Aspect MT5Account (Low-Level) MT5Service (Convenience) Parameters 7 required parameters 0-2 parameters with defaults Date calculation Manual <code>DateTime.UtcNow.AddDays(-7)</code> Built-in <code>days: 7</code> Sort mode Must specify enum \u2705 Sensible default (close time desc) Page size Must specify \u2705 Sensible default (100/1000) Intent <code>OrderHistoryAsync(from, to, ...)</code> <code>GetTodayOrdersAsync()</code> Trading check Integer unwrap + compare \u2705 Direct boolean"},{"location":"MT5Service/History_Convenience_Methods/#method-signatures","title":"\ud83d\udcca Method Signatures","text":"<pre><code>// Get recent orders\nTask&lt;OrdersHistoryData&gt; GetRecentOrdersAsync(\n    int days = 7,                         // Default: last 7 days\n    int limit = 100,                      // Default: 100 orders\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default)\n\n// Get today's orders\nTask&lt;OrdersHistoryData&gt; GetTodayOrdersAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default)\n\n// Check trading permission\nTask&lt;bool&gt; IsTradingAllowedAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default)\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#code-reduction-statistics","title":"\ud83d\udcca Code Reduction Statistics","text":"Task Lines (MT5Account) Lines (MT5Service) Reduction Get last 7 days 7 parameters 1 parameter 86% Get today's orders 7 parameters 0 parameters 100% Check trading allowed 3 lines 1 line 67% <p>Average reduction: 84% for history operations!</p>"},{"location":"MT5Service/History_Convenience_Methods/#when-to-use","title":"\ud83c\udf93 When to Use","text":""},{"location":"MT5Service/History_Convenience_Methods/#use-mt5service-when","title":"\u2705 Use MT5Service when:","text":"<ul> <li>Need recent history (last N days)</li> <li>Want today's orders specifically</li> <li>Checking if trading is enabled</li> <li>Building reports/analytics</li> <li>Common scenarios (90% of cases)</li> </ul>"},{"location":"MT5Service/History_Convenience_Methods/#use-mt5account-when","title":"\u26a0\ufe0f Use MT5Account when:","text":"<ul> <li>Need exact date range (not relative days)</li> <li>Need custom sort order</li> <li>Need pagination (page numbers)</li> <li>Building advanced history management</li> </ul>"},{"location":"MT5Service/History_Convenience_Methods/#implementation-details","title":"\ud83d\udca1 Implementation Details","text":""},{"location":"MT5Service/History_Convenience_Methods/#getrecentordersasync","title":"GetRecentOrdersAsync","text":"<pre><code>// What it does internally:\npublic Task&lt;OrdersHistoryData&gt; GetRecentOrdersAsync(\n    int days = 7,\n    int limit = 100,\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default)\n{\n    return OrderHistoryAsync(\n        from: DateTime.UtcNow.AddDays(-days),\n        to: DateTime.UtcNow,\n        sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc,\n        pageNumber: 0,\n        itemsPerPage: limit,\n        deadline: deadline,\n        cancellationToken: cancellationToken\n    );\n}\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#gettodayordersasync","title":"GetTodayOrdersAsync","text":"<pre><code>// Simply calls GetRecentOrdersAsync with days: 1\npublic Task&lt;OrdersHistoryData&gt; GetTodayOrdersAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default)\n    =&gt; GetRecentOrdersAsync(days: 1, limit: 1000, deadline, cancellationToken);\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#istradingallowedasync","title":"IsTradingAllowedAsync","text":"<pre><code>// Checks AccountTradeAllowed and returns boolean\npublic async Task&lt;bool&gt; IsTradingAllowedAsync(\n    DateTime? deadline = null,\n    CancellationToken cancellationToken = default)\n{\n    var allowed = await AccountInfoIntegerAsync(\n        AccountInfoIntegerPropertyType.AccountTradeAllowed,\n        deadline,\n        cancellationToken);\n    return allowed == 1;\n}\n</code></pre>"},{"location":"MT5Service/History_Convenience_Methods/#see-also","title":"\ud83d\udd17 See Also","text":"<ul> <li>MT5Service Overview - Complete MT5Service improvements</li> <li>Account Convenience Methods - Account shortcuts</li> <li>Symbol Convenience Methods - Symbol shortcuts</li> <li>Trading Convenience Methods - Trading shortcuts</li> <li>MT5Account History - Low-level reference</li> </ul>"},{"location":"MT5Service/History_Convenience_Methods/#summary","title":"\ud83d\udca1 Summary","text":"<p>3 history methods with sensible defaults for common scenarios:</p> <pre><code>// Get recent history - simple!\nvar lastWeek = await service.GetRecentOrdersAsync(days: 7);\nvar today = await service.GetTodayOrdersAsync();\n\n// Check trading permission - boolean!\nif (await service.IsTradingAllowedAsync())\n{\n    // Ready to trade!\n}\n\n// Custom if needed:\nvar lastMonth = await service.GetRecentOrdersAsync(days: 30, limit: 500);\n</code></pre> <p>Sensible defaults, flexible when needed! \ud83d\ude80</p>"},{"location":"MT5Service/MT5Service.Overview/","title":"MT5Service - Mid-Level API Overview","text":"<p>Not just a wrapper! MT5Service eliminates 50-70% of boilerplate code while maintaining full MT5 functionality.</p>"},{"location":"MT5Service/MT5Service.Overview/#what-is-mt5service","title":"\ud83c\udfaf What is MT5Service?","text":"<p>MT5Service is a mid-level convenience layer between low-level MT5Account (proto/gRPC) and high-level MT5Sugar (business logic).</p> <p>Three-Layer Architecture: <pre><code>MT5Account (Low-Level)  \u2192  Direct gRPC calls, returns Data wrappers\n     \u2193\nMT5Service (Mid-Level)  \u2192  Unwraps primitives + convenience shortcuts  \u2190 YOU ARE HERE\n     \u2193\nMT5Sugar (High-Level)   \u2192  Complex business logic, smart helpers\n</code></pre></p> <p>What makes it special:</p> <ul> <li>\u2705 Automatic value unwrapping - no more <code>.Value</code> ceremony</li> <li>\u2705 ~30 convenience methods - shortcuts for common operations</li> <li>\u2705 Smart combinations - multiple checks in one call</li> <li>\u2705 Ergonomic trading API - no manual request building</li> <li>\u2705 50-70% code reduction - write less, do more</li> </ul>"},{"location":"MT5Service/MT5Service.Overview/#quick-comparison","title":"\ud83d\ude80 Quick Comparison","text":""},{"location":"MT5Service/MT5Service.Overview/#account-operations","title":"Account Operations","text":"<pre><code>// \u274c MT5Account (Low-Level) - 2 lines:\nvar data = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountBalance);\ndouble balance = data.Value;\n\n// \u2705 MT5Service (Mid-Level) - 1 line:\ndouble balance = await service.GetBalanceAsync();\n</code></pre>"},{"location":"MT5Service/MT5Service.Overview/#trading-operations","title":"Trading Operations","text":"<pre><code>// \u274c MT5Account (Low-Level) - 9 lines:\nvar request = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,\n    StopLoss = 1.0800,\n    TakeProfit = 1.0900,\n    Comment = \"My trade\"\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 MT5Service (Mid-Level) - 1 line:\nvar result = await service.BuyMarketAsync(\"EURUSD\", 0.01,\n    stopLoss: 1.0800, takeProfit: 1.0900, comment: \"My trade\");\n</code></pre>"},{"location":"MT5Service/MT5Service.Overview/#symbol-availability-check","title":"Symbol Availability Check","text":"<pre><code>// \u274c MT5Account (Low-Level) - 2 separate calls:\nvar existsData = await account.SymbolExistAsync(\"EURUSD\");\nif (!existsData.Exists) return false;\nvar syncData = await account.SymbolIsSynchronizedAsync(\"EURUSD\");\nbool available = syncData.Synchronized;\n\n// \u2705 MT5Service (Mid-Level) - 1 smart call:\nbool available = await service.IsSymbolAvailableAsync(\"EURUSD\");\n</code></pre>"},{"location":"MT5Service/MT5Service.Overview/#whats-inside-4-groups-of-methods","title":"\ud83d\udce6 What's Inside: 4 Groups of Methods","text":""},{"location":"MT5Service/MT5Service.Overview/#1-account-convenience-methods-10-methods","title":"1\ufe0f\u20e3 Account Convenience Methods (10 methods)","text":"<p>Direct access to account properties without unwrapping:</p> <pre><code>// Get key account metrics - 1 line each:\ndouble balance = await service.GetBalanceAsync();\ndouble equity = await service.GetEquityAsync();\ndouble margin = await service.GetMarginAsync();\ndouble freeMargin = await service.GetFreeMarginAsync();\ndouble profit = await service.GetProfitAsync();\n\n// Get account info:\nlong login = await service.GetLoginAsync();\nlong leverage = await service.GetLeverageAsync();\nstring name = await service.GetAccountNameAsync();\nstring server = await service.GetServerNameAsync();\nstring currency = await service.GetCurrencyAsync();\n</code></pre> <p>Benefits: 50% code reduction, no <code>.Value</code>, readable names</p>"},{"location":"MT5Service/MT5Service.Overview/#2-symbol-convenience-methods-7-methods-1-smart","title":"2\ufe0f\u20e3 Symbol Convenience Methods (7 methods + 1 smart)","text":"<p>Quick access to symbol properties and smart availability check:</p> <pre><code>// Get current quote:\ndouble bid = await service.GetBidAsync(\"EURUSD\");\ndouble ask = await service.GetAskAsync(\"EURUSD\");\nlong spread = await service.GetSpreadAsync(\"EURUSD\");\n\n// Volume constraints:\ndouble minVol = await service.GetVolumeMinAsync(\"EURUSD\");\ndouble maxVol = await service.GetVolumeMaxAsync(\"EURUSD\");\ndouble step = await service.GetVolumeStepAsync(\"EURUSD\");\n\n// Smart combination (2 calls \u2192 1 method):\nbool available = await service.IsSymbolAvailableAsync(\"EURUSD\");\n\n// Trading permission check:\nbool canTrade = await service.IsTradingAllowedAsync();\n</code></pre> <p>Benefits: 60%+ code reduction, smart combinations, no enums</p>"},{"location":"MT5Service/MT5Service.Overview/#3-trading-convenience-methods-6-methods","title":"3\ufe0f\u20e3 Trading Convenience Methods (6 methods)","text":"<p>Simplified order placement without manual request building:</p> <pre><code>// Market orders:\nawait service.BuyMarketAsync(\"EURUSD\", 0.01, stopLoss: 1.08, takeProfit: 1.09);\nawait service.SellMarketAsync(\"GBPUSD\", 0.05, stopLoss: 1.26, takeProfit: 1.25);\n\n// Limit orders (price improvement):\nawait service.BuyLimitAsync(\"EURUSD\", 0.1, price: 1.0850, stopLoss: 1.08, takeProfit: 1.09);\nawait service.SellLimitAsync(\"GBPUSD\", 0.05, price: 1.2550, stopLoss: 1.26, takeProfit: 1.25);\n\n// Stop orders (breakout):\nawait service.BuyStopAsync(\"XAUUSD\", 0.01, price: 2010, stopLoss: 2000, takeProfit: 2030);\nawait service.SellStopAsync(\"USDJPY\", 0.1, price: 149.5, stopLoss: 150, takeProfit: 149);\n</code></pre> <p>Benefits: 70%+ code reduction, self-documenting, named parameters</p>"},{"location":"MT5Service/MT5Service.Overview/#4-history-convenience-methods-3-methods","title":"4\ufe0f\u20e3 History Convenience Methods (3 methods)","text":"<p>Sensible defaults for common history queries:</p> <pre><code>// Get recent orders:\nvar lastWeek = await service.GetRecentOrdersAsync(days: 7);\nvar lastMonth = await service.GetRecentOrdersAsync(days: 30, limit: 500);\n\n// Get today's orders:\nvar today = await service.GetTodayOrdersAsync();\n\n// Check trading permission:\nif (await service.IsTradingAllowedAsync())\n{\n    // Ready to trade\n}\n</code></pre> <p>Benefits: 84% code reduction, sensible defaults, readable intent</p>"},{"location":"MT5Service/MT5Service.Overview/#key-features-explained","title":"\ud83d\udd27 Key Features Explained","text":""},{"location":"MT5Service/MT5Service.Overview/#feature-1-automatic-value-unwrapping","title":"Feature 1: Automatic Value Unwrapping","text":"<p>Problem in MT5Account: Every call returns a <code>Data</code> wrapper object that must be unwrapped:</p> <pre><code>var balanceData = await account.AccountInfoDoubleAsync(AccountInfoDoublePropertyType.AccountBalance);\ndouble balance = balanceData.Value;  // \u2190 Must unwrap!\n\nvar bidData = await account.SymbolInfoDoubleAsync(\"EURUSD\", SymbolInfoDoubleProperty.SymbolBid);\ndouble bid = bidData.Value;  // \u2190 Must unwrap!\n\nvar existsData = await account.SymbolExistAsync(\"EURUSD\");\nbool exists = existsData.Exists;  // \u2190 Must unwrap!\n</code></pre> <p>Solution in MT5Service: Direct primitive returns - no unwrapping needed:</p> <pre><code>double balance = await service.GetBalanceAsync();  // \u2705 Already unwrapped\ndouble bid = await service.GetBidAsync(\"EURUSD\");  // \u2705 Already unwrapped\nbool exists = await service.SymbolExistAsync(\"EURUSD\");  // \u2705 Already unwrapped\n</code></pre> <p>Impact:</p> <ul> <li>\u2705 50% less code for data retrieval</li> <li>\u2705 Impossible to forget <code>.Value</code></li> <li>\u2705 Cleaner, more readable code</li> </ul> <p>Methods with unwrapping:</p> <ul> <li>All <code>AccountInfo*</code> \u2192 returns <code>double</code>, <code>long</code>, <code>string</code> directly</li> <li>All <code>SymbolInfo*</code> \u2192 returns <code>double</code>, <code>long</code>, <code>string</code> directly</li> <li><code>SymbolsTotal</code> \u2192 returns <code>int</code> directly</li> <li><code>SymbolExist</code>, <code>SymbolSelect</code>, <code>SymbolIsSynchronized</code> \u2192 returns <code>bool</code> directly</li> </ul>"},{"location":"MT5Service/MT5Service.Overview/#feature-2-smart-combinations","title":"Feature 2: Smart Combinations","text":"<p>Problem in MT5Account: Common operations require multiple separate calls:</p> <pre><code>// Check if symbol is ready for trading (2 calls):\nvar existsData = await account.SymbolExistAsync(\"BTCUSD\");\nif (!existsData.Exists)\n{\n    Console.WriteLine(\"Symbol doesn't exist!\");\n    return false;\n}\n\nvar syncData = await account.SymbolIsSynchronizedAsync(\"BTCUSD\");\nif (!syncData.Synchronized)\n{\n    Console.WriteLine(\"Symbol not synchronized!\");\n    return false;\n}\n\nreturn true;\n</code></pre> <p>Solution in MT5Service: Smart methods combine multiple checks:</p> <pre><code>// 1 smart call replaces 2 separate calls:\nbool available = await service.IsSymbolAvailableAsync(\"BTCUSD\");\n\nif (!available)\n{\n    Console.WriteLine(\"Symbol not available!\");\n    return false;\n}\n\nreturn true;\n</code></pre> <p>Smart methods:</p> <ul> <li><code>IsSymbolAvailableAsync(symbol)</code> - combines <code>SymbolExist</code> + <code>SymbolIsSynchronized</code></li> <li><code>IsTradingAllowedAsync()</code> - checks <code>AccountTradeAllowed</code> and returns boolean</li> </ul> <p>Impact:</p> <ul> <li>\u2705 Fewer server round-trips</li> <li>\u2705 Prevents common mistakes (forgetting one of the checks)</li> <li>\u2705 Clear intent from method name</li> </ul>"},{"location":"MT5Service/MT5Service.Overview/#feature-3-ergonomic-trading-api","title":"Feature 3: Ergonomic Trading API","text":"<p>Problem in MT5Account: Every order requires manual <code>OrderSendRequest</code> building:</p> <pre><code>// Want to BUY? Build entire request manually:\nvar request = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,  // Must remember enum\n    StopLoss = 1.0800,\n    TakeProfit = 1.0900,\n    Comment = \"My trade\",\n    ExpertId = 12345\n};\nvar result = await account.OrderSendAsync(request);\n\n// Want to SELL? Build another request:\nvar request2 = new OrderSendRequest\n{\n    Symbol = \"GBPUSD\",\n    Volume = 0.05,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeSell,  // Different enum\n    StopLoss = 1.2600,\n    TakeProfit = 1.2500\n};\nvar result2 = await account.OrderSendAsync(request2);\n</code></pre> <p>Solution in MT5Service: Direct trading methods with named parameters:</p> <pre><code>// BUY - intent clear from method name:\nvar result = await service.BuyMarketAsync(\"EURUSD\", 0.01,\n    stopLoss: 1.0800,\n    takeProfit: 1.0900,\n    comment: \"My trade\",\n    magic: 12345);\n\n// SELL - intent clear from method name:\nvar result2 = await service.SellMarketAsync(\"GBPUSD\", 0.05,\n    stopLoss: 1.2600,\n    takeProfit: 1.2500);\n</code></pre> <p>All 6 trading methods:</p> <ul> <li><code>BuyMarketAsync()</code> - buy at current ask</li> <li><code>SellMarketAsync()</code> - sell at current bid</li> <li><code>BuyLimitAsync()</code> - pending buy below current price</li> <li><code>SellLimitAsync()</code> - pending sell above current price</li> <li><code>BuyStopAsync()</code> - pending buy above current price (breakout)</li> <li><code>SellStopAsync()</code> - pending sell below current price (breakdown)</li> </ul> <p>Impact:</p> <ul> <li>\u2705 70-89% code reduction per order</li> <li>\u2705 Self-documenting (method name = intent)</li> <li>\u2705 Named parameters show what each value means</li> <li>\u2705 Can't set wrong <code>Operation</code> enum (impossible error)</li> </ul>"},{"location":"MT5Service/MT5Service.Overview/#feature-4-sensible-defaults","title":"Feature 4: Sensible Defaults","text":"<p>Problem in MT5Account: Common operations require many parameters:</p> <pre><code>// Want last week's orders? Specify everything:\nvar history = await account.OrderHistoryAsync(\n    from: DateTime.UtcNow.AddDays(-7),                // Calculate manually\n    to: DateTime.UtcNow,                              // Now\n    sortMode: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc,  // Long enum\n    pageNumber: 0,                                    // No pagination\n    itemsPerPage: 100,                                // Limit\n    deadline: null,                                   // No deadline\n    cancellationToken: default);                      // No cancellation\n\n// 7 parameters just to get last week!\n</code></pre> <p>Solution in MT5Service: Sensible defaults for common scenarios:</p> <pre><code>// Last week's orders - 1 parameter:\nvar history = await service.GetRecentOrdersAsync(days: 7);\n\n// Today's orders - no parameters:\nvar today = await service.GetTodayOrdersAsync();\n\n// Custom if needed:\nvar lastMonth = await service.GetRecentOrdersAsync(days: 30, limit: 500);\n</code></pre> <p>Impact:</p> <ul> <li>\u2705 84% code reduction for history queries</li> <li>\u2705 Readable intent (<code>GetTodayOrders</code> vs manual date calculation)</li> <li>\u2705 Defaults work for 90% of cases</li> <li>\u2705 Still customizable when needed</li> </ul>"},{"location":"MT5Service/MT5Service.Overview/#overall-statistics","title":"\ud83d\udcca Overall Statistics","text":""},{"location":"MT5Service/MT5Service.Overview/#code-reduction-by-category","title":"Code Reduction by Category","text":"Category Average Code Reduction Key Benefit Account operations 50% No <code>.Value</code> unwrapping Symbol operations 60%+ No enums + smart checks Trading operations 70-89% No request building History operations 84% Sensible defaults"},{"location":"MT5Service/MT5Service.Overview/#methods-count","title":"Methods Count","text":"Category Thin Wrappers New Convenience Methods Total Account 4 10 14 Symbol 7 7 + 1 smart 15 Trading 5 6 11 History 2 2 4 Streaming 5 (pass-through) 0 5 Total 23 ~30 ~53"},{"location":"MT5Service/MT5Service.Overview/#when-to-use-each-layer","title":"\ud83c\udf93 When to Use Each Layer","text":""},{"location":"MT5Service/MT5Service.Overview/#use-mt5account-low-level-when","title":"Use MT5Account (Low-Level) when:","text":"<ul> <li>\u274c Need exotic properties not covered by convenience methods</li> <li>\u274c Building custom wrapper/framework on top</li> <li>\u274c Require absolute control over proto objects</li> <li>\u274c Accessing advanced features not in MT5Service</li> </ul> <p>Example: Accessing <code>SymbolInfoSession*</code> for trading hours</p>"},{"location":"MT5Service/MT5Service.Overview/#use-mt5service-mid-level-when","title":"Use MT5Service (Mid-Level) when: \u2705","text":"<ul> <li>\u2705 90% of typical trading scenarios</li> <li>\u2705 Building trading bots/strategies</li> <li>\u2705 Rapid development</li> <li>\u2705 Want clean, readable code</li> <li>\u2705 Don't need auto-normalization (that's MT5Sugar)</li> </ul> <p>Example: Placing orders, getting quotes, checking balances</p>"},{"location":"MT5Service/MT5Service.Overview/#use-mt5sugar-high-level-when","title":"Use MT5Sugar (High-Level) when:","text":"<ul> <li>\u2705 Need auto-normalization of volumes/prices</li> <li>\u2705 Want risk-based position sizing</li> <li>\u2705 Need batch operations</li> <li>\u2705 Require advanced helpers/validators</li> </ul> <p>Example: <code>OpenPositionWithRisk(symbol, riskPercent: 2.0)</code></p>"},{"location":"MT5Service/MT5Service.Overview/#complete-example-trading-bot","title":"\ud83d\udca1 Complete Example: Trading Bot","text":"<pre><code>using mt5_term_api;\n\n// Initialize\nvar account = new MT5Account();\nvar service = new MT5Service(account);\n\nawait account.ConnectByHostPortAsync(\"mt5.mrpc.pro\", 443);\n\n// 1. Check account\ndouble balance = await service.GetBalanceAsync();\ndouble equity = await service.GetEquityAsync();\ndouble freeMargin = await service.GetFreeMarginAsync();\n\nConsole.WriteLine($\"Balance: ${balance:F2}\");\nConsole.WriteLine($\"Equity: ${equity:F2}\");\nConsole.WriteLine($\"Free Margin: ${freeMargin:F2}\");\n\n// 2. Check trading is allowed\nif (!await service.IsTradingAllowedAsync())\n{\n    Console.WriteLine(\"\u274c Trading not allowed!\");\n    return;\n}\n\n// 3. Check symbol\nstring symbol = \"EURUSD\";\nif (!await service.IsSymbolAvailableAsync(symbol))\n{\n    Console.WriteLine($\"\u274c Symbol {symbol} not available!\");\n    return;\n}\n\n// 4. Get quote\ndouble bid = await service.GetBidAsync(symbol);\ndouble ask = await service.GetAskAsync(symbol);\nConsole.WriteLine($\"{symbol}: Bid={bid:F5}, Ask={ask:F5}\");\n\n// 5. Validate volume\ndouble volume = 0.01;\ndouble minVol = await service.GetVolumeMinAsync(symbol);\ndouble maxVol = await service.GetVolumeMaxAsync(symbol);\ndouble step = await service.GetVolumeStepAsync(symbol);\n\nif (volume &lt; minVol || volume &gt; maxVol)\n{\n    Console.WriteLine($\"\u274c Volume out of range [{minVol}, {maxVol}]\");\n    return;\n}\n\n// 6. Place order\nvar result = await service.BuyMarketAsync(symbol, volume,\n    stopLoss: bid - 0.0050,\n    takeProfit: bid + 0.0100,\n    comment: \"Bot trade\");\n\nif (result.RetCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Order opened: #{result.Order}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n}\n\n// 7. Check today's performance\nvar today = await service.GetTodayOrdersAsync();\ndouble todayProfit = today.ClosedOrders.Sum(o =&gt; o.Profit);\nConsole.WriteLine($\"Today's P/L: ${todayProfit:F2} ({today.ClosedOrders.Count} trades)\");\n</code></pre> <p>Clean, readable, maintainable! \ud83d\ude80</p>"},{"location":"MT5Service/MT5Service.Overview/#documentation-index","title":"\ud83d\udd17 Documentation Index","text":""},{"location":"MT5Service/MT5Service.Overview/#method-groups","title":"Method Groups","text":"<ol> <li>Account Convenience Methods - Balance, equity, margin, profit, account info</li> <li>Symbol Convenience Methods - Bid, ask, spread, volumes, availability</li> <li>Trading Convenience Methods - Market/limit/stop orders simplified</li> <li>History Convenience Methods - Recent orders, today's orders, trading permissions</li> </ol>"},{"location":"MT5Service/MT5Service.Overview/#key-takeaways","title":"\ud83c\udfaf Key Takeaways","text":""},{"location":"MT5Service/MT5Service.Overview/#what-mt5service-does","title":"What MT5Service Does:","text":"<ol> <li>\u2705 Eliminates <code>.Value</code> unwrapping - returns primitives directly</li> <li>\u2705 Adds ~30 convenience methods - shortcuts for common operations</li> <li>\u2705 Smart combinations - multiple checks in one call</li> <li>\u2705 Ergonomic trading API - no request building</li> <li>\u2705 Sensible defaults - works for 90% of cases</li> <li>\u2705 50-70% code reduction - write less, do more</li> </ol>"},{"location":"MT5Service/MT5Service.Overview/#what-mt5service-does-not-do","title":"What MT5Service Does NOT Do:","text":"<ul> <li>\u274c Auto-normalization (that's MT5Sugar)</li> <li>\u274c Risk management (that's MT5Sugar)</li> <li>\u274c Complex business logic (that's MT5Sugar)</li> <li>\u274c Replace MT5Account (it wraps it)</li> </ul>"},{"location":"MT5Service/MT5Service.Overview/#the-bottom-line","title":"The Bottom Line:","text":"<p>MT5Service is the sweet spot between low-level control and high-level convenience. Use it for 90% of your trading code.</p> <pre><code>// This is MT5Service:\nvar balance = await service.GetBalanceAsync();\nvar result = await service.BuyMarketAsync(\"EURUSD\", 0.01, stopLoss: 1.08, takeProfit: 1.09);\nvar today = await service.GetTodayOrdersAsync();\n</code></pre> <p>Simple. Clean. Fast. \ud83d\ude80</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/","title":"MT5Service - Symbol Convenience Methods","text":"<p>7 convenient methods for quick access to symbol properties + 1 smart combination method</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/#why-these-methods-exist","title":"\ud83c\udfaf Why These Methods Exist","text":"<p>Problem: Getting symbol properties in MT5Account requires enum parameters and <code>.Value</code> unwrapping: <pre><code>var bidData = await account.SymbolInfoDoubleAsync(\"EURUSD\", SymbolInfoDoubleProperty.SymbolBid);\ndouble bid = bidData.Value;  // \u2190 unwrapping!\n</code></pre></p> <p>Solution: MT5Service provides direct methods with clear names: <pre><code>double bid = await service.GetBidAsync(\"EURUSD\");  // \u2705 clean!\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 Readable names (<code>GetBid</code> vs <code>SymbolInfoDouble(SymbolBid)</code>)</li> <li>\u2705 No enum parameters needed</li> <li>\u2705 No <code>.Value</code> unwrapping</li> <li>\u2705 Smart combinations (availability check = Exist + Synchronized)</li> </ul>"},{"location":"MT5Service/Symbol_Convenience_Methods/#all-7-methods-1-smart-method","title":"\ud83d\udccb All 7 Methods + 1 Smart Method","text":"Method Returns Low-Level Equivalent <code>GetBidAsync(symbol)</code> Current bid price <code>SymbolInfoDoubleAsync(symbol, SymbolBid)</code> <code>GetAskAsync(symbol)</code> Current ask price <code>SymbolInfoDoubleAsync(symbol, SymbolAsk)</code> <code>GetSpreadAsync(symbol)</code> Current spread in points <code>SymbolInfoIntegerAsync(symbol, SymbolSpread)</code> <code>GetVolumeMinAsync(symbol)</code> Minimum lot size <code>SymbolInfoDoubleAsync(symbol, SymbolVolumeMin)</code> <code>GetVolumeMaxAsync(symbol)</code> Maximum lot size <code>SymbolInfoDoubleAsync(symbol, SymbolVolumeMax)</code> <code>GetVolumeStepAsync(symbol)</code> Volume step increment <code>SymbolInfoDoubleAsync(symbol, SymbolVolumeStep)</code> <code>IsTradingAllowedAsync()</code> Trading permission check <code>AccountInfoIntegerAsync(AccountTradeAllowed)</code> <code>IsSymbolAvailableAsync(symbol)</code> Smart: Exist + Synchronized 2 calls combined!"},{"location":"MT5Service/Symbol_Convenience_Methods/#usage-examples","title":"\ud83d\udca1 Usage Examples","text":""},{"location":"MT5Service/Symbol_Convenience_Methods/#example-1-getting-current-quote-bidask","title":"Example 1: Getting Current Quote (Bid/Ask)","text":"<pre><code>// \u274c BEFORE (MT5Account) - 4 lines:\nvar bidData = await account.SymbolInfoDoubleAsync(\"EURUSD\", SymbolInfoDoubleProperty.SymbolBid);\ndouble bid = bidData.Value;\nvar askData = await account.SymbolInfoDoubleAsync(\"EURUSD\", SymbolInfoDoubleProperty.SymbolAsk);\ndouble ask = askData.Value;\n\n// \u2705 AFTER (MT5Service) - 2 lines:\ndouble bid = await service.GetBidAsync(\"EURUSD\");\ndouble ask = await service.GetAskAsync(\"EURUSD\");\n\nConsole.WriteLine($\"EURUSD: Bid={bid:F5}, Ask={ask:F5}\");\n</code></pre> <p>Code reduction: 50% (4 lines \u2192 2 lines)</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/#example-2-calculating-spread","title":"Example 2: Calculating Spread","text":"<pre><code>// \u274c BEFORE (MT5Account):\nvar spreadData = await account.SymbolInfoIntegerAsync(\"GBPUSD\", SymbolInfoIntegerProperty.SymbolSpread);\nlong spread = spreadData.Value;\nConsole.WriteLine($\"Spread: {spread} points\");\n\n// \u2705 AFTER (MT5Service):\nlong spread = await service.GetSpreadAsync(\"GBPUSD\");\nConsole.WriteLine($\"Spread: {spread} points\");\n\n// Or calculate spread in price:\ndouble bid = await service.GetBidAsync(\"GBPUSD\");\ndouble ask = await service.GetAskAsync(\"GBPUSD\");\ndouble spreadPrice = ask - bid;\nConsole.WriteLine($\"Spread: {spreadPrice:F5} ({spread} points)\");\n</code></pre>"},{"location":"MT5Service/Symbol_Convenience_Methods/#example-3-validating-volume-before-order","title":"Example 3: Validating Volume Before Order","text":"<pre><code>// \u274c BEFORE (MT5Account) - 6 lines:\nvar minData = await account.SymbolInfoDoubleAsync(\"XAUUSD\", SymbolInfoDoubleProperty.SymbolVolumeMin);\ndouble minVol = minData.Value;\nvar maxData = await account.SymbolInfoDoubleAsync(\"XAUUSD\", SymbolInfoDoubleProperty.SymbolVolumeMax);\ndouble maxVol = maxData.Value;\nvar stepData = await account.SymbolInfoDoubleAsync(\"XAUUSD\", SymbolInfoDoubleProperty.SymbolVolumeStep);\ndouble step = stepData.Value;\n\ndouble requestedVolume = 0.15;\nif (requestedVolume &lt; minVol)\n{\n    Console.WriteLine($\"\u274c Volume too small! Min: {minVol}\");\n}\nelse if (requestedVolume &gt; maxVol)\n{\n    Console.WriteLine($\"\u274c Volume too large! Max: {maxVol}\");\n}\nelse if ((requestedVolume % step) != 0)\n{\n    Console.WriteLine($\"\u274c Invalid volume step! Step: {step}\");\n}\n\n// \u2705 AFTER (MT5Service) - 3 lines:\ndouble minVol = await service.GetVolumeMinAsync(\"XAUUSD\");\ndouble maxVol = await service.GetVolumeMaxAsync(\"XAUUSD\");\ndouble step = await service.GetVolumeStepAsync(\"XAUUSD\");\n\ndouble requestedVolume = 0.15;\nif (requestedVolume &lt; minVol)\n{\n    Console.WriteLine($\"\u274c Volume too small! Min: {minVol}\");\n}\nelse if (requestedVolume &gt; maxVol)\n{\n    Console.WriteLine($\"\u274c Volume too large! Max: {maxVol}\");\n}\nelse if ((requestedVolume % step) != 0)\n{\n    Console.WriteLine($\"\u274c Invalid volume step! Step: {step}\");\n}\n</code></pre> <p>Code reduction: 50% (6 lines \u2192 3 lines for data retrieval)</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/#example-4-smart-symbol-availability-check","title":"Example 4: Smart Symbol Availability Check \u2b50","text":"<pre><code>// \u274c BEFORE (MT5Account) - 2 separate calls + unwrapping:\nvar existsData = await account.SymbolExistAsync(\"BTCUSD\");\nif (!existsData.Exists)\n{\n    Console.WriteLine(\"\u274c Symbol doesn't exist!\");\n    return;\n}\n\nvar syncData = await account.SymbolIsSynchronizedAsync(\"BTCUSD\");\nif (!syncData.Synchronized)\n{\n    Console.WriteLine(\"\u274c Symbol not synchronized!\");\n    return;\n}\n\nConsole.WriteLine(\"\u2705 Symbol ready to trade!\");\n\n// \u2705 AFTER (MT5Service) - 1 smart call:\nbool available = await service.IsSymbolAvailableAsync(\"BTCUSD\");\n\nif (!available)\n{\n    Console.WriteLine(\"\u274c Symbol not available (doesn't exist or not synchronized)!\");\n    return;\n}\n\nConsole.WriteLine(\"\u2705 Symbol ready to trade!\");\n</code></pre> <p>Smart combination: 2 server calls \u2192 1 method call!</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/#example-5-pre-trade-validation-full-example","title":"Example 5: Pre-Trade Validation (Full Example)","text":"<pre><code>// Complete validation before placing order\nstring symbol = \"EURUSD\";\ndouble requestedVolume = 0.05;\n\n// Check trading is allowed\nbool tradingAllowed = await service.IsTradingAllowedAsync();\nif (!tradingAllowed)\n{\n    Console.WriteLine(\"\u274c Trading not allowed on this account!\");\n    return;\n}\n\n// Check symbol availability (smart check!)\nbool symbolAvailable = await service.IsSymbolAvailableAsync(symbol);\nif (!symbolAvailable)\n{\n    Console.WriteLine($\"\u274c Symbol {symbol} not available!\");\n    return;\n}\n\n// Check volume constraints\ndouble minVol = await service.GetVolumeMinAsync(symbol);\ndouble maxVol = await service.GetVolumeMaxAsync(symbol);\ndouble step = await service.GetVolumeStepAsync(symbol);\n\nif (requestedVolume &lt; minVol || requestedVolume &gt; maxVol)\n{\n    Console.WriteLine($\"\u274c Volume {requestedVolume} out of range [{minVol}, {maxVol}]\");\n    return;\n}\n\nif ((requestedVolume % step) != 0)\n{\n    Console.WriteLine($\"\u274c Volume must be multiple of {step}\");\n    return;\n}\n\n// All checks passed!\nConsole.WriteLine(\"\u2705 All validations passed, ready to trade!\");\n\n// Place order...\nvar result = await service.BuyMarketAsync(symbol, requestedVolume);\n</code></pre>"},{"location":"MT5Service/Symbol_Convenience_Methods/#example-6-monitoring-multiple-symbols","title":"Example 6: Monitoring Multiple Symbols","text":"<pre><code>// Monitor quotes for multiple symbols\nstring[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\nforeach (var symbol in symbols)\n{\n    // Check availability first\n    if (!await service.IsSymbolAvailableAsync(symbol))\n    {\n        Console.WriteLine($\"\u26a0\ufe0f {symbol} not available, skipping...\");\n        continue;\n    }\n\n    // Get quote\n    double bid = await service.GetBidAsync(symbol);\n    double ask = await service.GetAskAsync(symbol);\n    long spread = await service.GetSpreadAsync(symbol);\n\n    Console.WriteLine($\"{symbol}: Bid={bid:F5}, Ask={ask:F5}, Spread={spread}pts\");\n}\n</code></pre>"},{"location":"MT5Service/Symbol_Convenience_Methods/#example-7-parallel-quote-retrieval","title":"Example 7: Parallel Quote Retrieval","text":"<pre><code>// Get bid/ask for multiple symbols in parallel\nvar tasks = new[]\n{\n    service.GetBidAsync(\"EURUSD\"),\n    service.GetBidAsync(\"GBPUSD\"),\n    service.GetBidAsync(\"USDJPY\")\n};\n\nawait Task.WhenAll(tasks);\n\nConsole.WriteLine($\"EURUSD Bid: {tasks[0].Result:F5}\");\nConsole.WriteLine($\"GBPUSD Bid: {tasks[1].Result:F5}\");\nConsole.WriteLine($\"USDJPY Bid: {tasks[2].Result:F5}\");\n</code></pre> <p>Performance: All requests execute concurrently!</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/#key-benefits","title":"\ud83d\udd11 Key Benefits","text":"Aspect MT5Account (Low-Level) MT5Service (Convenience) Code 2 lines per value 1 line per value Enums Always required \u274c Not needed Unwrapping Always <code>.Value</code> \u274c Not needed Availability Check 2 separate calls \u2705 1 smart method Readability <code>SymbolInfoDouble(SymbolBid)</code> <code>GetBid()</code> Error-prone Can forget <code>.Value</code> \u2705 Impossible"},{"location":"MT5Service/Symbol_Convenience_Methods/#special-issymbolavailableasync","title":"\u2b50 Special: IsSymbolAvailableAsync()","text":"<p>This is a smart combination method that does more than just unwrap values!</p> <pre><code>// What it does internally:\npublic async Task&lt;bool&gt; IsSymbolAvailableAsync(string symbol)\n{\n    // 1. Check if symbol exists\n    var exists = await SymbolExistAsync(symbol);\n    if (!exists) return false;\n\n    // 2. Check if symbol is synchronized with server\n    return await SymbolIsSynchronizedAsync(symbol);\n}\n</code></pre> <p>Benefits:</p> <ul> <li>\u2705 2 server calls \u2192 1 method call</li> <li>\u2705 Clear intent: \"Can I trade this symbol?\"</li> <li>\u2705 Prevents common mistake (checking Exist but forgetting Synchronized)</li> <li>\u2705 Less code, fewer errors</li> </ul>"},{"location":"MT5Service/Symbol_Convenience_Methods/#code-reduction-statistics","title":"\ud83d\udcca Code Reduction Statistics","text":"Task Lines (MT5Account) Lines (MT5Service) Reduction Get 1 value 2 1 50% Get Bid+Ask 4 2 50% Get volume constraints 6 3 50% Check availability 8 1 87.5% <p>Average reduction: 60%+ for symbol operations!</p>"},{"location":"MT5Service/Symbol_Convenience_Methods/#when-to-use","title":"\ud83c\udf93 When to Use","text":""},{"location":"MT5Service/Symbol_Convenience_Methods/#use-mt5service-when","title":"\u2705 Use MT5Service when:","text":"<ul> <li>Need quick access to common symbol properties (bid, ask, spread)</li> <li>Validating volumes before placing orders</li> <li>Checking symbol availability</li> <li>Writing trading strategies</li> <li>Want clean, readable code</li> </ul>"},{"location":"MT5Service/Symbol_Convenience_Methods/#use-mt5account-when","title":"\u26a0\ufe0f Use MT5Account when:","text":"<ul> <li>Need exotic symbol properties (no convenience method)</li> <li>Building custom wrappers</li> <li>Require low-level control</li> </ul>"},{"location":"MT5Service/Symbol_Convenience_Methods/#see-also","title":"\ud83d\udd17 See Also","text":"<ul> <li>MT5Service Overview - Complete MT5Service improvements</li> <li>Account Convenience Methods - Account shortcuts</li> <li>Trading Convenience Methods - Trading shortcuts</li> <li>MT5Account Symbol Methods - Low-level reference</li> </ul>"},{"location":"MT5Service/Symbol_Convenience_Methods/#summary","title":"\ud83d\udca1 Summary","text":"<p>7 convenience methods + 1 smart combination make symbol operations cleaner and safer:</p> <pre><code>// Quick quote check:\ndouble bid = await service.GetBidAsync(\"EURUSD\");\ndouble ask = await service.GetAskAsync(\"EURUSD\");\n\n// Smart availability check:\nif (await service.IsSymbolAvailableAsync(\"EURUSD\"))\n{\n    // Ready to trade!\n}\n\n// Volume validation:\ndouble min = await service.GetVolumeMinAsync(\"EURUSD\");\ndouble max = await service.GetVolumeMaxAsync(\"EURUSD\");\ndouble step = await service.GetVolumeStepAsync(\"EURUSD\");\n</code></pre> <p>Simple, safe, fast! \ud83d\ude80</p>"},{"location":"MT5Service/Trading_Convenience_Methods/","title":"MT5Service - Trading Convenience Methods","text":"<p>6 simplified trading methods that eliminate manual <code>OrderSendRequest</code> building</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#why-these-methods-exist","title":"\ud83c\udfaf Why These Methods Exist","text":"<p>Problem: In MT5Account, placing any order requires manually building <code>OrderSendRequest</code>: <pre><code>var request = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,\n    StopLoss = 1.0800,\n    TakeProfit = 1.0900,\n    Comment = \"My trade\",\n    ExpertId = 12345\n};\nvar result = await account.OrderSendAsync(request);\n</code></pre> 9 lines of boilerplate for every trade!</p> <p>Solution: MT5Service provides direct trading methods: <pre><code>var result = await service.BuyMarketAsync(\"EURUSD\", 0.01,\n    stopLoss: 1.0800, takeProfit: 1.0900,\n    comment: \"My trade\", magic: 12345);\n</code></pre></p> <p>1 line - intent is crystal clear!</p> <p>Benefits:</p> <ul> <li>\u2705 70% less code for order placement</li> <li>\u2705 No manual request building</li> <li>\u2705 Named parameters = self-documenting</li> <li>\u2705 Can't forget required fields</li> <li>\u2705 Clear intent from method name</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#all-6-trading-methods","title":"\ud83d\udccb All 6 Trading Methods","text":"Method Order Type When to Use <code>BuyMarketAsync()</code> Market BUY Buy at current ask price (immediate execution) <code>SellMarketAsync()</code> Market SELL Sell at current bid price (immediate execution) <code>BuyLimitAsync()</code> Pending BUY LIMIT Buy when price drops to specified level <code>SellLimitAsync()</code> Pending SELL LIMIT Sell when price rises to specified level <code>BuyStopAsync()</code> Pending BUY STOP Buy when price breaks above specified level <code>SellStopAsync()</code> Pending SELL STOP Sell when price breaks below specified level"},{"location":"MT5Service/Trading_Convenience_Methods/#usage-examples","title":"\ud83d\udca1 Usage Examples","text":""},{"location":"MT5Service/Trading_Convenience_Methods/#example-1-market-order-buysell","title":"Example 1: Market Order (BUY/SELL)","text":"<pre><code>// \u274c BEFORE (MT5Account) - 9 lines:\nvar request = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuy,\n    StopLoss = 1.0800,\n    TakeProfit = 1.0900,\n    Comment = \"My trade\"\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 AFTER (MT5Service) - 1 line:\nvar result = await service.BuyMarketAsync(\"EURUSD\", 0.01,\n    stopLoss: 1.0800, takeProfit: 1.0900, comment: \"My trade\");\n\n// Check result\nif (result.RetCode == 10009) // DONE\n{\n    Console.WriteLine($\"\u2705 Order opened: #{result.Order}\");\n}\n</code></pre> <p>Code reduction: 89% (9 lines \u2192 1 line)</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-2-sell-market-order","title":"Example 2: Sell Market Order","text":"<pre><code>// \u274c BEFORE (MT5Account):\nvar request = new OrderSendRequest\n{\n    Symbol = \"GBPUSD\",\n    Volume = 0.05,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeSell,\n    StopLoss = 1.2600,\n    TakeProfit = 1.2500\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 AFTER (MT5Service):\nvar result = await service.SellMarketAsync(\"GBPUSD\", 0.05,\n    stopLoss: 1.2600, takeProfit: 1.2500);\n\nif (result.RetCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Sell order: #{result.Order}\");\n}\n</code></pre>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-3-buy-limit-pending-order","title":"Example 3: BUY LIMIT (Pending Order)","text":"<pre><code>// Scenario: EURUSD is at 1.0900, want to buy at 1.0850 (below current price)\n\n// \u274c BEFORE (MT5Account):\nvar request = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.1,\n    Price = 1.0850,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuyLimit,\n    StopLoss = 1.0800,\n    TakeProfit = 1.0900\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 AFTER (MT5Service):\nvar result = await service.BuyLimitAsync(\"EURUSD\", 0.1, price: 1.0850,\n    stopLoss: 1.0800, takeProfit: 1.0900);\n\nif (result.RetCode == 10009)\n{\n    Console.WriteLine($\"\u2705 BUY LIMIT order placed: #{result.Order}\");\n    Console.WriteLine($\"   Will activate when price drops to 1.0850\");\n}\n</code></pre> <p>Use case: Expect price to fall before going up (buy the dip).</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-4-sell-limit-pending-order","title":"Example 4: SELL LIMIT (Pending Order)","text":"<pre><code>// Scenario: GBPUSD is at 1.2500, want to sell at 1.2550 (above current price)\n\n// \u274c BEFORE (MT5Account):\nvar request = new OrderSendRequest\n{\n    Symbol = \"GBPUSD\",\n    Volume = 0.05,\n    Price = 1.2550,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeSellLimit,\n    StopLoss = 1.2600,\n    TakeProfit = 1.2500\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 AFTER (MT5Service):\nvar result = await service.SellLimitAsync(\"GBPUSD\", 0.05, price: 1.2550,\n    stopLoss: 1.2600, takeProfit: 1.2500);\n\nif (result.RetCode == 10009)\n{\n    Console.WriteLine($\"\u2705 SELL LIMIT order placed: #{result.Order}\");\n    Console.WriteLine($\"   Will activate when price rises to 1.2550\");\n}\n</code></pre> <p>Use case: Expect price to rise before going down (sell at resistance).</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-5-buy-stop-breakout-order","title":"Example 5: BUY STOP (Breakout Order)","text":"<pre><code>// Scenario: XAUUSD is at 2000, want to buy if it breaks above 2010 (resistance)\n\n// \u274c BEFORE (MT5Account):\nvar request = new OrderSendRequest\n{\n    Symbol = \"XAUUSD\",\n    Volume = 0.01,\n    Price = 2010.0,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeBuyStop,\n    StopLoss = 2000.0,\n    TakeProfit = 2030.0\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 AFTER (MT5Service):\nvar result = await service.BuyStopAsync(\"XAUUSD\", 0.01, price: 2010.0,\n    stopLoss: 2000.0, takeProfit: 2030.0);\n\nif (result.RetCode == 10009)\n{\n    Console.WriteLine($\"\u2705 BUY STOP order placed: #{result.Order}\");\n    Console.WriteLine($\"   Will activate on breakout above 2010\");\n}\n</code></pre> <p>Use case: Breakout strategy - buy when price breaks resistance.</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-6-sell-stop-breakdown-order","title":"Example 6: SELL STOP (Breakdown Order)","text":"<pre><code>// Scenario: USDJPY is at 150.00, want to sell if it breaks below 149.50 (support)\n\n// \u274c BEFORE (MT5Account):\nvar request = new OrderSendRequest\n{\n    Symbol = \"USDJPY\",\n    Volume = 0.1,\n    Price = 149.50,\n    Operation = TMT5_ENUM_ORDER_TYPE.Tmt5OrderTypeSellStop,\n    StopLoss = 150.00,\n    TakeProfit = 149.00\n};\nvar result = await account.OrderSendAsync(request);\n\n// \u2705 AFTER (MT5Service):\nvar result = await service.SellStopAsync(\"USDJPY\", 0.1, price: 149.50,\n    stopLoss: 150.00, takeProfit: 149.00);\n\nif (result.RetCode == 10009)\n{\n    Console.WriteLine($\"\u2705 SELL STOP order placed: #{result.Order}\");\n    Console.WriteLine($\"   Will activate on breakdown below 149.50\");\n}\n</code></pre> <p>Use case: Breakdown strategy - sell when price breaks support.</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-7-optional-parameters","title":"Example 7: Optional Parameters","text":"<p>All parameters except <code>symbol</code> and <code>volume</code> are optional:</p> <pre><code>// Minimal: No SL/TP\nvar result1 = await service.BuyMarketAsync(\"EURUSD\", 0.01);\n\n// With SL only\nvar result2 = await service.BuyMarketAsync(\"EURUSD\", 0.01, stopLoss: 1.0800);\n\n// With TP only\nvar result3 = await service.BuyMarketAsync(\"EURUSD\", 0.01, takeProfit: 1.0900);\n\n// With SL + TP\nvar result4 = await service.BuyMarketAsync(\"EURUSD\", 0.01,\n    stopLoss: 1.0800, takeProfit: 1.0900);\n\n// With all parameters\nvar result5 = await service.BuyMarketAsync(\"EURUSD\", 0.01,\n    stopLoss: 1.0800,\n    takeProfit: 1.0900,\n    comment: \"My strategy\",\n    magic: 12345);\n</code></pre> <p>Flexibility: Use only what you need!</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#example-8-complete-trading-flow","title":"Example 8: Complete Trading Flow","text":"<pre><code>// Full example: Check conditions \u2192 Place order \u2192 Verify result\n\nstring symbol = \"EURUSD\";\ndouble volume = 0.01;\n\n// 1. Check account has free margin\ndouble freeMargin = await service.GetFreeMarginAsync();\nif (freeMargin &lt; 100.0)\n{\n    Console.WriteLine(\"\u274c Not enough free margin!\");\n    return;\n}\n\n// 2. Check symbol is available\nbool available = await service.IsSymbolAvailableAsync(symbol);\nif (!available)\n{\n    Console.WriteLine($\"\u274c Symbol {symbol} not available!\");\n    return;\n}\n\n// 3. Get current quote\ndouble bid = await service.GetBidAsync(symbol);\ndouble ask = await service.GetAskAsync(symbol);\nConsole.WriteLine($\"Current quote: Bid={bid:F5}, Ask={ask:F5}\");\n\n// 4. Calculate SL/TP\ndouble stopLoss = bid - 0.0050;    // 50 pips below\ndouble takeProfit = bid + 0.0100;  // 100 pips above\n\n// 5. Place BUY order\nvar result = await service.BuyMarketAsync(symbol, volume,\n    stopLoss: stopLoss,\n    takeProfit: takeProfit,\n    comment: \"My Strategy\",\n    magic: 12345);\n\n// 6. Check result\nif (result.RetCode == 10009) // DONE\n{\n    Console.WriteLine($\"\u2705 Order opened successfully!\");\n    Console.WriteLine($\"   Ticket: #{result.Order}\");\n    Console.WriteLine($\"   Deal: #{result.Deal}\");\n    Console.WriteLine($\"   Price: {result.Price:F5}\");\n    Console.WriteLine($\"   Volume: {result.Volume}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Order failed!\");\n    Console.WriteLine($\"   Return Code: {result.RetCode}\");\n    Console.WriteLine($\"   Comment: {result.Comment}\");\n}\n</code></pre>"},{"location":"MT5Service/Trading_Convenience_Methods/#key-benefits","title":"\ud83d\udd11 Key Benefits","text":"Aspect MT5Account (Low-Level) MT5Service (Convenience) Code per order 9 lines 1-3 lines Request building Manual <code>OrderSendRequest</code> \u274c Not needed Operation enum Must specify <code>Tmt5OrderType...</code> \u274c Method name is intent Readability <code>Operation = Tmt5OrderTypeBuy</code> <code>BuyMarketAsync()</code> Named parameters \u274c Not available \u2705 Self-documenting Error-prone Can set wrong Operation \u2705 Impossible"},{"location":"MT5Service/Trading_Convenience_Methods/#method-signatures","title":"\ud83d\udcca Method Signatures","text":"<p>All methods follow the same pattern:</p> <pre><code>Task&lt;OrderSendData&gt; BuyMarketAsync(\n    string symbol,                    // Required\n    double volume,                    // Required\n    double? stopLoss = null,          // Optional\n    double? takeProfit = null,        // Optional\n    string comment = \"\",              // Optional\n    ulong magic = 0,                  // Optional\n    DateTime? deadline = null,        // Optional (gRPC timeout)\n    CancellationToken ct = default)   // Optional (cancellation)\n</code></pre> <p>Pattern applies to all 6 methods!</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#code-reduction-statistics","title":"\ud83d\udcca Code Reduction Statistics","text":"Task Lines (MT5Account) Lines (MT5Service) Reduction Place 1 market order 9 1 89% Place 1 pending order 9 1 89% Place 3 different orders 27 3 89% Complete trading flow 35 25 29% <p>Average reduction: 70%+ for trading operations!</p>"},{"location":"MT5Service/Trading_Convenience_Methods/#order-type-quick-reference","title":"\ud83c\udf93 Order Type Quick Reference","text":""},{"location":"MT5Service/Trading_Convenience_Methods/#market-orders-immediate-execution","title":"Market Orders (Immediate Execution)","text":"<ul> <li>BuyMarketAsync: Buy at current ASK price</li> <li>SellMarketAsync: Sell at current BID price</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#limit-orders-price-must-improve","title":"Limit Orders (Price Must Improve)","text":"<ul> <li>BuyLimitAsync: Buy below current price (expect dip)</li> <li>SellLimitAsync: Sell above current price (expect rise)</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#stop-orders-breakoutbreakdown","title":"Stop Orders (Breakout/Breakdown)","text":"<ul> <li>BuyStopAsync: Buy above current price (breakout up)</li> <li>SellStopAsync: Sell below current price (breakdown)</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#when-to-use","title":"\ud83c\udf93 When to Use","text":""},{"location":"MT5Service/Trading_Convenience_Methods/#use-mt5service-when","title":"\u2705 Use MT5Service when:","text":"<ul> <li>Placing standard market/pending orders</li> <li>Want clean, readable code</li> <li>Don't need exotic order types</li> <li>Building trading strategies</li> <li>Rapid development</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#use-mt5account-when","title":"\u26a0\ufe0f Use MT5Account when:","text":"<ul> <li>Need advanced order types (not covered by convenience methods)</li> <li>Require full control over OrderSendRequest</li> <li>Building complex order management systems</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#see-also","title":"\ud83d\udd17 See Also","text":"<ul> <li>MT5Service Overview - Complete MT5Service improvements</li> <li>Account Convenience Methods - Account shortcuts</li> <li>Symbol Convenience Methods - Symbol shortcuts</li> <li>History Convenience Methods - History shortcuts</li> <li>MT5Account Trading - Low-level reference</li> </ul>"},{"location":"MT5Service/Trading_Convenience_Methods/#summary","title":"\ud83d\udca1 Summary","text":"<p>6 trading methods that eliminate 70%+ of boilerplate code:</p> <pre><code>// Market orders - 1 line each:\nawait service.BuyMarketAsync(\"EURUSD\", 0.01, stopLoss: 1.08, takeProfit: 1.09);\nawait service.SellMarketAsync(\"GBPUSD\", 0.05, stopLoss: 1.26, takeProfit: 1.25);\n\n// Pending orders - crystal clear intent:\nawait service.BuyLimitAsync(\"EURUSD\", 0.1, price: 1.0850, stopLoss: 1.08, takeProfit: 1.09);\nawait service.SellStopAsync(\"USDJPY\", 0.1, price: 149.5, stopLoss: 150, takeProfit: 149);\n</code></pre> <p>No ceremony, just trading! \ud83d\ude80</p>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/","title":"MT5Sugar - Complete API Reference","text":"<p>High-level convenience methods for MetaTrader 5 trading automation in C#</p> <p>MT5Sugar extends <code>MT5Service</code> with convenient methods for:</p> <ul> <li>\ud83c\udfaf Risk-based position sizing (fixed dollar risk)</li> <li>\ud83d\udcca Automatic volume and price normalization</li> <li>\ud83d\udd04 Bulk operations (close all positions, cancel all orders)</li> <li>\ud83d\udcc8 DOM (Market Depth) - order book analysis</li> <li>\u2705 Pre-flight order validation and margin checking</li> <li>\ud83d\udcc9 P&amp;L monitoring and position statistics</li> </ul> <p>\ud83d\udcd6 Important: How to Work with Streaming Subscriptions - Complete guide to real-time data streams</p>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#navigation-by-region","title":"Navigation by Region","text":""},{"location":"MT5Sugar/MT5Sugar.API_Overview/#01-infrastructure","title":"[01] \ud83d\udd27 INFRASTRUCTURE","text":"<p>Basic infrastructure for working with symbols</p> Method Description Documentation <code>EnsureSelected()</code> Ensures symbol is selected and synchronized in MT5 \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#02-snapshots","title":"[02] \ud83d\udcf8 SNAPSHOTS","text":"<p>Instant snapshots of account and symbol state</p> Method Description Documentation <code>GetAccountSnapshot()</code> Complete account snapshot (balance, margin, equity) \u2192 Docs <code>GetSymbolSnapshot()</code> Complete symbol snapshot (prices, spread, limits) \u2192 Docs <p>Data classes:</p> <ul> <li><code>AccountSnapshot</code> - account data structure</li> <li><code>SymbolSnapshot</code> - symbol data structure</li> </ul>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#03-normalization-utils","title":"[03] \ud83d\udd22 NORMALIZATION &amp; UTILS","text":"<p>Utilities for price normalization and unit conversion</p> Method Description Documentation <code>GetPointAsync()</code> Get point size for symbol \u2192 Docs <code>GetDigitsAsync()</code> Number of decimal places \u2192 Docs <code>NormalizePriceAsync()</code> Normalize price by TickSize \u2192 Docs <code>PointsToPipsAsync()</code> Convert points to pips \u2192 Docs <code>GetSpreadPointsAsync()</code> Current spread in points \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#04-history-helpers","title":"[04] \ud83d\udcdc HISTORY HELPERS","text":"<p>Retrieve order and position history with pagination</p> Method Description Documentation <code>OrdersHistoryLast()</code> Closed orders history for N days \u2192 Docs <code>PositionsHistoryPaged()</code> Position history with pagination \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#05-streams-helpers","title":"[05] \ud83c\udf0a STREAMS HELPERS","text":"<p>Bounded streaming - reading ticks and trades with limits</p> Method Description Documentation <code>ReadTicks()</code> Read N ticks or until timeout \u2192 Docs <code>ReadTrades()</code> Read N trade events or until timeout \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#06-trading-market-pending","title":"[06] \ud83d\udcb9 TRADING \u2014 MARKET &amp; PENDING","text":"<p>Placing and managing market and pending orders</p> Method Description Documentation <code>PlaceMarket()</code> Place market order (BUY/SELL) \u2192 Docs <code>PlacePending()</code> Place pending order (Limit/Stop) \u2192 Docs <code>ModifySlTpAsync()</code> Modify SL/TP of existing order \u2192 Docs <code>CloseByTicket()</code> Close position by ticket \u2192 Docs <code>CloseAll()</code> Close all positions (with filters) \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#07-volume-price-utilities","title":"[07] \u2696\ufe0f VOLUME &amp; PRICE UTILITIES","text":"<p>Critical utilities for volume calculation and price operations</p> Method Description Documentation <code>CalcVolumeForRiskAsync()</code> PRIMARY METHOD - calculate volume by risk \u2192 Docs <code>GetVolumeLimitsAsync()</code> Get Min/Max/Step for symbol volume \u2192 Docs <code>NormalizeVolumeAsync()</code> Normalize volume to broker limits \u2192 Docs <code>GetTickValueAndSizeAsync()</code> Get TickValue and TickSize \u2192 Docs <code>PriceFromOffsetPointsAsync()</code> Calculate price from point offset \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#08-pending-helpers-by-points","title":"[08] \ud83d\udccd PENDING HELPERS (BY POINTS)","text":"<p>Pending orders with point-based distance</p> Method Description Documentation <code>BuyLimitPoints()</code> Buy Limit N points below Ask \u2192 Docs <code>SellLimitPoints()</code> Sell Limit N points above Bid \u2192 Docs <code>BuyStopPoints()</code> Buy Stop N points above Ask \u2192 Docs <code>SellStopPoints()</code> Sell Stop N points below Bid \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#09-market-by-risk","title":"[09] \ud83d\udcb0 MARKET BY RISK","text":"<p>Market orders with fixed dollar risk</p> Method Description Documentation <code>BuyMarketByRisk()</code> BUY with automatic volume calculation by risk \u2192 Docs <code>SellMarketByRisk()</code> SELL with automatic volume calculation by risk \u2192 Docs <p>Example: <pre><code>// Risk exactly $100 with 50-point SL\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);\n</code></pre></p>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#10-bulk-convenience","title":"[10] \ud83e\uddf9 BULK CONVENIENCE","text":"<p>Bulk operations with orders and positions</p> Method Description Documentation <code>CancelAll()</code> Cancel all pending orders \u2192 Docs <code>CloseAllPositions()</code> Close all market positions \u2192 Docs <code>CloseAllPending()</code> Close/cancel all pending orders \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#11-market-depth-dom","title":"[11] \ud83d\udcca MARKET DEPTH (DOM)","text":"<p>Level II market data - order book analysis</p> Method Description Documentation <code>SubscribeToMarketBookAsync()</code> Subscribe to order book (returns IDisposable) \u2192 Docs <code>GetMarketBookSnapshotAsync()</code> Get order book snapshot \u2192 Docs <code>GetBestBidAskFromBookAsync()</code> Best Bid/Ask from order book \u2192 Docs <code>CalculateLiquidityAtLevelAsync()</code> Calculate liquidity at price level \u2192 Docs <p>Data class:</p> <ul> <li><code>MarketBookSubscription</code> - subscription management</li> </ul>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#12-order-validation","title":"[12] \u2705 ORDER VALIDATION","text":"<p>Pre-flight checks to prevent errors</p> Method Description Documentation <code>ValidateOrderAsync()</code> Full order validation before sending \u2192 Docs <code>CalculateBuyMarginAsync()</code> Calculate margin for BUY order \u2192 Docs <code>CalculateSellMarginAsync()</code> Calculate margin for SELL order \u2192 Docs <code>CheckMarginAvailabilityAsync()</code> Check free margin sufficiency \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#13-session-time","title":"[13] \u23f0 SESSION TIME","text":"<p>Trading and quote session information</p> Method Description Documentation <code>GetQuoteSessionAsync()</code> Quote session time (when prices are visible) \u2192 Docs <code>GetTradeSessionAsync()</code> Trading session time (when trading is allowed) \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#14-position-monitoring","title":"[14] \ud83d\udcc8 POSITION MONITORING","text":"<p>Monitoring and analyzing open positions</p> Method Description Documentation <code>GetProfitablePositionsAsync()</code> Get all profitable positions \u2192 Docs <code>GetLosingPositionsAsync()</code> Get all losing positions \u2192 Docs <code>GetTotalProfitLossAsync()</code> Total P&amp;L across all positions \u2192 Docs <code>GetPositionCountAsync()</code> Number of open positions \u2192 Docs <code>GetPositionStatsBySymbolAsync()</code> Position statistics by symbol \u2192 Docs"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#common-use-cases","title":"\ud83c\udfaf Common Use Cases","text":""},{"location":"MT5Sugar/MT5Sugar.API_Overview/#simple-market-order","title":"Simple market order","text":"<pre><code>// Buy 0.10 lots EURUSD\nvar result = await svc.PlaceMarket(\"EURUSD\", 0.10, isBuy: true);\nConsole.WriteLine($\"Order #{result.Order} at {result.Price:F5}\");\n</code></pre>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#order-with-fixed-risk-100","title":"Order with fixed risk ($100)","text":"<pre><code>// Risk $100, stop 50 points, take 150 points\nawait svc.BuyMarketByRisk(\"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100,\n    tpPoints: 150);\n</code></pre>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#margin-check-before-trading","title":"Margin check before trading","text":"<pre><code>var (hasEnough, free, required) = await svc.CheckMarginAvailabilityAsync(\n    \"EURUSD\", volume: 1.0, isBuy: true);\n\nif (hasEnough)\n{\n    await svc.PlaceMarket(\"EURUSD\", 1.0, isBuy: true);\n}\nelse\n{\n    Console.WriteLine($\"Insufficient margin: need ${required}, have ${free}\");\n}\n</code></pre>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#emergency-close-on-drawdown","title":"Emergency close on drawdown","text":"<pre><code>double totalPL = await svc.GetTotalProfitLossAsync();\n\nif (totalPL &lt; -500)\n{\n    Console.WriteLine(\"\ud83d\udea8 Drawdown $500 - closing all positions!\");\n    await svc.CloseAllPositions();\n}\n</code></pre>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#order-book-dom-analysis","title":"Order book (DOM) analysis","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n    var (bestBid, bestAsk) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    var liquidity = await svc.CalculateLiquidityAtLevelAsync(\n        \"EURUSD\", bestBid, isBuy: true);\n\n    Console.WriteLine($\"Liquidity at {bestBid}: {liquidity} lots\");\n}\n</code></pre>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#related-documentation","title":"\ud83d\udd17 Related Documentation","text":"<ul> <li>MT5Account Documentation - Low-level RPC methods</li> <li>MT5Service Documentation - Mid-level service layer</li> <li>MT5Sugar (this document) - High-level convenience methods</li> </ul>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#architecture","title":"\ud83d\udce6 Architecture","text":"<pre><code>MT5Sugar (Extension Methods) \u2190 You are here\n    \u2193 Risk-based trading, DOM, bulk operations\n    \u2193\nMT5Service (Mid-level)\n    \u2193 Typed wrappers, snapshots, validation\n    \u2193\nMT5Account (Low-level)\n    \u2193 Direct gRPC/Protobuf calls\n    \u2193\nMetaTrader 5 Terminal\n</code></pre>"},{"location":"MT5Sugar/MT5Sugar.API_Overview/#conventions","title":"\ud83d\udcdd Conventions","text":"<ul> <li>All methods are asynchronous (<code>async Task&lt;T&gt;</code>)</li> <li>Extend <code>MT5Service</code> class (extension methods)</li> <li>Parameter <code>timeoutSec</code> - RPC operation timeout (default 10-20 sec)</li> <li>Parameter <code>ct</code> - <code>CancellationToken</code> for operation cancellation</li> <li>Prices are always absolute, not relative</li> <li>Volumes are always in lots, not currency units</li> <li>Points - minimum price increment</li> <li>Pips - standard unit for traders (1 pip = 10 points for 5-digit)</li> </ul> <p>\ud83c\udf89 Ready to use!</p>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/","title":"\u2705 Ensure Symbol Selected and Synchronized (<code>EnsureSelected</code>)","text":"<p>Sugar method: Ensures a symbol is selected in MarketWatch and synchronized with server before using it. Throws exception if synchronization fails.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.EnsureSelected(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>SymbolSelectAsync()</code> + <code>SymbolIsSynchronizedAsync()</code></li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static async Task EnsureSelected(\n        this MT5Service svc,\n        string symbol,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., <code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>) <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task</code> Completes successfully if symbol is ready <p>Throws:</p> <ul> <li><code>InvalidOperationException</code> \u2014 If symbol is not synchronized after selection</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Helper that ensures symbol is visible in MarketWatch and fully synchronized with server data before you use it.</li> <li>Why you need it. Prevents errors when accessing symbol data (ticks, properties, DOM) by ensuring symbol is ready first.</li> <li>Sanity check. If method completes without exception \u2192 symbol is ready. If throws \u2192 symbol not available or not synchronized.</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it before symbol operations:</p> <ul> <li>Before reading symbol properties (tick, spread, etc.).</li> <li>Before placing orders on a symbol.</li> <li>Before subscribing to MarketBook (DOM).</li> <li>As safety check in automated strategies.</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Two-step process: First selects symbol (makes it visible in MarketWatch), then verifies synchronization.</li> <li>Synchronization: Ensures symbol data is up-to-date from server. Critical for accurate prices.</li> <li>Throws on failure: Unlike low-level methods, this throws exception if symbol can't be synchronized.</li> <li>Timeout: 10 seconds is usually enough. Increase for slow connections or exotic symbols.</li> <li>Idempotent: Safe to call multiple times. Won't fail if symbol already selected.</li> <li>Used internally: Many other sugar methods call this automatically (e.g., <code>PlaceMarket</code>, <code>GetSymbolSnapshot</code>).</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method combines two low-level calls:</p> <pre><code>// Step 1: Select symbol (make it visible in MarketWatch)\nawait svc.SymbolSelectAsync(symbol, selected: true, deadline, ct);\n\n// Step 2: Check if symbol is synchronized with server\nvar sync = await svc.SymbolIsSynchronizedAsync(symbol, deadline, ct);\n\n// Step 3: Throw exception if not synchronized\nif (!sync)\n    throw new InvalidOperationException($\"Symbol '{symbol}' is not synchronized in terminal.\");\n</code></pre> <p>What it improves:</p> <ul> <li>Combines 2 calls into 1 - simpler API</li> <li>Automatic validation - throws if symbol not ready</li> <li>Shared deadline - both calls use same timeout</li> <li>Clear error message - tells you exactly what's wrong</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar (manual approach): <pre><code>// You have to do this manually:\nvar deadline = DateTime.UtcNow.AddSeconds(10);\n\n// Step 1: Select symbol\nawait svc.SymbolSelectAsync(\"EURUSD\", selected: true, deadline, ct);\n\n// Step 2: Check synchronization\nvar sync = await svc.SymbolIsSynchronizedAsync(\"EURUSD\", deadline, ct);\n\n// Step 3: Validate manually\nif (!sync)\n{\n    throw new InvalidOperationException(\"Symbol 'EURUSD' is not synchronized in terminal.\");\n}\n\n// Now you can use the symbol\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\", deadline, ct);\n</code></pre></p> <p>WITH sugar (one-liner): <pre><code>// Sugar method does all of the above:\nawait svc.EnsureSelected(\"EURUSD\");\n\n// Now you can use the symbol\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\", ...);\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 3 lines \u2192 1 line</li> <li>\u2705 Automatic deadline management</li> <li>\u2705 Automatic validation</li> <li>\u2705 Clearer intent</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#1-basic-usage-ensure-symbol-ready","title":"1) Basic usage - ensure symbol ready","text":"<pre><code>// svc \u2014 MT5Service instance\n\nawait svc.EnsureSelected(\"EURUSD\");\n\n// Now safe to use symbol\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\nConsole.WriteLine($\"EURUSD Bid: {tick.Bid}\");\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#2-with-custom-timeout","title":"2) With custom timeout","text":"<pre><code>// Use longer timeout for slow connection\nawait svc.EnsureSelected(\"BTCUSD\", timeoutSec: 30);\n\nConsole.WriteLine(\"BTCUSD is ready\");\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#3-with-error-handling","title":"3) With error handling","text":"<pre><code>var symbol = \"XAUUSD\";\n\ntry\n{\n    await svc.EnsureSelected(symbol);\n    Console.WriteLine($\"\u2713 {symbol} is ready\");\n}\ncatch (InvalidOperationException ex)\n{\n    Console.WriteLine($\"\u2717 Failed to synchronize {symbol}: {ex.Message}\");\n    return;\n}\n\n// Safe to proceed with symbol operations\nvar spread = await svc.GetSpreadPointsAsync(symbol);\nConsole.WriteLine($\"Spread: {spread} points\");\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#4-ensure-multiple-symbols-before-trading","title":"4) Ensure multiple symbols before trading","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\n\nforeach (var symbol in symbols)\n{\n    try\n    {\n        await svc.EnsureSelected(symbol);\n        Console.WriteLine($\"\u2713 {symbol} ready\");\n    }\n    catch (InvalidOperationException)\n    {\n        Console.WriteLine($\"\u2717 {symbol} not available\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#5-before-placing-order","title":"5) Before placing order","text":"<pre><code>var symbol = \"EURUSD\";\n\n// Ensure symbol ready first\nawait svc.EnsureSelected(symbol);\n\n// Now safe to place order\nvar result = await svc.BuyMarket(\n    symbol: symbol,\n    volume: 0.01,\n    sl: 1.0800,\n    tp: 1.0900\n);\n\nConsole.WriteLine($\"Order placed: #{result.Order}\");\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#6-before-accessing-marketbook-dom","title":"6) Before accessing MarketBook (DOM)","text":"<pre><code>var symbol = \"BTCUSD\";\n\n// Must ensure symbol ready before DOM subscription\nawait svc.EnsureSelected(symbol, timeoutSec: 15);\n\n// Now can subscribe to DOM\nvar subResult = await svc.MarketBookAddAsync(symbol);\n\nif (subResult.OpenedSuccessfully)\n{\n    Console.WriteLine($\"DOM subscription opened for {symbol}\");\n}\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#7-parallel-symbol-preparation","title":"7) Parallel symbol preparation","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\n\n// Prepare all symbols in parallel\nvar tasks = symbols.Select(symbol =&gt;\n    svc.EnsureSelected(symbol).ContinueWith(t =&gt;\n        new { Symbol = symbol, Success = !t.IsFaulted }\n    )\n);\n\nvar results = await Task.WhenAll(tasks);\n\nforeach (var result in results)\n{\n    var status = result.Success ? \"\u2713 Ready\" : \"\u2717 Failed\";\n    Console.WriteLine($\"{result.Symbol}: {status}\");\n}\n\nvar readySymbols = results.Where(r =&gt; r.Success).Select(r =&gt; r.Symbol).ToList();\nConsole.WriteLine($\"\\n{readySymbols.Count} symbols ready for trading\");\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#8-with-cancellation-token","title":"8) With cancellation token","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(5)); // Cancel after 5 seconds\n\ntry\n{\n    await svc.EnsureSelected(\"EURUSD\", timeoutSec: 10, ct: cts.Token);\n    Console.WriteLine(\"Symbol ready\");\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Operation cancelled (timeout)\");\n}\ncatch (InvalidOperationException ex)\n{\n    Console.WriteLine($\"Synchronization failed: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#9-retry-pattern-for-unreliable-symbols","title":"9) Retry pattern for unreliable symbols","text":"<pre><code>var symbol = \"EXOTIC_PAIR\";\nint maxRetries = 3;\nint retryCount = 0;\nbool success = false;\n\nwhile (retryCount &lt; maxRetries &amp;&amp; !success)\n{\n    try\n    {\n        await svc.EnsureSelected(symbol, timeoutSec: 15);\n        success = true;\n        Console.WriteLine($\"\u2713 {symbol} ready after {retryCount + 1} attempt(s)\");\n    }\n    catch (InvalidOperationException)\n    {\n        retryCount++;\n        Console.WriteLine($\"Retry {retryCount}/{maxRetries}...\");\n        await Task.Delay(2000); // Wait 2 seconds before retry\n    }\n}\n\nif (!success)\n{\n    Console.WriteLine($\"\u2717 Failed to prepare {symbol} after {maxRetries} attempts\");\n}\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#10-integration-with-strategy-initialization","title":"10) Integration with strategy initialization","text":"<pre><code>public class TradingStrategy\n{\n    private readonly MT5Service _svc;\n    private readonly string[] _symbols;\n\n    public TradingStrategy(MT5Service svc, string[] symbols)\n    {\n        _svc = svc;\n        _symbols = symbols;\n    }\n\n    public async Task InitializeAsync()\n    {\n        Console.WriteLine(\"Initializing strategy...\");\n\n        // Ensure all symbols ready\n        foreach (var symbol in _symbols)\n        {\n            await _svc.EnsureSelected(symbol, timeoutSec: 20);\n            Console.WriteLine($\"  \u2713 {symbol} ready\");\n        }\n\n        Console.WriteLine(\"Strategy initialized successfully\");\n    }\n\n    public async Task ExecuteAsync()\n    {\n        // All symbols guaranteed to be ready here\n        foreach (var symbol in _symbols)\n        {\n            var tick = await _svc.SymbolInfoTickAsync(symbol);\n            Console.WriteLine($\"{symbol}: Bid={tick.Bid}\");\n        }\n    }\n}\n\n// Usage\nvar strategy = new TradingStrategy(svc, new[] { \"EURUSD\", \"GBPUSD\" });\nawait strategy.InitializeAsync();\nawait strategy.ExecuteAsync();\n</code></pre>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>SymbolSelectAsync()</code> - Select/deselect symbol in MarketWatch (step 1)</li> <li><code>SymbolIsSynchronizedAsync()</code> - Check if symbol synchronized with server (step 2)</li> </ul> <p>\ud83c\udf6c Sugar methods that use <code>EnsureSelected</code> internally:</p> <ul> <li><code>GetSymbolSnapshot()</code> - Calls this before getting symbol data</li> <li><code>PlaceMarket()</code> / <code>BuyMarket()</code> / <code>SellMarket()</code> - Ensures symbol ready before placing order</li> <li><code>PlacePending()</code> - Ensures symbol ready before placing pending order</li> <li>All <code>*LimitPoints()</code> and <code>*StopPoints()</code> methods - Ensure symbol ready first</li> <li>All <code>*ByRisk()</code> methods - Ensure symbol ready before calculating volume</li> <li><code>NormalizePriceAsync()</code> / <code>NormalizeVolumeAsync()</code> - Can optionally call this first</li> </ul>"},{"location":"MT5Sugar/1.%20Infrastructure/EnsureSelected/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Symbol doesn't exist on broker: <pre><code>// Will throw InvalidOperationException\nawait svc.EnsureSelected(\"NONEXISTENT_SYMBOL\");\n</code></pre></p> </li> <li> <p>Symbol exists but not tradeable: <pre><code>// May fail if symbol is not synchronized (e.g., closed market hours)\nawait svc.EnsureSelected(\"SYMBOL\");\n</code></pre></p> </li> <li> <p>Too short timeout: <pre><code>// May fail on slow connection\nawait svc.EnsureSelected(\"SYMBOL\", timeoutSec: 1);\n</code></pre></p> </li> </ol> <p>Solution: Use reasonable timeout (10-30 seconds) and handle exceptions properly.</p>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/","title":"Buy Market by Risk (<code>BuyMarketByRisk</code>) \u2b50","text":"<p>\u2b50 CRITICAL PROFESSIONAL METHOD: Opens Buy market position with auto-calculated volume based on fixed dollar risk. The HOLY GRAIL of risk management!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.BuyMarketByRisk(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [10] MARKET BY RISK \u2b50</li> <li>Underlying calls: <code>CalcVolumeForRiskAsync()</code> + <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code> + <code>PlaceMarket()</code></li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; BuyMarketByRisk(\n    this MT5Service svc,\n    string symbol,\n    double stopPoints,\n    double riskMoney,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 20,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>stopPoints</code> <code>double</code> Stop-loss distance in points from entry <code>riskMoney</code> <code>double</code> Maximum amount to risk in account currency (e.g., $100) <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points from entry <code>comment</code> <code>string?</code> Optional order comment <code>deviationPoints</code> <code>int</code> Maximum price slippage in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 20) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details <p>Key fields:</p> <ul> <li><code>Order</code> - Order ticket number (ulong)</li> <li><code>ReturnedCode</code> - MT5 return code (10009 = success)</li> <li><code>Comment</code> - Server response comment</li> <li><code>Volume</code> - Auto-calculated volume used for the trade</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: The ULTIMATE risk management method - you specify how much $ to risk, method calculates volume automatically!</li> <li>Why you need it: Consistent risk per trade = professional money management. No more guessing lot sizes!</li> <li>Sanity check: Risk $100 with 50-point SL \u2192 method calculates exact volume \u2192 opens Buy position at market price.</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Professional trading - Every institutional trader uses fixed dollar risk</li> <li>Consistent risk management - 1-2% account risk per trade</li> <li>Eliminating calculation errors - No manual volume math</li> <li>Portfolio consistency - Same risk across different symbols/strategies</li> <li>Backtesting alignment - Match live trading with backtest logic</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Ensure symbol is selected in MarketWatch\nawait svc.EnsureSelected(symbol, timeoutSec, ct);\n\n// Step 2: Calculate volume based on risk (MOST CRITICAL STEP)\nvar vol = await svc.CalcVolumeForRiskAsync(symbol, stopPoints, riskMoney, timeoutSec, ct);\n// Example: $100 risk / 50pts SL on EURUSD \u2192 vol = 0.2 lots\n\n// Step 3: Get current tick and point size\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 4: Calculate SL/TP prices (from current Bid for Buy)\ndouble sl = tick.Bid - stopPoints * point;  // SL below Bid\ndouble tp = tpPoints.HasValue ? tick.Ask + tpPoints.Value * point : 0;  // TP above Ask\n\n// Step 5: Normalize prices to tick size\nsl = sl &gt; 0 ? await svc.NormalizePriceAsync(symbol, sl, timeoutSec, ct) : 0;\ntp = tp &gt; 0 ? await svc.NormalizePriceAsync(symbol, tp, timeoutSec, ct) : 0;\n\n// Step 6: Place market Buy order with calculated volume\nreturn await svc.PlaceMarket(symbol, vol, isBuy: true, sl, tp, comment, deviationPoints, timeoutSec, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Eliminates manual volume calculation - no spreadsheets needed</li> <li>Guarantees fixed dollar risk - always risk exactly what you specify</li> <li>Works across all symbols - EURUSD, XAUUSD, indices, crypto - same API</li> <li>Handles broker constraints - auto-normalizes volume to min/max/step</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-1-basic-buy-with-100-risk","title":"Example 1: Basic Buy with $100 Risk","text":"<pre><code>// Buy EURUSD risking exactly $100 with 50-point SL\nvar result = await svc.BuyMarketByRisk(\n    symbol: \"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100.0);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Buy order opened: Ticket #{result.Order}\");\n    Console.WriteLine($\"   Volume: {result.Volume} lots (auto-calculated)\");\n    Console.WriteLine($\"   Risk: $100 if SL hit\");\n}\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-2-buy-with-sl-and-tp","title":"Example 2: Buy with SL and TP","text":"<pre><code>// Risk $200 with 30-point SL and 90-point TP (1:3 risk-reward)\nvar result = await svc.BuyMarketByRisk(\n    symbol: \"EURUSD\",\n    stopPoints: 30,\n    riskMoney: 200.0,\n    tpPoints: 90);\n\nConsole.WriteLine($\"\u2705 Buy position opened:\");\nConsole.WriteLine($\"   Ticket: #{result.Order}\");\nConsole.WriteLine($\"   Volume: {result.Volume} lots\");\nConsole.WriteLine($\"   Risk: $200 (SL: 30pts)\");\nConsole.WriteLine($\"   Reward: $600 (TP: 90pts) \u2192 1:3 RR\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-3-percentage-based-risk-1-rule","title":"Example 3: Percentage-Based Risk (1% Rule)","text":"<pre><code>// Risk 1% of account balance on each trade\ndouble balance = await svc.AccountInfoDoubleAsync(AccountInfoDoubleProperty.AccountBalance);\ndouble riskPercent = 0.01;  // 1%\ndouble riskMoney = balance * riskPercent;\n\nvar result = await svc.BuyMarketByRisk(\n    \"EURUSD\",\n    stopPoints: 40,\n    riskMoney: riskMoney,\n    tpPoints: 120);\n\nConsole.WriteLine($\"Account balance: ${balance:F2}\");\nConsole.WriteLine($\"Risk per trade: ${riskMoney:F2} (1%)\");\nConsole.WriteLine($\"\u2705 Buy opened: Ticket #{result.Order}\");\nConsole.WriteLine($\"   Volume: {result.Volume} lots\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-4-multi-symbol-trading-with-equal-risk","title":"Example 4: Multi-Symbol Trading with Equal Risk","text":"<pre><code>// Trade multiple symbols with same dollar risk\nstring[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\ndouble fixedRisk = 50.0;  // $50 per trade\ndouble slPoints = 30;\ndouble tpPoints = 90;\n\nforeach (var symbol in symbols)\n{\n    var result = await svc.BuyMarketByRisk(\n        symbol,\n        stopPoints: slPoints,\n        riskMoney: fixedRisk,\n        tpPoints: tpPoints);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 {symbol}: {result.Volume} lots, Ticket #{result.Order}\");\n    }\n}\n\n// Output (volumes auto-adjusted per symbol):\n// \u2705 EURUSD: 0.15 lots, Ticket #12361\n// \u2705 GBPUSD: 0.12 lots, Ticket #12362\n// \u2705 USDJPY: 0.18 lots, Ticket #12363\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-5-atr-based-dynamic-sl-with-fixed-risk","title":"Example 5: ATR-Based Dynamic SL with Fixed Risk","text":"<pre><code>// Use ATR for stop-loss, keep risk constant\ndouble atr = 0.0012;  // ATR for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble atrPoints = atr / point;\n\n// SL = 1.5x ATR, TP = 3x ATR\ndouble slPoints = atrPoints * 1.5;\ndouble tpPoints = atrPoints * 3.0;\ndouble riskMoney = 100.0;\n\nvar result = await svc.BuyMarketByRisk(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskMoney,\n    tpPoints: tpPoints);\n\nConsole.WriteLine($\"\u2705 ATR-based Buy:\");\nConsole.WriteLine($\"   ATR: {atr:F5} ({atrPoints:F0} points)\");\nConsole.WriteLine($\"   SL: {slPoints:F0}pts, TP: {tpPoints:F0}pts\");\nConsole.WriteLine($\"   Volume: {result.Volume} lots (auto-calculated for $100 risk)\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-6-with-order-comment-for-strategy-tracking","title":"Example 6: With Order Comment for Strategy Tracking","text":"<pre><code>// Tag orders with strategy name\nvar result = await svc.BuyMarketByRisk(\n    symbol: \"GBPUSD\",\n    stopPoints: 50,\n    riskMoney: 150.0,\n    tpPoints: 150,\n    comment: \"TrendFollow_v2_LongEntry\");\n\nConsole.WriteLine($\"\u2705 Order #{result.Order}\");\nConsole.WriteLine($\"   Strategy: TrendFollow_v2_LongEntry\");\nConsole.WriteLine($\"   Risk: $150\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-7-error-handling","title":"Example 7: Error Handling","text":"<pre><code>try\n{\n    var result = await svc.BuyMarketByRisk(\n        \"EURUSD\",\n        stopPoints: 50,\n        riskMoney: 100.0,\n        tpPoints: 150);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Success: Ticket #{result.Order}\");\n        Console.WriteLine($\"   Volume: {result.Volume} lots\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n        Console.WriteLine($\"   Return code: {result.ReturnedCode}\");\n    }\n}\ncatch (ArgumentOutOfRangeException ex)\n{\n    Console.WriteLine($\"\u274c Invalid parameters: {ex.Message}\");\n    // stopPoints or riskMoney was &lt;= 0\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-8-risk-2-of-account-with-kelly-criterion-adjustment","title":"Example 8: Risk 2% of Account with Kelly Criterion Adjustment","text":"<pre><code>public async Task&lt;OrderSendData&gt; OpenBuyWithKelly(\n    MT5Service svc,\n    string symbol,\n    double slPoints,\n    double tpPoints)\n{\n    // Get account balance\n    double balance = await svc.AccountInfoDoubleAsync(\n        AccountInfoDoubleProperty.AccountBalance);\n\n    // Kelly Criterion: f* = (bp - q) / b\n    // Simplified: assume 55% win rate, 1:2 RR\n    double winRate = 0.55;\n    double lossRate = 0.45;\n    double riskRewardRatio = tpPoints / slPoints;\n    double kellyPercent = (winRate * riskRewardRatio - lossRate) / riskRewardRatio;\n    kellyPercent = Math.Min(kellyPercent, 0.02);  // Cap at 2%\n\n    double riskMoney = balance * kellyPercent;\n\n    Console.WriteLine($\"Kelly % risk: {kellyPercent * 100:F2}%\");\n    Console.WriteLine($\"Risk amount: ${riskMoney:F2}\");\n\n    return await svc.BuyMarketByRisk(\n        symbol,\n        stopPoints: slPoints,\n        riskMoney: riskMoney,\n        tpPoints: tpPoints);\n}\n\n// Usage:\nvar result = await OpenBuyWithKelly(svc, \"EURUSD\", slPoints: 40, tpPoints: 120);\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-9-portfolio-risk-management-max-5-total-risk","title":"Example 9: Portfolio Risk Management (Max 5% Total Risk)","text":"<pre><code>// Check current portfolio risk before opening new trade\nvar positions = await svc.OpenedOrdersAllAsync();\ndouble totalRisk = 0;\n\n// Calculate total risk from existing positions\nforeach (var pos in positions.Orders)\n{\n    // Simplified: assume $50 risk per position\n    totalRisk += 50.0;\n}\n\ndouble maxPortfolioRisk = 500.0;  // Max $500 across all trades\ndouble remainingRisk = maxPortfolioRisk - totalRisk;\n\nif (remainingRisk &gt;= 100.0)\n{\n    var result = await svc.BuyMarketByRisk(\n        \"EURUSD\",\n        stopPoints: 40,\n        riskMoney: Math.Min(100.0, remainingRisk),\n        tpPoints: 120);\n\n    Console.WriteLine($\"\u2705 New Buy opened with ${100.0:F2} risk\");\n    Console.WriteLine($\"   Total portfolio risk: ${totalRisk + 100.0:F2} / $500\");\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f Portfolio risk limit reached!\");\n    Console.WriteLine($\"   Current risk: ${totalRisk:F2}\");\n    Console.WriteLine($\"   Max allowed: ${maxPortfolioRisk:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#example-10-compare-manual-vs-auto-volume-calculation","title":"Example 10: Compare Manual vs Auto Volume Calculation","text":"<pre><code>// \u274c MANUAL WAY (complex and error-prone):\ndouble slPoints = 50;\ndouble riskMoney = 100.0;\n\nvar point = await svc.SymbolInfoDoubleAsync(\"EURUSD\", SymbolInfoDoubleProperty.SymbolPoint);\nvar (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\nvar lossPerLot = (slPoints * point / tickSize) * tickValue;\nvar volume = riskMoney / lossPerLot;\nvolume = await svc.NormalizeVolumeAsync(\"EURUSD\", volume);\n\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble slPrice = tick.Bid - slPoints * point;\n\nvar resultManual = await svc.PlaceMarket(\"EURUSD\", volume, isBuy: true, slPrice, 0);\n\nConsole.WriteLine($\"Manual way: {resultManual.Order}\");\n\n// \u2705 AUTO WAY (clean and safe):\nvar resultAuto = await svc.BuyMarketByRisk(\n    \"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100.0);\n\nConsole.WriteLine($\"Auto way: {resultAuto.Order}\");\nConsole.WriteLine($\"Volume: {resultAuto.Volume} lots (calculated automatically)\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>CalcVolumeForRiskAsync()</code> \u2b50 - Core volume calculation engine</li> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes SL/TP prices</li> <li><code>PlaceMarket()</code> - Places market order</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>SellMarketByRisk()</code> \u2b50 - Sell version of this method</li> <li><code>CalcVolumeForRiskAsync()</code> - Calculate volume only (no order placement)</li> <li><code>NormalizeVolumeAsync()</code> - Normalize volume to broker constraints</li> <li><code>GetVolumeLimitsAsync()</code> - Get broker volume limits</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>CalcVolumeForRiskAsync()</code> + <code>PlaceMarket()</code> - Two-step manual approach</li> <li>Manual calculation - NOT recommended (error-prone)</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing stopPoints with SL price: <pre><code>// \u274c WRONG: Passing price instead of points\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 1.0850, riskMoney: 100);\n// stopPoints should be DISTANCE, not absolute price!\n\n// \u2705 CORRECT: Use point distance\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);\n</code></pre></p> </li> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points on 5-digit broker\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 5, riskMoney: 100);\n// This is 0.5 pips, not 5 pips!\n\n// \u2705 CORRECT: Convert pips to points\ndouble pips = 5;\ndouble points = pips * 10;  // 1 pip = 10 points on 5-digit\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: points, riskMoney: 100);\n</code></pre></p> </li> <li> <p>Negative or zero risk/stop: <pre><code>// \u274c WRONG: Invalid parameters\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 0, riskMoney: 100);\n// Throws ArgumentOutOfRangeException\n\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: -100);\n// Throws ArgumentOutOfRangeException\n\n// \u2705 CORRECT: Always positive values\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);\n</code></pre></p> </li> <li> <p>Risking too much (no portfolio risk check): <pre><code>// \u274c DANGEROUS: No check on total portfolio risk\nfor (int i = 0; i &lt; 10; i++)\n{\n    await svc.BuyMarketByRisk(\"EURUSD\", 50, 100);  // 10x $100 = $1000 total risk!\n}\n\n// \u2705 BETTER: Limit total portfolio risk\ndouble maxTotalRisk = 500.0;\ndouble currentRisk = 300.0;  // From existing positions\ndouble newRisk = Math.Min(100.0, maxTotalRisk - currentRisk);\n\nif (newRisk &gt; 0)\n{\n    await svc.BuyMarketByRisk(\"EURUSD\", 50, newRisk);\n}\n</code></pre></p> </li> <li> <p>Not handling very small calculated volumes: <pre><code>// \u26a0\ufe0f With very small risk or large SL, volume might be below broker minimum\nvar result = await svc.BuyMarketByRisk(\n    \"EURUSD\",\n    stopPoints: 500,   // Large SL\n    riskMoney: 1.0);   // Small risk\n// Calculated volume might be 0.001 lots, but broker min is 0.01!\n\n// Method handles this via NormalizeVolumeAsync, but be aware:\n// Actual risk will be higher than specified if volume gets rounded up!\n</code></pre></p> </li> <li> <p>Forgetting account currency matters: <pre><code>// \u26a0\ufe0f riskMoney is in ACCOUNT CURRENCY\n// If account is in EUR, riskMoney: 100 means 100 EUR, not 100 USD\n\n// Get account currency first if needed:\nvar currency = await svc.AccountInfoStringAsync(\n    AccountInfoStringProperty.AccountCurrency);\nConsole.WriteLine($\"Account currency: {currency}\");\n\n// Then risk in that currency\nawait svc.BuyMarketByRisk(\"EURUSD\", 50, riskMoney: 100.0);  // 100 in account currency\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/10.%20Market_ByRisk/BuyMarketByRisk/#summary","title":"\ud83d\udca1 Summary","text":"<p>BuyMarketByRisk is THE professional's choice for risk-managed trading:</p> <ul> <li>\u2705 Auto-calculates volume based on fixed dollar risk</li> <li>\u2705 Guarantees consistent risk across all trades</li> <li>\u2705 Eliminates manual volume calculation errors</li> <li>\u2705 Works across all symbols and account sizes</li> <li>\u2705 Combines CalcVolumeForRiskAsync + PlaceMarket in one call</li> </ul> <pre><code>// Instead of guessing volumes:\nawait svc.PlaceMarket(\"EURUSD\", 0.1, isBuy: true);  // \u274c How much risk is this?\n\n// Specify EXACT risk amount:\nawait svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);  // \u2705 Exactly $100 risk!\n</code></pre> <p>This is how professionals trade. Use it on EVERY trade! \ud83d\ude80\u2b50</p>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/","title":"Sell Market by Risk (<code>SellMarketByRisk</code>) \u2b50","text":"<p>\u2b50 CRITICAL PROFESSIONAL METHOD: Opens Sell market position with auto-calculated volume based on fixed dollar risk. Professional short trading made simple!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.SellMarketByRisk(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [10] MARKET BY RISK \u2b50</li> <li>Underlying calls: <code>CalcVolumeForRiskAsync()</code> + <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code> + <code>PlaceMarket()</code></li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SellMarketByRisk(\n    this MT5Service svc,\n    string symbol,\n    double stopPoints,\n    double riskMoney,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 20,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>stopPoints</code> <code>double</code> Stop-loss distance in points from entry <code>riskMoney</code> <code>double</code> Maximum amount to risk in account currency (e.g., $100) <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points from entry <code>comment</code> <code>string?</code> Optional order comment <code>deviationPoints</code> <code>int</code> Maximum price slippage in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 20) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details <p>Key fields:</p> <ul> <li><code>Order</code> - Order ticket number (ulong)</li> <li><code>ReturnedCode</code> - MT5 return code (10009 = success)</li> <li><code>Comment</code> - Server response comment</li> <li><code>Volume</code> - Auto-calculated volume used for the trade</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: The ULTIMATE risk management method for SHORT trades - you specify how much $ to risk, method calculates volume automatically!</li> <li>Why you need it: Consistent risk per trade = professional money management. No more guessing lot sizes for short positions!</li> <li>Sanity check: Risk $100 with 50-point SL \u2192 method calculates exact volume \u2192 opens Sell position at market price.</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Professional short trading - Same risk management for longs and shorts</li> <li>Consistent risk management - 1-2% account risk per trade</li> <li>Eliminating calculation errors - No manual volume math</li> <li>Portfolio consistency - Same risk across different symbols/strategies</li> <li>Downtrend trading - Professional entries on bearish setups</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Ensure symbol is selected in MarketWatch\nawait svc.EnsureSelected(symbol, timeoutSec, ct);\n\n// Step 2: Calculate volume based on risk (MOST CRITICAL STEP)\nvar vol = await svc.CalcVolumeForRiskAsync(symbol, stopPoints, riskMoney, timeoutSec, ct);\n// Example: $100 risk / 50pts SL on EURUSD \u2192 vol = 0.2 lots\n\n// Step 3: Get current tick and point size\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 4: Calculate SL/TP prices (from current Ask for Sell)\ndouble sl = tick.Ask + stopPoints * point;  // SL above Ask\ndouble tp = tpPoints.HasValue ? tick.Bid - tpPoints.Value * point : 0;  // TP below Bid\n\n// Step 5: Normalize prices to tick size\nsl = sl &gt; 0 ? await svc.NormalizePriceAsync(symbol, sl, timeoutSec, ct) : 0;\ntp = tp &gt; 0 ? await svc.NormalizePriceAsync(symbol, tp, timeoutSec, ct) : 0;\n\n// Step 6: Place market Sell order with calculated volume\nreturn await svc.PlaceMarket(symbol, vol, isBuy: false, sl, tp, comment, deviationPoints, timeoutSec, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Eliminates manual volume calculation - no spreadsheets needed</li> <li>Guarantees fixed dollar risk - always risk exactly what you specify</li> <li>Works across all symbols - EURUSD, XAUUSD, indices, crypto - same API</li> <li>Handles broker constraints - auto-normalizes volume to min/max/step</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-1-basic-sell-with-100-risk","title":"Example 1: Basic Sell with $100 Risk","text":"<pre><code>// Sell EURUSD risking exactly $100 with 50-point SL\nvar result = await svc.SellMarketByRisk(\n    symbol: \"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100.0);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Sell order opened: Ticket #{result.Order}\");\n    Console.WriteLine($\"   Volume: {result.Volume} lots (auto-calculated)\");\n    Console.WriteLine($\"   Risk: $100 if SL hit\");\n}\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-2-sell-with-sl-and-tp","title":"Example 2: Sell with SL and TP","text":"<pre><code>// Risk $200 with 30-point SL and 90-point TP (1:3 risk-reward)\nvar result = await svc.SellMarketByRisk(\n    symbol: \"EURUSD\",\n    stopPoints: 30,\n    riskMoney: 200.0,\n    tpPoints: 90);\n\nConsole.WriteLine($\"\u2705 Sell position opened:\");\nConsole.WriteLine($\"   Ticket: #{result.Order}\");\nConsole.WriteLine($\"   Volume: {result.Volume} lots\");\nConsole.WriteLine($\"   Risk: $200 (SL: 30pts)\");\nConsole.WriteLine($\"   Reward: $600 (TP: 90pts) \u2192 1:3 RR\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-3-percentage-based-risk-1-rule","title":"Example 3: Percentage-Based Risk (1% Rule)","text":"<pre><code>// Risk 1% of account balance on each trade\ndouble balance = await svc.AccountInfoDoubleAsync(AccountInfoDoubleProperty.AccountBalance);\ndouble riskPercent = 0.01;  // 1%\ndouble riskMoney = balance * riskPercent;\n\nvar result = await svc.SellMarketByRisk(\n    \"EURUSD\",\n    stopPoints: 40,\n    riskMoney: riskMoney,\n    tpPoints: 120);\n\nConsole.WriteLine($\"Account balance: ${balance:F2}\");\nConsole.WriteLine($\"Risk per trade: ${riskMoney:F2} (1%)\");\nConsole.WriteLine($\"\u2705 Sell opened: Ticket #{result.Order}\");\nConsole.WriteLine($\"   Volume: {result.Volume} lots\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-4-multi-symbol-short-portfolio","title":"Example 4: Multi-Symbol Short Portfolio","text":"<pre><code>// Short multiple symbols with same dollar risk\nstring[] symbols = { \"EURUSD\", \"GBPUSD\", \"AUDUSD\" };\ndouble fixedRisk = 50.0;  // $50 per trade\ndouble slPoints = 30;\ndouble tpPoints = 90;\n\nforeach (var symbol in symbols)\n{\n    var result = await svc.SellMarketByRisk(\n        symbol,\n        stopPoints: slPoints,\n        riskMoney: fixedRisk,\n        tpPoints: tpPoints);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 {symbol}: {result.Volume} lots, Ticket #{result.Order}\");\n    }\n}\n\n// Output (volumes auto-adjusted per symbol):\n// \u2705 EURUSD: 0.15 lots, Ticket #12364\n// \u2705 GBPUSD: 0.12 lots, Ticket #12365\n// \u2705 AUDUSD: 0.18 lots, Ticket #12366\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-5-atr-based-dynamic-sl-with-fixed-risk","title":"Example 5: ATR-Based Dynamic SL with Fixed Risk","text":"<pre><code>// Use ATR for stop-loss, keep risk constant\ndouble atr = 0.0012;  // ATR for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble atrPoints = atr / point;\n\n// SL = 1.5x ATR, TP = 3x ATR\ndouble slPoints = atrPoints * 1.5;\ndouble tpPoints = atrPoints * 3.0;\ndouble riskMoney = 100.0;\n\nvar result = await svc.SellMarketByRisk(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskMoney,\n    tpPoints: tpPoints);\n\nConsole.WriteLine($\"\u2705 ATR-based Sell:\");\nConsole.WriteLine($\"   ATR: {atr:F5} ({atrPoints:F0} points)\");\nConsole.WriteLine($\"   SL: {slPoints:F0}pts, TP: {tpPoints:F0}pts\");\nConsole.WriteLine($\"   Volume: {result.Volume} lots (auto-calculated for $100 risk)\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-6-with-order-comment-for-strategy-tracking","title":"Example 6: With Order Comment for Strategy Tracking","text":"<pre><code>// Tag orders with strategy name\nvar result = await svc.SellMarketByRisk(\n    symbol: \"GBPUSD\",\n    stopPoints: 50,\n    riskMoney: 150.0,\n    tpPoints: 150,\n    comment: \"TrendFollow_v2_ShortEntry\");\n\nConsole.WriteLine($\"\u2705 Order #{result.Order}\");\nConsole.WriteLine($\"   Strategy: TrendFollow_v2_ShortEntry\");\nConsole.WriteLine($\"   Risk: $150\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-7-error-handling","title":"Example 7: Error Handling","text":"<pre><code>try\n{\n    var result = await svc.SellMarketByRisk(\n        \"EURUSD\",\n        stopPoints: 50,\n        riskMoney: 100.0,\n        tpPoints: 150);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Success: Ticket #{result.Order}\");\n        Console.WriteLine($\"   Volume: {result.Volume} lots\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n        Console.WriteLine($\"   Return code: {result.ReturnedCode}\");\n    }\n}\ncatch (ArgumentOutOfRangeException ex)\n{\n    Console.WriteLine($\"\u274c Invalid parameters: {ex.Message}\");\n    // stopPoints or riskMoney was &lt;= 0\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-8-resistance-rejection-strategy","title":"Example 8: Resistance Rejection Strategy","text":"<pre><code>public async Task&lt;OrderSendData&gt; SellAtResistance(\n    MT5Service svc,\n    string symbol,\n    double resistanceLevel)\n{\n    // Check if price is near resistance\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    double distancePoints = Math.Abs(tick.Bid - resistanceLevel) / point;\n\n    if (distancePoints &lt;= 10)  // Within 10 points of resistance\n    {\n        Console.WriteLine($\"\u2705 Price near resistance {resistanceLevel:F5}\");\n        Console.WriteLine($\"   Entering short with $100 risk\");\n\n        return await svc.SellMarketByRisk(\n            symbol,\n            stopPoints: 40,      // SL above resistance\n            riskMoney: 100.0,\n            tpPoints: 120,       // 1:3 RR\n            comment: $\"ResistanceReject_{resistanceLevel}\");\n    }\n    else\n    {\n        throw new InvalidOperationException(\n            $\"Price too far from resistance: {distancePoints:F0} points\");\n    }\n}\n\n// Usage:\nvar result = await SellAtResistance(svc, \"EURUSD\", resistanceLevel: 1.0950);\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-9-portfolio-risk-management-max-5-total-risk","title":"Example 9: Portfolio Risk Management (Max 5% Total Risk)","text":"<pre><code>// Check current portfolio risk before opening new trade\nvar positions = await svc.OpenedOrdersAllAsync();\ndouble totalRisk = 0;\n\n// Calculate total risk from existing positions\nforeach (var pos in positions.Orders)\n{\n    // Simplified: assume $50 risk per position\n    totalRisk += 50.0;\n}\n\ndouble maxPortfolioRisk = 500.0;  // Max $500 across all trades\ndouble remainingRisk = maxPortfolioRisk - totalRisk;\n\nif (remainingRisk &gt;= 100.0)\n{\n    var result = await svc.SellMarketByRisk(\n        \"EURUSD\",\n        stopPoints: 40,\n        riskMoney: Math.Min(100.0, remainingRisk),\n        tpPoints: 120);\n\n    Console.WriteLine($\"\u2705 New Sell opened with ${100.0:F2} risk\");\n    Console.WriteLine($\"   Total portfolio risk: ${totalRisk + 100.0:F2} / $500\");\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f Portfolio risk limit reached!\");\n    Console.WriteLine($\"   Current risk: ${totalRisk:F2}\");\n    Console.WriteLine($\"   Max allowed: ${maxPortfolioRisk:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#example-10-longshort-pair-trading-with-equal-risk","title":"Example 10: Long/Short Pair Trading with Equal Risk","text":"<pre><code>// Pairs trading: Buy weak, Sell strong (equal risk on both sides)\ndouble riskPerSide = 50.0;\ndouble slPoints = 30;\ndouble tpPoints = 90;\n\n// Sell the strong currency (EURUSD)\nvar sellResult = await svc.SellMarketByRisk(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskPerSide,\n    tpPoints: tpPoints,\n    comment: \"PairTrade_SellStrong\");\n\n// Buy the weak currency (GBPUSD)\nvar buyResult = await svc.BuyMarketByRisk(\n    \"GBPUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskPerSide,\n    tpPoints: tpPoints,\n    comment: \"PairTrade_BuyWeak\");\n\nConsole.WriteLine($\"\u2705 Pair trade opened:\");\nConsole.WriteLine($\"   SELL EURUSD: {sellResult.Volume} lots, Ticket #{sellResult.Order}\");\nConsole.WriteLine($\"   BUY GBPUSD: {buyResult.Volume} lots, Ticket #{buyResult.Order}\");\nConsole.WriteLine($\"   Total risk: ${riskPerSide * 2:F2}\");\n</code></pre>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>CalcVolumeForRiskAsync()</code> \u2b50 - Core volume calculation engine</li> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes SL/TP prices</li> <li><code>PlaceMarket()</code> - Places market order</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>BuyMarketByRisk()</code> \u2b50 - Buy version of this method</li> <li><code>CalcVolumeForRiskAsync()</code> - Calculate volume only (no order placement)</li> <li><code>NormalizeVolumeAsync()</code> - Normalize volume to broker constraints</li> <li><code>GetVolumeLimitsAsync()</code> - Get broker volume limits</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>CalcVolumeForRiskAsync()</code> + <code>PlaceMarket()</code> - Two-step manual approach</li> <li>Manual calculation - NOT recommended (error-prone)</li> </ul>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing stopPoints with SL price: <pre><code>// \u274c WRONG: Passing price instead of points\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 1.0950, riskMoney: 100);\n// stopPoints should be DISTANCE, not absolute price!\n\n// \u2705 CORRECT: Use point distance\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);\n</code></pre></p> </li> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points on 5-digit broker\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 5, riskMoney: 100);\n// This is 0.5 pips, not 5 pips!\n\n// \u2705 CORRECT: Convert pips to points\ndouble pips = 5;\ndouble points = pips * 10;  // 1 pip = 10 points on 5-digit\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: points, riskMoney: 100);\n</code></pre></p> </li> <li> <p>Negative or zero risk/stop: <pre><code>// \u274c WRONG: Invalid parameters\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 0, riskMoney: 100);\n// Throws ArgumentOutOfRangeException\n\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: -100);\n// Throws ArgumentOutOfRangeException\n\n// \u2705 CORRECT: Always positive values\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);\n</code></pre></p> </li> <li> <p>Risking too much (no portfolio risk check): <pre><code>// \u274c DANGEROUS: No check on total portfolio risk\nfor (int i = 0; i &lt; 10; i++)\n{\n    await svc.SellMarketByRisk(\"EURUSD\", 50, 100);  // 10x $100 = $1000 total risk!\n}\n\n// \u2705 BETTER: Limit total portfolio risk\ndouble maxTotalRisk = 500.0;\ndouble currentRisk = 300.0;  // From existing positions\ndouble newRisk = Math.Min(100.0, maxTotalRisk - currentRisk);\n\nif (newRisk &gt; 0)\n{\n    await svc.SellMarketByRisk(\"EURUSD\", 50, newRisk);\n}\n</code></pre></p> </li> <li> <p>Not handling very small calculated volumes: <pre><code>// \u26a0\ufe0f With very small risk or large SL, volume might be below broker minimum\nvar result = await svc.SellMarketByRisk(\n    \"EURUSD\",\n    stopPoints: 500,   // Large SL\n    riskMoney: 1.0);   // Small risk\n// Calculated volume might be 0.001 lots, but broker min is 0.01!\n\n// Method handles this via NormalizeVolumeAsync, but be aware:\n// Actual risk will be higher than specified if volume gets rounded up!\n</code></pre></p> </li> <li> <p>Forgetting account currency matters: <pre><code>// \u26a0\ufe0f riskMoney is in ACCOUNT CURRENCY\n// If account is in EUR, riskMoney: 100 means 100 EUR, not 100 USD\n\n// Get account currency first if needed:\nvar currency = await svc.AccountInfoStringAsync(\n    AccountInfoStringProperty.AccountCurrency);\nConsole.WriteLine($\"Account currency: {currency}\");\n\n// Then risk in that currency\nawait svc.SellMarketByRisk(\"EURUSD\", 50, riskMoney: 100.0);  // 100 in account currency\n</code></pre></p> </li> <li> <p>SL direction confusion for Sell: <pre><code>// \u26a0\ufe0f For SELL orders, SL is ABOVE entry (not below!)\n// Method handles this correctly automatically\n\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\n// Entry: tick.Bid (e.g., 1.0900)\n// SL: tick.Ask + stopPoints * point (e.g., 1.0950)\n// \u2705 SL is 50 points ABOVE entry (correct for Sell)\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/10.%20Market_ByRisk/SellMarketByRisk/#summary","title":"\ud83d\udca1 Summary","text":"<p>SellMarketByRisk is THE professional's choice for short trading with risk management:</p> <ul> <li>\u2705 Auto-calculates volume based on fixed dollar risk</li> <li>\u2705 Guarantees consistent risk across all trades</li> <li>\u2705 Eliminates manual volume calculation errors</li> <li>\u2705 Works across all symbols and account sizes</li> <li>\u2705 Combines CalcVolumeForRiskAsync + PlaceMarket in one call</li> </ul> <pre><code>// Instead of guessing volumes:\nawait svc.PlaceMarket(\"EURUSD\", 0.1, isBuy: false);  // \u274c How much risk is this?\n\n// Specify EXACT risk amount:\nawait svc.SellMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);  // \u2705 Exactly $100 risk!\n</code></pre> <p>This is how professionals short the market. Use it on EVERY short trade! \ud83d\ude80\u2b50</p>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/","title":"Cancel All Pending Orders (<code>CancelAll</code>)","text":"<p>\u26a0\ufe0f DANGEROUS BULK METHOD: Cancels all pending orders with optional symbol/direction filtering. USE WITH CAUTION!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CancelAll(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [11] BULK CONVENIENCE</li> <li>Underlying calls: <code>OpenedOrdersAsync()</code> + <code>CloseByTicket()</code> (in loop)</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;int&gt; CancelAll(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string?</code> Optional symbol filter. <code>null</code> = cancel ALL symbols \u26a0\ufe0f <code>isBuy</code> <code>bool?</code> Optional direction filter. <code>true</code> = buy orders only, <code>false</code> = sell orders only, <code>null</code> = both <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;int&gt;</code> Number of pending orders successfully cancelled"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Bulk cancellation method - cancels all pending orders (Limit, Stop, StopLimit) matching the filter criteria.</li> <li>Why you need it: Quickly clear all pending orders when market conditions change or trading session ends.</li> <li>\u26a0\ufe0f WARNING: NO confirmation prompt! Cancels immediately. Affects ONLY pending orders, NOT market positions.</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>End-of-day cleanup - Cancel all pending orders before market close</li> <li>Strategy termination - Clear all pending orders when exiting a strategy</li> <li>Market condition change - Remove pending orders when volatility spikes</li> <li>Symbol-specific cleanup - Cancel all pending orders for one symbol</li> <li>Emergency stop - Quickly remove all pending entries</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get all opened orders (both market and pending)\nvar opened = await svc.OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc, deadline, ct);\n\nint cancelled = 0;\n\n// Step 2: Iterate through orders via reflection (proto-agnostic)\nforeach (var order in EnumerateOrders(opened))\n{\n    var typeInt = GetOrderTypeInt(order);\n\n    // Step 3: Skip market positions (only pending orders)\n    if (!IsPendingType(typeInt)) continue;\n    // Pending types: 2-7 (BuyLimit, SellLimit, BuyStop, SellStop, BuyStopLimit, SellStopLimit)\n\n    // Step 4: Apply symbol filter\n    var orderSymbol = order.Symbol;\n    if (symbol != null &amp;&amp; orderSymbol != symbol) continue;\n\n    // Step 5: Apply direction filter\n    bool isOrderBuy = IsBuyType(typeInt);\n    if (isBuy.HasValue &amp;&amp; isOrderBuy != isBuy.Value) continue;\n\n    // Step 6: Cancel the order\n    var ticket = order.Ticket;\n    await svc.CloseByTicket(ticket, null, timeoutSec, ct);\n    cancelled++;\n}\n\nreturn cancelled;\n</code></pre> <p>What it improves:</p> <ul> <li>Batch operation - No manual loop needed</li> <li>Flexible filtering - By symbol, direction, or both</li> <li>Safe targeting - Only pending orders, never market positions</li> <li>Returns count - Know exactly how many orders were cancelled</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-1-cancel-all-pending-orders-dangerous","title":"Example 1: Cancel ALL Pending Orders (\u26a0\ufe0f DANGEROUS)","text":"<pre><code>// \u26a0\ufe0f WARNING: Cancels ALL pending orders across ALL symbols!\nint cancelled = await svc.CancelAll();\n\nConsole.WriteLine($\"\u2705 Cancelled {cancelled} pending orders\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-2-cancel-pending-orders-for-one-symbol","title":"Example 2: Cancel Pending Orders for One Symbol","text":"<pre><code>// Cancel all pending orders for EURUSD only\nint cancelled = await svc.CancelAll(symbol: \"EURUSD\");\n\nConsole.WriteLine($\"\u2705 Cancelled {cancelled} EURUSD pending orders\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-3-cancel-only-buy-pending-orders","title":"Example 3: Cancel Only Buy Pending Orders","text":"<pre><code>// Cancel all Buy Limit and Buy Stop orders (all symbols)\nint cancelled = await svc.CancelAll(isBuy: true);\n\nConsole.WriteLine($\"\u2705 Cancelled {cancelled} buy pending orders\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-4-cancel-specific-symbol-direction","title":"Example 4: Cancel Specific Symbol + Direction","text":"<pre><code>// Cancel only GBPUSD Sell pending orders (Sell Limit + Sell Stop)\nint cancelled = await svc.CancelAll(symbol: \"GBPUSD\", isBuy: false);\n\nConsole.WriteLine($\"\u2705 Cancelled {cancelled} GBPUSD sell pending orders\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-5-end-of-day-cleanup","title":"Example 5: End-of-Day Cleanup","text":"<pre><code>public async Task EndOfDayCleanup(MT5Service svc)\n{\n    Console.WriteLine(\"End of day cleanup...\");\n\n    // Cancel all pending orders\n    int cancelled = await svc.CancelAll();\n\n    Console.WriteLine($\"\u2705 Cancelled {cancelled} pending orders\");\n    Console.WriteLine(\"\u2705 Market positions remain open\");\n    Console.WriteLine(\"\u2705 Cleanup complete\");\n}\n\n// Usage at 16:55 (before market close):\nawait EndOfDayCleanup(svc);\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-6-cancel-with-safety-confirmation","title":"Example 6: Cancel with Safety Confirmation","text":"<pre><code>// Add manual confirmation before cancelling\nConsole.Write(\"Cancel all pending orders? (y/n): \");\nvar input = Console.ReadLine();\n\nif (input?.ToLower() == \"y\")\n{\n    int cancelled = await svc.CancelAll();\n    Console.WriteLine($\"\u2705 Cancelled {cancelled} pending orders\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c Cancelled operation aborted\");\n}\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-7-count-before-cancel","title":"Example 7: Count Before Cancel","text":"<pre><code>// Check how many orders will be cancelled before doing it\nvar opened = await svc.OpenedOrdersAllAsync();\nint pendingCount = opened.Orders\n    .Count(o =&gt; o.Type != ENUM_ORDER_TYPE.OrderTypeBuy &amp;&amp;\n                o.Type != ENUM_ORDER_TYPE.OrderTypeSell);\n\nConsole.WriteLine($\"Found {pendingCount} pending orders\");\nConsole.Write(\"Cancel all? (y/n): \");\n\nif (Console.ReadLine()?.ToLower() == \"y\")\n{\n    int cancelled = await svc.CancelAll();\n    Console.WriteLine($\"\u2705 Cancelled {cancelled} orders\");\n}\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    int cancelled = await svc.CancelAll(symbol: \"EURUSD\");\n\n    if (cancelled &gt; 0)\n    {\n        Console.WriteLine($\"\u2705 Cancelled {cancelled} EURUSD pending orders\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u2139\ufe0f No pending orders to cancel for EURUSD\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Error cancelling orders: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-9-cancel-by-strategy-using-comment-filter","title":"Example 9: Cancel by Strategy (Using Comment Filter)","text":"<pre><code>// NOTE: CancelAll doesn't filter by comment, so we implement custom logic\npublic async Task&lt;int&gt; CancelByStrategy(\n    MT5Service svc,\n    string strategyName)\n{\n    var opened = await svc.OpenedOrdersAllAsync();\n    int cancelled = 0;\n\n    foreach (var order in opened.Orders)\n    {\n        // Skip market positions\n        if (order.Type == ENUM_ORDER_TYPE.OrderTypeBuy ||\n            order.Type == ENUM_ORDER_TYPE.OrderTypeSell)\n            continue;\n\n        // Check comment matches strategy\n        if (order.Comment?.Contains(strategyName) == true)\n        {\n            await svc.CloseByTicket(order.Ticket);\n            cancelled++;\n        }\n    }\n\n    Console.WriteLine($\"\u2705 Cancelled {cancelled} orders for strategy '{strategyName}'\");\n    return cancelled;\n}\n\n// Usage:\nawait CancelByStrategy(svc, \"GridTrading_v2\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#example-10-volatility-spike-cleanup","title":"Example 10: Volatility Spike Cleanup","text":"<pre><code>public async Task HandleVolatilitySpike(MT5Service svc, string symbol)\n{\n    // Measure current spread\n    double spread = await svc.GetSpreadPointsAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n    double spreadPips = spread / (point * 10);  // Convert to pips\n\n    if (spreadPips &gt; 5.0)  // Spread &gt; 5 pips = too volatile\n    {\n        Console.WriteLine($\"\u26a0\ufe0f High spread detected: {spreadPips:F1} pips\");\n        Console.WriteLine($\"Cancelling all pending {symbol} orders...\");\n\n        int cancelled = await svc.CancelAll(symbol: symbol);\n\n        Console.WriteLine($\"\u2705 Cancelled {cancelled} pending orders\");\n        Console.WriteLine(\"Waiting for spread to normalize...\");\n    }\n}\n\n// Usage:\nawait HandleVolatilitySpike(svc, \"GBPUSD\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>OpenedOrdersAsync()</code> - Gets all orders (market + pending)</li> <li><code>CloseByTicket()</code> - Cancels individual order by ticket</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>CloseAllPending()</code> - Alias for CancelAll (same functionality)</li> <li><code>CloseAllPositions()</code> - Closes market positions (NOT pending orders)</li> <li><code>CloseAll()</code> - DIFFERENT METHOD - closes market positions, not from Region 11!</li> </ul> <p>\u26a0\ufe0f CONFUSION WARNING:</p> <ul> <li><code>CancelAll()</code> - Cancels PENDING orders (this method)</li> <li><code>CloseAllPositions()</code> - Closes MARKET positions</li> <li><code>CloseAll()</code> - From Region 06, closes market positions with filters</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing with CloseAllPositions: <pre><code>// \u274c CONFUSION: Different methods!\nawait svc.CancelAll();         // Cancels PENDING orders\nawait svc.CloseAllPositions(); // Closes MARKET positions\n\n// They do DIFFERENT things!\n</code></pre></p> </li> <li> <p>No confirmation prompt: <pre><code>// \u26a0\ufe0f DANGEROUS: Executes immediately!\nawait svc.CancelAll();  // No \"Are you sure?\" prompt!\n\n// \u2705 SAFER: Add manual confirmation\nConsole.Write(\"Cancel all? (y/n): \");\nif (Console.ReadLine()?.ToLower() == \"y\")\n{\n    await svc.CancelAll();\n}\n</code></pre></p> </li> <li> <p>Forgetting symbol parameter = ALL symbols: <pre><code>// \u274c WRONG: Thinking this only cancels EURUSD\nawait svc.CancelAll();  // \u26a0\ufe0f Cancels ALL symbols!\n\n// \u2705 CORRECT: Specify symbol\nawait svc.CancelAll(symbol: \"EURUSD\");\n</code></pre></p> </li> <li> <p>Expecting market positions to close: <pre><code>// \u274c WRONG: CancelAll does NOT close market positions\nawait svc.CancelAll();\n// Your open BUY/SELL positions are still open!\n\n// \u2705 CORRECT: Use CloseAllPositions for market positions\nawait svc.CloseAllPositions();\n</code></pre></p> </li> <li> <p>Not checking return count: <pre><code>// \u274c SUBOPTIMAL: Not checking if anything was cancelled\nawait svc.CancelAll(symbol: \"EURUSD\");\n\n// \u2705 BETTER: Check result\nint cancelled = await svc.CancelAll(symbol: \"EURUSD\");\nif (cancelled == 0)\n{\n    Console.WriteLine(\"\u2139\ufe0f No pending orders to cancel\");\n}\n</code></pre></p> </li> <li> <p>Filter logic confusion: <pre><code>// \u26a0\ufe0f FILTER LOGIC:\n// symbol: null \u2192 ALL symbols\n// isBuy: null \u2192 BOTH buy and sell\n\nawait svc.CancelAll(symbol: null, isBuy: true);\n// Cancels ALL buy pending orders across ALL symbols!\n\nawait svc.CancelAll(symbol: \"EURUSD\", isBuy: null);\n// Cancels BOTH buy and sell pending orders for EURUSD\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CancelAll/#summary","title":"\ud83d\udca1 Summary","text":"<p>CancelAll provides bulk cancellation of pending orders:</p> <ul> <li>\u2705 Cancels all pending orders (Limit, Stop, StopLimit)</li> <li>\u2705 Optional filtering by symbol and direction</li> <li>\u2705 Returns count of cancelled orders</li> <li>\u26a0\ufe0f NO market positions affected (only pending orders)</li> <li>\u26a0\ufe0f NO confirmation prompt (executes immediately)</li> </ul> <pre><code>// Cancel all pending orders for EURUSD:\nint cancelled = await svc.CancelAll(symbol: \"EURUSD\");\n\n// Cancel only sell pending orders:\nint cancelled = await svc.CancelAll(isBuy: false);\n\n// Cancel everything (\u26a0\ufe0f DANGEROUS):\nint cancelled = await svc.CancelAll();\n</code></pre> <p>Use with caution - this is a powerful bulk operation! \u26a0\ufe0f</p>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/","title":"Close All Pending Orders (<code>CloseAllPending</code>)","text":"<p>Alias method: Direct alias for <code>CancelAll()</code>. Cancels all pending orders with optional filtering.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CloseAllPending(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [11] BULK CONVENIENCE</li> <li>Implementation: <code>=&gt; svc.CancelAll(symbol, isBuy, timeoutSec, ct);</code></li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#method-signature","title":"Method Signature","text":"<pre><code>public static Task&lt;int&gt; CloseAllPending(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default)\n    =&gt; svc.CancelAll(symbol, isBuy, timeoutSec, ct);\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Alias for <code>CancelAll()</code> - exact same functionality, just a different method name.</li> <li>Why it exists: Some developers prefer \"close\" terminology for pending orders instead of \"cancel\".</li> <li>Which to use: Personal preference! Both do exactly the same thing.</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Same purposes as <code>CancelAll()</code> - see CancelAll.md for full documentation</li> <li>When you prefer \"close\" terminology over \"cancel\"</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#full-documentation","title":"\ud83d\udd17 Full Documentation","text":"<p>This method is a direct alias for <code>CancelAll()</code>. For complete documentation, including:</p> <ul> <li>Detailed examples</li> <li>Common pitfalls</li> <li>Error handling</li> <li>Usage scenarios</li> </ul> <p>See: CancelAll.md</p>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#quick-reference","title":"\ud83d\udccb Quick Reference","text":"<pre><code>// These are IDENTICAL:\nint result1 = await svc.CancelAll(symbol: \"EURUSD\");\nint result2 = await svc.CloseAllPending(symbol: \"EURUSD\");\n// Both cancel all pending orders for EURUSD\n\n// Internally, CloseAllPending just calls CancelAll:\npublic static Task&lt;int&gt; CloseAllPending(...)\n    =&gt; svc.CancelAll(symbol, isBuy, timeoutSec, ct);\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udd04 Aliases:</p> <ul> <li><code>CancelAll()</code> - Primary method (this is an alias for it)</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>CloseAllPositions()</code> - Closes MARKET positions (different!)</li> <li><code>CloseAll()</code> - From Region 06, closes market positions</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Thinking it's different from CancelAll: <pre><code>// \u274c WRONG: Thinking these are different\nawait svc.CancelAll();       // Cancels pending orders\nawait svc.CloseAllPending(); // \u2190 Does EXACTLY the same thing!\n\n// \u2705 CORRECT: They are aliases\n// Use whichever name you prefer\n</code></pre></p> </li> <li> <p>Confusing with CloseAllPositions: <pre><code>// \u274c CONFUSION: Different targets!\nawait svc.CloseAllPending();    // Cancels PENDING orders\nawait svc.CloseAllPositions();  // Closes MARKET positions\n\n// These affect different order types!\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPending/#summary","title":"\ud83d\udca1 Summary","text":"<p>CloseAllPending is a simple alias for <code>CancelAll()</code>:</p> <ul> <li>\u2705 Exact same functionality as <code>CancelAll()</code></li> <li>\u2705 Just a naming preference</li> <li>\u2705 Use whichever name makes more sense to you</li> </ul> <pre><code>// Both are identical:\nawait svc.CancelAll(symbol: \"EURUSD\");      // Option 1\nawait svc.CloseAllPending(symbol: \"EURUSD\"); // Option 2\n</code></pre> <p>For full documentation, see CancelAll.md \ud83d\udcd6</p>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/","title":"Close All Market Positions (<code>CloseAllPositions</code>)","text":"<p>\u26a0\ufe0f EXTREMELY DANGEROUS BULK METHOD: Closes all open market positions with optional symbol/direction filtering. NUCLEAR OPTION!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CloseAllPositions(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [11] BULK CONVENIENCE</li> <li>Underlying calls: <code>OpenedOrdersAsync()</code> + <code>CloseByTicket()</code> (in loop)</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;int&gt; CloseAllPositions(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string?</code> Optional symbol filter. <code>null</code> = close ALL symbols \u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f <code>isBuy</code> <code>bool?</code> Optional direction filter. <code>true</code> = buy positions only, <code>false</code> = sell positions only, <code>null</code> = both <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;int&gt;</code> Number of market positions successfully closed"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: NUCLEAR OPTION - closes all open market positions (BUY/SELL) matching the filter criteria.</li> <li>Why you need it: Emergency exit, strategy termination, or end-of-day position cleanup.</li> <li>\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f WARNING: NO confirmation prompt! Closes ALL positions immediately. Can realize massive losses if used incorrectly!</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>\ud83d\udea8 EMERGENCY STOP - Flatten all positions immediately (market crash, news event)</li> <li>End-of-day cleanup - Close all positions before market close</li> <li>Strategy termination - Exit all positions when stopping a strategy</li> <li>Symbol-specific exit - Close all positions for one symbol</li> <li>Direction-specific exit - Close all buy OR all sell positions</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get all opened orders (both market and pending)\nvar opened = await svc.OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc, deadline, ct);\n\nint closed = 0;\n\n// Step 2: Iterate through orders via reflection (proto-agnostic)\nforeach (var order in EnumerateOrders(opened))\n{\n    var typeInt = GetOrderTypeInt(order);\n\n    // Step 3: Skip pending orders (only market positions)\n    if (!IsMarketType(typeInt)) continue;\n    // Market types: 0-1 (Buy, Sell)\n\n    // Step 4: Apply symbol filter\n    var orderSymbol = order.Symbol;\n    if (symbol != null &amp;&amp; orderSymbol != symbol) continue;\n\n    // Step 5: Apply direction filter\n    bool isOrderBuy = IsBuyType(typeInt);\n    if (isBuy.HasValue &amp;&amp; isOrderBuy != isBuy.Value) continue;\n\n    // Step 6: Close the position at market price\n    var ticket = order.Ticket;\n    await svc.CloseByTicket(ticket, null, timeoutSec, ct);\n    closed++;\n}\n\nreturn closed;\n</code></pre> <p>What it improves:</p> <ul> <li>Instant liquidation - Close entire portfolio in one call</li> <li>Flexible filtering - By symbol, direction, or both</li> <li>Safe targeting - Only market positions, never pending orders</li> <li>Returns count - Know exactly how many positions were closed</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-1-close-all-positions-nuclear-option","title":"Example 1: Close ALL Positions (\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f NUCLEAR OPTION)","text":"<pre><code>// \u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f EXTREMELY DANGEROUS: Closes ALL positions across ALL symbols!\n// USE ONLY IN EMERGENCY!\nint closed = await svc.CloseAllPositions();\n\nConsole.WriteLine($\"\ud83d\udea8 EMERGENCY EXIT: Closed {closed} positions\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-2-close-all-positions-for-one-symbol","title":"Example 2: Close All Positions for One Symbol","text":"<pre><code>// Close all EURUSD positions (both buy and sell)\nint closed = await svc.CloseAllPositions(symbol: \"EURUSD\");\n\nConsole.WriteLine($\"\u2705 Closed {closed} EURUSD positions\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-3-close-only-buy-positions","title":"Example 3: Close Only Buy Positions","text":"<pre><code>// Close all buy positions across all symbols\nint closed = await svc.CloseAllPositions(isBuy: true);\n\nConsole.WriteLine($\"\u2705 Closed {closed} buy positions\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-4-close-specific-symbol-direction","title":"Example 4: Close Specific Symbol + Direction","text":"<pre><code>// Close only GBPUSD sell positions\nint closed = await svc.CloseAllPositions(symbol: \"GBPUSD\", isBuy: false);\n\nConsole.WriteLine($\"\u2705 Closed {closed} GBPUSD sell positions\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-5-end-of-day-full-exit","title":"Example 5: End-of-Day Full Exit","text":"<pre><code>public async Task EndOfDayFullExit(MT5Service svc)\n{\n    Console.WriteLine(\"\u26a0\ufe0f End of day - closing all positions...\");\n\n    // Close ALL market positions\n    int closedPositions = await svc.CloseAllPositions();\n\n    // Cancel ALL pending orders\n    int cancelledOrders = await svc.CancelAll();\n\n    Console.WriteLine($\"\u2705 Closed {closedPositions} positions\");\n    Console.WriteLine($\"\u2705 Cancelled {cancelledOrders} pending orders\");\n    Console.WriteLine(\"\u2705 Account fully flat\");\n}\n\n// Usage at 16:55 (before market close):\nawait EndOfDayFullExit(svc);\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-6-emergency-stop-with-confirmation","title":"Example 6: Emergency Stop with Confirmation","text":"<pre><code>// Add DOUBLE confirmation for safety\nConsole.WriteLine(\"\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f EMERGENCY STOP - CLOSE ALL POSITIONS \u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f\");\nConsole.Write(\"Are you ABSOLUTELY SURE? Type 'YES' to confirm: \");\nvar input = Console.ReadLine();\n\nif (input == \"YES\")\n{\n    int closed = await svc.CloseAllPositions();\n    Console.WriteLine($\"\ud83d\udea8 EMERGENCY EXIT: Closed {closed} positions\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c Emergency stop aborted\");\n}\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-7-close-losing-positions-only","title":"Example 7: Close Losing Positions Only","text":"<pre><code>// Custom logic: Close only positions with unrealized loss\npublic async Task&lt;int&gt; CloseLosers(MT5Service svc)\n{\n    var positions = await svc.OpenedOrdersAllAsync();\n    int closed = 0;\n\n    foreach (var pos in positions.Orders)\n    {\n        // Skip pending orders\n        if (pos.Type != ENUM_ORDER_TYPE.OrderTypeBuy &amp;&amp;\n            pos.Type != ENUM_ORDER_TYPE.OrderTypeSell)\n            continue;\n\n        // Check if position is losing\n        if (pos.Profit &lt; 0)\n        {\n            await svc.CloseByTicket(pos.Ticket);\n            closed++;\n            Console.WriteLine($\"  Closed losing position #{pos.Ticket}: ${pos.Profit:F2}\");\n        }\n    }\n\n    Console.WriteLine($\"\u2705 Closed {closed} losing positions\");\n    return closed;\n}\n\n// Usage:\nawait CloseLosers(svc);\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    int closed = await svc.CloseAllPositions(symbol: \"EURUSD\");\n\n    if (closed &gt; 0)\n    {\n        Console.WriteLine($\"\u2705 Closed {closed} EURUSD positions\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u2139\ufe0f No open positions to close for EURUSD\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Error closing positions: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-9-news-event-emergency-exit","title":"Example 9: News Event Emergency Exit","text":"<pre><code>public async Task HandleNewsEvent(MT5Service svc, string eventName)\n{\n    Console.WriteLine($\"\u26a0\ufe0f HIGH IMPACT NEWS: {eventName}\");\n    Console.WriteLine(\"\u26a0\ufe0f Closing all positions for safety...\");\n\n    int closed = await svc.CloseAllPositions();\n    int cancelled = await svc.CancelAll();\n\n    Console.WriteLine($\"\u2705 Closed {closed} positions\");\n    Console.WriteLine($\"\u2705 Cancelled {cancelled} pending orders\");\n    Console.WriteLine(\"\u2705 Waiting for news event to pass...\");\n}\n\n// Usage:\nawait HandleNewsEvent(svc, \"NFP - Non-Farm Payrolls\");\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#example-10-close-with-pl-reporting","title":"Example 10: Close with P&amp;L Reporting","text":"<pre><code>public async Task CloseAllWithReport(MT5Service svc)\n{\n    // Get positions before closing\n    var positions = await svc.OpenedOrdersAllAsync();\n    double totalProfit = 0;\n    int count = 0;\n\n    foreach (var pos in positions.Orders)\n    {\n        if (pos.Type == ENUM_ORDER_TYPE.OrderTypeBuy ||\n            pos.Type == ENUM_ORDER_TYPE.OrderTypeSell)\n        {\n            totalProfit += pos.Profit;\n            count++;\n        }\n    }\n\n    Console.WriteLine($\"About to close {count} positions\");\n    Console.WriteLine($\"Current unrealized P&amp;L: ${totalProfit:F2}\");\n    Console.Write(\"Continue? (y/n): \");\n\n    if (Console.ReadLine()?.ToLower() == \"y\")\n    {\n        int closed = await svc.CloseAllPositions();\n        Console.WriteLine($\"\u2705 Closed {closed} positions\");\n        Console.WriteLine($\"\u2705 Realized P&amp;L: ${totalProfit:F2}\");\n    }\n}\n\n// Usage:\nawait CloseAllWithReport(svc);\n</code></pre>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>OpenedOrdersAsync()</code> - Gets all orders (market + pending)</li> <li><code>CloseByTicket()</code> - Closes individual position by ticket</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>CancelAll()</code> - Cancels PENDING orders (NOT market positions!)</li> <li><code>CloseAllPending()</code> - Alias for CancelAll</li> <li><code>CloseAll()</code> - DIFFERENT METHOD from Region 06 (similar functionality)</li> </ul> <p>\u26a0\ufe0f CONFUSION WARNING:</p> <ul> <li><code>CloseAllPositions()</code> - Closes MARKET positions (this method)</li> <li><code>CancelAll()</code> - Cancels PENDING orders</li> <li><code>CloseAll()</code> - From Region 06, also closes market positions</li> </ul>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing with CancelAll: <pre><code>// \u274c CONFUSION: Different methods!\nawait svc.CloseAllPositions(); // Closes MARKET positions\nawait svc.CancelAll();         // Cancels PENDING orders\n\n// They do DIFFERENT things!\n</code></pre></p> </li> <li> <p>No confirmation prompt - instant execution: <pre><code>// \u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f EXTREMELY DANGEROUS: Executes immediately!\nawait svc.CloseAllPositions();  // No \"Are you sure?\" prompt!\n\n// \u2705 SAFER: Add manual confirmation\nConsole.Write(\"Close all positions? Type 'YES': \");\nif (Console.ReadLine() == \"YES\")\n{\n    await svc.CloseAllPositions();\n}\n</code></pre></p> </li> <li> <p>Forgetting symbol parameter = ALL symbols: <pre><code>// \u274c WRONG: Thinking this only closes EURUSD\nawait svc.CloseAllPositions();  // \u26a0\ufe0f Closes ALL symbols!\n\n// \u2705 CORRECT: Specify symbol\nawait svc.CloseAllPositions(symbol: \"EURUSD\");\n</code></pre></p> </li> <li> <p>Expecting pending orders to cancel: <pre><code>// \u274c WRONG: CloseAllPositions does NOT cancel pending orders\nawait svc.CloseAllPositions();\n// Your Buy Limit / Sell Stop orders are still active!\n\n// \u2705 CORRECT: Use CancelAll for pending orders\nawait svc.CancelAll();\n</code></pre></p> </li> <li> <p>Not considering slippage on close: <pre><code>// \u26a0\ufe0f Market orders = slippage possible\n// Closing 100 positions at once might get bad fills!\n\n// Especially dangerous during:\n// - High volatility (news events)\n// - Low liquidity (market open/close)\n// - Large position sizes\n\n// Consider closing incrementally for large portfolios\n</code></pre></p> </li> <li> <p>Not checking P&amp;L before closing: <pre><code>// \u274c DANGEROUS: Closing without knowing current P&amp;L\nawait svc.CloseAllPositions();\n// Might realize huge losses if positions are underwater!\n\n// \u2705 BETTER: Check P&amp;L first\nvar positions = await svc.OpenedOrdersAllAsync();\ndouble totalPL = positions.Orders.Sum(o =&gt; o.Profit);\nConsole.WriteLine($\"Current P&amp;L: ${totalPL:F2}\");\nConsole.Write(\"Close all? (y/n): \");\n</code></pre></p> </li> <li> <p>Filter logic confusion: <pre><code>// \u26a0\ufe0f FILTER LOGIC:\n// symbol: null \u2192 ALL symbols\n// isBuy: null \u2192 BOTH buy and sell\n\nawait svc.CloseAllPositions(symbol: null, isBuy: true);\n// Closes ALL buy positions across ALL symbols!\n\nawait svc.CloseAllPositions(symbol: \"EURUSD\", isBuy: null);\n// Closes BOTH buy and sell positions for EURUSD\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/11.%20Bulk_Convenience/CloseAllPositions/#summary","title":"\ud83d\udca1 Summary","text":"<p>CloseAllPositions provides nuclear-option liquidation of all market positions:</p> <ul> <li>\u2705 Closes all market positions (BUY/SELL)</li> <li>\u2705 Optional filtering by symbol and direction</li> <li>\u2705 Returns count of closed positions</li> <li>\u26a0\ufe0f NO pending orders affected (only market positions)</li> <li>\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f NO confirmation prompt (executes immediately)</li> <li>\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f CAN REALIZE MASSIVE LOSSES if used incorrectly</li> </ul> <pre><code>// Close all positions for EURUSD:\nint closed = await svc.CloseAllPositions(symbol: \"EURUSD\");\n\n// Close only sell positions:\nint closed = await svc.CloseAllPositions(isBuy: false);\n\n// Close EVERYTHING (\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f NUCLEAR OPTION):\nint closed = await svc.CloseAllPositions();\n</code></pre> <p>This is the PANIC BUTTON. Use with EXTREME caution! \ud83d\udea8\u26a0\ufe0f\ud83d\udea8</p>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/","title":"Calculate Liquidity at Level (<code>CalculateLiquidityAtLevelAsync</code>)","text":"<p>Sugar method: Calculates total volume available at specific price level in order book - perfect for large order planning!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CalculateLiquidityAtLevelAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [12] MARKET DEPTH (DOM)</li> <li>Underlying calls: <code>MarketBookGetAsync()</code> + LINQ aggregation</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;long&gt; CalculateLiquidityAtLevelAsync(\n    this MT5Service svc,\n    string symbol,\n    double price,\n    bool isBuy,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol to query (e.g., \"EURUSD\") <code>price</code> <code>double</code> Exact price level to check <code>isBuy</code> <code>bool</code> <code>true</code> = check bid side, <code>false</code> = check ask side <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;long&gt;</code> Total volume (in lots) at the specified price level <p>Returns: 0 if no liquidity at that exact price level</p>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Sums all volume at a specific price level in the order book.</li> <li>Why you need it: Check available liquidity before placing large orders to estimate slippage.</li> <li>Price matching: Uses tolerance of 0.00001 for floating-point comparison.</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get order book snapshot\nvar book = await svc.MarketBookGetAsync(symbol, Dl(timeoutSec), ct);\n\n// Step 2: Determine side (bid or ask)\nvar targetType = isBuy ? BookType.Buy : BookType.Sell;\n\n// Step 3: Sum volumes at matching price level\nreturn book.MqlBookInfos\n    .Where(e =&gt; e.Type == targetType &amp;&amp; Math.Abs(e.Price - price) &lt; 0.00001)\n    .Sum(e =&gt; e.Volume);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto-aggregation - sums all entries at same price</li> <li>Floating-point safe - uses tolerance for price matching</li> <li>Side-specific - separate bid/ask querying</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-1-check-liquidity-at-current-best-bid","title":"Example 1: Check Liquidity at Current Best Bid","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    long bidVolume = await svc.CalculateLiquidityAtLevelAsync(\n        \"EURUSD\",\n        price: bid,\n        isBuy: true);\n\n    Console.WriteLine($\"Best Bid: {bid:F5}\");\n    Console.WriteLine($\"Volume at best bid: {bidVolume} lots\");\n\n    if (bidVolume &gt;= 100)\n    {\n        Console.WriteLine(\"\u2705 Strong liquidity - safe for large orders\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u26a0\ufe0f Thin liquidity - may cause slippage\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-2-compare-liquidity-across-multiple-levels","title":"Example 2: Compare Liquidity Across Multiple Levels","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    // Get top 5 ask levels\n    var topAsks = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Sell)\n        .OrderBy(b =&gt; b.Price)\n        .Take(5)\n        .ToList();\n\n    Console.WriteLine(\"Ask-side liquidity:\");\n    foreach (var level in topAsks)\n    {\n        long volume = await svc.CalculateLiquidityAtLevelAsync(\n            \"EURUSD\",\n            price: level.Price,\n            isBuy: false);\n\n        Console.WriteLine($\"  {level.Price:F5}: {volume,6} lots\");\n    }\n}\n\n// Output:\n// Ask-side liquidity:\n//   1.08523:    120 lots\n//   1.08524:    250 lots\n//   1.08525:    180 lots\n//   1.08526:    150 lots\n//   1.08527:     80 lots\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-3-find-iceberg-orders-large-hidden-volume","title":"Example 3: Find \"Iceberg\" Orders (Large Hidden Volume)","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    // Find bid levels with unusually high volume (potential icebergs)\n    var bids = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Buy)\n        .OrderByDescending(b =&gt; b.Price)\n        .ToList();\n\n    long avgVolume = bids.Any() ? (long)bids.Average(b =&gt; b.Volume) : 0;\n\n    Console.WriteLine($\"Average bid volume: {avgVolume} lots\");\n    Console.WriteLine(\"\\nLarge orders (potential icebergs):\");\n\n    foreach (var bid in bids)\n    {\n        if (bid.Volume &gt; avgVolume * 3)  // 3x average = suspicious\n        {\n            long volume = await svc.CalculateLiquidityAtLevelAsync(\n                \"EURUSD\",\n                price: bid.Price,\n                isBuy: true);\n\n            Console.WriteLine($\"  \ud83e\uddca {bid.Price:F5}: {volume} lots ({volume / avgVolume:F1}x avg)\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-4-liquidity-heatmap","title":"Example 4: Liquidity Heatmap","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    Console.WriteLine(\"Liquidity Heatmap:\");\n    Console.WriteLine(\"Price      | Bids    | Asks\");\n    Console.WriteLine(\"-----------|---------|--------\");\n\n    var allPrices = book.MqlBookInfos.Select(b =&gt; b.Price).Distinct().OrderByDescending(p =&gt; p);\n\n    foreach (var price in allPrices.Take(10))\n    {\n        long bidVol = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", price, isBuy: true);\n        long askVol = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", price, isBuy: false);\n\n        string bidBar = new string('\u2588', (int)(bidVol / 10));\n        string askBar = new string('\u2588', (int)(askVol / 10));\n\n        Console.WriteLine($\"{price:F5} | {bidBar,-7} {bidVol,4} | {askBar,-7} {askVol,4}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-5-pre-trade-liquidity-check","title":"Example 5: Pre-Trade Liquidity Check","text":"<pre><code>public async Task&lt;bool&gt; CanExecuteWithoutSlippage(\n    MT5Service svc,\n    string symbol,\n    double targetVolume,\n    bool isBuy)\n{\n    using (await svc.SubscribeToMarketBookAsync(symbol))\n    {\n        var (bid, ask) = await svc.GetBestBidAskFromBookAsync(symbol);\n        double bestPrice = isBuy ? ask : bid;\n\n        long available = await svc.CalculateLiquidityAtLevelAsync(\n            symbol,\n            price: bestPrice,\n            isBuy: !isBuy);  // Opposite side for execution\n\n        Console.WriteLine($\"Target volume: {targetVolume} lots\");\n        Console.WriteLine($\"Available at best price: {available} lots\");\n\n        return available &gt;= targetVolume;\n    }\n}\n\n// Usage:\nbool safe = await CanExecuteWithoutSlippage(svc, \"EURUSD\", targetVolume: 50, isBuy: true);\nif (safe)\n{\n    Console.WriteLine(\"\u2705 Sufficient liquidity - execute\");\n    // await svc.BuyMarketByRisk(...);\n}\nelse\n{\n    Console.WriteLine(\"\u26a0\ufe0f Insufficient liquidity - split order\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-6-supportresistance-from-order-walls","title":"Example 6: Support/Resistance from Order Walls","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    // Find largest bid cluster (potential support)\n    var biggestBid = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Buy)\n        .OrderByDescending(b =&gt; b.Volume)\n        .First();\n\n    long supportVolume = await svc.CalculateLiquidityAtLevelAsync(\n        \"EURUSD\",\n        price: biggestBid.Price,\n        isBuy: true);\n\n    Console.WriteLine($\"\ud83d\udee1\ufe0f Potential Support: {biggestBid.Price:F5}\");\n    Console.WriteLine($\"   Volume: {supportVolume} lots (order wall)\");\n\n    // Find largest ask cluster (potential resistance)\n    var biggestAsk = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Sell)\n        .OrderByDescending(b =&gt; b.Volume)\n        .First();\n\n    long resistanceVolume = await svc.CalculateLiquidityAtLevelAsync(\n        \"EURUSD\",\n        price: biggestAsk.Price,\n        isBuy: false);\n\n    Console.WriteLine($\"\ud83d\udea7 Potential Resistance: {biggestAsk.Price:F5}\");\n    Console.WriteLine($\"   Volume: {resistanceVolume} lots (order wall)\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-7-cumulative-liquidity-analysis","title":"Example 7: Cumulative Liquidity Analysis","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    var asks = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Sell)\n        .OrderBy(b =&gt; b.Price)\n        .ToList();\n\n    long cumulative = 0;\n    double targetVolume = 500;  // Need to buy 5.00 lots\n\n    Console.WriteLine(\"Cumulative ask-side liquidity:\");\n    foreach (var ask in asks.Take(10))\n    {\n        long levelVol = await svc.CalculateLiquidityAtLevelAsync(\n            \"EURUSD\",\n            price: ask.Price,\n            isBuy: false);\n\n        cumulative += levelVol;\n\n        Console.WriteLine($\"{ask.Price:F5}: +{levelVol,4} lots (cumulative: {cumulative,6})\");\n\n        if (cumulative &gt;= targetVolume &amp;&amp; cumulative - levelVol &lt; targetVolume)\n        {\n            Console.WriteLine($\"  \u2b06\ufe0f Need to reach this level for {targetVolume} lots\");\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-8-zero-liquidity-detection","title":"Example 8: Zero Liquidity Detection","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    double testPrice = 1.08500;  // Round number\n\n    long volume = await svc.CalculateLiquidityAtLevelAsync(\n        \"EURUSD\",\n        price: testPrice,\n        isBuy: true);\n\n    if (volume == 0)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f No liquidity at {testPrice:F5}\");\n        Console.WriteLine(\"  Price level not in order book\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u2705 Found {volume} lots at {testPrice:F5}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-9-bid-ask-imbalance-at-specific-level","title":"Example 9: Bid-Ask Imbalance at Specific Level","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    long bidVolume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", bid, isBuy: true);\n    long askVolume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", ask, isBuy: false);\n\n    double ratio = (double)bidVolume / askVolume;\n\n    Console.WriteLine($\"Best Bid Volume: {bidVolume} lots\");\n    Console.WriteLine($\"Best Ask Volume: {askVolume} lots\");\n    Console.WriteLine($\"Bid/Ask Ratio: {ratio:F2}\");\n\n    if (ratio &gt; 2.0)\n    {\n        Console.WriteLine(\"\ud83d\udd3c Strong buying pressure (2:1 bid dominance)\");\n    }\n    else if (ratio &lt; 0.5)\n    {\n        Console.WriteLine(\"\ud83d\udd3d Strong selling pressure (2:1 ask dominance)\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u27a1\ufe0f Balanced market\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#example-10-liquidity-monitoring-over-time","title":"Example 10: Liquidity Monitoring Over Time","text":"<pre><code>public async Task MonitorLiquidityAsync(MT5Service svc, string symbol, double priceLevel)\n{\n    using (await svc.SubscribeToMarketBookAsync(symbol))\n    {\n        for (int i = 0; i &lt; 20; i++)\n        {\n            long bidVol = await svc.CalculateLiquidityAtLevelAsync(\n                symbol,\n                price: priceLevel,\n                isBuy: true);\n\n            long askVol = await svc.CalculateLiquidityAtLevelAsync(\n                symbol,\n                price: priceLevel,\n                isBuy: false);\n\n            Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] {priceLevel:F5}: Bid={bidVol,4} Ask={askVol,4}\");\n\n            if (bidVol == 0 &amp;&amp; askVol == 0)\n            {\n                Console.WriteLine(\"  \ud83d\udca8 Level disappeared from book\");\n            }\n\n            await Task.Delay(1000);\n        }\n    }\n}\n\n// Usage:\nawait MonitorLiquidityAsync(svc, \"EURUSD\", priceLevel: 1.08520);\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>MarketBookGetAsync()</code> - Gets order book snapshot</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>SubscribeToMarketBookAsync()</code> - Subscribe to order book</li> <li><code>GetMarketBookSnapshotAsync()</code> - Get full order book</li> <li><code>GetBestBidAskFromBookAsync()</code> - Get best prices</li> </ul> <p>\ud83d\udcca Use cases:</p> <ul> <li>Pre-trade analysis before large orders</li> <li>Iceberg order detection</li> <li>Support/Resistance level identification</li> <li>Slippage estimation</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Exact price matching issues: <pre><code>// \u26a0\ufe0f Floating-point precision - method handles this with tolerance\nlong volume = await svc.CalculateLiquidityAtLevelAsync(\n    \"EURUSD\",\n    price: 1.085200000001,  // Close but not exact\n    isBuy: true);\n// Method uses Math.Abs(e.Price - price) &lt; 0.00001 for matching\n</code></pre></p> </li> <li> <p>Wrong side parameter: <pre><code>var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n// \u274c WRONG: Checking bid volume on ask side\nlong wrong = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", bid, isBuy: false);\n\n// \u2705 CORRECT: Check bid volume on bid side\nlong correct = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", bid, isBuy: true);\n</code></pre></p> </li> <li> <p>Not checking for zero volume: <pre><code>long volume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", 1.08500, isBuy: true);\n\nif (volume == 0)\n{\n    Console.WriteLine(\"\u26a0\ufe0f No liquidity at this level\");\n}\n</code></pre></p> </li> <li> <p>Using without subscription: <pre><code>// \u274c WRONG: No subscription\nlong volume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", 1.08520, true);\n\n// \u2705 CORRECT: Subscribe first\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    long volume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", 1.08520, true);\n}\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/CalculateLiquidityAtLevelAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>CalculateLiquidityAtLevelAsync provides price-level volume analysis:</p> <ul> <li>\u2705 Sums total volume at specific price level</li> <li>\u2705 Floating-point safe price matching (0.00001 tolerance)</li> <li>\u2705 Side-specific (bid or ask)</li> <li>\u2705 Essential for large order execution planning</li> <li>\u2705 Perfect for support/resistance detection from order clusters</li> </ul> <pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    long bidVolume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", bid, isBuy: true);\n    Console.WriteLine($\"Liquidity at best bid: {bidVolume} lots\");\n}\n</code></pre> <p>Know your liquidity before you trade! \ud83d\udcca</p>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/","title":"Get Best Bid/Ask from Book (<code>GetBestBidAskFromBookAsync</code>)","text":"<p>Sugar method: Extracts best bid and best ask prices from order book - no manual LINQ needed!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetBestBidAskFromBookAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [12] MARKET DEPTH (DOM)</li> <li>Underlying calls: <code>MarketBookGetAsync()</code> + LINQ to find best prices</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;(double bestBid, double bestAsk)&gt; GetBestBidAskFromBookAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol to query (e.g., \"EURUSD\") <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;(double, double)&gt;</code> Tuple: (bestBid, bestAsk) <p>Return values:</p> <ul> <li><code>bestBid</code> - Highest bid price (or 0 if no bids)</li> <li><code>bestAsk</code> - Lowest ask price (or 0 if no asks)</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Auto-extracts best bid (highest buy price) and best ask (lowest sell price) from order book.</li> <li>Why you need it: Quick access to top-of-book prices without manual LINQ queries.</li> <li>Returns: <code>(0, 0)</code> if order book is empty.</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get order book snapshot\nvar book = await svc.MarketBookGetAsync(symbol, Dl(timeoutSec), ct);\n\ndouble bestBid = 0;\ndouble bestAsk = 0;\n\n// Step 2: Find highest bid (BookType.Buy)\nvar bids = book.MqlBookInfos.Where(b =&gt; b.Type == BookType.Buy);\nif (bids.Any())\n    bestBid = bids.Max(b =&gt; b.Price);\n\n// Step 3: Find lowest ask (BookType.Sell)\nvar asks = book.MqlBookInfos.Where(b =&gt; b.Type == BookType.Sell);\nif (asks.Any())\n    bestAsk = asks.Min(s =&gt; s.Price);\n\nreturn (bestBid, bestAsk);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto-finding best prices - no manual Max/Min queries</li> <li>Handles empty book - returns (0, 0) safely</li> <li>Clean tuple return - easy destructuring</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-1-basic-best-bidask","title":"Example 1: Basic Best Bid/Ask","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    Console.WriteLine($\"Best Bid: {bid:F5}\");\n    Console.WriteLine($\"Best Ask: {ask:F5}\");\n    Console.WriteLine($\"Spread: {(ask - bid):F5}\");\n}\n\n// Output:\n// Best Bid: 1.08520\n// Best Ask: 1.08523\n// Spread: 0.00003\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-2-compare-with-tick-data","title":"Example 2: Compare with Tick Data","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    // Get best prices from order book\n    var (bookBid, bookAsk) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    // Get tick data\n    var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\n\n    Console.WriteLine(\"Order Book vs Tick:\");\n    Console.WriteLine($\"  Book Bid: {bookBid:F5} | Tick Bid: {tick.Bid:F5}\");\n    Console.WriteLine($\"  Book Ask: {bookAsk:F5} | Tick Ask: {tick.Ask:F5}\");\n\n    // Usually identical, but order book may have slight delays\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-3-spread-monitoring-loop","title":"Example 3: Spread Monitoring Loop","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    for (int i = 0; i &lt; 10; i++)\n    {\n        var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n        double spreadPips = (ask - bid) * 100000 / 10;  // For 5-digit EURUSD\n\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Spread: {spreadPips:F1} pips\");\n\n        if (spreadPips &gt; 2.0)\n        {\n            Console.WriteLine(\"  \u26a0\ufe0f High spread - avoid trading\");\n        }\n\n        await Task.Delay(1000);\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-4-mid-price-calculation","title":"Example 4: Mid-Price Calculation","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    double midPrice = (bid + ask) / 2.0;\n\n    Console.WriteLine($\"Bid: {bid:F5}\");\n    Console.WriteLine($\"Ask: {ask:F5}\");\n    Console.WriteLine($\"Mid: {midPrice:F5}\");\n\n    // Mid-price used for:\n    // - Fair value calculation\n    // - TWAP/VWAP benchmarks\n    // - Slippage measurement\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-5-multi-symbol-best-prices","title":"Example 5: Multi-Symbol Best Prices","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\n\nforeach (var symbol in symbols)\n{\n    using (await svc.SubscribeToMarketBookAsync(symbol))\n    {\n        var (bid, ask) = await svc.GetBestBidAskFromBookAsync(symbol);\n        Console.WriteLine($\"{symbol,-8} {bid:F5} / {ask:F5}\");\n    }\n}\n\n// Output:\n// EURUSD  1.08520 / 1.08523\n// GBPUSD  1.27345 / 1.27348\n// USDJPY  149.850 / 149.853\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-6-empty-book-check","title":"Example 6: Empty Book Check","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EXOTIC_PAIR\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EXOTIC_PAIR\");\n\n    if (bid == 0 &amp;&amp; ask == 0)\n    {\n        Console.WriteLine(\"\u26a0\ufe0f Order book is empty or not available\");\n        Console.WriteLine(\"  Broker may not provide DOM for this symbol\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u2705 Best prices: {bid:F5} / {ask:F5}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-7-slippage-estimation","title":"Example 7: Slippage Estimation","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    // For market buy, you pay the ask\n    double entryPrice = ask;\n\n    // Estimate slippage if placing large order\n    double targetVolume = 500;  // 5.00 lots\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    var asks = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Sell)\n        .OrderBy(b =&gt; b.Price)\n        .ToList();\n\n    long cumulative = 0;\n    double worstFill = ask;\n\n    foreach (var level in asks)\n    {\n        cumulative += level.Volume;\n        worstFill = level.Price;\n\n        if (cumulative &gt;= targetVolume)\n            break;\n    }\n\n    double slippagePips = (worstFill - ask) * 100000 / 10;\n\n    Console.WriteLine($\"Best Ask: {ask:F5}\");\n    Console.WriteLine($\"Worst Fill (500 lots): {worstFill:F5}\");\n    Console.WriteLine($\"Estimated Slippage: {slippagePips:F1} pips\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-8-market-direction-from-book-pressure","title":"Example 8: Market Direction from Book Pressure","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    // Compare volume at best bid vs best ask\n    long bidVolume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", bid, isBuy: true);\n    long askVolume = await svc.CalculateLiquidityAtLevelAsync(\"EURUSD\", ask, isBuy: false);\n\n    Console.WriteLine($\"Best Bid ({bid:F5}): {bidVolume} lots\");\n    Console.WriteLine($\"Best Ask ({ask:F5}): {askVolume} lots\");\n\n    if (bidVolume &gt; askVolume * 1.5)\n    {\n        Console.WriteLine(\"\ud83d\udd3c Strong buying pressure at top of book\");\n    }\n    else if (askVolume &gt; bidVolume * 1.5)\n    {\n        Console.WriteLine(\"\ud83d\udd3d Strong selling pressure at top of book\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u27a1\ufe0f Balanced pressure\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-9-real-time-spread-alert","title":"Example 9: Real-Time Spread Alert","text":"<pre><code>public async Task MonitorSpreadAsync(MT5Service svc, string symbol, double maxSpreadPips)\n{\n    using (await svc.SubscribeToMarketBookAsync(symbol))\n    {\n        while (true)\n        {\n            var (bid, ask) = await svc.GetBestBidAskFromBookAsync(symbol);\n            double spreadPips = (ask - bid) * 100000 / 10;\n\n            if (spreadPips &gt; maxSpreadPips)\n            {\n                Console.WriteLine($\"\ud83d\udea8 ALERT: Spread {spreadPips:F1} pips &gt; {maxSpreadPips} pips\");\n            }\n\n            await Task.Delay(500);  // Check every 500ms\n        }\n    }\n}\n\n// Usage:\nawait MonitorSpreadAsync(svc, \"EURUSD\", maxSpreadPips: 2.0);\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#example-10-compare-manual-vs-auto-extraction","title":"Example 10: Compare Manual vs Auto Extraction","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    // \u274c MANUAL WAY (verbose):\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n    var bids = book.MqlBookInfos.Where(b =&gt; b.Type == BookType.Buy);\n    var asks = book.MqlBookInfos.Where(b =&gt; b.Type == BookType.Sell);\n    double manualBid = bids.Any() ? bids.Max(b =&gt; b.Price) : 0;\n    double manualAsk = asks.Any() ? asks.Min(b =&gt; b.Price) : 0;\n\n    Console.WriteLine($\"Manual: {manualBid:F5} / {manualAsk:F5}\");\n\n    // \u2705 AUTO WAY (clean):\n    var (autoBid, autoAsk) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    Console.WriteLine($\"Auto: {autoBid:F5} / {autoAsk:F5}\");\n\n    // Same result, cleaner code!\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>MarketBookGetAsync()</code> - Gets order book snapshot</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>SubscribeToMarketBookAsync()</code> - Subscribe to order book</li> <li><code>GetMarketBookSnapshotAsync()</code> - Get full order book</li> <li><code>CalculateLiquidityAtLevelAsync()</code> - Get volume at specific price</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Gets bid/ask from tick data (faster, but no depth)</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using without subscription: <pre><code>// \u274c WRONG: Will fail - no subscription!\nvar (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n// \u2705 CORRECT: Subscribe first\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n}\n</code></pre></p> </li> <li> <p>Not checking for empty book: <pre><code>// \u26a0\ufe0f Returns (0, 0) if book is empty\nvar (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\nif (bid == 0 || ask == 0)\n{\n    Console.WriteLine(\"\u26a0\ufe0f Empty order book\");\n    return;\n}\n</code></pre></p> </li> <li> <p>Confusing with tick prices: <pre><code>// DOM prices vs Tick prices:\nvar (bookBid, bookAsk) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\n\n// Usually same, but book may lag slightly\n// Use tick for immediate prices, book for depth analysis\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetBestBidAskFromBookAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>GetBestBidAskFromBookAsync extracts top-of-book prices automatically:</p> <ul> <li>\u2705 Auto-finds highest bid and lowest ask</li> <li>\u2705 Clean tuple return for destructuring</li> <li>\u2705 Handles empty book gracefully (returns 0, 0)</li> <li>\u2705 Essential for spread monitoring and mid-price calculation</li> </ul> <pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n    double spread = ask - bid;\n}\n</code></pre> <p>Top-of-book access made simple! \ud83d\udcca</p>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/","title":"Get Market Book Snapshot (<code>GetMarketBookSnapshotAsync</code>)","text":"<p>Sugar method: Gets current order book (DOM) snapshot - wrapper over <code>MarketBookGetAsync()</code> with clearer naming.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetMarketBookSnapshotAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [12] MARKET DEPTH (DOM)</li> <li>Underlying calls: <code>MarketBookGetAsync()</code></li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static Task&lt;MarketBookGetData&gt; GetMarketBookSnapshotAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n    =&gt; svc.MarketBookGetAsync(symbol, Dl(timeoutSec), ct);\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol to query (e.g., \"EURUSD\") <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;MarketBookGetData&gt;</code> Order book snapshot with bid/ask levels <p>Key fields:</p> <ul> <li><code>MqlBookInfos</code> - List of order book entries</li> <li><code>Price</code> - Price level</li> <li><code>Volume</code> - Volume at this level (in lots)</li> <li><code>Type</code> - <code>BookType.Buy</code> (bid) or <code>BookType.Sell</code> (ask)</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Gets current snapshot of order book (all bid/ask levels with volumes).</li> <li>Why you need it: Alias for <code>MarketBookGetAsync()</code> with clearer, more descriptive name.</li> <li>\u26a0\ufe0f Prerequisite: Must subscribe first using <code>SubscribeToMarketBookAsync()</code> or <code>MarketBookAddAsync()</code>.</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#full-documentation","title":"\ud83d\udd17 Full Documentation","text":"<p>This method is a simple wrapper for better naming. For complete DOM usage, see:</p> <ul> <li>SubscribeToMarketBookAsync.md - Subscription management</li> <li>GetBestBidAskFromBookAsync.md - Extract best prices</li> <li>CalculateLiquidityAtLevelAsync.md - Volume analysis</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#quick-example","title":"\ud83d\udccb Quick Example","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    Console.WriteLine($\"Order book depth: {book.MqlBookInfos.Count} levels\");\n\n    foreach (var entry in book.MqlBookInfos)\n    {\n        string side = entry.Type == BookType.Buy ? \"BID\" : \"ASK\";\n        Console.WriteLine($\"{side}: {entry.Price:F5} - {entry.Volume} lots\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/GetMarketBookSnapshotAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>GetMarketBookSnapshotAsync = clearer alias for <code>MarketBookGetAsync()</code>:</p> <ul> <li>\u2705 More descriptive method name</li> <li>\u2705 Same functionality as <code>MarketBookGetAsync()</code></li> <li>\u2705 Returns full order book snapshot</li> <li>\u26a0\ufe0f Requires active subscription first</li> </ul> <pre><code>// These are identical:\nvar book1 = await svc.MarketBookGetAsync(\"EURUSD\", deadline, ct);\nvar book2 = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/","title":"Subscribe to Market Book (<code>SubscribeToMarketBookAsync</code>)","text":"<p>Sugar method: Subscribes to Market Depth (order book) with automatic cleanup via IDisposable pattern.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.SubscribeToMarketBookAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [12] MARKET DEPTH (DOM)</li> <li>Underlying calls: <code>MarketBookAddAsync()</code> + custom <code>MarketBookSubscription</code> wrapper</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;IDisposable&gt; SubscribeToMarketBookAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol to subscribe (e.g., \"EURUSD\", \"XAUUSD\") <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;IDisposable&gt;</code> Disposable subscription that auto-releases when disposed <p>Key behavior:</p> <ul> <li>When disposed, automatically calls <code>MarketBookReleaseAsync()</code></li> <li>Use with <code>using</code> statement for automatic cleanup</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Subscribes to real-time order book (DOM) data for a symbol with automatic cleanup.</li> <li>Why you need it: Access Level II market data for scalping, liquidity analysis, and advanced order placement.</li> <li>Pattern: Use with <code>using</code> block - automatically unsubscribes when block exits.</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Scalping - See real liquidity and order flow</li> <li>Large order execution - Check available liquidity before placing big orders</li> <li>Market microstructure analysis - Study bid/ask dynamics</li> <li>Iceberg order detection - Find hidden large orders</li> <li>Support/Resistance detection - Identify order clusters</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Subscribe to market book\nawait svc.MarketBookAddAsync(symbol, Dl(timeoutSec), ct);\n\n// Step 2: Return disposable wrapper\nreturn new MarketBookSubscription(svc, symbol, timeoutSec);\n\n// Internal MarketBookSubscription class:\nprivate class MarketBookSubscription : IDisposable\n{\n    private readonly MT5Service _svc;\n    private readonly string _symbol;\n    private readonly int _timeoutSec;\n    private bool _disposed;\n\n    public void Dispose()\n    {\n        if (!_disposed)\n        {\n            _disposed = true;\n            // Fire-and-forget release (cannot await in Dispose)\n            _ = _svc.MarketBookReleaseAsync(_symbol, Dl(_timeoutSec), default);\n        }\n    }\n}\n</code></pre> <p>What it improves:</p> <ul> <li>Automatic cleanup - No manual unsubscribe needed</li> <li>Resource safety - Guaranteed cleanup even on exception</li> <li>Clean syntax - <code>using</code> block pattern</li> <li>Fire-and-forget release - Non-blocking dispose</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-1-basic-subscription","title":"Example 1: Basic Subscription","text":"<pre><code>// Subscribe to EURUSD order book\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    Console.WriteLine($\"Order book entries: {book.MqlBookInfos.Count}\");\n\n    foreach (var entry in book.MqlBookInfos.Take(5))\n    {\n        string side = entry.Type == BookType.Buy ? \"BID\" : \"ASK\";\n        Console.WriteLine($\"{side}: {entry.Price:F5} - {entry.Volume} lots\");\n    }\n} // Auto-unsubscribes here\n\n// Output:\n// Order book entries: 20\n// BID: 1.08520 - 100 lots\n// BID: 1.08519 - 250 lots\n// BID: 1.08518 - 150 lots\n// ASK: 1.08523 - 120 lots\n// ASK: 1.08524 - 180 lots\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-2-find-best-bidask-from-book","title":"Example 2: Find Best Bid/Ask from Book","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var (bestBid, bestAsk) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n\n    double spread = bestAsk - bestBid;\n    Console.WriteLine($\"Best Bid: {bestBid:F5}\");\n    Console.WriteLine($\"Best Ask: {bestAsk:F5}\");\n    Console.WriteLine($\"Spread: {spread:F5}\");\n}\n\n// Output:\n// Best Bid: 1.08520\n// Best Ask: 1.08523\n// Spread: 0.00003\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-3-check-liquidity-before-large-order","title":"Example 3: Check Liquidity Before Large Order","text":"<pre><code>public async Task&lt;bool&gt; HasEnoughLiquidity(\n    MT5Service svc,\n    string symbol,\n    double targetVolume)\n{\n    using (await svc.SubscribeToMarketBookAsync(symbol))\n    {\n        var book = await svc.GetMarketBookSnapshotAsync(symbol);\n\n        // Sum top 3 ask levels\n        long totalAskVolume = book.MqlBookInfos\n            .Where(b =&gt; b.Type == BookType.Sell)\n            .OrderBy(b =&gt; b.Price)\n            .Take(3)\n            .Sum(b =&gt; b.Volume);\n\n        Console.WriteLine($\"Available liquidity (top 3 levels): {totalAskVolume} lots\");\n        Console.WriteLine($\"Target volume: {targetVolume} lots\");\n\n        return totalAskVolume &gt;= targetVolume;\n    }\n}\n\n// Usage:\nbool canExecute = await HasEnoughLiquidity(svc, \"EURUSD\", targetVolume: 500);\nif (canExecute)\n{\n    Console.WriteLine(\"\u2705 Sufficient liquidity - placing order\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0\ufe0f Insufficient liquidity - may cause slippage\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-4-find-order-book-imbalance","title":"Example 4: Find Order Book Imbalance","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    long totalBidVolume = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Buy)\n        .Sum(b =&gt; b.Volume);\n\n    long totalAskVolume = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Sell)\n        .Sum(b =&gt; b.Volume);\n\n    double imbalance = (double)totalBidVolume / totalAskVolume;\n\n    Console.WriteLine($\"Total Bid Volume: {totalBidVolume}\");\n    Console.WriteLine($\"Total Ask Volume: {totalAskVolume}\");\n    Console.WriteLine($\"Bid/Ask Imbalance: {imbalance:F2}\");\n\n    if (imbalance &gt; 1.5)\n    {\n        Console.WriteLine(\"\ud83d\udd3c Strong buying pressure\");\n    }\n    else if (imbalance &lt; 0.67)\n    {\n        Console.WriteLine(\"\ud83d\udd3d Strong selling pressure\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u27a1\ufe0f Balanced order book\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-5-monitor-order-book-in-real-time-loop","title":"Example 5: Monitor Order Book in Real-Time Loop","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    for (int i = 0; i &lt; 10; i++)\n    {\n        var (bid, ask) = await svc.GetBestBidAskFromBookAsync(\"EURUSD\");\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Bid: {bid:F5}, Ask: {ask:F5}\");\n\n        await Task.Delay(1000);  // Update every second\n    }\n} // Auto-cleanup after loop\n\n// Output:\n// [14:30:00] Bid: 1.08520, Ask: 1.08523\n// [14:30:01] Bid: 1.08521, Ask: 1.08523\n// [14:30:02] Bid: 1.08520, Ask: 1.08524\n// ...\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-6-find-supportresistance-from-order-clusters","title":"Example 6: Find Support/Resistance from Order Clusters","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    // Find largest bid cluster (potential support)\n    var largestBid = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Buy)\n        .OrderByDescending(b =&gt; b.Volume)\n        .First();\n\n    // Find largest ask cluster (potential resistance)\n    var largestAsk = book.MqlBookInfos\n        .Where(b =&gt; b.Type == BookType.Sell)\n        .OrderByDescending(b =&gt; b.Volume)\n        .First();\n\n    Console.WriteLine($\"\ud83d\udee1\ufe0f Support (largest bid): {largestBid.Price:F5} ({largestBid.Volume} lots)\");\n    Console.WriteLine($\"\ud83d\udea7 Resistance (largest ask): {largestAsk.Price:F5} ({largestAsk.Volume} lots)\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-7-multiple-symbol-subscriptions","title":"Example 7: Multiple Symbol Subscriptions","text":"<pre><code>// Subscribe to multiple symbols simultaneously\nvar symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\nvar subscriptions = new List&lt;IDisposable&gt;();\n\ntry\n{\n    // Subscribe to all\n    foreach (var symbol in symbols)\n    {\n        subscriptions.Add(await svc.SubscribeToMarketBookAsync(symbol));\n    }\n\n    // Analyze all books\n    foreach (var symbol in symbols)\n    {\n        var (bid, ask) = await svc.GetBestBidAskFromBookAsync(symbol);\n        Console.WriteLine($\"{symbol}: {bid:F5} / {ask:F5}\");\n    }\n}\nfinally\n{\n    // Cleanup all subscriptions\n    foreach (var sub in subscriptions)\n    {\n        sub.Dispose();\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-8-exception-handling-with-guaranteed-cleanup","title":"Example 8: Exception Handling with Guaranteed Cleanup","text":"<pre><code>try\n{\n    using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n    {\n        var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n        if (book.MqlBookInfos.Count == 0)\n        {\n            throw new InvalidOperationException(\"Empty order book!\");\n        }\n\n        // Process book...\n    }\n} // Dispose called even if exception occurs\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Error: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-9-calculate-weighted-average-price-from-book","title":"Example 9: Calculate Weighted Average Price from Book","text":"<pre><code>using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n    // Calculate VWAP (Volume Weighted Average Price) from ask side\n    var asks = book.MqlBookInfos.Where(b =&gt; b.Type == BookType.Sell).ToList();\n\n    double totalValue = asks.Sum(a =&gt; a.Price * a.Volume);\n    long totalVolume = asks.Sum(a =&gt; a.Volume);\n\n    double vwap = totalValue / totalVolume;\n\n    Console.WriteLine($\"Ask-side VWAP: {vwap:F5}\");\n    Console.WriteLine($\"Based on {totalVolume} lots across {asks.Count} levels\");\n}\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#example-10-async-using-declaration-c-80","title":"Example 10: Async Using Declaration (C# 8.0+)","text":"<pre><code>// Modern C# 8.0+ syntax - auto-disposes at end of scope\nawait using var subscription = await svc.SubscribeToMarketBookAsync(\"EURUSD\");\n\nvar book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\nConsole.WriteLine($\"Book depth: {book.MqlBookInfos.Count} levels\");\n\n// Process book data...\n\n// Auto-disposes here (end of method/scope)\n</code></pre>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>MarketBookAddAsync()</code> - Low-level subscription</li> <li><code>MarketBookReleaseAsync()</code> - Low-level unsubscription</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>GetMarketBookSnapshotAsync()</code> - Get current order book snapshot</li> <li><code>GetBestBidAskFromBookAsync()</code> - Extract best bid/ask from book</li> <li><code>CalculateLiquidityAtLevelAsync()</code> - Calculate volume at price level</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>MarketBookAddAsync()</code> + manual <code>MarketBookReleaseAsync()</code> - More control, but manual cleanup</li> </ul>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Forgetting to dispose: <pre><code>// \u274c WRONG: Memory leak - never unsubscribes!\nvar sub = await svc.SubscribeToMarketBookAsync(\"EURUSD\");\nvar book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n// sub never disposed!\n\n// \u2705 CORRECT: Use using block\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n} // Auto-cleanup\n</code></pre></p> </li> <li> <p>Using book data after unsubscribe: <pre><code>MarketBookGetData book;\n\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n} // Unsubscribed here\n\n// \u26a0\ufe0f Book data may be stale - subscription is closed\nConsole.WriteLine(book.MqlBookInfos.Count);\n\n// \u2705 CORRECT: Process data inside using block\n</code></pre></p> </li> <li> <p>Not checking if broker supports DOM: <pre><code>// \u26a0\ufe0f Not all brokers provide Level II data\ntry\n{\n    using (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n    {\n        var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n\n        if (book.MqlBookInfos.Count == 0)\n        {\n            Console.WriteLine(\"\u26a0\ufe0f Broker doesn't provide DOM data\");\n        }\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c DOM not supported: {ex.Message}\");\n}\n</code></pre></p> </li> <li> <p>Subscribing to same symbol multiple times: <pre><code>// \u26a0\ufe0f Redundant - MT5 handles multiple subscriptions, but wasteful\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))  // Redundant\n{\n    // Only need one subscription per symbol\n}\n\n// \u2705 CORRECT: One subscription per symbol\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    // Use single subscription\n}\n</code></pre></p> </li> <li> <p>Assuming real-time updates without polling: <pre><code>// \u26a0\ufe0f GetMarketBookSnapshotAsync returns snapshot, not live stream\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n    // This book is a snapshot - won't update automatically\n\n    // Must poll to see changes:\n    await Task.Delay(1000);\n    book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");  // New snapshot\n}\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/12.%20Market_Depth_DOM/SubscribeToMarketBookAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>SubscribeToMarketBookAsync provides clean DOM subscription with automatic cleanup:</p> <ul> <li>\u2705 IDisposable pattern for automatic unsubscribe</li> <li>\u2705 Use with <code>using</code> block for guaranteed cleanup</li> <li>\u2705 Access to Level II market data</li> <li>\u2705 Essential for scalping and large order execution</li> <li>\u2705 Works with all other DOM methods</li> </ul> <pre><code>// Clean pattern:\nusing (await svc.SubscribeToMarketBookAsync(\"EURUSD\"))\n{\n    var book = await svc.GetMarketBookSnapshotAsync(\"EURUSD\");\n    // Analyze order book...\n} // Auto-cleanup guaranteed\n</code></pre> <p>Professional DOM access made simple! \ud83d\udcca</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/","title":"Calculate Buy Margin (<code>CalculateBuyMarginAsync</code>)","text":"<p>Sugar method: Calculate exact margin required for BUY order before placing it.</p> <p>API: <code>MT5Service.CalculateBuyMarginAsync(...)</code> Region: [13] ORDER VALIDATION \u2b50</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;double&gt; CalculateBuyMarginAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double price = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#parameters","title":"Parameters","text":"Param Type Description <code>symbol</code> <code>string</code> Symbol (e.g., \"EURUSD\") <code>volume</code> <code>double</code> Volume in lots <code>price</code> <code>double</code> Entry price (0 = market price)"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#returns","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Required margin in account currency</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#examples","title":"Examples","text":""},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#1-market-order-margin","title":"1. Market Order Margin","text":"<pre><code>double margin = await svc.CalculateBuyMarginAsync(\"EURUSD\", volume: 0.10);\nConsole.WriteLine($\"Margin for 0.10 lots: ${margin:F2}\");\n// Output: Margin for 0.10 lots: $10.85\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#2-pending-order-margin","title":"2. Pending Order Margin","text":"<pre><code>double margin = await svc.CalculateBuyMarginAsync(\n    \"EURUSD\",\n    volume: 0.50,\n    price: 1.08500);\nConsole.WriteLine($\"Margin at 1.08500: ${margin:F2}\");\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#3-compare-multiple-volumes","title":"3. Compare Multiple Volumes","text":"<pre><code>double[] volumes = { 0.01, 0.10, 1.0, 10.0 };\nConsole.WriteLine(\"Volume  | Margin\");\nConsole.WriteLine(\"--------|--------\");\n\nforeach (var vol in volumes)\n{\n    double margin = await svc.CalculateBuyMarginAsync(\"EURUSD\", vol);\n    Console.WriteLine($\"{vol,7} | ${margin,7:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#4-check-affordability","title":"4. Check Affordability","text":"<pre><code>double freeMargin = await svc.GetFreeMarginAsync();\ndouble requiredMargin = await svc.CalculateBuyMarginAsync(\"EURUSD\", 1.0);\n\nif (freeMargin &gt;= requiredMargin)\n{\n    Console.WriteLine($\"\u2705 Can afford: ${freeMargin:F2} &gt;= ${requiredMargin:F2}\");\n    await svc.BuyMarketAsync(\"EURUSD\", 1.0);\n}\nelse\n{\n    Console.WriteLine($\"\u274c Insufficient: ${freeMargin:F2} &lt; ${requiredMargin:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#5-multi-symbol-margin-planning","title":"5. Multi-Symbol Margin Planning","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\ndouble totalMargin = 0;\n\nforeach (var symbol in symbols)\n{\n    double margin = await svc.CalculateBuyMarginAsync(symbol, 0.10);\n    totalMargin += margin;\n    Console.WriteLine($\"{symbol}: ${margin:F2}\");\n}\n\nConsole.WriteLine($\"Total margin needed: ${totalMargin:F2}\");\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#related-methods","title":"Related Methods","text":"<ul> <li><code>CalculateSellMarginAsync()</code> - SELL margin calculation</li> <li><code>CheckMarginAvailabilityAsync()</code> - Margin check + comparison</li> <li><code>ValidateOrderAsync()</code> - Full order validation</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateBuyMarginAsync/#summary","title":"Summary","text":"<p>CalculateBuyMarginAsync calculates exact BUY margin:</p> <ul> <li>\u2705 Quick margin estimation</li> <li>\u2705 Works for market and pending orders  </li> <li>\u2705 Essential for portfolio planning</li> <li>\u2705 Prevents \"Not enough money\" errors</li> </ul> <pre><code>double margin = await svc.CalculateBuyMarginAsync(\"EURUSD\", 0.10);\nif (await svc.GetFreeMarginAsync() &gt;= margin)\n{\n    await svc.BuyMarketAsync(\"EURUSD\", 0.10);\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/","title":"Calculate Sell Margin (<code>CalculateSellMarginAsync</code>)","text":"<p>Sugar method: Calculate exact margin required for SELL order before placing it.</p> <p>API: <code>MT5Service.CalculateSellMarginAsync(...)</code> Region: [13] ORDER VALIDATION \u2b50</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;double&gt; CalculateSellMarginAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double price = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/#parameters","title":"Parameters","text":"Param Type Description <code>symbol</code> <code>string</code> Symbol (e.g., \"EURUSD\") <code>volume</code> <code>double</code> Volume in lots <code>price</code> <code>double</code> Entry price (0 = market price)"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/#returns","title":"Returns","text":"<p><code>Task&lt;double&gt;</code> - Required margin in account currency</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/#quick-examples","title":"Quick Examples","text":"<pre><code>// Market order margin\ndouble margin = await svc.CalculateSellMarginAsync(\"EURUSD\", 0.10);\nConsole.WriteLine($\"Sell margin: ${margin:F2}\");\n\n// Pending order margin\ndouble margin = await svc.CalculateSellMarginAsync(\"EURUSD\", 0.50, price: 1.09000);\n\n// Check affordability\ndouble freeMargin = await svc.GetFreeMarginAsync();\ndouble required = await svc.CalculateSellMarginAsync(\"EURUSD\", 1.0);\nif (freeMargin &gt;= required)\n{\n    await svc.SellMarketAsync(\"EURUSD\", 1.0);\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/#related-methods","title":"Related Methods","text":"<ul> <li><code>CalculateBuyMarginAsync()</code> - BUY margin calculation</li> <li><code>CheckMarginAvailabilityAsync()</code> - Margin check + comparison</li> <li><code>ValidateOrderAsync()</code> - Full order validation</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/CalculateSellMarginAsync/#summary","title":"Summary","text":"<p>CalculateSellMarginAsync calculates exact SELL margin:</p> <ul> <li>\u2705 Same as BUY margin (usually)</li> <li>\u2705 Works for market and pending</li> <li>\u2705 Essential for short trading planning</li> <li>\u2705 Prevents margin call errors</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/","title":"Check Margin Availability (<code>CheckMarginAvailabilityAsync</code>) \u2b50","text":"<p>\u2b50 CRITICAL METHOD: Check if account has enough free margin for order - one-shot pre-flight check!</p> <p>API: <code>MT5Service.CheckMarginAvailabilityAsync(...)</code> Region: [13] ORDER VALIDATION \u2b50</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;(bool hasEnough, double freeMargin, double required)&gt;\n    CheckMarginAvailabilityAsync(\n        this MT5Service svc,\n        string symbol,\n        double volume,\n        bool isBuy,\n        double price = 0,\n        int timeoutSec = 20,\n        CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#returns","title":"Returns","text":"<p>Tuple: <code>(bool hasEnough, double freeMargin, double required)</code></p> <ul> <li><code>hasEnough</code> - <code>true</code> if can afford order</li> <li><code>freeMargin</code> - Current free margin</li> <li><code>required</code> - Required margin for this order</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#quick-examples","title":"Quick Examples","text":""},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#1-basic-check","title":"1. Basic Check","text":"<pre><code>var (hasEnough, free, required) = await svc.CheckMarginAvailabilityAsync(\n    \"EURUSD\",\n    volume: 1.0,\n    isBuy: true);\n\nif (hasEnough)\n{\n    Console.WriteLine($\"\u2705 Can trade: ${free:F2} &gt;= ${required:F2}\");\n    await svc.BuyMarketAsync(\"EURUSD\", 1.0);\n}\nelse\n{\n    Console.WriteLine($\"\u274c Insufficient: ${free:F2} &lt; ${required:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#2-with-risk-management","title":"2. With Risk Management","text":"<pre><code>var (hasMargin, _, _) = await svc.CheckMarginAvailabilityAsync(\"EURUSD\", 10.0, true);\nif (hasMargin)\n{\n    await svc.BuyMarketByRisk(\"EURUSD\", stopPoints: 50, riskMoney: 100);\n}\nelse\n{\n    Console.WriteLine(\"\u26a0\ufe0f Insufficient margin - skipping trade\");\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#3-compare-buy-vs-sell","title":"3. Compare Buy vs Sell","text":"<pre><code>var (canBuy, freeBuy, reqBuy) = await svc.CheckMarginAvailabilityAsync(\n    \"EURUSD\", 1.0, isBuy: true);\nvar (canSell, freeSell, reqSell) = await svc.CheckMarginAvailabilityAsync(\n    \"EURUSD\", 1.0, isBuy: false);\n\nConsole.WriteLine($\"BUY:  ${reqBuy:F2} - {(canBuy ? \"\u2705\" : \"\u274c\")}\");\nConsole.WriteLine($\"SELL: ${reqSell:F2} - {(canSell ? \"\u2705\" : \"\u274c\")}\");\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#4-multi-symbol-portfolio-check","title":"4. Multi-Symbol Portfolio Check","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\ndouble totalRequired = 0;\n\nforeach (var symbol in symbols)\n{\n    var (_, _, required) = await svc.CheckMarginAvailabilityAsync(symbol, 0.10, true);\n    totalRequired += required;\n}\n\nvar (hasEnough, freeMargin, _) = await svc.CheckMarginAvailabilityAsync(\n    symbols[0], 0, true);  // Get current free margin\n\nConsole.WriteLine($\"Total margin needed: ${totalRequired:F2}\");\nConsole.WriteLine($\"Free margin: ${freeMargin:F2}\");\nConsole.WriteLine(hasEnough ? \"\u2705 Can trade all\" : \"\u274c Insufficient for portfolio\");\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#5-progressive-volume-increase","title":"5. Progressive Volume Increase","text":"<pre><code>public async Task&lt;double&gt; FindMaxAffordableVolume(\n    MT5Service svc,\n    string symbol,\n    bool isBuy)\n{\n    double volume = 0.01;\n    double maxVolume = 0;\n\n    while (volume &lt;= 100.0)\n    {\n        var (hasEnough, _, _) = await svc.CheckMarginAvailabilityAsync(\n            symbol, volume, isBuy);\n\n        if (hasEnough)\n        {\n            maxVolume = volume;\n            volume *= 2;  // Double volume\n        }\n        else\n        {\n            break;\n        }\n    }\n\n    Console.WriteLine($\"Max affordable volume: {maxVolume} lots\");\n    return maxVolume;\n}\n\n// Usage:\ndouble maxVol = await FindMaxAffordableVolume(svc, \"EURUSD\", isBuy: true);\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#under-the-hood","title":"Under the Hood","text":"<pre><code>// Step 1: Calculate required margin (parallel with free margin query)\nvar marginReq = new OrderCalcMarginRequest\n{\n    Symbol = symbol,\n    OrderType = isBuy ? ENUM_ORDER_TYPE_TF.OrderTypeTfBuy : ENUM_ORDER_TYPE_TF.OrderTypeTfSell,\n    Volume = volume,\n    OpenPrice = price\n};\n\nvar marginTask = svc.OrderCalcMarginAsync(marginReq, deadline, ct);\nvar freeMarginTask = svc.GetFreeMarginAsync(deadline, ct);\n\nawait Task.WhenAll(marginTask, freeMarginTask);  // Parallel execution\n\n// Step 2: Compare\nvar requiredMargin = (await marginTask).Margin;\nvar freeMargin = await freeMarginTask;\nbool hasEnough = freeMargin &gt;= requiredMargin;\n\nreturn (hasEnough, freeMargin, requiredMargin);\n</code></pre> <p>Performance: Executes margin calculation and free margin query in parallel for speed!</p>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#related-methods","title":"Related Methods","text":"<ul> <li><code>CalculateBuyMarginAsync()</code> - BUY margin only</li> <li><code>CalculateSellMarginAsync()</code> - SELL margin only</li> <li><code>ValidateOrderAsync()</code> - Full validation (slower, more comprehensive)</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#when-to-use","title":"When to Use","text":"Method Use When <code>CheckMarginAvailabilityAsync()</code> \u2b50 Quick margin check before placing order <code>CalculateBuyMarginAsync()</code> Only need margin amount (no comparison) <code>ValidateOrderAsync()</code> Need full validation (symbol, stops, etc.)"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#common-pitfalls","title":"Common Pitfalls","text":"<pre><code>// \u274c WRONG: Ignoring the check\nawait svc.BuyMarketAsync(\"EURUSD\", 10.0);  // May fail!\n\n// \u2705 CORRECT: Always check first\nvar (hasEnough, _, _) = await svc.CheckMarginAvailabilityAsync(\"EURUSD\", 10.0, true);\nif (hasEnough)\n{\n    await svc.BuyMarketAsync(\"EURUSD\", 10.0);\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/CheckMarginAvailabilityAsync/#summary","title":"Summary","text":"<p>CheckMarginAvailabilityAsync provides one-shot margin verification:</p> <ul> <li>\u2705 Returns bool + both values (free and required)</li> <li>\u2705 Parallel execution for speed</li> <li>\u2705 Perfect for pre-trade validation</li> <li>\u2b50 Use before ALL large orders!</li> </ul> <pre><code>// Professional pattern:\nvar (hasMargin, free, required) = await svc.CheckMarginAvailabilityAsync(\n    \"EURUSD\", 1.0, isBuy: true);\n\nif (hasMargin)\n{\n    await svc.BuyMarketByRisk(\"EURUSD\", 50, 100);\n}\nelse\n{\n    Console.WriteLine($\"Need ${required:F2}, have ${free:F2}\");\n}\n</code></pre> <p>Check margin first, avoid margin calls! \ud83d\udee1\ufe0f</p>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/","title":"Validate Order (<code>ValidateOrderAsync</code>)","text":"<p>\u2b50 CRITICAL METHOD: Pre-flight validation for orders - check BEFORE sending to avoid rejections!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.ValidateOrderAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [13] ORDER VALIDATION \u2b50</li> <li>Underlying calls: <code>OrderCheckAsync()</code></li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static Task&lt;OrderCheckData&gt; ValidateOrderAsync(\n    this MT5Service svc,\n    OrderCheckRequest request,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n    =&gt; svc.OrderCheckAsync(request, Dl(timeoutSec), ct);\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>request</code> <code>OrderCheckRequest</code> Request containing <code>MqlTradeRequest</code> with order details <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderCheckData&gt;</code> Validation result with error codes and details <p>Key fields in <code>OrderCheckData.MqlTradeCheckResult</code>:</p> <ul> <li><code>ReturnedCode</code> - Validation result code (0 = valid, non-zero = error)</li> <li><code>Comment</code> - Human-readable error message</li> <li><code>Balance</code> - Account balance after order (if valid)</li> <li><code>Equity</code> - Account equity after order (if valid)</li> <li><code>Margin</code> - Required margin for this order</li> <li><code>MarginFree</code> - Free margin after order</li> <li><code>MarginLevel</code> - Margin level percentage after order</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Pre-flight check for orders - validates symbol, volume, margin, stop levels BEFORE sending to broker.</li> <li>Why you need it: Catch errors before order submission. Saves time and prevents broker rejections.</li> <li>Returns code 0 if valid, non-zero with error message if invalid.</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Pre-flight validation - Check order before OrderSendAsync()</li> <li>Margin verification - Ensure sufficient margin before order</li> <li>Symbol/volume checks - Validate symbol availability and lot constraints</li> <li>Stop level validation - Check SL/TP are within broker limits</li> <li>Prevent rejections - Catch errors client-side before broker sees them</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Simple wrapper with timeout handling\nreturn await svc.OrderCheckAsync(request, Dl(timeoutSec), ct);\n\n// OrderCheckAsync sends request to MT5 terminal which:\n// 1. Validates symbol exists and is tradable\n// 2. Checks volume against min/max/step constraints\n// 3. Verifies sufficient margin\n// 4. Validates stop levels (SL/TP distances)\n// 5. Checks account permissions (hedging, trading allowed, etc.)\n// 6. Returns detailed validation result\n</code></pre> <p>What it improves:</p> <ul> <li>Clearer naming - \"Validate\" vs generic \"Check\"</li> <li>Timeout parameter - Easier to specify timeout</li> <li>Catches errors early - Before broker rejection</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-1-basic-order-validation","title":"Example 1: Basic Order Validation","text":"<pre><code>var tradeReq = new MqlTradeRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n    Price = 0,  // Market price\n    StopLoss = 0,\n    TakeProfit = 0\n};\n\nvar checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\nvar result = await svc.ValidateOrderAsync(checkReq);\n\nif (result.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    Console.WriteLine(\"\u2705 Order is valid - safe to send\");\n    Console.WriteLine($\"   Required margin: ${result.MqlTradeCheckResult.Margin:F2}\");\n    Console.WriteLine($\"   Free margin after: ${result.MqlTradeCheckResult.MarginFree:F2}\");\n\n    // Now send the order\n    await svc.OrderSendAsync(new OrderSendRequest { MqlTradeRequest = tradeReq });\n}\nelse\n{\n    Console.WriteLine($\"\u274c Order invalid: {result.MqlTradeCheckResult.Comment}\");\n    Console.WriteLine($\"   Error code: {result.MqlTradeCheckResult.ReturnedCode}\");\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-2-validate-before-large-order","title":"Example 2: Validate Before Large Order","text":"<pre><code>public async Task&lt;bool&gt; ValidateAndPlaceLargeOrder(\n    MT5Service svc,\n    string symbol,\n    double volume)\n{\n    // Build order request\n    var tradeReq = new MqlTradeRequest\n    {\n        Symbol = symbol,\n        Volume = volume,\n        Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n        Price = 0\n    };\n\n    // Validate first\n    var checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\n    var validation = await svc.ValidateOrderAsync(checkReq);\n\n    if (validation.MqlTradeCheckResult.ReturnedCode != 0)\n    {\n        Console.WriteLine($\"\u274c Cannot place {volume} lots:\");\n        Console.WriteLine($\"   {validation.MqlTradeCheckResult.Comment}\");\n\n        // Check if margin issue\n        if (validation.MqlTradeCheckResult.Comment.Contains(\"margin\"))\n        {\n            Console.WriteLine($\"   Required: ${validation.MqlTradeCheckResult.Margin:F2}\");\n            Console.WriteLine($\"   Available: ${validation.MqlTradeCheckResult.MarginFree:F2}\");\n            Console.WriteLine(\"   Consider reducing volume or adding funds\");\n        }\n\n        return false;\n    }\n\n    // Validation passed - send order\n    var sendReq = new OrderSendRequest { MqlTradeRequest = tradeReq };\n    var result = await svc.OrderSendAsync(sendReq);\n\n    Console.WriteLine($\"\u2705 Order placed: Ticket #{result.Order}\");\n    return true;\n}\n\n// Usage:\nbool success = await ValidateAndPlaceLargeOrder(svc, \"EURUSD\", volume: 10.0);\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-3-validate-multiple-symbols","title":"Example 3: Validate Multiple Symbols","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"XAUUSD\" };\ndouble volume = 0.10;\n\nConsole.WriteLine($\"Validating {volume} lots for multiple symbols:\\n\");\n\nforeach (var symbol in symbols)\n{\n    var tradeReq = new MqlTradeRequest\n    {\n        Symbol = symbol,\n        Volume = volume,\n        Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n        Price = 0\n    };\n\n    var checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\n    var result = await svc.ValidateOrderAsync(checkReq);\n\n    if (result.MqlTradeCheckResult.ReturnedCode == 0)\n    {\n        Console.WriteLine($\"\u2705 {symbol,-8} Margin: ${result.MqlTradeCheckResult.Margin,8:F2}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c {symbol,-8} {result.MqlTradeCheckResult.Comment}\");\n    }\n}\n\n// Output:\n// Validating 0.1 lots for multiple symbols:\n//\n// \u2705 EURUSD   Margin: $  108.50\n// \u2705 GBPUSD   Margin: $  127.30\n// \u2705 USDJPY   Margin: $   99.20\n// \u274c XAUUSD   Not enough money\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-4-validate-with-sltp","title":"Example 4: Validate with SL/TP","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\nvar tradeReq = new MqlTradeRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n    Price = 0,  // Market\n    StopLoss = tick.Bid - 50 * point,   // 50 points below\n    TakeProfit = tick.Ask + 100 * point  // 100 points above\n};\n\nvar checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\nvar result = await svc.ValidateOrderAsync(checkReq);\n\nif (result.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    Console.WriteLine(\"\u2705 Order with SL/TP is valid\");\n    Console.WriteLine($\"   SL: {tradeReq.StopLoss:F5}\");\n    Console.WriteLine($\"   TP: {tradeReq.TakeProfit:F5}\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Invalid SL/TP: {result.MqlTradeCheckResult.Comment}\");\n    // Common: \"Invalid stops\" if too close to current price\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-5-check-margin-level","title":"Example 5: Check Margin Level","text":"<pre><code>var tradeReq = new MqlTradeRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 5.0,  // Large volume\n    Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n    Price = 0\n};\n\nvar checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\nvar result = await svc.ValidateOrderAsync(checkReq);\n\nif (result.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    double marginLevel = result.MqlTradeCheckResult.MarginLevel;\n\n    Console.WriteLine($\"After order:\");\n    Console.WriteLine($\"  Balance: ${result.MqlTradeCheckResult.Balance:F2}\");\n    Console.WriteLine($\"  Equity: ${result.MqlTradeCheckResult.Equity:F2}\");\n    Console.WriteLine($\"  Margin Level: {marginLevel:F2}%\");\n\n    if (marginLevel &lt; 200)\n    {\n        Console.WriteLine(\"\u26a0\ufe0f WARNING: Low margin level after order!\");\n        Console.WriteLine(\"   Consider reducing volume\");\n    }\n    else\n    {\n        Console.WriteLine(\"\u2705 Healthy margin level - safe to proceed\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-6-validate-pending-order","title":"Example 6: Validate Pending Order","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Buy Limit 50 points below current Ask\ndouble entryPrice = tick.Ask - 50 * point;\n\nvar tradeReq = new MqlTradeRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.05,\n    Type = ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    Price = entryPrice,\n    StopLoss = entryPrice - 30 * point,\n    TakeProfit = entryPrice + 90 * point\n};\n\nvar checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\nvar result = await svc.ValidateOrderAsync(checkReq);\n\nif (result.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    Console.WriteLine($\"\u2705 Buy Limit valid at {entryPrice:F5}\");\n    await svc.OrderSendAsync(new OrderSendRequest { MqlTradeRequest = tradeReq });\n}\nelse\n{\n    Console.WriteLine($\"\u274c Pending order invalid: {result.MqlTradeCheckResult.Comment}\");\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-7-batch-validation","title":"Example 7: Batch Validation","text":"<pre><code>public async Task&lt;List&lt;string&gt;&gt; ValidateBatchOrders(\n    MT5Service svc,\n    List&lt;MqlTradeRequest&gt; orders)\n{\n    var validSymbols = new List&lt;string&gt;();\n\n    foreach (var order in orders)\n    {\n        var checkReq = new OrderCheckRequest { MqlTradeRequest = order };\n        var result = await svc.ValidateOrderAsync(checkReq);\n\n        if (result.MqlTradeCheckResult.ReturnedCode == 0)\n        {\n            validSymbols.Add(order.Symbol);\n            Console.WriteLine($\"\u2705 {order.Symbol}: Valid\");\n        }\n        else\n        {\n            Console.WriteLine($\"\u274c {order.Symbol}: {result.MqlTradeCheckResult.Comment}\");\n        }\n    }\n\n    Console.WriteLine($\"\\n{validSymbols.Count}/{orders.Count} orders are valid\");\n    return validSymbols;\n}\n\n// Usage:\nvar orders = new List&lt;MqlTradeRequest&gt;\n{\n    new() { Symbol = \"EURUSD\", Volume = 0.1, Type = ENUM_ORDER_TYPE.OrderTypeBuy },\n    new() { Symbol = \"GBPUSD\", Volume = 0.1, Type = ENUM_ORDER_TYPE.OrderTypeBuy },\n    new() { Symbol = \"USDJPY\", Volume = 0.1, Type = ENUM_ORDER_TYPE.OrderTypeBuy }\n};\n\nvar valid = await ValidateBatchOrders(svc, orders);\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-8-error-code-analysis","title":"Example 8: Error Code Analysis","text":"<pre><code>var tradeReq = new MqlTradeRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n    Price = 0\n};\n\nvar checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\nvar result = await svc.ValidateOrderAsync(checkReq);\n\nint code = result.MqlTradeCheckResult.ReturnedCode;\n\nif (code == 0)\n{\n    Console.WriteLine(\"\u2705 Valid\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Error code: {code}\");\n\n    // Common error codes:\n    switch (code)\n    {\n        case 10004:\n            Console.WriteLine(\"   Requote\");\n            break;\n        case 10006:\n            Console.WriteLine(\"   Rejected\");\n            break;\n        case 10014:\n            Console.WriteLine(\"   Invalid volume\");\n            break;\n        case 10019:\n            Console.WriteLine(\"   Not enough money\");\n            break;\n        case 10021:\n            Console.WriteLine(\"   Market closed\");\n            break;\n        default:\n            Console.WriteLine($\"   {result.MqlTradeCheckResult.Comment}\");\n            break;\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-9-retry-with-reduced-volume","title":"Example 9: Retry with Reduced Volume","text":"<pre><code>public async Task&lt;double&gt; FindMaxValidVolume(\n    MT5Service svc,\n    string symbol,\n    double startVolume)\n{\n    double volume = startVolume;\n    double minVolume = 0.01;\n\n    while (volume &gt;= minVolume)\n    {\n        var tradeReq = new MqlTradeRequest\n        {\n            Symbol = symbol,\n            Volume = volume,\n            Type = ENUM_ORDER_TYPE.OrderTypeBuy,\n            Price = 0\n        };\n\n        var checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\n        var result = await svc.ValidateOrderAsync(checkReq);\n\n        if (result.MqlTradeCheckResult.ReturnedCode == 0)\n        {\n            Console.WriteLine($\"\u2705 Maximum valid volume: {volume} lots\");\n            return volume;\n        }\n\n        // Reduce by 10%\n        volume *= 0.9;\n        volume = Math.Round(volume, 2);\n\n        Console.WriteLine($\"   Trying {volume} lots...\");\n    }\n\n    Console.WriteLine(\"\u274c No valid volume found\");\n    return 0;\n}\n\n// Usage:\ndouble maxVolume = await FindMaxValidVolume(svc, \"EURUSD\", startVolume: 10.0);\nif (maxVolume &gt; 0)\n{\n    await svc.BuyMarketAsync(\"EURUSD\", maxVolume);\n}\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#example-10-compare-multiple-order-types","title":"Example 10: Compare Multiple Order Types","text":"<pre><code>var orderTypes = new[]\n{\n    ENUM_ORDER_TYPE.OrderTypeBuy,\n    ENUM_ORDER_TYPE.OrderTypeSell,\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    ENUM_ORDER_TYPE.OrderTypeSellLimit\n};\n\nConsole.WriteLine(\"Comparing margin requirements:\\n\");\n\nforeach (var type in orderTypes)\n{\n    var tradeReq = new MqlTradeRequest\n    {\n        Symbol = \"EURUSD\",\n        Volume = 1.0,\n        Type = type,\n        Price = type == ENUM_ORDER_TYPE.OrderTypeBuy || type == ENUM_ORDER_TYPE.OrderTypeSell\n            ? 0\n            : 1.08500  // Pending order price\n    };\n\n    var checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\n    var result = await svc.ValidateOrderAsync(checkReq);\n\n    if (result.MqlTradeCheckResult.ReturnedCode == 0)\n    {\n        Console.WriteLine($\"{type,-20} Margin: ${result.MqlTradeCheckResult.Margin:F2}\");\n    }\n}\n\n// Output:\n// Comparing margin requirements:\n//\n// OrderTypeBuy         Margin: $1085.00\n// OrderTypeSell        Margin: $1085.00\n// OrderTypeBuyLimit    Margin: $1085.00\n// OrderTypeSellLimit   Margin: $1085.00\n</code></pre>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>OrderCheckAsync()</code> - Low-level validation RPC call</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>CheckMarginAvailabilityAsync()</code> - Simpler margin-only check</li> <li><code>CalculateBuyMarginAsync()</code> - Calculate margin for BUY</li> <li><code>CalculateSellMarginAsync()</code> - Calculate margin for SELL</li> </ul> <p>\ud83d\udcca When to use:</p> <ul> <li>Use <code>ValidateOrderAsync()</code> for full validation (symbol, volume, margin, stops)</li> <li>Use <code>CheckMarginAvailabilityAsync()</code> for quick margin-only check</li> <li>Use <code>CalculateBuyMarginAsync()</code> / <code>CalculateSellMarginAsync()</code> for margin estimation only</li> </ul>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Not checking return code: <pre><code>// \u274c WRONG: Ignoring validation result\nawait svc.ValidateOrderAsync(checkReq);\nawait svc.OrderSendAsync(sendReq);  // May still fail!\n\n// \u2705 CORRECT: Check return code\nvar result = await svc.ValidateOrderAsync(checkReq);\nif (result.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    await svc.OrderSendAsync(sendReq);\n}\n</code></pre></p> </li> <li> <p>Assuming validation guarantees execution: <pre><code>// \u26a0\ufe0f Validation passed, but order can still fail due to:\n// - Price movement between validation and execution\n// - Margin changes from other positions\n// - Market closure\n// - Broker rejection\n\nvar result = await svc.ValidateOrderAsync(checkReq);\nif (result.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    // Still handle OrderSendAsync errors!\n    try\n    {\n        await svc.OrderSendAsync(sendReq);\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"Order failed despite validation: {ex.Message}\");\n    }\n}\n</code></pre></p> </li> <li> <p>Forgetting Price parameter for pending orders: <pre><code>// \u274c WRONG: Price = 0 for pending order\nvar tradeReq = new MqlTradeRequest\n{\n    Type = ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    Price = 0  // Invalid for pending orders!\n};\n\n// \u2705 CORRECT: Specify entry price\nvar tradeReq = new MqlTradeRequest\n{\n    Type = ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    Price = 1.08500  // Must specify for pending\n};\n</code></pre></p> </li> <li> <p>Not normalizing prices: <pre><code>// \u26a0\ufe0f Prices should be normalized to tick size\ndouble slPrice = 1.085234567;  // Too many decimals\n\n// \u2705 BETTER: Normalize first\ndouble slPrice = await svc.NormalizePriceAsync(\"EURUSD\", 1.085234567);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/13.%20Order_Validation/ValidateOrderAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>ValidateOrderAsync provides pre-flight order validation:</p> <ul> <li>\u2705 Validates symbol, volume, margin, stops</li> <li>\u2705 Returns detailed error codes and messages</li> <li>\u2705 Shows account state after order (balance, equity, margin level)</li> <li>\u2705 Prevents broker rejections by catching errors early</li> <li>\u2b50 Use before ALL orders to ensure they'll be accepted</li> </ul> <pre><code>// Professional pattern:\nvar checkReq = new OrderCheckRequest { MqlTradeRequest = tradeReq };\nvar validation = await svc.ValidateOrderAsync(checkReq);\n\nif (validation.MqlTradeCheckResult.ReturnedCode == 0)\n{\n    await svc.OrderSendAsync(new OrderSendRequest { MqlTradeRequest = tradeReq });\n}\nelse\n{\n    Console.WriteLine($\"\u274c {validation.MqlTradeCheckResult.Comment}\");\n}\n</code></pre> <p>Validate first, trade safely! \ud83d\udee1\ufe0f</p>"},{"location":"MT5Sugar/14.%20Session_Time/GetQuoteSessionAsync/","title":"Get Quote Session (<code>GetQuoteSessionAsync</code>)","text":"<p>Utility method: Get quote session times for a symbol - when you can see prices.</p> <p>API: <code>MT5Service.GetQuoteSessionAsync(...)</code> Region: [14] SESSION TIME</p>"},{"location":"MT5Sugar/14.%20Session_Time/GetQuoteSessionAsync/#signature","title":"Signature","text":"<pre><code>public static Task&lt;SymbolInfoSessionQuoteData&gt; GetQuoteSessionAsync(\n    this MT5Service svc,\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    int sessionIndex = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n    =&gt; svc.SymbolInfoSessionQuoteAsync(symbol, dayOfWeek, sessionIndex, Dl(timeoutSec), ct);\n</code></pre>"},{"location":"MT5Sugar/14.%20Session_Time/GetQuoteSessionAsync/#examples","title":"Examples","text":"<pre><code>// Get Monday quote session\nvar session = await svc.GetQuoteSessionAsync(\"EURUSD\", DayOfWeek.Monday, sessionIndex: 0);\nConsole.WriteLine($\"Quote hours: {session.From} - {session.To} UTC\");\n\n// Check all weekdays\nfor (int day = 1; day &lt;= 5; day++)\n{\n    var s = await svc.GetQuoteSessionAsync(\"XAUUSD\", (DayOfWeek)day, 0);\n    Console.WriteLine($\"{(DayOfWeek)day}: {s.From} - {s.To}\");\n}\n</code></pre>"},{"location":"MT5Sugar/14.%20Session_Time/GetQuoteSessionAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Wrapper for <code>SymbolInfoSessionQuoteAsync()</code></li> <li>\u2705 Quote session = when prices are available</li> <li>\u2705 Usually same as trade session</li> </ul>"},{"location":"MT5Sugar/14.%20Session_Time/GetTradeSessionAsync/","title":"Get Trade Session (<code>GetTradeSessionAsync</code>)","text":"<p>Utility method: Get trade session times for a symbol - when you can execute orders.</p> <p>API: <code>MT5Service.GetTradeSessionAsync(...)</code> Region: [14] SESSION TIME</p>"},{"location":"MT5Sugar/14.%20Session_Time/GetTradeSessionAsync/#signature","title":"Signature","text":"<pre><code>public static Task&lt;SymbolInfoSessionTradeData&gt; GetTradeSessionAsync(\n    this MT5Service svc,\n    string symbol,\n    mt5_term_api.DayOfWeek dayOfWeek,\n    int sessionIndex = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n    =&gt; svc.SymbolInfoSessionTradeAsync(symbol, dayOfWeek, sessionIndex, Dl(timeoutSec), ct);\n</code></pre>"},{"location":"MT5Sugar/14.%20Session_Time/GetTradeSessionAsync/#examples","title":"Examples","text":"<pre><code>// Get Friday trade session\nvar session = await svc.GetTradeSessionAsync(\"EURUSD\", DayOfWeek.Friday, sessionIndex: 0);\nConsole.WriteLine($\"Trading hours: {session.From} - {session.To} UTC\");\n\n// Check if market is open now\nvar now = DateTime.UtcNow;\nvar todaySession = await svc.GetTradeSessionAsync(\n    \"EURUSD\",\n    (mt5_term_api.DayOfWeek)(int)now.DayOfWeek,\n    0);\n\nvar from = TimeSpan.Parse(todaySession.From);\nvar to = TimeSpan.Parse(todaySession.To);\nbool isOpen = now.TimeOfDay &gt;= from &amp;&amp; now.TimeOfDay &lt;= to;\n\nConsole.WriteLine(isOpen ? \"\ud83d\udfe2 Market OPEN\" : \"\ud83d\udd34 Market CLOSED\");\n</code></pre>"},{"location":"MT5Sugar/14.%20Session_Time/GetTradeSessionAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Wrapper for <code>SymbolInfoSessionTradeAsync()</code></li> <li>\u2705 Trade session = when orders can execute</li> <li>\u2705 Essential for automated trading bots</li> </ul>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetLosingPositionsAsync/","title":"Get Losing Positions (<code>GetLosingPositionsAsync</code>)","text":"<p>Monitoring method: Filter all positions with profit &lt; 0.</p> <p>API: <code>MT5Service.GetLosingPositionsAsync(...)</code> Region: [15] POSITION MONITORING</p>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetLosingPositionsAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;List&lt;object&gt;&gt; GetLosingPositionsAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetLosingPositionsAsync/#examples","title":"Examples","text":"<pre><code>// All losers\nvar losers = await svc.GetLosingPositionsAsync();\nConsole.WriteLine($\"Losing positions: {losers.Count}\");\n\n// Cut losses if too many\nif (losers.Count &gt; winners.Count)\n{\n    foreach (var pos in losers)\n    {\n        var ticket = Convert.ToUInt64(pos.GetType().GetProperty(\"Ticket\")?.GetValue(pos));\n        await svc.CloseByTicket(ticket);\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetLosingPositionsAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Returns <code>List&lt;object&gt;</code> of losing positions</li> <li>\u2705 Optional symbol filter</li> <li>\u2705 Perfect for stop-loss strategies</li> </ul>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionCountAsync/","title":"Get Position Count (<code>GetPositionCountAsync</code>)","text":"<p>Monitoring method: Count open market positions.</p> <p>API: <code>MT5Service.GetPositionCountAsync(...)</code> Region: [15] POSITION MONITORING</p>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionCountAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;int&gt; GetPositionCountAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionCountAsync/#examples","title":"Examples","text":"<pre><code>// Total positions\nint total = await svc.GetPositionCountAsync();\nConsole.WriteLine($\"Open positions: {total}\");\n\n// Per-symbol count\nint eurusd = await svc.GetPositionCountAsync(symbol: \"EURUSD\");\n\n// Position limit enforcement\nint maxPositions = 10;\nint current = await svc.GetPositionCountAsync();\n\nif (current &lt; maxPositions)\n{\n    await svc.BuyMarketByRisk(\"EURUSD\", 50, 100);\n}\nelse\n{\n    Console.WriteLine($\"\u26a0\ufe0f Position limit reached: {current}/{maxPositions}\");\n}\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionCountAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Returns int count</li> <li>\u2705 Optional symbol filter</li> <li>\u2705 Perfect for position limit enforcement</li> </ul>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionStatsBySymbolAsync/","title":"Get Position Stats By Symbol (<code>GetPositionStatsBySymbolAsync</code>)","text":"<p>Portfolio method: Aggregate position statistics per symbol - count, volume, and P&amp;L.</p> <p>API: <code>MT5Service.GetPositionStatsBySymbolAsync(...)</code> Region: [15] POSITION MONITORING</p>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionStatsBySymbolAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;Dictionary&lt;string, (int count, double totalVolume, double totalPnL)&gt;&gt;\n    GetPositionStatsBySymbolAsync(\n        this MT5Service svc,\n        int timeoutSec = 20,\n        CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionStatsBySymbolAsync/#returns","title":"Returns","text":"<p>Dictionary <ul> <li>Key: Symbol name (e.g., \"EURUSD\", \"XAUUSD\")</li> <li>Value Tuple:</li> <li><code>count</code> - Number of open positions</li> <li><code>totalVolume</code> - Sum of all position volumes (lots)</li> <li><code>totalPnL</code> - Total profit/loss for this symbol</li> </ul>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionStatsBySymbolAsync/#examples","title":"Examples","text":"<pre><code>// Get portfolio breakdown\nvar stats = await svc.GetPositionStatsBySymbolAsync();\n\nConsole.WriteLine(\"\ud83d\udcca Portfolio Statistics:\");\nforeach (var (symbol, (count, volume, pnl)) in stats)\n{\n    string plEmoji = pnl &gt;= 0 ? \"\ud83d\udfe2\" : \"\ud83d\udd34\";\n    Console.WriteLine($\"{plEmoji} {symbol}: {count} positions, {volume:F2} lots, ${pnl:F2} P&amp;L\");\n}\n\n// Example output:\n// \ud83d\udcca Portfolio Statistics:\n// \ud83d\udfe2 EURUSD: 3 positions, 0.30 lots, $45.50 P&amp;L\n// \ud83d\udd34 GBPUSD: 2 positions, 0.20 lots, -$12.30 P&amp;L\n// \ud83d\udfe2 XAUUSD: 1 positions, 0.05 lots, $89.00 P&amp;L\n\n// Find worst-performing symbol\nvar stats = await svc.GetPositionStatsBySymbolAsync();\nvar worstSymbol = stats\n    .OrderBy(kvp =&gt; kvp.Value.totalPnL)\n    .FirstOrDefault();\n\nif (worstSymbol.Key != null)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Worst performer: {worstSymbol.Key} with ${worstSymbol.Value.totalPnL:F2}\");\n\n    if (worstSymbol.Value.totalPnL &lt; -100)\n    {\n        Console.WriteLine($\"\ud83d\udea8 Closing all {worstSymbol.Key} positions!\");\n        // Close all positions for this symbol\n        var positions = await svc.GetLosingPositionsAsync(worstSymbol.Key);\n        // ... close logic\n    }\n}\n\n// Portfolio diversification check\nvar stats = await svc.GetPositionStatsBySymbolAsync();\nint symbolCount = stats.Count;\ndouble totalVolume = stats.Sum(kvp =&gt; kvp.Value.totalVolume);\n\nConsole.WriteLine($\"\ud83d\udcc8 Trading {symbolCount} symbols with total {totalVolume:F2} lots\");\n\nforeach (var (symbol, (count, volume, pnl)) in stats)\n{\n    double volumePercent = (volume / totalVolume) * 100;\n    Console.WriteLine($\"  {symbol}: {volumePercent:F1}% of portfolio\");\n\n    if (volumePercent &gt; 40)\n    {\n        Console.WriteLine($\"  \u26a0\ufe0f Over-concentrated in {symbol}!\");\n    }\n}\n\n// Symbol exposure limits\nvar maxPositionsPerSymbol = 5;\nvar stats = await svc.GetPositionStatsBySymbolAsync();\n\nbool canTrade = true;\nif (stats.TryGetValue(\"EURUSD\", out var eurusdStats))\n{\n    if (eurusdStats.count &gt;= maxPositionsPerSymbol)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f EURUSD limit reached: {eurusdStats.count}/{maxPositionsPerSymbol}\");\n        canTrade = false;\n    }\n}\n\nif (canTrade)\n{\n    await svc.BuyMarketByRisk(\"EURUSD\", 50, 100);\n}\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetPositionStatsBySymbolAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Returns dictionary grouped by symbol</li> <li>\u2705 Includes count, total volume, and total P&amp;L</li> <li>\u2705 Perfect for portfolio analytics and risk management</li> </ul>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetProfitablePositionsAsync/","title":"Get Profitable Positions (<code>GetProfitablePositionsAsync</code>)","text":"<p>Monitoring method: Filter all positions with profit &gt; 0.</p> <p>API: <code>MT5Service.GetProfitablePositionsAsync(...)</code> Region: [15] POSITION MONITORING</p>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetProfitablePositionsAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;List&lt;object&gt;&gt; GetProfitablePositionsAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetProfitablePositionsAsync/#examples","title":"Examples","text":"<pre><code>// All winners\nvar winners = await svc.GetProfitablePositionsAsync();\nConsole.WriteLine($\"Winning positions: {winners.Count}\");\n\n// EURUSD winners only\nvar eurusdWinners = await svc.GetProfitablePositionsAsync(symbol: \"EURUSD\");\n\n// Close all winners\nforeach (var pos in winners)\n{\n    var ticket = Convert.ToUInt64(pos.GetType().GetProperty(\"Ticket\")?.GetValue(pos));\n    await svc.CloseByTicket(ticket);\n}\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetProfitablePositionsAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Returns <code>List&lt;object&gt;</code> of winning positions</li> <li>\u2705 Optional symbol filter</li> <li>\u2705 Perfect for profit-taking strategies</li> </ul>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetTotalProfitLossAsync/","title":"Get Total Profit/Loss (<code>GetTotalProfitLossAsync</code>) \u2b50","text":"<p>\u2b50 CRITICAL METHOD: Calculate total unrealized P&amp;L across all open positions.</p> <p>API: <code>MT5Service.GetTotalProfitLossAsync(...)</code> Region: [15] POSITION MONITORING</p>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetTotalProfitLossAsync/#signature","title":"Signature","text":"<pre><code>public static async Task&lt;double&gt; GetTotalProfitLossAsync(\n    this MT5Service svc,\n    string? symbol = null,\n    int timeoutSec = 20,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetTotalProfitLossAsync/#examples","title":"Examples","text":"<pre><code>// Total P&amp;L\ndouble totalPL = await svc.GetTotalProfitLossAsync();\nConsole.WriteLine($\"Portfolio P&amp;L: ${totalPL:F2}\");\n\n// EUR USD P&amp;L only\ndouble eurusdPL = await svc.GetTotalProfitLossAsync(symbol: \"EURUSD\");\n\n// Risk alert\nif (totalPL &lt; -500)\n{\n    Console.WriteLine(\"\ud83d\udea8 Portfolio down $500 - emergency close!\");\n    await svc.CloseAllPositions();\n}\n\n// Real-time monitoring\nwhile (true)\n{\n    double pl = await svc.GetTotalProfitLossAsync();\n    Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] P&amp;L: ${pl:F2}\");\n    await Task.Delay(5000);\n}\n</code></pre>"},{"location":"MT5Sugar/15.%20Position_Monitoring/GetTotalProfitLossAsync/#summary","title":"Summary","text":"<ul> <li>\u2705 Returns total unrealized P&amp;L (double)</li> <li>\u2705 Optional symbol filter</li> <li>\u2b50 Essential for portfolio risk management</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/","title":"\u2705 Get Account Snapshot (<code>GetAccountSnapshot</code>)","text":"<p>Sugar method: Gets account summary and opened orders in one convenient call. Returns both as a single record.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetAccountSnapshot(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>AccountSummaryAsync()</code> + <code>OpenedOrdersAsync()</code></li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public sealed record AccountSnapshot(\n        AccountSummaryData Summary,\n        OpenedOrdersData OpenedOrders\n    );\n\n    public static async Task&lt;AccountSnapshot&gt; GetAccountSnapshot(\n        this MT5Service svc,\n        int timeoutSec = 15,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#output-accountsnapshot","title":"\u2b06\ufe0f Output \u2014 <code>AccountSnapshot</code>","text":"Field Type Description <code>Summary</code> <code>AccountSummaryData</code> Account summary (balance, equity, etc) <code>OpenedOrders</code> <code>OpenedOrdersData</code> All opened orders and positions"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#accountsummarydata-account-information","title":"<code>AccountSummaryData</code> \u2014 Account information","text":"Field Type Description <code>AccountLogin</code> <code>int64</code> Account login number <code>AccountBalance</code> <code>double</code> Account balance <code>AccountEquity</code> <code>double</code> Account equity <code>AccountUserName</code> <code>string</code> Account holder name <code>AccountLeverage</code> <code>int64</code> Account leverage <code>AccountTradeMode</code> <code>MrpcEnumAccountTradeMode</code> Trade mode (Demo/Contest/Real) <code>AccountCompanyName</code> <code>string</code> Broker company name <code>AccountCurrency</code> <code>string</code> Account currency <code>ServerTime</code> <code>Timestamp</code> Server time <code>UtcTimezoneServerTimeShiftMinutes</code> <code>int64</code> Server time UTC offset <code>AccountCredit</code> <code>double</code> Account credit"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#openedordersdata-opened-orders-and-positions","title":"<code>OpenedOrdersData</code> \u2014 Opened orders and positions","text":"Field Type Description <code>OpenedOrders</code> <code>List&lt;OpenedOrderInfo&gt;</code> Array of pending orders <code>PositionInfos</code> <code>List&lt;PositionInfo&gt;</code> Array of open positions"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. One-liner to get complete account state: balance, equity, and all active positions/orders.</li> <li>Why you need it. Avoid two separate API calls. Get everything needed for dashboards, risk checks, position monitoring.</li> <li>Sanity check. Returns record with <code>Summary</code> (account data) and <code>OpenedOrders</code> (positions/orders). Check counts and balances.</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for account monitoring:</p> <ul> <li>Display account dashboard.</li> <li>Check account balance and equity before trading.</li> <li>Get list of active positions and pending orders.</li> <li>Calculate risk metrics (margin level, exposure).</li> <li>Quick account health check.</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Single call: Combines two API calls internally but feels like one operation.</li> <li>Atomic snapshot: Both calls use same deadline, so data is relatively synchronized.</li> <li>Sorted orders: Orders sorted by open time (ascending) by default.</li> <li>Timeout: 15 seconds default is usually enough for both calls.</li> <li>Record type: Returns immutable <code>AccountSnapshot</code> record with two properties.</li> <li>No filtering: Returns all opened orders/positions. Filter in your code if needed.</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method combines two low-level calls:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Step 1: Get account summary (balance, equity, leverage, etc)\nvar summary = await svc.AccountSummaryAsync(deadline, ct);\n\n// Step 2: Get all opened orders and positions\nvar openedOrders = await svc.OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc, deadline, ct);\n\n// Step 3: Return as single record\nreturn new AccountSnapshot(summary, openedOrders);\n</code></pre> <p>What it improves:</p> <ul> <li>Combines 2 calls into 1 - simpler API</li> <li>Shared deadline - both calls use same timeout</li> <li>Single return type - immutable record with both results</li> <li>Clearer intent - \"get account snapshot\" vs \"get summary + get orders\"</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar (manual approach): <pre><code>// You have to do this manually:\nvar deadline = DateTime.UtcNow.AddSeconds(15);\n\n// Call 1: Get account summary\nvar summary = await svc.AccountSummaryAsync(deadline, ct);\n\n// Call 2: Get opened orders\nvar openedOrders = await svc.OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc, deadline, ct);\n\n// Now you have two separate objects to work with\nConsole.WriteLine($\"Balance: {summary.AccountBalance}\");\nConsole.WriteLine($\"Positions: {openedOrders.PositionInfos.Count}\");\n</code></pre></p> <p>WITH sugar (one-liner): <pre><code>// Sugar method does all of the above:\nvar snapshot = await svc.GetAccountSnapshot();\n\n// Work with single object:\nConsole.WriteLine($\"Balance: {snapshot.Summary.AccountBalance}\");\nConsole.WriteLine($\"Positions: {snapshot.OpenedOrders.PositionInfos.Count}\");\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 2 calls \u2192 1 call</li> <li>\u2705 Automatic deadline management</li> <li>\u2705 Single object to work with</li> <li>\u2705 Guaranteed consistency (both calls use same deadline)</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#1-basic-account-snapshot","title":"1) Basic account snapshot","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar snapshot = await svc.GetAccountSnapshot();\n\nConsole.WriteLine(\"Account Summary:\");\nConsole.WriteLine($\"  Balance: ${snapshot.Summary.AccountBalance:F2}\");\nConsole.WriteLine($\"  Equity:  ${snapshot.Summary.AccountEquity:F2}\");\nConsole.WriteLine($\"  Leverage: 1:{snapshot.Summary.AccountLeverage}\");\nConsole.WriteLine($\"  Currency: {snapshot.Summary.AccountCurrency}\");\nConsole.WriteLine();\n\nConsole.WriteLine($\"Active Positions: {snapshot.OpenedOrders.PositionInfos.Count}\");\nConsole.WriteLine($\"Pending Orders:   {snapshot.OpenedOrders.OpenedOrders.Count}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#2-display-all-positions","title":"2) Display all positions","text":"<pre><code>var snapshot = await svc.GetAccountSnapshot();\n\nConsole.WriteLine(\"Open Positions:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var pos in snapshot.OpenedOrders.PositionInfos)\n{\n    var type = pos.Type == 0 ? \"BUY\" : \"SELL\";\n    var profitSign = pos.Profit &gt;= 0 ? \"+\" : \"\";\n\n    Console.WriteLine($\"#{pos.Ticket} {type} {pos.Symbol}\");\n    Console.WriteLine($\"  Volume: {pos.Volume} lots\");\n    Console.WriteLine($\"  Entry:  {pos.PriceOpen}\");\n    Console.WriteLine($\"  P/L:    {profitSign}${pos.Profit:F2}\");\n    Console.WriteLine();\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#3-calculate-total-exposure","title":"3) Calculate total exposure","text":"<pre><code>var snapshot = await svc.GetAccountSnapshot();\n\nvar totalProfit = snapshot.OpenedOrders.PositionInfos.Sum(p =&gt; p.Profit);\nvar totalVolume = snapshot.OpenedOrders.PositionInfos.Sum(p =&gt; p.Volume);\n\nConsole.WriteLine($\"Account Equity:  ${snapshot.Summary.AccountEquity:F2}\");\nConsole.WriteLine($\"Total Positions: {snapshot.OpenedOrders.PositionInfos.Count}\");\nConsole.WriteLine($\"Total Volume:    {totalVolume:F2} lots\");\nConsole.WriteLine($\"Total P/L:       ${totalProfit:F2}\");\n\nvar returnPct = (totalProfit / snapshot.Summary.AccountBalance) * 100;\nConsole.WriteLine($\"Return:          {returnPct:F2}%\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#4-check-if-account-can-trade","title":"4) Check if account can trade","text":"<pre><code>var snapshot = await svc.GetAccountSnapshot();\n\nvar balance = snapshot.Summary.AccountBalance;\nvar equity = snapshot.Summary.AccountEquity;\nvar openPositions = snapshot.OpenedOrders.PositionInfos.Count;\n\nbool canTrade = true;\nList&lt;string&gt; warnings = new();\n\nif (equity &lt; balance * 0.5)\n{\n    warnings.Add($\"Low equity: ${equity:F2} (50% of balance)\");\n    canTrade = false;\n}\n\nif (openPositions &gt;= 10)\n{\n    warnings.Add($\"Too many positions: {openPositions}\");\n    canTrade = false;\n}\n\nif (canTrade)\n{\n    Console.WriteLine(\"\u2713 Account OK for trading\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0 Trading not recommended:\");\n    foreach (var warning in warnings)\n    {\n        Console.WriteLine($\"  \u2022 {warning}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#5-group-positions-by-symbol","title":"5) Group positions by symbol","text":"<pre><code>var snapshot = await svc.GetAccountSnapshot();\n\nvar positionsBySymbol = snapshot.OpenedOrders.PositionInfos\n    .GroupBy(p =&gt; p.Symbol)\n    .Select(g =&gt; new\n    {\n        Symbol = g.Key,\n        Count = g.Count(),\n        TotalVolume = g.Sum(p =&gt; p.Volume),\n        TotalProfit = g.Sum(p =&gt; p.Profit)\n    })\n    .OrderByDescending(x =&gt; x.TotalVolume);\n\nConsole.WriteLine(\"Positions by Symbol:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var group in positionsBySymbol)\n{\n    Console.WriteLine($\"{group.Symbol,-10} Count: {group.Count,2} | \" +\n                     $\"Volume: {group.TotalVolume,6:F2} | \" +\n                     $\"P/L: ${group.TotalProfit,8:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#6-risk-dashboard","title":"6) Risk dashboard","text":"<pre><code>var snapshot = await svc.GetAccountSnapshot();\n\nvar balance = snapshot.Summary.AccountBalance;\nvar equity = snapshot.Summary.AccountEquity;\nvar totalProfit = snapshot.OpenedOrders.PositionInfos.Sum(p =&gt; p.Profit);\nvar totalSwap = snapshot.OpenedOrders.PositionInfos.Sum(p =&gt; p.Swap);\n\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\nConsole.WriteLine(\"          RISK DASHBOARD                   \");\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\nConsole.WriteLine();\nConsole.WriteLine($\"Balance:       ${balance,12:F2}\");\nConsole.WriteLine($\"Equity:        ${equity,12:F2}\");\nConsole.WriteLine($\"Floating P/L:  ${totalProfit,12:F2}\");\nConsole.WriteLine($\"Swap:          ${totalSwap,12:F2}\");\nConsole.WriteLine();\nConsole.WriteLine($\"Positions:     {snapshot.OpenedOrders.PositionInfos.Count,12}\");\nConsole.WriteLine($\"Pending:       {snapshot.OpenedOrders.OpenedOrders.Count,12}\");\nConsole.WriteLine();\n\nvar drawdown = balance - equity;\nvar drawdownPct = (drawdown / balance) * 100;\n\nif (drawdownPct &gt; 0)\n{\n    Console.WriteLine($\"Drawdown:      ${drawdown,12:F2} ({drawdownPct:F2}%)\");\n}\nelse\n{\n    var profit = equity - balance;\n    var profitPct = (profit / balance) * 100;\n    Console.WriteLine($\"Profit:        ${profit,12:F2} ({profitPct:F2}%)\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#7-monitor-positions-in-loop","title":"7) Monitor positions in loop","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromMinutes(1)); // Monitor for 1 minute\n\ntry\n{\n    while (!cts.Token.IsCancellationRequested)\n    {\n        var snapshot = await svc.GetAccountSnapshot(ct: cts.Token);\n\n        Console.Clear();\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Account Monitor\");\n        Console.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n        Console.WriteLine($\"Equity: ${snapshot.Summary.AccountEquity:F2}\");\n        Console.WriteLine($\"Positions: {snapshot.OpenedOrders.PositionInfos.Count}\");\n\n        foreach (var pos in snapshot.OpenedOrders.PositionInfos.Take(5))\n        {\n            var sign = pos.Profit &gt;= 0 ? \"+\" : \"\";\n            Console.WriteLine($\"  {pos.Symbol}: {sign}${pos.Profit:F2}\");\n        }\n\n        await Task.Delay(2000, cts.Token); // Update every 2 seconds\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"\\nMonitoring stopped\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#8-check-account-mode-demoreal","title":"8) Check account mode (Demo/Real)","text":"<pre><code>var snapshot = await svc.GetAccountSnapshot();\n\nvar tradeMode = snapshot.Summary.AccountTradeMode;\n\nstring modeText = tradeMode switch\n{\n    MrpcEnumAccountTradeMode.MrpcAccountTradeModeDemo =&gt; \"\ud83d\udd35 DEMO\",\n    MrpcEnumAccountTradeModeReal =&gt; \"\ud83d\udd34 REAL\",\n    MrpcEnumAccountTradeModeContest =&gt; \"\ud83c\udfc6 CONTEST\",\n    _ =&gt; \"\u2753 UNKNOWN\"\n};\n\nConsole.WriteLine($\"Account Mode: {modeText}\");\nConsole.WriteLine($\"Login: {snapshot.Summary.AccountLogin}\");\nConsole.WriteLine($\"Broker: {snapshot.Summary.AccountCompanyName}\");\nConsole.WriteLine($\"Name: {snapshot.Summary.AccountUserName}\");\n\nif (tradeMode == MrpcEnumAccountTradeMode.MrpcAccountTradeModeReal)\n{\n    Console.WriteLine(\"\\n\u26a0\ufe0f  WARNING: Trading on REAL account!\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#9-export-to-json","title":"9) Export to JSON","text":"<pre><code>using System.Text.Json;\n\nvar snapshot = await svc.GetAccountSnapshot();\n\nvar report = new\n{\n    Timestamp = DateTime.UtcNow,\n    Account = new\n    {\n        snapshot.Summary.AccountLogin,\n        snapshot.Summary.AccountBalance,\n        snapshot.Summary.AccountEquity,\n        snapshot.Summary.AccountCurrency\n    },\n    Positions = snapshot.OpenedOrders.PositionInfos.Select(p =&gt; new\n    {\n        p.Ticket,\n        p.Symbol,\n        Type = p.Type == 0 ? \"BUY\" : \"SELL\",\n        p.Volume,\n        p.PriceOpen,\n        p.Profit\n    })\n};\n\nvar json = JsonSerializer.Serialize(report, new JsonSerializerOptions\n{\n    WriteIndented = true\n});\n\nFile.WriteAllText(\"account_snapshot.json\", json);\nConsole.WriteLine(\"Snapshot exported to account_snapshot.json\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#10-compare-with-previous-snapshot","title":"10) Compare with previous snapshot","text":"<pre><code>AccountSnapshot? previous = null;\n\nwhile (true)\n{\n    var current = await svc.GetAccountSnapshot();\n\n    if (previous != null)\n    {\n        var balanceChange = current.Summary.AccountBalance - previous.Summary.AccountBalance;\n        var equityChange = current.Summary.AccountEquity - previous.Summary.AccountEquity;\n        var positionChange = current.OpenedOrders.PositionInfos.Count - previous.OpenedOrders.PositionInfos.Count;\n\n        if (balanceChange != 0)\n            Console.WriteLine($\"Balance: {balanceChange:+0.00;-0.00}\");\n\n        if (equityChange != 0)\n            Console.WriteLine($\"Equity: {equityChange:+0.00;-0.00}\");\n\n        if (positionChange != 0)\n            Console.WriteLine($\"Positions: {positionChange:+0;-0}\");\n    }\n\n    previous = current;\n    await Task.Delay(5000); // Check every 5 seconds\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetAccountSnapshot/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>AccountSummaryAsync()</code> - Get account summary (balance, equity, leverage, etc) - step 1</li> <li><code>OpenedOrdersAsync()</code> - Get all opened orders and positions - step 2</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetSymbolSnapshot()</code> - Get symbol data snapshot (tick, point, digits, margin)</li> <li>All trading methods need account data for risk checks - can use this snapshot</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/","title":"\u2705 Get Symbol Snapshot (<code>GetSymbolSnapshot</code>)","text":"<p>Sugar method: Gets symbol tick, point, digits, and margin rate in one convenient call. Returns all as a single record.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetSymbolSnapshot(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>EnsureSelected()</code> + <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>SymbolInfoIntegerAsync()</code> + <code>SymbolInfoMarginRateAsync()</code></li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public sealed record SymbolSnapshot(\n        MrpcMqlTick Tick,\n        double Point,\n        int Digits,\n        SymbolInfoMarginRateData MarginRate\n    );\n\n    public static async Task&lt;SymbolSnapshot&gt; GetSymbolSnapshot(\n        this MT5Service svc,\n        string symbol,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\") <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#output-symbolsnapshot","title":"\u2b06\ufe0f Output \u2014 <code>SymbolSnapshot</code>","text":"Field Type Description <code>Tick</code> <code>MrpcMqlTick</code> Current tick (bid, ask, last, volume) <code>Point</code> <code>double</code> Symbol point size <code>Digits</code> <code>int</code> Symbol digits (decimal places) <code>MarginRate</code> <code>SymbolInfoMarginRateData</code> Margin rate for BUY orders"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#mrpcmqltick-tick-information","title":"<code>MrpcMqlTick</code> \u2014 Tick information","text":"Field Type Description <code>Time</code> <code>Timestamp</code> Tick time <code>Bid</code> <code>double</code> Current bid price <code>Ask</code> <code>double</code> Current ask price <code>Last</code> <code>double</code> Last price <code>Volume</code> <code>uint64</code> Tick volume <code>TimeMsc</code> <code>int64</code> Tick time in milliseconds <code>Flags</code> <code>uint32</code> Tick flags <code>VolumeReal</code> <code>double</code> Real volume"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#symbolinfomarginratedata-margin-rate-information","title":"<code>SymbolInfoMarginRateData</code> \u2014 Margin rate information","text":"Field Type Description <code>Initial</code> <code>double</code> Initial margin rate <code>Maintenance</code> <code>double</code> Maintenance margin rate"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. One-liner to get complete symbol state: tick prices, point size, digits, and margin requirements.</li> <li>Why you need it. Avoid multiple separate API calls. Get everything needed for price calculations, order placement, risk management.</li> <li>Sanity check. Returns record with all symbol properties. Use <code>Tick.Bid</code>/<code>Tick.Ask</code> for current prices, <code>Point</code> for price calculations, <code>Digits</code> for formatting.</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for symbol initialization:</p> <ul> <li>Get current bid/ask prices.</li> <li>Calculate price offsets using point size.</li> <li>Format prices with correct decimal places.</li> <li>Calculate margin requirements.</li> <li>Quick symbol information check.</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Single call: Combines 5 API calls internally but feels like one operation.</li> <li>Symbol selection: Automatically calls <code>EnsureSelected()</code> to ensure symbol is selected and synchronized.</li> <li>Atomic snapshot: All calls use same deadline, so data is relatively synchronized.</li> <li>BUY margin rate: Returns margin rate for BUY orders (enum value 0). For SELL, call <code>SymbolInfoMarginRateAsync()</code> separately.</li> <li>Record type: Returns immutable <code>SymbolSnapshot</code> record with four properties.</li> <li>Point vs Digits: <code>Point</code> is actual tick size (e.g., 0.00001), <code>Digits</code> is decimal places (e.g., 5). Use <code>Point</code> for calculations, <code>Digits</code> for formatting.</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method combines five low-level calls:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Step 1: Ensure symbol is selected and synchronized\nawait svc.EnsureSelected(symbol, timeoutSec, ct);\n\n// Step 2: Get current tick (bid, ask, last, volume)\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\n\n// Step 3: Get point size (minimum price change)\nvar point = (await svc.SymbolInfoDoubleAsync(symbol,\n    SymbolInfoDoubleProperty.SymbolPoint, deadline, ct)).Value;\n\n// Step 4: Get digits (decimal precision)\nvar digits = (int)(await svc.SymbolInfoIntegerAsync(symbol,\n    SymbolInfoIntegerProperty.SymbolDigits, deadline, ct)).Value;\n\n// Step 5: Get margin rate for BUY orders\nvar margin = await svc.SymbolInfoMarginRateAsync(symbol,\n    (mt5_term_api.ENUM_ORDER_TYPE)0, deadline, ct);\n\n// Step 6: Return as single record\nreturn new SymbolSnapshot(tick, point, digits, margin);\n</code></pre> <p>What it improves:</p> <ul> <li>Combines 5 calls into 1 - much simpler API</li> <li>Automatic symbol selection - ensures symbol is ready</li> <li>Shared deadline - all calls use same timeout</li> <li>Single return type - immutable record with all data</li> <li>Safe enum usage - uses enum value 0, not hardcoded name</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar (manual approach): <pre><code>// You have to do this manually:\nvar deadline = DateTime.UtcNow.AddSeconds(10);\n\n// Step 1: Select symbol\nawait svc.SymbolSelectAsync(\"EURUSD\", selected: true, deadline, ct);\n\n// Step 2: Check synchronization\nvar sync = await svc.SymbolIsSynchronizedAsync(\"EURUSD\", deadline, ct);\nif (!sync.Synchronized)\n    throw new InvalidOperationException(\"Symbol not synchronized\");\n\n// Step 3: Get tick\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\", deadline, ct);\n\n// Step 4: Get point\nvar pointResult = await svc.SymbolInfoDoubleAsync(\"EURUSD\",\n    SymbolInfoDoubleProperty.SymbolPoint, deadline, ct);\nvar point = pointResult.Value;\n\n// Step 5: Get digits\nvar digitsResult = await svc.SymbolInfoIntegerAsync(\"EURUSD\",\n    SymbolInfoIntegerProperty.SymbolDigits, deadline, ct);\nvar digits = (int)digitsResult.Value;\n\n// Step 6: Get margin rate\nvar margin = await svc.SymbolInfoMarginRateAsync(\"EURUSD\",\n    (mt5_term_api.ENUM_ORDER_TYPE)0, deadline, ct);\n\n// Now you have 4 separate variables to manage\n</code></pre></p> <p>WITH sugar (one-liner): <pre><code>// Sugar method does all of the above:\nvar snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\n// Work with single object:\nConsole.WriteLine($\"Bid: {snapshot.Tick.Bid}\");\nConsole.WriteLine($\"Point: {snapshot.Point}\");\nConsole.WriteLine($\"Digits: {snapshot.Digits}\");\nConsole.WriteLine($\"Margin: {snapshot.MarginRate.Initial}\");\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 6 steps \u2192 1 line</li> <li>\u2705 Automatic symbol selection &amp; validation</li> <li>\u2705 Automatic deadline management</li> <li>\u2705 Single object to work with</li> <li>\u2705 Type-safe int conversion for digits</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#1-basic-symbol-snapshot","title":"1) Basic symbol snapshot","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\nConsole.WriteLine(\"Symbol: EURUSD\");\nConsole.WriteLine($\"  Bid:    {snapshot.Tick.Bid}\");\nConsole.WriteLine($\"  Ask:    {snapshot.Tick.Ask}\");\nConsole.WriteLine($\"  Spread: {(snapshot.Tick.Ask - snapshot.Tick.Bid) / snapshot.Point:F1} points\");\nConsole.WriteLine($\"  Point:  {snapshot.Point}\");\nConsole.WriteLine($\"  Digits: {snapshot.Digits}\");\nConsole.WriteLine($\"  Margin (Initial):     {snapshot.MarginRate.Initial}\");\nConsole.WriteLine($\"  Margin (Maintenance): {snapshot.MarginRate.Maintenance}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#2-calculate-price-offset-in-points","title":"2) Calculate price offset in points","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"GBPUSD\");\n\nint stopLossPoints = 100;\ndouble slPrice = snapshot.Tick.Bid - (stopLossPoints * snapshot.Point);\n\nConsole.WriteLine($\"Current Bid: {snapshot.Tick.Bid}\");\nConsole.WriteLine($\"SL (-100 points): {slPrice}\");\nConsole.WriteLine($\"Distance: {stopLossPoints} points = ${(stopLossPoints * snapshot.Point):F5}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#3-format-price-with-correct-digits","title":"3) Format price with correct digits","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"USDJPY\");\n\n// Round price to symbol digits\ndouble rawPrice = 149.12345678;\ndouble normalizedPrice = Math.Round(rawPrice, snapshot.Digits);\n\nConsole.WriteLine($\"Raw price:        {rawPrice}\");\nConsole.WriteLine($\"Normalized price: {normalizedPrice}\");\nConsole.WriteLine($\"Formatted:        {normalizedPrice.ToString($\"F{snapshot.Digits}\")}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#4-calculate-spread-in-different-units","title":"4) Calculate spread in different units","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\ndouble spreadPoints = (snapshot.Tick.Ask - snapshot.Tick.Bid) / snapshot.Point;\ndouble spreadPrice = snapshot.Tick.Ask - snapshot.Tick.Bid;\n\nConsole.WriteLine($\"Bid: {snapshot.Tick.Bid}\");\nConsole.WriteLine($\"Ask: {snapshot.Tick.Ask}\");\nConsole.WriteLine($\"Spread: {spreadPoints:F1} points\");\nConsole.WriteLine($\"Spread: ${spreadPrice:F5}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#5-check-if-prices-are-reasonable","title":"5) Check if prices are reasonable","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\nbool isValid = snapshot.Tick.Bid &gt; 0\n            &amp;&amp; snapshot.Tick.Ask &gt; 0\n            &amp;&amp; snapshot.Tick.Ask &gt; snapshot.Tick.Bid\n            &amp;&amp; snapshot.Point &gt; 0\n            &amp;&amp; snapshot.Digits &gt; 0;\n\nif (isValid)\n{\n    Console.WriteLine(\"\u2713 Symbol data is valid\");\n    Console.WriteLine($\"  Bid/Ask spread: {(snapshot.Tick.Ask - snapshot.Tick.Bid) / snapshot.Point:F1} points\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0 Invalid symbol data!\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#6-compare-margin-rates-across-symbols","title":"6) Compare margin rates across symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\n\nConsole.WriteLine(\"Margin Rates Comparison:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var symbol in symbols)\n{\n    var snapshot = await svc.GetSymbolSnapshot(symbol);\n\n    Console.WriteLine($\"{symbol,-10} Initial: {snapshot.MarginRate.Initial,6:F2} | \" +\n                     $\"Maintenance: {snapshot.MarginRate.Maintenance,6:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#7-calculate-take-profit-price","title":"7) Calculate take profit price","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\nint takeProfitPoints = 200;\ndouble tpPrice = snapshot.Tick.Ask + (takeProfitPoints * snapshot.Point);\n\n// Normalize to symbol digits\ntpPrice = Math.Round(tpPrice, snapshot.Digits);\n\nConsole.WriteLine($\"Current Ask: {snapshot.Tick.Ask}\");\nConsole.WriteLine($\"TP (+{takeProfitPoints} points): {tpPrice}\");\nConsole.WriteLine($\"Expected profit: {takeProfitPoints} points\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#8-validate-symbol-before-trading","title":"8) Validate symbol before trading","text":"<pre><code>async Task&lt;bool&gt; ValidateSymbol(MT5Service svc, string symbol)\n{\n    try\n    {\n        var snapshot = await svc.GetSymbolSnapshot(symbol);\n\n        // Check if tick is recent (within last 5 seconds)\n        var tickTime = snapshot.Tick.Time.ToDateTime();\n        var age = DateTime.UtcNow - tickTime;\n\n        if (age.TotalSeconds &gt; 5)\n        {\n            Console.WriteLine($\"\u26a0 Tick is old: {age.TotalSeconds:F1}s\");\n            return false;\n        }\n\n        // Check if spread is reasonable (&lt; 50 points)\n        var spreadPoints = (snapshot.Tick.Ask - snapshot.Tick.Bid) / snapshot.Point;\n        if (spreadPoints &gt; 50)\n        {\n            Console.WriteLine($\"\u26a0 Spread too wide: {spreadPoints:F1} points\");\n            return false;\n        }\n\n        Console.WriteLine($\"\u2713 {symbol} validated successfully\");\n        return true;\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"\u2717 Validation failed: {ex.Message}\");\n        return false;\n    }\n}\n\n// Usage\nbool canTrade = await ValidateSymbol(svc, \"EURUSD\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#9-build-price-ladder","title":"9) Build price ladder","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\nint levels = 5;\nint stepPoints = 10;\n\nConsole.WriteLine(\"Price Ladder (Buy):\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nfor (int i = -levels; i &lt;= levels; i++)\n{\n    double price = snapshot.Tick.Ask + (i * stepPoints * snapshot.Point);\n    price = Math.Round(price, snapshot.Digits);\n\n    string marker = i == 0 ? \" \u2190 Current Ask\" : \"\";\n    Console.WriteLine($\"{i,3} levels ({i * stepPoints,4} pts): {price}{marker}\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#10-symbol-information-dashboard","title":"10) Symbol information dashboard","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\nConsole.WriteLine(\"        SYMBOL INFORMATION DASHBOARD       \");\nConsole.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\nConsole.WriteLine();\nConsole.WriteLine($\"Symbol:        EURUSD\");\nConsole.WriteLine($\"Time:          {snapshot.Tick.Time.ToDateTime():yyyy-MM-dd HH:mm:ss}\");\nConsole.WriteLine();\nConsole.WriteLine($\"Bid:           {snapshot.Tick.Bid}\");\nConsole.WriteLine($\"Ask:           {snapshot.Tick.Ask}\");\nConsole.WriteLine($\"Last:          {snapshot.Tick.Last}\");\nConsole.WriteLine($\"Spread:        {(snapshot.Tick.Ask - snapshot.Tick.Bid) / snapshot.Point:F1} points\");\nConsole.WriteLine();\nConsole.WriteLine($\"Point Size:    {snapshot.Point}\");\nConsole.WriteLine($\"Digits:        {snapshot.Digits}\");\nConsole.WriteLine();\nConsole.WriteLine($\"Margin (Initial):     {snapshot.MarginRate.Initial}\");\nConsole.WriteLine($\"Margin (Maintenance): {snapshot.MarginRate.Maintenance}\");\nConsole.WriteLine();\n\n// Calculate 1 pip value\ndouble onePipInPoints = snapshot.Digits == 5 || snapshot.Digits == 3 ? 10 : 1;\ndouble onePipInPrice = onePipInPoints * snapshot.Point;\n\nConsole.WriteLine($\"1 Pip = {onePipInPoints} points = {onePipInPrice:F5}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#11-monitor-multiple-symbols","title":"11) Monitor multiple symbols","text":"<pre><code>string[] watchlist = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"GOLD\" };\n\nvar cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(30)); // Monitor for 30 seconds\n\ntry\n{\n    while (!cts.Token.IsCancellationRequested)\n    {\n        Console.Clear();\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Market Watch\");\n        Console.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\n        foreach (var symbol in watchlist)\n        {\n            var snapshot = await svc.GetSymbolSnapshot(symbol, ct: cts.Token);\n            var spread = (snapshot.Tick.Ask - snapshot.Tick.Bid) / snapshot.Point;\n\n            Console.WriteLine($\"{symbol,-10} Bid: {snapshot.Tick.Bid,10:F5} | \" +\n                             $\"Ask: {snapshot.Tick.Ask,10:F5} | \" +\n                             $\"Spread: {spread,5:F1} pts\");\n        }\n\n        await Task.Delay(2000, cts.Token); // Update every 2 seconds\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"\\nMonitoring stopped\");\n}\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#12-calculate-required-margin","title":"12) Calculate required margin","text":"<pre><code>var snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n\ndouble volume = 1.0; // 1 lot\ndouble contractSize = 100000; // Standard lot for EURUSD\n\n// Margin = (Volume * ContractSize * Price) / Leverage * MarginRate\n// Simplified: assuming leverage is applied elsewhere\ndouble requiredMargin = volume * contractSize * snapshot.Tick.Ask * snapshot.MarginRate.Initial;\n\nConsole.WriteLine($\"Symbol:           EURUSD\");\nConsole.WriteLine($\"Volume:           {volume} lot\");\nConsole.WriteLine($\"Entry Price:      {snapshot.Tick.Ask}\");\nConsole.WriteLine($\"Margin Rate:      {snapshot.MarginRate.Initial}\");\nConsole.WriteLine($\"Required Margin:  ${requiredMargin:F2}\");\n</code></pre>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>EnsureSelected()</code> - Ensure symbol is selected and synchronized - step 1</li> <li><code>SymbolInfoTickAsync()</code> - Get current tick (bid, ask, last) - step 2</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Get point size - step 3</li> <li><code>SymbolInfoIntegerAsync(SymbolDigits)</code> - Get decimal digits - step 4</li> <li><code>SymbolInfoMarginRateAsync()</code> - Get margin rates - step 5</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetAccountSnapshot()</code> - Get account data snapshot (balance, equity, positions)</li> <li><code>GetPointAsync()</code> - Get point size only (simpler if you only need point)</li> <li><code>GetDigitsAsync()</code> - Get digits only (simpler if you only need digits)</li> <li>All trading methods can use this snapshot for symbol data</li> </ul>"},{"location":"MT5Sugar/2.%20Snapshots/GetSymbolSnapshot/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using Digits for calculations instead of Point <pre><code>// \u274c WRONG - using digits\ndouble slPrice = bid - (100 * Math.Pow(10, -digits));\n\n// \u2705 CORRECT - using point\ndouble slPrice = bid - (100 * snapshot.Point);\n</code></pre></p> </li> <li> <p>Not checking tick freshness <pre><code>// \u274c WRONG - using old tick\nvar snapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\n// ... hours later ...\ndouble price = snapshot.Tick.Ask; // Old price!\n\n// \u2705 CORRECT - get fresh snapshot\nsnapshot = await svc.GetSymbolSnapshot(\"EURUSD\");\ndouble price = snapshot.Tick.Ask;\n</code></pre></p> </li> <li> <p>Ignoring spread <pre><code>// \u274c WRONG - using Bid for buy orders\ndouble entryPrice = snapshot.Tick.Bid; // Should use Ask!\n\n// \u2705 CORRECT - use Ask for buy, Bid for sell\ndouble buyPrice = snapshot.Tick.Ask;\ndouble sellPrice = snapshot.Tick.Bid;\n</code></pre></p> </li> <li> <p>Assuming margin rate is 1.0 <pre><code>// \u274c WRONG - ignoring margin rate\ndouble margin = volume * price;\n\n// \u2705 CORRECT - apply margin rate\ndouble margin = volume * price * snapshot.MarginRate.Initial;\n</code></pre></p> </li> <li> <p>Not normalizing calculated prices <pre><code>// \u274c WRONG - raw calculation\ndouble tpPrice = snapshot.Tick.Ask + (100 * snapshot.Point);\n\n// \u2705 CORRECT - normalize to symbol digits\ndouble tpPrice = Math.Round(\n    snapshot.Tick.Ask + (100 * snapshot.Point),\n    snapshot.Digits);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/","title":"\u2705 Get Symbol Digits (<code>GetDigitsAsync</code>)","text":"<p>Sugar method: Gets number of decimal places for symbol prices. Simple wrapper for <code>SymbolInfoIntegerAsync(SymbolDigits)</code> with int conversion.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetDigitsAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>SymbolInfoIntegerAsync(SymbolDigits)</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static async Task&lt;int&gt; GetDigitsAsync(\n        this MT5Service svc,\n        string symbol,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\") <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#output-int","title":"\u2b06\ufe0f Output \u2014 <code>int</code>","text":"<p>Returns the number of decimal places (digits) for symbol prices.</p> <p>Examples:</p> <ul> <li>EURUSD: <code>5</code> (prices like 1.10000)</li> <li>USDJPY: <code>3</code> (prices like 149.123)</li> <li>GOLD: <code>2</code> (prices like 2050.12)</li> </ul> <p>Exception: Throws <code>OverflowException</code> if value doesn't fit in <code>int</code> (extremely rare).</p>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. One-liner to get symbol decimal precision - how many digits after decimal point for prices.</li> <li>Why you need it. Essential for formatting prices correctly, rounding calculations, and displaying prices to users.</li> <li>Sanity check. Returns small integer like 5 (for EURUSD) or 3 (for USDJPY). Use for FORMATTING only, NOT for calculations.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for price formatting:</p> <ul> <li>Format prices for display.</li> <li>Round prices to correct precision.</li> <li>Validate price strings.</li> <li>Format order parameters.</li> <li>Build price display templates.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Digits vs Point: Digits is for FORMATTING (display), Point is for CALCULATIONS. Never use digits for calculating SL/TP.</li> <li>Format strings: Use <code>price.ToString($\"F{digits}\")</code> to format prices correctly.</li> <li>Rounding: Use <code>Math.Round(price, digits)</code> to round to correct precision.</li> <li>Not for calculations: Don't use <code>Math.Pow(10, -digits)</code> for calculations. Use <code>GetPointAsync()</code> instead.</li> <li>Caching: Digits don't change during session. Cache if calling frequently.</li> <li>5-digit vs 4-digit brokers: Modern brokers use 5 digits (EURUSD), old brokers used 4 digits.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method wraps a low-level call with type conversion:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Get SYMBOL_DIGITS property (returns int64)\nvar result = await svc.SymbolInfoIntegerAsync(symbol,\n    SymbolInfoIntegerProperty.SymbolDigits, deadline, ct);\n\n// Convert int64 to int with overflow check\nlong value = result.Value;\nif (value &gt; int.MaxValue || value &lt; int.MinValue)\n    throw new OverflowException($\"SymbolDigits={value} does not fit into int.\");\n\nreturn (int)value;\n</code></pre> <p>What it improves:</p> <ul> <li>Simpler call - no need to specify property enum</li> <li>Automatic deadline - just pass timeout in seconds</li> <li>Safe int conversion - handles overflow gracefully</li> <li>Returns int directly - not int64, easier to use</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar: <pre><code>var deadline = DateTime.UtcNow.AddSeconds(10);\n\nvar result = await svc.SymbolInfoIntegerAsync(\"EURUSD\",\n    SymbolInfoIntegerProperty.SymbolDigits, deadline, ct);\n\nlong digitsLong = result.Value;\nint digits = (int)digitsLong; // Unsafe cast!\n</code></pre></p> <p>WITH sugar: <pre><code>int digits = await svc.GetDigitsAsync(\"EURUSD\");\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 3 lines \u2192 1 line</li> <li>\u2705 No enum lookup needed</li> <li>\u2705 Safe int64\u2192int conversion</li> <li>\u2705 Auto deadline management</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#1-basic-digits-retrieval","title":"1) Basic digits retrieval","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\nConsole.WriteLine($\"EURUSD digits: {digits}\");\n// Output: EURUSD digits: 5\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#2-format-price-for-display","title":"2) Format price for display","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\n\ndouble price = 1.100005;\nstring formatted = price.ToString($\"F{digits}\");\n\nConsole.WriteLine($\"Raw price:       {price}\");\nConsole.WriteLine($\"Formatted price: {formatted}\");\n\n// Output:\n// Raw price:       1.100005\n// Formatted price: 1.10001\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#3-round-price-to-correct-precision","title":"3) Round price to correct precision","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"GBPUSD\");\n\ndouble rawPrice = 1.250000123456;\ndouble rounded = Math.Round(rawPrice, digits);\n\nConsole.WriteLine($\"Raw:     {rawPrice}\");\nConsole.WriteLine($\"Rounded: {rounded}\");\nConsole.WriteLine($\"Display: {rounded.ToString($\"F{digits}\")}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#4-compare-digits-across-symbols","title":"4) Compare digits across symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"GOLD\", \"BTCUSD\" };\n\nConsole.WriteLine(\"Symbol Digits:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var symbol in symbols)\n{\n    var digits = await svc.GetDigitsAsync(symbol);\n    var samplePrice = digits == 5 ? \"1.10000\" :\n                      digits == 3 ? \"149.123\" :\n                      digits == 2 ? \"2050.12\" : \"0.00\";\n\n    Console.WriteLine($\"{symbol,-10} {digits} digits  (e.g., {samplePrice})\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#5-validate-price-string","title":"5) Validate price string","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\n\nstring priceStr = \"1.10005\";\nbool isValid = false;\n\nif (double.TryParse(priceStr, out double price))\n{\n    // Check if price has correct number of decimal places\n    string[] parts = priceStr.Split('.');\n    if (parts.Length == 2 &amp;&amp; parts[1].Length == digits)\n    {\n        isValid = true;\n    }\n}\n\nConsole.WriteLine($\"Price: {priceStr}\");\nConsole.WriteLine($\"Valid: {isValid}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#6-create-price-format-template","title":"6) Create price format template","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\n\n// Create reusable format string\nstring formatTemplate = $\"F{digits}\";\n\n// Use for multiple prices\ndouble[] prices = { 1.10000, 1.10050, 1.10100 };\n\nConsole.WriteLine(\"Formatted Prices:\");\nforeach (var price in prices)\n{\n    Console.WriteLine($\"  {price.ToString(formatTemplate)}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#7-determine-pip-position","title":"7) Determine pip position","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\n\n// For 5-digit pairs, pip is 4th digit (index 3 from right)\n// For 3-digit pairs, pip is 2nd digit (index 1 from right)\nint pipPosition = digits - 1;\n\nConsole.WriteLine($\"Symbol:       EURUSD\");\nConsole.WriteLine($\"Digits:       {digits}\");\nConsole.WriteLine($\"Pip position: {pipPosition}th digit from right\");\n\nif (digits == 5)\n{\n    Console.WriteLine(\"Example: 1.10[0]05 - pip digit in brackets\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#8-format-prices-in-table","title":"8) Format prices in table","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"USDJPY\", \"GOLD\" };\nvar prices = new[] { 1.10000, 149.123, 2050.12 };\n\nConsole.WriteLine(\"Symbol     Price\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nfor (int i = 0; i &lt; symbols.Length; i++)\n{\n    var digits = await svc.GetDigitsAsync(symbols[i]);\n    var formatted = prices[i].ToString($\"F{digits}\");\n\n    Console.WriteLine($\"{symbols[i],-10} {formatted,10}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#9-calculate-decimal-multiplier-for-display","title":"9) Calculate decimal multiplier (for display)","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\n\n// Calculate multiplier for decimal conversions (display only!)\ndouble multiplier = Math.Pow(10, digits);\n\ndouble price = 1.10005;\nlong priceAsInt = (long)(price * multiplier);\n\nConsole.WriteLine($\"Digits:     {digits}\");\nConsole.WriteLine($\"Multiplier: {multiplier}\");\nConsole.WriteLine($\"Price:      {price}\");\nConsole.WriteLine($\"As integer: {priceAsInt}\");\n\n// WARNING: Don't use this for trading calculations!\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#10-smart-price-rounding-utility","title":"10) Smart price rounding utility","text":"<pre><code>async Task&lt;double&gt; SmartRound(string symbol, double price)\n{\n    var digits = await svc.GetDigitsAsync(symbol);\n    return Math.Round(price, digits);\n}\n\n// Usage\ndouble rawPrice1 = 1.100005123;\ndouble rawPrice2 = 149.123456789;\n\ndouble rounded1 = await SmartRound(\"EURUSD\", rawPrice1);\ndouble rounded2 = await SmartRound(\"USDJPY\", rawPrice2);\n\nConsole.WriteLine($\"EURUSD: {rawPrice1} \u2192 {rounded1}\");\nConsole.WriteLine($\"USDJPY: {rawPrice2} \u2192 {rounded2}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level method used internally:</p> <ul> <li><code>SymbolInfoIntegerAsync(SymbolDigits)</code> - Direct digits query (this is what GetDigitsAsync wraps)</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetPointAsync()</code> - Get symbol point size (use this for calculations, not digits!)</li> <li><code>GetSymbolSnapshot()</code> - Get point, digits, tick, and margin in one call</li> <li><code>NormalizePriceAsync()</code> - Normalize price to tick size</li> <li><code>PointsToPipsAsync()</code> - Convert points to pips (uses digits internally for conversion factor)</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetDigitsAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using digits for price calculations <pre><code>// \u274c WRONG - using digits to calculate point\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble point = Math.Pow(10, -digits); // DON'T DO THIS!\ndouble slPrice = entry - (100 * point);\n\n// \u2705 CORRECT - use point directly\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble slPrice = entry - (100 * point);\n</code></pre></p> </li> <li> <p>Assuming all FX pairs have 5 digits <pre><code>// \u274c WRONG - hardcoded digits\ndouble price = 1.10005;\nstring formatted = price.ToString(\"F5\"); // What about USDJPY?\n\n// \u2705 CORRECT - query actual digits\nvar digits = await svc.GetDigitsAsync(symbol);\nstring formatted = price.ToString($\"F{digits}\");\n</code></pre></p> </li> <li> <p>Using digits for volume formatting <pre><code>// \u274c WRONG - digits is for prices, not volumes\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\nstring volume = 1.5.ToString($\"F{digits}\"); // Wrong!\n\n// \u2705 CORRECT - volumes typically use 2 decimal places\nstring volume = 1.5.ToString(\"F2\");\n</code></pre></p> </li> <li> <p>Confusing digits with point <pre><code>// \u274c WRONG - using wrong property\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble distance = (price2 - price1) / digits; // Makes no sense!\n\n// \u2705 CORRECT - use point for calculations\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble distanceInPoints = (price2 - price1) / point;\n</code></pre></p> </li> <li> <p>Not rounding after calculations <pre><code>// \u274c WRONG - calculated price has wrong precision\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble slPrice = entry - (100 * point); // Might have rounding errors\n\n// \u2705 CORRECT - round to digits after calculation\nvar point = await svc.GetPointAsync(\"EURUSD\");\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble slPrice = Math.Round(entry - (100 * point), digits);\n</code></pre></p> </li> <li> <p>Using digits to normalize prices <pre><code>// \u274c WRONG - rounding to digits doesn't respect tick size\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble normalized = Math.Round(price, digits);\n\n// \u2705 CORRECT - normalize to actual tick size\ndouble normalized = await svc.NormalizePriceAsync(\"EURUSD\", price);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/","title":"\u2705 Get Point Size (<code>GetPointAsync</code>)","text":"<p>Sugar method: Gets symbol point size (minimum price change). Simple wrapper for <code>SymbolInfoDoubleAsync(SymbolPoint)</code>.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetPointAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>SymbolInfoDoubleAsync(SymbolPoint)</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static async Task&lt;double&gt; GetPointAsync(\n        this MT5Service svc,\n        string symbol,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\") <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#output-double","title":"\u2b06\ufe0f Output \u2014 <code>double</code>","text":"<p>Returns the symbol's point size (minimum price change).</p> <p>Examples:</p> <ul> <li>EURUSD (5 digits): <code>0.00001</code></li> <li>USDJPY (3 digits): <code>0.001</code></li> <li>GOLD (2 digits): <code>0.01</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. One-liner to get symbol point size - the smallest price movement possible for the symbol.</li> <li>Why you need it. Essential for calculating stop loss, take profit, and price offsets in points. Use point size for ALL price calculations.</li> <li>Sanity check. Returns small number like 0.00001 (for 5-digit pairs) or 0.001 (for 3-digit pairs). NEVER use fixed values or Math.Pow(10, -digits).</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for price calculations:</p> <ul> <li>Calculate SL/TP prices from point offsets.</li> <li>Convert price differences to points.</li> <li>Validate price precision.</li> <li>Build price ladders and levels.</li> <li>Calculate pip values.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Point vs Pip: For 5-digit FX pairs, 1 pip = 10 points. For 3-digit pairs, 1 pip = 1 point.</li> <li>Point vs Digits: Point is the actual value (0.00001), Digits is just the count (5). Always use Point for calculations.</li> <li>Never hardcode: Don't use <code>Math.Pow(10, -digits)</code>. Always call <code>GetPointAsync()</code> or <code>SymbolInfoDoubleAsync(SymbolPoint)</code>.</li> <li>Caching: Point size doesn't change during session. Cache it if calling frequently.</li> <li>Use for calculations: Point is the building block for all price calculations: <code>price = basePrice + (points * point)</code>.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method is a simple wrapper around one low-level call:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Get SYMBOL_POINT property\nvar result = await svc.SymbolInfoDoubleAsync(symbol,\n    SymbolInfoDoubleProperty.SymbolPoint, deadline, ct);\n\nreturn result.Value;\n</code></pre> <p>What it improves:</p> <ul> <li>Simpler call - no need to specify property enum</li> <li>Automatic deadline - just pass timeout in seconds</li> <li>Returns double directly - no need to extract <code>.Value</code></li> <li>Clearer intent - method name tells you exactly what you get</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar: <pre><code>var deadline = DateTime.UtcNow.AddSeconds(10);\n\nvar result = await svc.SymbolInfoDoubleAsync(\"EURUSD\",\n    SymbolInfoDoubleProperty.SymbolPoint, deadline, ct);\n\ndouble point = result.Value;\n</code></pre></p> <p>WITH sugar: <pre><code>double point = await svc.GetPointAsync(\"EURUSD\");\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 3 lines \u2192 1 line</li> <li>\u2705 No enum lookup needed</li> <li>\u2705 Auto deadline management</li> <li>\u2705 Direct value return</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#1-basic-point-retrieval","title":"1) Basic point retrieval","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar point = await svc.GetPointAsync(\"EURUSD\");\nConsole.WriteLine($\"EURUSD point size: {point}\");\n// Output: EURUSD point size: 0.00001\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#2-calculate-sl-price-from-points","title":"2) Calculate SL price from points","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble entryPrice = 1.10000;\nint stopLossPoints = 100;\n\ndouble slPrice = entryPrice - (stopLossPoints * point);\n\nConsole.WriteLine($\"Entry:  {entryPrice}\");\nConsole.WriteLine($\"SL:     {slPrice}\");\nConsole.WriteLine($\"Distance: {stopLossPoints} points\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#3-calculate-tp-price-from-points","title":"3) Calculate TP price from points","text":"<pre><code>var point = await svc.GetPointAsync(\"GBPUSD\");\n\ndouble entryPrice = 1.25000;\nint takeProfitPoints = 200;\n\ndouble tpPrice = entryPrice + (takeProfitPoints * point);\n\nConsole.WriteLine($\"Entry:  {entryPrice}\");\nConsole.WriteLine($\"TP:     {tpPrice}\");\nConsole.WriteLine($\"Target: +{takeProfitPoints} points\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#4-convert-price-difference-to-points","title":"4) Convert price difference to points","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble price1 = 1.10000;\ndouble price2 = 1.10050;\n\ndouble differenceInPoints = (price2 - price1) / point;\n\nConsole.WriteLine($\"Price 1: {price1}\");\nConsole.WriteLine($\"Price 2: {price2}\");\nConsole.WriteLine($\"Difference: {differenceInPoints} points\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#5-compare-point-sizes-across-symbols","title":"5) Compare point sizes across symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"GOLD\" };\n\nConsole.WriteLine(\"Symbol Point Sizes:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var symbol in symbols)\n{\n    var point = await svc.GetPointAsync(symbol);\n    Console.WriteLine($\"{symbol,-10} {point:F8}\");\n}\n\n// Output:\n// EURUSD     0.00001000\n// GBPUSD     0.00001000\n// USDJPY     0.00100000\n// GOLD       0.01000000\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#6-validate-price-precision","title":"6) Validate price precision","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble price = 1.100055; // Invalid precision\n\n// Check if price is valid (multiple of point)\ndouble remainder = (price % point);\nbool isValid = Math.Abs(remainder) &lt; point * 0.1;\n\nif (!isValid)\n{\n    Console.WriteLine($\"\u26a0 Price {price} is not aligned to point size {point}\");\n\n    // Normalize to nearest point\n    double normalized = Math.Round(price / point) * point;\n    Console.WriteLine($\"  Normalized: {normalized}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#7-build-price-ladder","title":"7) Build price ladder","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble basePrice = 1.10000;\nint levels = 5;\nint stepPoints = 10;\n\nConsole.WriteLine(\"Price Ladder:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nfor (int i = -levels; i &lt;= levels; i++)\n{\n    double price = basePrice + (i * stepPoints * point);\n    string marker = i == 0 ? \" \u2190 Entry\" : \"\";\n    Console.WriteLine($\"{i,3}: {price:F5} ({i * stepPoints,4} pts){marker}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#8-calculate-pip-value-for-5-digit-pairs","title":"8) Calculate pip value for 5-digit pairs","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\n\n// For 5-digit pairs, 1 pip = 10 points\nint pointsPerPip = (digits == 5 || digits == 3) ? 10 : 1;\ndouble pipValue = pointsPerPip * point;\n\nConsole.WriteLine($\"Symbol:    EURUSD\");\nConsole.WriteLine($\"Digits:    {digits}\");\nConsole.WriteLine($\"Point:     {point}\");\nConsole.WriteLine($\"Pip value: {pipValue}\");\nConsole.WriteLine($\"1 pip = {pointsPerPip} points\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#9-cache-point-size-for-performance","title":"9) Cache point size for performance","text":"<pre><code>// Cache point size for multiple calculations\nvar symbolCache = new Dictionary&lt;string, double&gt;();\n\nasync Task&lt;double&gt; GetPointCached(string symbol)\n{\n    if (!symbolCache.ContainsKey(symbol))\n    {\n        symbolCache[symbol] = await svc.GetPointAsync(symbol);\n        Console.WriteLine($\"Cached point for {symbol}: {symbolCache[symbol]}\");\n    }\n    return symbolCache[symbol];\n}\n\n// Use cached value\nvar point1 = await GetPointCached(\"EURUSD\"); // Fetches from API\nvar point2 = await GetPointCached(\"EURUSD\"); // Returns cached value\nvar point3 = await GetPointCached(\"EURUSD\"); // Returns cached value\n\nConsole.WriteLine($\"All three calls returned: {point1}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#10-calculate-multiple-price-levels","title":"10) Calculate multiple price levels","text":"<pre><code>var point = await svc.GetPointAsync(\"GBPUSD\");\n\ndouble entryPrice = 1.25000;\n\nvar levels = new[]\n{\n    (\"Entry\", 0),\n    (\"SL\", -100),\n    (\"TP1\", 50),\n    (\"TP2\", 100),\n    (\"TP3\", 150)\n};\n\nConsole.WriteLine(\"Price Levels:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var (label, points) in levels)\n{\n    double price = entryPrice + (points * point);\n    Console.WriteLine($\"{label,-8} {price:F5} ({points,4} points)\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level method used internally:</p> <ul> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Direct point size query (this is what GetPointAsync wraps)</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetDigitsAsync()</code> - Get symbol digits (for formatting, not calculations)</li> <li><code>GetSymbolSnapshot()</code> - Get point, digits, tick, and margin in one call</li> <li><code>NormalizePriceAsync()</code> - Normalize price to tick size (uses point internally)</li> <li><code>PointsToPipsAsync()</code> - Convert points to pips for display</li> <li><code>GetSpreadPointsAsync()</code> - Get current spread in points (uses point internally)</li> <li>All price calculation methods use point size</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetPointAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using Math.Pow(10, -digits) instead of point <pre><code>// \u274c WRONG - calculating point from digits\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\nvar point = Math.Pow(10, -digits); // Don't do this!\n\n// \u2705 CORRECT - getting actual point size\nvar point = await svc.GetPointAsync(\"EURUSD\");\n</code></pre></p> </li> <li> <p>Hardcoding point values <pre><code>// \u274c WRONG - hardcoded point\ndouble point = 0.00001; // What if symbol changes?\n\n// \u2705 CORRECT - query from broker\nvar point = await svc.GetPointAsync(\"EURUSD\");\n</code></pre></p> </li> <li> <p>Confusing points and pips <pre><code>// \u274c WRONG - treating 50 pips as 50 points\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble slPrice = entry - (50 * point); // This is 50 points, not 50 pips!\n\n// \u2705 CORRECT - for 5-digit pairs, 50 pips = 500 points\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble slPrice = entry - (500 * point); // 50 pips\n</code></pre></p> </li> <li> <p>Not caching point size <pre><code>// \u274c WRONG - fetching point multiple times\nfor (int i = 0; i &lt; 100; i++)\n{\n    var point = await svc.GetPointAsync(\"EURUSD\"); // 100 API calls!\n    prices[i] = basePrice + (i * point);\n}\n\n// \u2705 CORRECT - fetch once, reuse\nvar point = await svc.GetPointAsync(\"EURUSD\");\nfor (int i = 0; i &lt; 100; i++)\n{\n    prices[i] = basePrice + (i * point);\n}\n</code></pre></p> </li> <li> <p>Using point for volume calculations <pre><code>// \u274c WRONG - point is for prices, not volumes\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble volume = 1.5 + point; // Makes no sense!\n\n// \u2705 CORRECT - use volume step for volumes\nvar volumeStep = await svc.SymbolInfoDoubleAsync(\"EURUSD\",\n    SymbolInfoDoubleProperty.SymbolVolumeStep, ...);\ndouble volume = Math.Round(1.5 / volumeStep) * volumeStep;\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/","title":"\u2705 Get Spread in Points (<code>GetSpreadPointsAsync</code>)","text":"<p>Sugar method: Calculates current spread in points from the last tick. Returns (Ask - Bid) / Point.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetSpreadPointsAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync(SymbolPoint)</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static async Task&lt;double&gt; GetSpreadPointsAsync(\n        this MT5Service svc,\n        string symbol,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\") <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#output-double","title":"\u2b06\ufe0f Output \u2014 <code>double</code>","text":"<p>Returns the current spread in points.</p> <p>Examples:</p> <ul> <li>EURUSD: Ask = 1.10010, Bid = 1.10000, Point = 0.00001 \u2192 Spread = 10 points</li> <li>USDJPY: Ask = 149.125, Bid = 149.120, Point = 0.001 \u2192 Spread = 5 points</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. One-liner to get current bid-ask spread in points. Fetches latest tick and calculates (Ask - Bid) / Point.</li> <li>Why you need it. Check trading costs before order placement, monitor spread conditions, filter high-spread periods.</li> <li>Sanity check. Typical EURUSD spread: 0-2 points (good), 5-10 points (normal), 20+ points (high/avoid). Always positive.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for spread monitoring:</p> <ul> <li>Check if spread is acceptable before trading.</li> <li>Filter high-spread periods (news events).</li> <li>Calculate trading costs.</li> <li>Monitor broker conditions.</li> <li>Build spread statistics.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Real-time: Gets current tick, so spread reflects real-time market conditions.</li> <li>Always positive: Spread is always Ask - Bid, which is always positive (broker markup).</li> <li>Volatility indicator: Wide spread often indicates high volatility or low liquidity.</li> <li>Cost of trading: Spread is immediate cost of entering position (slippage).</li> <li>Variable: Spread changes constantly. Check before each trade.</li> <li>Typical values: FX major pairs: 0-3 points normal, 5-10 moderate, 20+ high.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method combines tick fetch and point calculation:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Step 1: Get current tick (bid and ask prices)\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\n\n// Step 2: Get point size\nvar pointResult = await svc.SymbolInfoDoubleAsync(symbol,\n    SymbolInfoDoubleProperty.SymbolPoint, deadline, ct);\ndouble point = pointResult.Value;\n\n// Step 3: Calculate spread in points\nreturn (tick.Ask - tick.Bid) / point;\n</code></pre> <p>What it improves:</p> <ul> <li>Combines 2 calls - tick + point in one method</li> <li>Automatic calculation - no manual spread formula</li> <li>Shared deadline - both calls use same timeout</li> <li>Returns points directly - ready to use</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar: <pre><code>var deadline = DateTime.UtcNow.AddSeconds(10);\n\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\", deadline, ct);\n\nvar pointResult = await svc.SymbolInfoDoubleAsync(\"EURUSD\",\n    SymbolInfoDoubleProperty.SymbolPoint, deadline, ct);\ndouble point = pointResult.Value;\n\ndouble spreadPoints = (tick.Ask - tick.Bid) / point;\n</code></pre></p> <p>WITH sugar: <pre><code>double spreadPoints = await svc.GetSpreadPointsAsync(\"EURUSD\");\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 6 lines \u2192 1 line</li> <li>\u2705 No manual calculation</li> <li>\u2705 Auto deadline management</li> <li>\u2705 Clearer intent</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#1-basic-spread-check","title":"1) Basic spread check","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\nConsole.WriteLine($\"EURUSD spread: {spread:F1} points\");\n// Output: EURUSD spread: 1.2 points\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#2-check-spread-before-trading","title":"2) Check spread before trading","text":"<pre><code>var spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\ndouble maxAllowedSpread = 5.0;\n\nif (spread &lt;= maxAllowedSpread)\n{\n    Console.WriteLine($\"\u2713 Spread OK: {spread:F1} points\");\n    // Proceed with trade\n}\nelse\n{\n    Console.WriteLine($\"\u26a0 Spread too high: {spread:F1} points (max: {maxAllowedSpread})\");\n    // Skip trade\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#3-convert-spread-to-pips","title":"3) Convert spread to pips","text":"<pre><code>var spreadPoints = await svc.GetSpreadPointsAsync(\"EURUSD\");\nvar spreadPips = await svc.PointsToPipsAsync(\"EURUSD\", spreadPoints);\n\nConsole.WriteLine($\"Spread:\");\nConsole.WriteLine($\"  {spreadPoints:F1} points\");\nConsole.WriteLine($\"  {spreadPips:F2} pips\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#4-compare-spreads-across-symbols","title":"4) Compare spreads across symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"GOLD\" };\n\nConsole.WriteLine(\"Current Spreads:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var symbol in symbols)\n{\n    var spread = await svc.GetSpreadPointsAsync(symbol);\n    var pips = await svc.PointsToPipsAsync(symbol, spread);\n\n    Console.WriteLine($\"{symbol,-10} {spread,5:F1} points ({pips,4:F2} pips)\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#5-calculate-spread-cost-in-money","title":"5) Calculate spread cost in money","text":"<pre><code>var spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\nvar point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble volume = 1.0; // 1 lot\ndouble contractSize = 100000; // Standard lot\n\n// Spread cost = spread in price * volume * contract size\ndouble spreadCost = (spread * point) * volume * contractSize;\n\nConsole.WriteLine($\"Spread: {spread:F1} points\");\nConsole.WriteLine($\"Volume: {volume} lot\");\nConsole.WriteLine($\"Cost:   ${spreadCost:F2}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#6-monitor-spread-during-session","title":"6) Monitor spread during session","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(30)); // Monitor for 30 seconds\n\ndouble minSpread = double.MaxValue;\ndouble maxSpread = double.MinValue;\ndouble totalSpread = 0;\nint count = 0;\n\ntry\n{\n    while (!cts.Token.IsCancellationRequested)\n    {\n        var spread = await svc.GetSpreadPointsAsync(\"EURUSD\", ct: cts.Token);\n\n        minSpread = Math.Min(minSpread, spread);\n        maxSpread = Math.Max(maxSpread, spread);\n        totalSpread += spread;\n        count++;\n\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Spread: {spread:F1} points\");\n\n        await Task.Delay(2000, cts.Token);\n    }\n}\ncatch (OperationCanceledException)\n{\n    double avgSpread = totalSpread / count;\n\n    Console.WriteLine(\"\\nSpread Statistics:\");\n    Console.WriteLine($\"  Min: {minSpread:F1} points\");\n    Console.WriteLine($\"  Max: {maxSpread:F1} points\");\n    Console.WriteLine($\"  Avg: {avgSpread:F1} points\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#7-alert-on-high-spread","title":"7) Alert on high spread","text":"<pre><code>double alertThreshold = 10.0;\n\nvar cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromMinutes(5));\n\ntry\n{\n    while (!cts.Token.IsCancellationRequested)\n    {\n        var spread = await svc.GetSpreadPointsAsync(\"EURUSD\", ct: cts.Token);\n\n        if (spread &gt; alertThreshold)\n        {\n            Console.WriteLine($\"\ud83d\udd14 ALERT: High spread detected!\");\n            Console.WriteLine($\"   Current: {spread:F1} points\");\n            Console.WriteLine($\"   Threshold: {alertThreshold:F1} points\");\n            Console.WriteLine($\"   Time: {DateTime.Now:HH:mm:ss}\");\n        }\n\n        await Task.Delay(1000, cts.Token);\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Monitoring stopped\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#8-build-spread-histogram","title":"8) Build spread histogram","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromMinutes(1));\n\nvar spreadCounts = new Dictionary&lt;int, int&gt;();\n\ntry\n{\n    while (!cts.Token.IsCancellationRequested)\n    {\n        var spread = await svc.GetSpreadPointsAsync(\"EURUSD\", ct: cts.Token);\n        int bucket = (int)Math.Floor(spread);\n\n        if (!spreadCounts.ContainsKey(bucket))\n            spreadCounts[bucket] = 0;\n\n        spreadCounts[bucket]++;\n\n        await Task.Delay(500, cts.Token);\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"\\nSpread Distribution:\");\n    Console.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\n    foreach (var bucket in spreadCounts.Keys.OrderBy(k =&gt; k))\n    {\n        var count = spreadCounts[bucket];\n        var bar = new string('\u2588', count);\n\n        Console.WriteLine($\"{bucket,2} points: {bar} ({count})\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#9-compare-spread-to-average","title":"9) Compare spread to average","text":"<pre><code>// Get current spread\nvar currentSpread = await svc.GetSpreadPointsAsync(\"EURUSD\");\n\n// Simulate average spread (in real app, calculate from history)\ndouble averageSpread = 1.5;\n\ndouble deviation = ((currentSpread - averageSpread) / averageSpread) * 100;\n\nConsole.WriteLine($\"Current spread:  {currentSpread:F1} points\");\nConsole.WriteLine($\"Average spread:  {averageSpread:F1} points\");\nConsole.WriteLine($\"Deviation:       {deviation:+0.0;-0.0}%\");\n\nif (Math.Abs(deviation) &gt; 50)\n{\n    Console.WriteLine(\"\u26a0 Spread is significantly different from average!\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#10-multi-symbol-spread-dashboard","title":"10) Multi-symbol spread dashboard","text":"<pre><code>string[] watchlist = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"GOLD\" };\n\nvar cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(30));\n\ntry\n{\n    while (!cts.Token.IsCancellationRequested)\n    {\n        Console.Clear();\n        Console.WriteLine($\"[{DateTime.Now:HH:mm:ss}] Spread Monitor\");\n        Console.WriteLine(\"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\");\n\n        foreach (var symbol in watchlist)\n        {\n            var spread = await svc.GetSpreadPointsAsync(symbol, ct: cts.Token);\n            var pips = await svc.PointsToPipsAsync(symbol, spread);\n\n            // Color-code by spread level\n            string status = spread switch\n            {\n                &lt;= 3.0 =&gt; \"\u2713 Good\",\n                &lt;= 10.0 =&gt; \"\u26a1 Normal\",\n                _ =&gt; \"\u26a0 High\"\n            };\n\n            Console.WriteLine($\"{symbol,-10} {spread,5:F1} pts ({pips,4:F2} pips) {status}\");\n        }\n\n        await Task.Delay(2000, cts.Token);\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"\\nMonitoring stopped\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Get current tick (bid/ask prices) - step 1</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Get point size - step 2</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetPointAsync()</code> - Get point size only</li> <li><code>PointsToPipsAsync()</code> - Convert spread points to pips for display</li> <li><code>GetSymbolSnapshot()</code> - Get tick, point, digits, margin in one call</li> <li>Use before trading to check if spread is acceptable</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/GetSpreadPointsAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Assuming spread is constant <pre><code>// \u274c WRONG - caching spread for long time\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\n// ... hours later ...\nif (spread &lt; 5) { /* trade */ } // Old value!\n\n// \u2705 CORRECT - check spread before each trade\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\nif (spread &lt; 5) { /* trade immediately */ }\n</code></pre></p> </li> <li> <p>Not accounting for spread in calculations <pre><code>// \u274c WRONG - ignoring spread\ndouble entryPrice = currentBid;\ndouble expectedTP = entryPrice + (100 * point); // Ignores spread!\n\n// \u2705 CORRECT - account for spread\ndouble entryPrice = currentAsk; // Buy at Ask\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\ndouble expectedTP = entryPrice + (100 * point); // TP accounts for Ask entry\n</code></pre></p> </li> <li> <p>Comparing spread across different symbols <pre><code>// \u274c WRONG - comparing raw point values\nvar spreadEUR = await svc.GetSpreadPointsAsync(\"EURUSD\");\nvar spreadJPY = await svc.GetSpreadPointsAsync(\"USDJPY\");\nif (spreadEUR &lt; spreadJPY) { /* EURUSD is better? Not necessarily! */ }\n\n// \u2705 CORRECT - convert to pips or percentage\nvar spreadEUR = await svc.GetSpreadPointsAsync(\"EURUSD\");\nvar spreadJPY = await svc.GetSpreadPointsAsync(\"USDJPY\");\nvar pipsEUR = await svc.PointsToPipsAsync(\"EURUSD\", spreadEUR);\nvar pipsJPY = await svc.PointsToPipsAsync(\"USDJPY\", spreadJPY);\n// Now compare pipsEUR vs pipsJPY\n</code></pre></p> </li> <li> <p>Using spread for volume calculations <pre><code>// \u274c WRONG - spread is price difference, not volume\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\ndouble volume = 1.0 + spread; // Makes no sense!\n\n// \u2705 CORRECT - use spread for cost calculations\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble spreadCost = (spread * point) * volume * contractSize;\n</code></pre></p> </li> <li> <p>Not checking for abnormal spreads <pre><code>// \u274c WRONG - trading without spread check\nawait PlaceOrder(\"EURUSD\", volume, sl, tp); // What if spread is 100 points?\n\n// \u2705 CORRECT - validate spread first\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\nif (spread &gt; 10)\n{\n    Console.WriteLine($\"\u26a0 Spread too high ({spread:F1} points), skipping trade\");\n    return;\n}\nawait PlaceOrder(\"EURUSD\", volume, sl, tp);\n</code></pre></p> </li> <li> <p>Confusing spread with slippage <pre><code>// \u274c WRONG - spread is not slippage\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\");\n// Spread is Bid-Ask difference (always present)\n// Slippage is difference between expected and executed price (market orders)\n\n// \u2705 CORRECT - understand the difference\nvar spread = await svc.GetSpreadPointsAsync(\"EURUSD\"); // Trading cost\n// Slippage is additional cost during execution (fast markets)\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/","title":"\u2705 Normalize Price (<code>NormalizePriceAsync</code>)","text":"<p>Sugar method: Normalizes price to symbol tick size (strict normalization, not just digits). Ensures price is valid for order placement.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.NormalizePriceAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>SymbolInfoDoubleAsync(SymbolTradeTickSize)</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static async Task&lt;double&gt; NormalizePriceAsync(\n        this MT5Service svc,\n        string symbol,\n        double price,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\") <code>price</code> <code>double</code> Price to normalize <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#output-double","title":"\u2b06\ufe0f Output \u2014 <code>double</code>","text":"<p>Returns the normalized price aligned to symbol's tick size.</p> <p>Example:</p> <ul> <li>Input: <code>1.100005</code></li> <li>Tick size: <code>0.00001</code></li> <li>Output: <code>1.10001</code> (rounded to nearest tick)</li> </ul> <p>Exception: Throws <code>InvalidOperationException</code> if tick size is 0 or negative.</p>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Strict price normalization using actual tick size (SYMBOL_TRADE_TICK_SIZE), not just rounding by digits.</li> <li>Why you need it. Broker rejects orders with invalid price precision. This ensures price is valid before sending to MT5.</li> <li>Sanity check. Returns price rounded to nearest valid tick. ALWAYS normalize calculated prices before order placement.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it before order placement:</p> <ul> <li>Normalize calculated SL/TP prices.</li> <li>Validate prices from user input.</li> <li>Ensure pending order prices are valid.</li> <li>Fix prices after calculations.</li> <li>Avoid \"invalid price\" errors.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Tick size vs Point: Tick size can differ from point size. Always use tick size for normalization.</li> <li>Strict normalization: Uses SYMBOL_TRADE_TICK_SIZE property, not SYMBOL_POINT or digits.</li> <li>Rounding: Rounds to NEAREST valid tick, not floor/ceiling.</li> <li>Required: ALWAYS normalize before: <code>OrderSendAsync()</code>, <code>OrderModifyAsync()</code>, pending order placement.</li> <li>Performance: Tick size doesn't change. Cache if normalizing many prices.</li> <li>Formula: <code>normalized = round(price / tickSize) * tickSize</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method gets tick size and normalizes:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Get SYMBOL_TRADE_TICK_SIZE (not SYMBOL_POINT!)\nvar result = await svc.SymbolInfoDoubleAsync(symbol,\n    SymbolInfoDoubleProperty.SymbolTradeTickSize, deadline, ct);\n\ndouble tickSize = result.Value;\n\n// Validate tick size\nif (tickSize &lt;= 0)\n    throw new InvalidOperationException(\"SymbolTradeTickSize is 0\");\n\n// Normalize to nearest tick\ndouble steps = Math.Round(price / tickSize);\nreturn steps * tickSize;\n</code></pre> <p>What it improves:</p> <ul> <li>Strict normalization - uses tick size, not just digits</li> <li>Automatic validation - throws if tick size invalid</li> <li>Simple API - just pass symbol and price</li> <li>Guaranteed valid price - broker will accept it</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar (wrong approach): <pre><code>// \u274c Many developers do this (WRONG!):\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble normalized = Math.Round(price, digits); // Not strict enough!\n</code></pre></p> <p>WITHOUT sugar (correct but verbose): <pre><code>var deadline = DateTime.UtcNow.AddSeconds(10);\n\nvar result = await svc.SymbolInfoDoubleAsync(\"EURUSD\",\n    SymbolInfoDoubleProperty.SymbolTradeTickSize, deadline, ct);\n\ndouble tickSize = result.Value;\nif (tickSize &lt;= 0)\n    throw new InvalidOperationException(\"Invalid tick size\");\n\ndouble normalized = Math.Round(price / tickSize) * tickSize;\n</code></pre></p> <p>WITH sugar: <pre><code>double normalized = await svc.NormalizePriceAsync(\"EURUSD\", price);\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 6 lines \u2192 1 line</li> <li>\u2705 Uses correct property (tick size, not point or digits)</li> <li>\u2705 Automatic validation</li> <li>\u2705 Clearer intent</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#1-basic-price-normalization","title":"1) Basic price normalization","text":"<pre><code>// svc \u2014 MT5Service instance\n\ndouble rawPrice = 1.100005;\ndouble normalized = await svc.NormalizePriceAsync(\"EURUSD\", rawPrice);\n\nConsole.WriteLine($\"Raw:        {rawPrice}\");\nConsole.WriteLine($\"Normalized: {normalized}\");\n// Output:\n// Raw:        1.100005\n// Normalized: 1.10001\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#2-normalize-sl-before-order-placement","title":"2) Normalize SL before order placement","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble entryPrice = 1.10000;\ndouble rawSL = entryPrice - (100 * point); // Might have rounding errors\n\n// Normalize before sending\ndouble normalizedSL = await svc.NormalizePriceAsync(\"EURUSD\", rawSL);\n\nConsole.WriteLine($\"Entry:         {entryPrice}\");\nConsole.WriteLine($\"Raw SL:        {rawSL}\");\nConsole.WriteLine($\"Normalized SL: {normalizedSL}\");\n\n// Use normalizedSL in order\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#3-normalize-tp-after-calculation","title":"3) Normalize TP after calculation","text":"<pre><code>var point = await svc.GetPointAsync(\"GBPUSD\");\n\ndouble entryPrice = 1.25000;\ndouble rawTP = entryPrice + (200 * point);\n\n// Normalize to valid tick\ndouble normalizedTP = await svc.NormalizePriceAsync(\"GBPUSD\", rawTP);\n\nConsole.WriteLine($\"Entry:         {entryPrice}\");\nConsole.WriteLine($\"Raw TP:        {rawTP}\");\nConsole.WriteLine($\"Normalized TP: {normalizedTP}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#4-validate-user-input-price","title":"4) Validate user input price","text":"<pre><code>string userInput = \"1.100055\";\n\nif (double.TryParse(userInput, out double userPrice))\n{\n    double normalized = await svc.NormalizePriceAsync(\"EURUSD\", userPrice);\n\n    if (Math.Abs(normalized - userPrice) &gt; 0.0000001)\n    {\n        Console.WriteLine($\"\u26a0 Price adjusted from {userPrice} to {normalized}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u2713 Price {userPrice} is valid\");\n    }\n\n    // Use normalized price\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#5-normalize-pending-order-price","title":"5) Normalize pending order price","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\", ...);\nvar point = await svc.GetPointAsync(\"EURUSD\");\n\n// Place Buy Limit 50 points below current Ask\ndouble rawPrice = tick.Ask - (50 * point);\ndouble normalizedPrice = await svc.NormalizePriceAsync(\"EURUSD\", rawPrice);\n\nConsole.WriteLine($\"Current Ask:   {tick.Ask}\");\nConsole.WriteLine($\"Raw Limit:     {rawPrice}\");\nConsole.WriteLine($\"Normalized:    {normalizedPrice}\");\n\n// Use normalizedPrice for pending order\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#6-normalize-price-ladder","title":"6) Normalize price ladder","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble basePrice = 1.10000;\nint levels = 5;\n\nConsole.WriteLine(\"Normalized Price Ladder:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nfor (int i = 0; i &lt;= levels; i++)\n{\n    double rawPrice = basePrice + (i * 10 * point);\n    double normalized = await svc.NormalizePriceAsync(\"EURUSD\", rawPrice);\n\n    Console.WriteLine($\"Level {i}: {normalized:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#7-fix-prices-from-external-source","title":"7) Fix prices from external source","text":"<pre><code>// Prices from external API or calculation\ndouble[] externalPrices = { 1.100005, 1.100123, 1.099987 };\n\nConsole.WriteLine(\"Fixing External Prices:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var rawPrice in externalPrices)\n{\n    double normalized = await svc.NormalizePriceAsync(\"EURUSD\", rawPrice);\n\n    Console.WriteLine($\"{rawPrice:F6} \u2192 {normalized:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#8-batch-normalization","title":"8) Batch normalization","text":"<pre><code>async Task&lt;double[]&gt; NormalizeBatch(string symbol, double[] prices)\n{\n    var result = new double[prices.Length];\n\n    for (int i = 0; i &lt; prices.Length; i++)\n    {\n        result[i] = await svc.NormalizePriceAsync(symbol, prices[i]);\n    }\n\n    return result;\n}\n\n// Usage\ndouble[] rawPrices = { 1.10005, 1.10015, 1.10025 };\ndouble[] normalized = await NormalizeBatch(\"EURUSD\", rawPrices);\n\nConsole.WriteLine(\"Batch Normalization:\");\nfor (int i = 0; i &lt; rawPrices.Length; i++)\n{\n    Console.WriteLine($\"  {rawPrices[i]:F6} \u2192 {normalized[i]:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#9-compare-normalization-vs-rounding","title":"9) Compare normalization vs rounding","text":"<pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble rawPrice = 1.100055;\n\n// Method 1: Round by digits (WRONG for orders!)\ndouble roundedByDigits = Math.Round(rawPrice, digits);\n\n// Method 2: Normalize by tick size (CORRECT!)\ndouble normalizedByTick = await svc.NormalizePriceAsync(\"EURUSD\", rawPrice);\n\nConsole.WriteLine($\"Raw price:          {rawPrice:F6}\");\nConsole.WriteLine($\"Rounded by digits:  {roundedByDigits:F5}\");\nConsole.WriteLine($\"Normalized by tick: {normalizedByTick:F5}\");\n\nif (roundedByDigits != normalizedByTick)\n{\n    Console.WriteLine(\"\u26a0 Methods give different results!\");\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#10-cached-normalization-for-performance","title":"10) Cached normalization for performance","text":"<pre><code>// Cache tick size for multiple normalizations\nDictionary&lt;string, double&gt; tickSizeCache = new();\n\nasync Task&lt;double&gt; NormalizeCached(string symbol, double price)\n{\n    if (!tickSizeCache.ContainsKey(symbol))\n    {\n        var tickSize = (await svc.SymbolInfoDoubleAsync(symbol,\n            SymbolInfoDoubleProperty.SymbolTradeTickSize,\n            DateTime.UtcNow.AddSeconds(10),\n            default)).Value;\n\n        tickSizeCache[symbol] = tickSize;\n    }\n\n    double tick = tickSizeCache[symbol];\n    if (tick &lt;= 0) throw new InvalidOperationException(\"Invalid tick size\");\n\n    return Math.Round(price / tick) * tick;\n}\n\n// Usage - first call fetches, subsequent calls use cache\nvar p1 = await NormalizeCached(\"EURUSD\", 1.10005); // Fetches tick size\nvar p2 = await NormalizeCached(\"EURUSD\", 1.10015); // Uses cache\nvar p3 = await NormalizeCached(\"EURUSD\", 1.10025); // Uses cache\n\nConsole.WriteLine($\"Normalized: {p1:F5}, {p2:F5}, {p3:F5}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level method used internally:</p> <ul> <li><code>SymbolInfoDoubleAsync(SymbolTradeTickSize)</code> - Get tick size for normalization</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetPointAsync()</code> - Get point size (for calculations, not normalization)</li> <li><code>GetDigitsAsync()</code> - Get digits (for display only, NOT for normalization)</li> <li><code>GetSymbolSnapshot()</code> - Get tick, point, digits, and margin</li> <li><code>NormalizeVolumeAsync()</code> - Normalize volume (similar concept for volumes)</li> <li>All order placement methods should use this to normalize SL/TP prices</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/NormalizePriceAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using Math.Round(price, digits) instead <pre><code>// \u274c WRONG - rounding by digits\nvar digits = await svc.GetDigitsAsync(\"EURUSD\");\ndouble normalized = Math.Round(price, digits); // Not valid for orders!\n\n// \u2705 CORRECT - normalizing by tick size\ndouble normalized = await svc.NormalizePriceAsync(\"EURUSD\", price);\n</code></pre></p> </li> <li> <p>Assuming tick size equals point size <pre><code>// \u274c WRONG - using point instead of tick\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble normalized = Math.Round(price / point) * point; // Might differ!\n\n// \u2705 CORRECT - using actual tick size\ndouble normalized = await svc.NormalizePriceAsync(\"EURUSD\", price);\n</code></pre></p> </li> <li> <p>Not normalizing calculated prices <pre><code>// \u274c WRONG - sending calculated price directly\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble slPrice = entry - (100 * point);\n// OrderSendAsync(..., sl: slPrice, ...); // Might be invalid!\n\n// \u2705 CORRECT - normalize before sending\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble slPrice = await svc.NormalizePriceAsync(\"EURUSD\",\n    entry - (100 * point));\n// OrderSendAsync(..., sl: slPrice, ...);\n</code></pre></p> </li> <li> <p>Normalizing volumes with this method <pre><code>// \u274c WRONG - this is for prices, not volumes\ndouble volume = 1.55;\ndouble normalized = await svc.NormalizePriceAsync(\"EURUSD\", volume); // Wrong!\n\n// \u2705 CORRECT - use NormalizeVolumeAsync for volumes\ndouble normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", volume);\n</code></pre></p> </li> <li> <p>Not checking for errors <pre><code>// \u274c WRONG - no error handling\ndouble normalized = await svc.NormalizePriceAsync(\"EURUSD\", price);\n\n// \u2705 CORRECT - handle potential errors\ntry\n{\n    double normalized = await svc.NormalizePriceAsync(\"EURUSD\", price);\n    // Use normalized price\n}\ncatch (InvalidOperationException ex)\n{\n    Console.WriteLine($\"Normalization failed: {ex.Message}\");\n    // Handle error\n}\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/","title":"\u2705 Convert Points to Pips (<code>PointsToPipsAsync</code>)","text":"<p>Sugar method: Converts points to pips. For 5-digit FX pairs (EURUSD), 10 points = 1 pip. For 3-digit pairs (USDJPY), 1 point = 1 pip.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.PointsToPipsAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>GetDigitsAsync()</code></li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static async Task&lt;double&gt; PointsToPipsAsync(\n        this MT5Service svc,\n        string symbol,\n        double points,\n        int timeoutSec = 10,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\") <code>points</code> <code>double</code> Number of points to convert <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#output-double","title":"\u2b06\ufe0f Output \u2014 <code>double</code>","text":"<p>Returns the number of pips.</p> <p>Examples:</p> <ul> <li>EURUSD (5 digits): 100 points \u2192 10 pips</li> <li>USDJPY (3 digits): 100 points \u2192 100 pips</li> <li>GOLD (2 digits): 100 points \u2192 100 pips</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Converts broker points to trader pips. For 5-digit pairs, divides by 10. For others, returns same value.</li> <li>Why you need it. Display distances in traditional pip terms for traders familiar with classic 4-digit quoting.</li> <li>Sanity check. For EURUSD: 100 points = 10 pips. For USDJPY: 100 points = 100 pips.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for display and reporting:</p> <ul> <li>Show stop loss/take profit in pips.</li> <li>Display spread in pips.</li> <li>Report trade results in pips.</li> <li>Convert broker points to trader language.</li> <li>Build trading journals with pip values.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>5-digit vs 3-digit: Formula uses <code>digits - 4</code> to determine conversion factor.</li> <li>Conversion formula: <code>pips = points / 10^max(0, digits - 4)</code></li> <li>EURUSD (5 digits): 10 points = 1 pip (factor = 10)</li> <li>USDJPY (3 digits): 1 point = 1 pip (factor = 1)</li> <li>Display only: Use for reporting, NOT for calculations. Always work in points internally.</li> <li>Classic vs Modern: Old 4-digit brokers: 1 point = 1 pip. Modern 5-digit: 10 points = 1 pip.</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method gets digits and calculates conversion:</p> <pre><code>// Step 1: Get symbol digits\nvar digits = await svc.GetDigitsAsync(symbol, timeoutSec, ct);\n\n// Step 2: Calculate conversion factor\n// For 5-digit pairs (digits=5): factor = 10^(5-4) = 10\n// For 3-digit pairs (digits=3): factor = 10^0 = 1\nvar factor = Math.Pow(10, Math.Max(0, digits - 4));\n\n// Step 3: Convert points to pips\nreturn points / factor;\n</code></pre> <p>What it improves:</p> <ul> <li>Symbol-aware conversion - handles different digit counts automatically</li> <li>Simple API - just pass symbol and points</li> <li>Clear intent - converts for display, not calculation</li> <li>Correct for all symbol types - FX, metals, crypto</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar: <pre><code>var digits = await svc.GetDigitsAsync(\"EURUSD\");\nvar factor = Math.Pow(10, Math.Max(0, digits - 4));\ndouble pips = points / factor;\n</code></pre></p> <p>WITH sugar: <pre><code>double pips = await svc.PointsToPipsAsync(\"EURUSD\", points);\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 3 lines \u2192 1 line</li> <li>\u2705 No manual factor calculation</li> <li>\u2705 Symbol-aware</li> <li>\u2705 Clearer intent</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#1-basic-point-to-pip-conversion","title":"1) Basic point to pip conversion","text":"<pre><code>// svc \u2014 MT5Service instance\n\ndouble points = 100;\ndouble pips = await svc.PointsToPipsAsync(\"EURUSD\", points);\n\nConsole.WriteLine($\"{points} points = {pips} pips\");\n// Output: 100 points = 10 pips\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#2-convert-stop-loss-to-pips","title":"2) Convert stop loss to pips","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble entryPrice = 1.10000;\ndouble slPrice = 1.09900;\n\n// Calculate SL distance in points\ndouble slPoints = (entryPrice - slPrice) / point;\n\n// Convert to pips for display\ndouble slPips = await svc.PointsToPipsAsync(\"EURUSD\", slPoints);\n\nConsole.WriteLine($\"SL Distance:\");\nConsole.WriteLine($\"  {slPoints:F0} points\");\nConsole.WriteLine($\"  {slPips:F1} pips\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#3-display-spread-in-pips","title":"3) Display spread in pips","text":"<pre><code>var spreadPoints = await svc.GetSpreadPointsAsync(\"EURUSD\");\nvar spreadPips = await svc.PointsToPipsAsync(\"EURUSD\", spreadPoints);\n\nConsole.WriteLine($\"Spread:\");\nConsole.WriteLine($\"  {spreadPoints:F1} points\");\nConsole.WriteLine($\"  {spreadPips:F2} pips\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#4-compare-conversions-across-symbols","title":"4) Compare conversions across symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\", \"GOLD\" };\ndouble testPoints = 100;\n\nConsole.WriteLine($\"Converting {testPoints} points to pips:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var symbol in symbols)\n{\n    var pips = await svc.PointsToPipsAsync(symbol, testPoints);\n    var digits = await svc.GetDigitsAsync(symbol);\n\n    Console.WriteLine($\"{symbol,-10} ({digits} digits): {testPoints,3} pts = {pips,5:F1} pips\");\n}\n\n// Output:\n// EURUSD     (5 digits): 100 pts =  10.0 pips\n// GBPUSD     (5 digits): 100 pts =  10.0 pips\n// USDJPY     (3 digits): 100 pts = 100.0 pips\n// GOLD       (2 digits): 100 pts = 100.0 pips\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#5-report-trade-result-in-pips","title":"5) Report trade result in pips","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble entryPrice = 1.10000;\ndouble exitPrice = 1.10150;\n\n// Calculate profit in points\ndouble profitPoints = (exitPrice - entryPrice) / point;\n\n// Convert to pips\ndouble profitPips = await svc.PointsToPipsAsync(\"EURUSD\", profitPoints);\n\nConsole.WriteLine($\"Trade Result:\");\nConsole.WriteLine($\"  Entry: {entryPrice}\");\nConsole.WriteLine($\"  Exit:  {exitPrice}\");\nConsole.WriteLine($\"  Profit: {profitPoints:F0} points ({profitPips:F1} pips)\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#6-build-pip-based-statistics","title":"6) Build pip-based statistics","text":"<pre><code>// Sample trades with profit in points\nvar trades = new[]\n{\n    (\"EURUSD\", 150.0),  // points\n    (\"EURUSD\", -80.0),\n    (\"EURUSD\", 200.0),\n    (\"GBPUSD\", 120.0),\n    (\"USDJPY\", 500.0)\n};\n\nConsole.WriteLine(\"Trade Results:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\ndouble totalPips = 0;\n\nforeach (var (symbol, points) in trades)\n{\n    var pips = await svc.PointsToPipsAsync(symbol, points);\n    totalPips += pips;\n\n    var sign = pips &gt;= 0 ? \"+\" : \"\";\n    Console.WriteLine($\"{symbol,-10} {sign}{points,6:F0} pts = {sign}{pips,5:F1} pips\");\n}\n\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\nConsole.WriteLine($\"Total:      {totalPips,20:F1} pips\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#7-format-trade-journal-entry","title":"7) Format trade journal entry","text":"<pre><code>var point = await svc.GetPointAsync(\"EURUSD\");\n\ndouble entry = 1.10000;\ndouble sl = 1.09900;\ndouble tp = 1.10200;\n\n// Calculate distances in points\ndouble slPoints = Math.Abs((entry - sl) / point);\ndouble tpPoints = Math.Abs((tp - entry) / point);\n\n// Convert to pips\ndouble slPips = await svc.PointsToPipsAsync(\"EURUSD\", slPoints);\ndouble tpPips = await svc.PointsToPipsAsync(\"EURUSD\", tpPoints);\ndouble rrRatio = tpPips / slPips;\n\nConsole.WriteLine(\"Trade Setup:\");\nConsole.WriteLine($\"  Entry:     {entry}\");\nConsole.WriteLine($\"  SL:        {sl} ({slPips:F1} pips risk)\");\nConsole.WriteLine($\"  TP:        {tp} ({tpPips:F1} pips target)\");\nConsole.WriteLine($\"  R:R Ratio: 1:{rrRatio:F2}\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#8-calculate-average-pip-movement","title":"8) Calculate average pip movement","text":"<pre><code>// Daily high/low prices\nvar dailyRanges = new[] { 1.10200 - 1.10050, 1.10150 - 1.10000, 1.10300 - 1.10100 };\n\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble totalPips = 0;\n\nConsole.WriteLine(\"Daily Ranges:\");\nforeach (var range in dailyRanges)\n{\n    double rangePoints = range / point;\n    double rangePips = await svc.PointsToPipsAsync(\"EURUSD\", rangePoints);\n    totalPips += rangePips;\n\n    Console.WriteLine($\"  {rangePips:F1} pips\");\n}\n\ndouble averagePips = totalPips / dailyRanges.Length;\nConsole.WriteLine($\"Average: {averagePips:F1} pips/day\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#9-display-strategy-parameters-in-pips","title":"9) Display strategy parameters in pips","text":"<pre><code>// Strategy uses points internally\nint stopLossPoints = 100;\nint takeProfitPoints = 200;\nint trailingStopPoints = 50;\n\n// Convert for display\ndouble slPips = await svc.PointsToPipsAsync(\"EURUSD\", stopLossPoints);\ndouble tpPips = await svc.PointsToPipsAsync(\"EURUSD\", takeProfitPoints);\ndouble tsPips = await svc.PointsToPipsAsync(\"EURUSD\", trailingStopPoints);\n\nConsole.WriteLine(\"Strategy Parameters:\");\nConsole.WriteLine($\"  Stop Loss:     {slPips:F0} pips ({stopLossPoints} points)\");\nConsole.WriteLine($\"  Take Profit:   {tpPips:F0} pips ({takeProfitPoints} points)\");\nConsole.WriteLine($\"  Trailing Stop: {tsPips:F0} pips ({trailingStopPoints} points)\");\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#10-build-conversion-utility","title":"10) Build conversion utility","text":"<pre><code>async Task DisplayConversion(string symbol, double points)\n{\n    var pips = await svc.PointsToPipsAsync(symbol, points);\n    var digits = await svc.GetDigitsAsync(symbol);\n\n    string factor = digits switch\n    {\n        5 =&gt; \"\u00f710\",\n        3 =&gt; \"\u00d71\",\n        _ =&gt; \"\u00d71\"\n    };\n\n    Console.WriteLine($\"{symbol} ({digits} digits):\");\n    Console.WriteLine($\"  {points} points {factor} = {pips:F2} pips\");\n}\n\n// Usage\nawait DisplayConversion(\"EURUSD\", 100);\nawait DisplayConversion(\"USDJPY\", 100);\nawait DisplayConversion(\"GOLD\", 50);\n\n// Output:\n// EURUSD (5 digits):\n//   100 points \u00f710 = 10.00 pips\n// USDJPY (3 digits):\n//   100 points \u00d71 = 100.00 pips\n// GOLD (2 digits):\n//   50 points \u00d71 = 50.00 pips\n</code></pre>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level method used internally:</p> <ul> <li><code>GetDigitsAsync()</code> - Get symbol digits (used to calculate conversion factor)</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>GetPointAsync()</code> - Get point size (use points for calculations, convert to pips for display)</li> <li><code>GetSpreadPointsAsync()</code> - Get spread in points (can convert result to pips with this method)</li> <li><code>GetSymbolSnapshot()</code> - Get tick, point, digits, margin</li> <li>Use this method to convert any point-based values for user display</li> </ul>"},{"location":"MT5Sugar/3.%20Normalization_Utils/PointsToPipsAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using pips for calculations <pre><code>// \u274c WRONG - calculating in pips\ndouble slPips = 10;\ndouble slPrice = entry - (slPips * ???); // How to convert back?\n\n// \u2705 CORRECT - calculate in points, display in pips\ndouble slPoints = 100;\ndouble slPrice = entry - (slPoints * point);\ndouble slPips = await svc.PointsToPipsAsync(\"EURUSD\", slPoints); // For display\n</code></pre></p> </li> <li> <p>Hardcoding conversion factor <pre><code>// \u274c WRONG - assuming all pairs divide by 10\ndouble pips = points / 10; // Wrong for USDJPY!\n\n// \u2705 CORRECT - using symbol-aware conversion\ndouble pips = await svc.PointsToPipsAsync(symbol, points);\n</code></pre></p> </li> <li> <p>Confusing points and pips in code <pre><code>// \u274c WRONG - mixing units\nint stopLoss = 10; // Is this points or pips? Unclear!\n\n// \u2705 CORRECT - explicit naming\nint stopLossPoints = 100; // Clear: this is points\ndouble stopLossPips = await svc.PointsToPipsAsync(\"EURUSD\", stopLossPoints);\n</code></pre></p> </li> <li> <p>Not considering symbol digits <pre><code>// \u274c WRONG - assuming 5 digits for all\ndouble pips = points / 10; // What about USDJPY (3 digits)?\n\n// \u2705 CORRECT - symbol-specific conversion\ndouble pips = await svc.PointsToPipsAsync(symbol, points);\n</code></pre></p> </li> <li> <p>Converting pips back to points manually <pre><code>// \u274c WRONG - manual conversion back\ndouble pips = 10;\ndouble points = pips * 10; // What if symbol is not 5-digit?\n\n// \u2705 CORRECT - work in points, convert to pips only for display\ndouble points = 100; // Use points internally\ndouble pips = await svc.PointsToPipsAsync(\"EURUSD\", points); // Display\n</code></pre></p> </li> <li> <p>Using for volume or money calculations <pre><code>// \u274c WRONG - this is for price units only\ndouble volume = 1.5;\ndouble volumePips = await svc.PointsToPipsAsync(\"EURUSD\", volume); // Makes no sense!\n\n// \u2705 CORRECT - use only for price-related points\ndouble pricePoints = 100;\ndouble pricePips = await svc.PointsToPipsAsync(\"EURUSD\", pricePoints);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/","title":"\u2705 Get Recent Orders History (<code>OrdersHistoryLast</code>)","text":"<p>Sugar method: Gets closed orders for the last N days with paging. Simple wrapper that calculates date range automatically.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.OrdersHistoryLast(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>OrderHistoryAsync()</code></li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static Task&lt;OrdersHistoryData&gt; OrdersHistoryLast(\n        this MT5Service svc,\n        int days = 7,\n        int page = 0,\n        int size = 100,\n        BMT5_ENUM_ORDER_HISTORY_SORT_TYPE sort = BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeAsc,\n        int timeoutSec = 20,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>days</code> <code>int</code> Number of days to look back (default: 7) <code>page</code> <code>int</code> Page number for pagination (default: 0) <code>size</code> <code>int</code> Page size (default: 100) <code>sort</code> <code>BMT5_ENUM_ORDER_HISTORY_SORT_TYPE</code> Sort order (default: by close time ascending) <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 20) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#output-ordershistorydata","title":"\u2b06\ufe0f Output \u2014 <code>OrdersHistoryData</code>","text":"<p>Returns closed orders from the last N days.</p> Field Type Description <code>Orders</code> <code>List&lt;OrderHistoryInfo&gt;</code> List of closed orders <code>TotalCount</code> <code>int</code> Total number of matching orders"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Simple way to get recent closed orders without manually calculating date ranges.</li> <li>Why you need it. Quickly fetch last week/month of trading history for analysis, reporting, or statistics.</li> <li>Sanity check. Returns paged results. Check <code>TotalCount</code> to see if you need to fetch more pages.</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for history analysis:</p> <ul> <li>View last week's trading activity.</li> <li>Build trading journals.</li> <li>Calculate performance statistics.</li> <li>Analyze closed trades.</li> <li>Export trading history.</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Auto date range - calculates <code>from</code> and <code>to</code> automatically from current UTC time</li> <li>Paging - use <code>page</code> and <code>size</code> for large result sets</li> <li>Default period - 7 days (last week)</li> <li>Sort options - by close time (asc/desc), open time, or ticket</li> <li>Longer timeout - default 20 seconds (history queries can be slow)</li> <li>UTC times - all dates are in UTC</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method simplifies date range calculation:</p> <pre><code>// Calculate date range automatically\nvar to = DateTime.UtcNow;                // Now\nvar from = to.AddDays(-days);            // N days ago\n\nvar deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Call low-level method with calculated range\nreturn await svc.OrderHistoryAsync(from, to, sort, page, size, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto date calculation - no manual <code>DateTime.UtcNow.AddDays(-7)</code></li> <li>Simpler API - just specify number of days</li> <li>Default parameters - sensible defaults for common use cases</li> <li>Auto deadline - converts timeout to deadline</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar: <pre><code>var to = DateTime.UtcNow;\nvar from = to.AddDays(-7);\nvar deadline = DateTime.UtcNow.AddSeconds(20);\n\nvar history = await svc.OrderHistoryAsync(\n    from,\n    to,\n    BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeAsc,\n    page: 0,\n    size: 100,\n    deadline,\n    ct);\n</code></pre></p> <p>WITH sugar: <pre><code>var history = await svc.OrdersHistoryLast(days: 7);\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 4 lines \u2192 1 line</li> <li>\u2705 No manual date calculation</li> <li>\u2705 Default parameters</li> <li>\u2705 Clearer intent</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#1-get-last-weeks-orders","title":"1) Get last week's orders","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar history = await svc.OrdersHistoryLast(days: 7);\n\nConsole.WriteLine($\"Closed orders (last 7 days): {history.TotalCount}\");\n\nforeach (var order in history.Orders)\n{\n    Console.WriteLine($\"  Ticket: {order.Ticket}, Symbol: {order.Symbol}, \" +\n                     $\"Profit: {order.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#2-get-last-months-orders","title":"2) Get last month's orders","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 30);\n\nConsole.WriteLine($\"Orders in last 30 days: {history.TotalCount}\");\nConsole.WriteLine($\"Retrieved: {history.Orders.Count}\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#3-paginate-through-all-orders","title":"3) Paginate through all orders","text":"<pre><code>int days = 7;\nint pageSize = 100;\nint page = 0;\n\nvar allOrders = new List&lt;OrderHistoryInfo&gt;();\n\nwhile (true)\n{\n    var history = await svc.OrdersHistoryLast(days, page, pageSize);\n\n    allOrders.AddRange(history.Orders);\n\n    Console.WriteLine($\"Page {page}: {history.Orders.Count} orders\");\n\n    if (history.Orders.Count &lt; pageSize)\n        break; // Last page\n\n    page++;\n}\n\nConsole.WriteLine($\"Total orders retrieved: {allOrders.Count}\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#4-sort-by-close-time-descending-newest-first","title":"4) Sort by close time descending (newest first)","text":"<pre><code>var history = await svc.OrdersHistoryLast(\n    days: 7,\n    sort: BMT5_ENUM_ORDER_HISTORY_SORT_TYPE.Bmt5SortByCloseTimeDesc);\n\nConsole.WriteLine(\"Recent orders (newest first):\");\n\nforeach (var order in history.Orders.Take(10))\n{\n    Console.WriteLine($\"  {order.CloseTime}: {order.Symbol} \" +\n                     $\"Profit: {order.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#5-calculate-total-profit","title":"5) Calculate total profit","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 7);\n\ndouble totalProfit = history.Orders.Sum(o =&gt; o.Profit);\nint winningTrades = history.Orders.Count(o =&gt; o.Profit &gt; 0);\nint losingTrades = history.Orders.Count(o =&gt; o.Profit &lt; 0);\n\nConsole.WriteLine($\"Last 7 days statistics:\");\nConsole.WriteLine($\"  Total orders:   {history.Orders.Count}\");\nConsole.WriteLine($\"  Winning trades: {winningTrades}\");\nConsole.WriteLine($\"  Losing trades:  {losingTrades}\");\nConsole.WriteLine($\"  Total profit:   {totalProfit:F2}\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#6-filter-by-symbol","title":"6) Filter by symbol","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 30);\n\nvar eurusdOrders = history.Orders.Where(o =&gt; o.Symbol == \"EURUSD\").ToList();\n\nConsole.WriteLine($\"EURUSD orders: {eurusdOrders.Count}\");\n\ndouble eurusdProfit = eurusdOrders.Sum(o =&gt; o.Profit);\nConsole.WriteLine($\"EURUSD profit: {eurusdProfit:F2}\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#7-export-to-csv","title":"7) Export to CSV","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 30);\n\nvar csv = new StringBuilder();\ncsv.AppendLine(\"Ticket,Symbol,Type,OpenTime,CloseTime,Volume,OpenPrice,ClosePrice,Profit\");\n\nforeach (var order in history.Orders)\n{\n    csv.AppendLine($\"{order.Ticket},{order.Symbol},{order.Type},\" +\n                  $\"{order.OpenTime},{order.CloseTime},{order.Volume},\" +\n                  $\"{order.OpenPrice},{order.ClosePrice},{order.Profit}\");\n}\n\nFile.WriteAllText(\"orders_history.csv\", csv.ToString());\nConsole.WriteLine(\"Exported to orders_history.csv\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#8-find-best-and-worst-trades","title":"8) Find best and worst trades","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 30);\n\nif (history.Orders.Any())\n{\n    var bestTrade = history.Orders.OrderByDescending(o =&gt; o.Profit).First();\n    var worstTrade = history.Orders.OrderBy(o =&gt; o.Profit).First();\n\n    Console.WriteLine(\"Best trade:\");\n    Console.WriteLine($\"  {bestTrade.Symbol} ticket {bestTrade.Ticket}: \" +\n                     $\"+{bestTrade.Profit:F2}\");\n\n    Console.WriteLine(\"Worst trade:\");\n    Console.WriteLine($\"  {worstTrade.Symbol} ticket {worstTrade.Ticket}: \" +\n                     $\"{worstTrade.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#9-group-by-symbol","title":"9) Group by symbol","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 30);\n\nvar bySymbol = history.Orders\n    .GroupBy(o =&gt; o.Symbol)\n    .Select(g =&gt; new\n    {\n        Symbol = g.Key,\n        Count = g.Count(),\n        TotalProfit = g.Sum(o =&gt; o.Profit)\n    })\n    .OrderByDescending(x =&gt; x.TotalProfit);\n\nConsole.WriteLine(\"Performance by symbol:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var item in bySymbol)\n{\n    Console.WriteLine($\"{item.Symbol,-10} {item.Count,3} trades  \" +\n                     $\"Profit: {item.TotalProfit,8:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#10-calculate-win-rate","title":"10) Calculate win rate","text":"<pre><code>var history = await svc.OrdersHistoryLast(days: 30);\n\nif (history.Orders.Any())\n{\n    int total = history.Orders.Count;\n    int winning = history.Orders.Count(o =&gt; o.Profit &gt; 0);\n    int losing = history.Orders.Count(o =&gt; o.Profit &lt; 0);\n    int breakeven = history.Orders.Count(o =&gt; o.Profit == 0);\n\n    double winRate = (double)winning / total * 100;\n\n    Console.WriteLine(\"Trading Statistics (last 30 days):\");\n    Console.WriteLine($\"  Total trades: {total}\");\n    Console.WriteLine($\"  Winning:      {winning} ({winRate:F1}%)\");\n    Console.WriteLine($\"  Losing:       {losing} ({(double)losing / total * 100:F1}%)\");\n    Console.WriteLine($\"  Breakeven:    {breakeven}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level method used internally:</p> <ul> <li><code>OrderHistoryAsync()</code> - Get orders history with explicit date range</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>PositionsHistoryPaged()</code> - Get positions history (closed positions, not orders)</li> <li><code>GetAccountSnapshot()</code> - Get current account state (not history)</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/OrdersHistoryLast/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Not handling pagination <pre><code>// \u274c WRONG - only gets first 100 orders\nvar history = await svc.OrdersHistoryLast(days: 365);\n// If you have 500 orders, you only got 100!\n\n// \u2705 CORRECT - paginate through all\nvar allOrders = new List&lt;OrderHistoryInfo&gt;();\nint page = 0;\nwhile (true)\n{\n    var history = await svc.OrdersHistoryLast(365, page, 100);\n    allOrders.AddRange(history.Orders);\n    if (history.Orders.Count &lt; 100) break;\n    page++;\n}\n</code></pre></p> </li> <li> <p>Confusing orders with positions <pre><code>// \u274c WRONG - orders are not the same as positions\nvar orders = await svc.OrdersHistoryLast(days: 7);\n// This returns order history, not position history\n\n// \u2705 CORRECT - use correct method for positions\nvar positions = await svc.PositionsHistoryPaged();\n</code></pre></p> </li> <li> <p>Ignoring TotalCount <pre><code>// \u274c WRONG - not checking if there's more data\nvar history = await svc.OrdersHistoryLast(days: 30);\nConsole.WriteLine($\"Total: {history.Orders.Count}\"); // Wrong!\n\n// \u2705 CORRECT - check TotalCount\nvar history = await svc.OrdersHistoryLast(days: 30);\nConsole.WriteLine($\"Retrieved: {history.Orders.Count}\");\nConsole.WriteLine($\"Total: {history.TotalCount}\");\n</code></pre></p> </li> <li> <p>Using local time instead of UTC <pre><code>// \u274c WRONG - comparing with local time\nvar history = await svc.OrdersHistoryLast(days: 1);\nvar today = history.Orders.Where(o =&gt; o.CloseTime.Date == DateTime.Now.Date);\n\n// \u2705 CORRECT - use UTC\nvar history = await svc.OrdersHistoryLast(days: 1);\nvar today = history.Orders.Where(o =&gt; o.CloseTime.Date == DateTime.UtcNow.Date);\n</code></pre></p> </li> <li> <p>Not specifying enough timeout for large queries <pre><code>// \u274c WRONG - default timeout might not be enough\nvar history = await svc.OrdersHistoryLast(days: 365);\n\n// \u2705 CORRECT - use longer timeout for large queries\nvar history = await svc.OrdersHistoryLast(days: 365, timeoutSec: 60);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/","title":"\u2705 Get Positions History with Paging (<code>PositionsHistoryPaged</code>)","text":"<p>Sugar method: Gets closed positions history with optional open date filter and paging. Direct wrapper with default parameters.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.PositionsHistoryPaged(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Underlying calls: <code>PositionsHistoryAsync()</code></li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#method-signature","title":"Method Signature","text":"<pre><code>public static class MT5ServiceExtensions\n{\n    public static Task&lt;PositionsHistoryData&gt; PositionsHistoryPaged(\n        this MT5Service svc,\n        AH_ENUM_POSITIONS_HISTORY_SORT_TYPE sort = AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AhPositionOpenTimeAsc,\n        DateTime? openFrom = null,\n        DateTime? openTo = null,\n        int page = 0,\n        int size = 100,\n        int timeoutSec = 20,\n        CancellationToken ct = default);\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>sort</code> <code>AH_ENUM_POSITIONS_HISTORY_SORT_TYPE</code> Sort order (default: by open time ascending) <code>openFrom</code> <code>DateTime?</code> Filter by open time from (optional) <code>openTo</code> <code>DateTime?</code> Filter by open time to (optional) <code>page</code> <code>int</code> Page number for pagination (default: 0) <code>size</code> <code>int</code> Page size (default: 100) <code>timeoutSec</code> <code>int</code> Timeout in seconds (default: 20) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#output-positionshistorydata","title":"\u2b06\ufe0f Output \u2014 <code>PositionsHistoryData</code>","text":"<p>Returns closed positions with pagination.</p> Field Type Description <code>Positions</code> <code>List&lt;PositionHistoryInfo&gt;</code> List of closed positions <code>TotalCount</code> <code>int</code> Total number of matching positions"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is. Simple wrapper for getting closed positions history with sensible defaults and optional date filtering.</li> <li>Why you need it. Query position history with pagination - easier than OrdersHistoryAsync (position vs order).</li> <li>Sanity check. Returns paged results. Check <code>TotalCount</code> to see if you need more pages. Positions are different from orders.</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for position history analysis:</p> <ul> <li>View all closed positions.</li> <li>Filter positions by open date range.</li> <li>Build performance reports.</li> <li>Calculate statistics per position (not per order).</li> <li>Export closed positions data.</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#notes-tips","title":"\ud83e\udde9 Notes &amp; Tips","text":"<ul> <li>Positions vs Orders - position can have multiple orders (entry, partial closes, full close)</li> <li>Optional filtering - <code>openFrom</code>/<code>openTo</code> are optional (null = no filter)</li> <li>Paging - use <code>page</code> and <code>size</code> for large datasets</li> <li>Default sort - by open time ascending (oldest first)</li> <li>Longer timeout - default 20 seconds (history queries can be slow)</li> <li>UTC dates - all DateTime parameters should be UTC</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<p>This sugar method is a simple wrapper with default parameters:</p> <pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Direct call to low-level method\nreturn await svc.PositionsHistoryAsync(\n    sort,\n    openFrom,\n    openTo,\n    page,\n    size,\n    deadline,\n    ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Named method - clearer than generic \"PositionsHistoryAsync\"</li> <li>Default parameters - sensible defaults for common cases</li> <li>Auto deadline - converts timeout to deadline</li> <li>Clear intent - \"paged\" indicates pagination support</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#low-level-alternative","title":"\ud83d\udcca Low-Level Alternative","text":"<p>WITHOUT sugar: <pre><code>var deadline = DateTime.UtcNow.AddSeconds(20);\n\nvar history = await svc.PositionsHistoryAsync(\n    AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AhPositionOpenTimeAsc,\n    openFrom: null,\n    openTo: null,\n    page: 0,\n    size: 100,\n    deadline,\n    ct);\n</code></pre></p> <p>WITH sugar: <pre><code>var history = await svc.PositionsHistoryPaged();\n</code></pre></p> <p>Benefits:</p> <ul> <li>\u2705 Shorter call</li> <li>\u2705 Default parameters</li> <li>\u2705 Auto deadline</li> <li>\u2705 Clearer name</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#1-get-all-closed-positions-first-page","title":"1) Get all closed positions (first page)","text":"<pre><code>// svc \u2014 MT5Service instance\n\nvar history = await svc.PositionsHistoryPaged();\n\nConsole.WriteLine($\"Closed positions: {history.TotalCount}\");\nConsole.WriteLine($\"Retrieved: {history.Positions.Count}\");\n\nforeach (var pos in history.Positions)\n{\n    Console.WriteLine($\"  Ticket: {pos.Ticket}, Symbol: {pos.Symbol}, \" +\n                     $\"Profit: {pos.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#2-get-positions-opened-in-specific-date-range","title":"2) Get positions opened in specific date range","text":"<pre><code>var from = new DateTime(2024, 1, 1, 0, 0, 0, DateTimeKind.Utc);\nvar to = new DateTime(2024, 1, 31, 23, 59, 59, DateTimeKind.Utc);\n\nvar history = await svc.PositionsHistoryPaged(\n    openFrom: from,\n    openTo: to);\n\nConsole.WriteLine($\"Positions opened in January 2024: {history.TotalCount}\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#3-paginate-through-all-positions","title":"3) Paginate through all positions","text":"<pre><code>int pageSize = 100;\nint page = 0;\n\nvar allPositions = new List&lt;PositionHistoryInfo&gt;();\n\nwhile (true)\n{\n    var history = await svc.PositionsHistoryPaged(page: page, size: pageSize);\n\n    allPositions.AddRange(history.Positions);\n\n    Console.WriteLine($\"Page {page}: {history.Positions.Count} positions\");\n\n    if (history.Positions.Count &lt; pageSize)\n        break; // Last page\n\n    page++;\n}\n\nConsole.WriteLine($\"Total positions retrieved: {allPositions.Count}\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#4-sort-by-close-time-descending-newest-closed-first","title":"4) Sort by close time descending (newest closed first)","text":"<pre><code>var history = await svc.PositionsHistoryPaged(\n    sort: AH_ENUM_POSITIONS_HISTORY_SORT_TYPE.AhPositionCloseTimeDesc);\n\nConsole.WriteLine(\"Recent closed positions (newest first):\");\n\nforeach (var pos in history.Positions.Take(10))\n{\n    Console.WriteLine($\"  Closed: {pos.CloseTime}, {pos.Symbol}, \" +\n                     $\"Profit: {pos.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#5-calculate-total-profit-and-statistics","title":"5) Calculate total profit and statistics","text":"<pre><code>var history = await svc.PositionsHistoryPaged();\n\nif (history.Positions.Any())\n{\n    double totalProfit = history.Positions.Sum(p =&gt; p.Profit);\n    int winners = history.Positions.Count(p =&gt; p.Profit &gt; 0);\n    int losers = history.Positions.Count(p =&gt; p.Profit &lt; 0);\n    double winRate = (double)winners / history.Positions.Count * 100;\n\n    Console.WriteLine(\"Position Statistics:\");\n    Console.WriteLine($\"  Total positions: {history.Positions.Count}\");\n    Console.WriteLine($\"  Winners:         {winners} ({winRate:F1}%)\");\n    Console.WriteLine($\"  Losers:          {losers}\");\n    Console.WriteLine($\"  Total profit:    {totalProfit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#6-group-by-symbol","title":"6) Group by symbol","text":"<pre><code>var history = await svc.PositionsHistoryPaged();\n\nvar bySymbol = history.Positions\n    .GroupBy(p =&gt; p.Symbol)\n    .Select(g =&gt; new\n    {\n        Symbol = g.Key,\n        Count = g.Count(),\n        TotalProfit = g.Sum(p =&gt; p.Profit),\n        AvgProfit = g.Average(p =&gt; p.Profit)\n    })\n    .OrderByDescending(x =&gt; x.TotalProfit);\n\nConsole.WriteLine(\"Performance by symbol:\");\nConsole.WriteLine(\"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\");\n\nforeach (var item in bySymbol)\n{\n    Console.WriteLine($\"{item.Symbol,-10} {item.Count,3} pos  \" +\n                     $\"Total: {item.TotalProfit,8:F2}  Avg: {item.AvgProfit,7:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#7-find-longest-holding-period","title":"7) Find longest holding period","text":"<pre><code>var history = await svc.PositionsHistoryPaged();\n\nif (history.Positions.Any())\n{\n    var longest = history.Positions\n        .OrderByDescending(p =&gt; (p.CloseTime - p.OpenTime).TotalHours)\n        .First();\n\n    var duration = longest.CloseTime - longest.OpenTime;\n\n    Console.WriteLine(\"Longest held position:\");\n    Console.WriteLine($\"  Symbol: {longest.Symbol}\");\n    Console.WriteLine($\"  Ticket: {longest.Ticket}\");\n    Console.WriteLine($\"  Duration: {duration.TotalDays:F1} days\");\n    Console.WriteLine($\"  Profit: {longest.Profit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#8-export-to-csv","title":"8) Export to CSV","text":"<pre><code>var history = await svc.PositionsHistoryPaged();\n\nvar csv = new StringBuilder();\ncsv.AppendLine(\"Ticket,Symbol,Type,OpenTime,CloseTime,Volume,OpenPrice,ClosePrice,Profit,Duration\");\n\nforeach (var pos in history.Positions)\n{\n    var duration = (pos.CloseTime - pos.OpenTime).TotalHours;\n\n    csv.AppendLine($\"{pos.Ticket},{pos.Symbol},{pos.Type},\" +\n                  $\"{pos.OpenTime:yyyy-MM-dd HH:mm:ss},\" +\n                  $\"{pos.CloseTime:yyyy-MM-dd HH:mm:ss},\" +\n                  $\"{pos.Volume},{pos.OpenPrice},{pos.ClosePrice},\" +\n                  $\"{pos.Profit:F2},{duration:F1}\");\n}\n\nFile.WriteAllText(\"positions_history.csv\", csv.ToString());\nConsole.WriteLine(\"Exported to positions_history.csv\");\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#9-calculate-average-holding-time","title":"9) Calculate average holding time","text":"<pre><code>var history = await svc.PositionsHistoryPaged();\n\nif (history.Positions.Any())\n{\n    var avgHoldingTime = history.Positions\n        .Average(p =&gt; (p.CloseTime - p.OpenTime).TotalHours);\n\n    Console.WriteLine($\"Average holding time: {avgHoldingTime:F1} hours \" +\n                     $\"({avgHoldingTime / 24:F1} days)\");\n\n    // By symbol\n    var bySymbol = history.Positions\n        .GroupBy(p =&gt; p.Symbol)\n        .Select(g =&gt; new\n        {\n            Symbol = g.Key,\n            AvgHours = g.Average(p =&gt; (p.CloseTime - p.OpenTime).TotalHours)\n        })\n        .OrderBy(x =&gt; x.Symbol);\n\n    Console.WriteLine(\"\\nAverage holding time by symbol:\");\n    foreach (var item in bySymbol)\n    {\n        Console.WriteLine($\"  {item.Symbol,-10} {item.AvgHours,6:F1} hours\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#10-filter-positions-opened-last-month","title":"10) Filter positions opened last month","text":"<pre><code>var now = DateTime.UtcNow;\nvar lastMonthStart = new DateTime(now.Year, now.Month, 1, 0, 0, 0, DateTimeKind.Utc)\n    .AddMonths(-1);\nvar lastMonthEnd = lastMonthStart.AddMonths(1).AddSeconds(-1);\n\nvar history = await svc.PositionsHistoryPaged(\n    openFrom: lastMonthStart,\n    openTo: lastMonthEnd);\n\nConsole.WriteLine($\"Positions opened last month: {history.TotalCount}\");\n\nif (history.Positions.Any())\n{\n    double monthProfit = history.Positions.Sum(p =&gt; p.Profit);\n    Console.WriteLine($\"Total profit: {monthProfit:F2}\");\n}\n</code></pre>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level method used internally:</p> <ul> <li><code>PositionsHistoryAsync()</code> - Get positions history (this is what PositionsHistoryPaged wraps)</li> </ul> <p>\ud83c\udf6c Other sugar methods:</p> <ul> <li><code>OrdersHistoryLast()</code> - Get closed orders (not positions) for last N days</li> <li><code>GetAccountSnapshot()</code> - Get current open positions (not history)</li> </ul>"},{"location":"MT5Sugar/4.%20History_Helpers/PositionsHistoryPaged/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing positions with orders <pre><code>// \u274c WRONG - positions are not orders\n// Position = one trade (can have multiple orders)\n// Order = individual operation (entry, partial close, etc)\n\nvar history = await svc.PositionsHistoryPaged();\n// This returns positions, not orders!\n\n// \u2705 CORRECT - use appropriate method\nvar positions = await svc.PositionsHistoryPaged(); // Positions\nvar orders = await svc.OrdersHistoryLast(days: 7); // Orders\n</code></pre></p> </li> <li> <p>Not handling pagination <pre><code>// \u274c WRONG - only gets first 100 positions\nvar history = await svc.PositionsHistoryPaged();\nif (history.TotalCount &gt; 100) {\n    // You're missing data!\n}\n\n// \u2705 CORRECT - paginate through all\nvar allPositions = new List&lt;PositionHistoryInfo&gt;();\nint page = 0;\nwhile (true)\n{\n    var history = await svc.PositionsHistoryPaged(page: page);\n    allPositions.AddRange(history.Positions);\n    if (history.Positions.Count &lt; 100) break;\n    page++;\n}\n</code></pre></p> </li> <li> <p>Using local time for filtering <pre><code>// \u274c WRONG - using local time\nvar from = DateTime.Now.AddDays(-30); // Local time!\n\n// \u2705 CORRECT - use UTC\nvar from = DateTime.UtcNow.AddDays(-30);\nvar history = await svc.PositionsHistoryPaged(openFrom: from);\n</code></pre></p> </li> <li> <p>Ignoring TotalCount <pre><code>// \u274c WRONG - assuming you got all data\nvar history = await svc.PositionsHistoryPaged();\nConsole.WriteLine($\"Total: {history.Positions.Count}\"); // Wrong!\n\n// \u2705 CORRECT - check TotalCount\nvar history = await svc.PositionsHistoryPaged();\nConsole.WriteLine($\"Retrieved: {history.Positions.Count}\");\nConsole.WriteLine($\"Total in DB: {history.TotalCount}\");\n</code></pre></p> </li> <li> <p>Wrong date range specification <pre><code>// \u274c WRONG - unspecified DateTimeKind\nvar from = new DateTime(2024, 1, 1); // Kind = Unspecified!\n\n// \u2705 CORRECT - explicit UTC\nvar from = new DateTime(2024, 1, 1, 0, 0, 0, DateTimeKind.Utc);\nvar history = await svc.PositionsHistoryPaged(openFrom: from);\n</code></pre></p> </li> <li> <p>Not filtering when you should <pre><code>// \u274c WRONG - fetching all positions when you only need recent\nvar history = await svc.PositionsHistoryPaged();\nvar recent = history.Positions\n    .Where(p =&gt; p.OpenTime &gt;= DateTime.UtcNow.AddDays(-7))\n    .ToList();\n\n// \u2705 CORRECT - filter on server side\nvar from = DateTime.UtcNow.AddDays(-7);\nvar history = await svc.PositionsHistoryPaged(openFrom: from);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/","title":"\ud83d\udcca Reading Limited Tick Stream (<code>ReadTicks</code>)","text":"<p>Request: Subscribe to symbol tick stream and read a limited number of events or until timeout.</p>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#overview","title":"Overview","text":"<p><code>ReadTicks</code> is a convenience wrapper over <code>OnSymbolTickAsync</code> that automatically limits the stream by: - Maximum number of events - Duration timeout</p> <p>This is useful for testing, sampling, or short-term monitoring without having to manually manage cancellation tokens and counters.</p>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#method-signature","title":"Method Signature","text":"<pre><code>public static async IAsyncEnumerable&lt;OnSymbolTickData&gt; ReadTicks(\n    this MT5Service svc,\n    IEnumerable&lt;string&gt; symbols,\n    int maxEvents = 50,\n    int durationSec = 5,\n    [EnumeratorCancellation] CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#parameters","title":"Parameters","text":"Parameter Type Default Description <code>svc</code> <code>MT5Service</code> - Extension method target <code>symbols</code> <code>IEnumerable&lt;string&gt;</code> - Symbols to subscribe to (e.g., <code>[\"EURUSD\", \"GBPUSD\"]</code>) <code>maxEvents</code> <code>int</code> <code>50</code> Maximum number of tick events to read before stopping <code>durationSec</code> <code>int</code> <code>5</code> Maximum duration in seconds before timeout <code>ct</code> <code>CancellationToken</code> <code>default</code> Optional cancellation token"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#return-value","title":"Return Value","text":"<p>Type: <code>IAsyncEnumerable&lt;OnSymbolTickData&gt;</code></p> <p>Returns an async stream of tick data events. The stream automatically stops when either:</p> <ol> <li><code>maxEvents</code> ticks have been received, OR</li> <li><code>durationSec</code> seconds have elapsed, OR</li> <li>The cancellation token is triggered</li> </ol>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#how-it-works","title":"How It Works","text":"<ol> <li>Creates a linked cancellation token source from the provided <code>ct</code></li> <li>Sets a timeout of <code>durationSec</code> seconds</li> <li>Subscribes to <code>OnSymbolTickAsync</code> for the specified symbols</li> <li>Yields each tick event until:</li> <li>Counter reaches <code>maxEvents</code>, or</li> <li>Timeout is reached, or</li> <li>Cancellation is requested</li> <li>Automatically disposes the cancellation token source</li> </ol>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#common-use-cases","title":"Common Use Cases","text":""},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#1-quick-tick-sample","title":"1\ufe0f\u20e3 Quick Tick Sample","text":"<p>Capture first 10 ticks from EURUSD within 10 seconds:</p> <pre><code>await foreach (var tick in svc.ReadTicks(new[] { \"EURUSD\" }, maxEvents: 10, durationSec: 10))\n{\n    Console.WriteLine($\"[{tick.Symbol}] Bid: {tick.Tick.Bid:F5}, Ask: {tick.Tick.Ask:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#2-multi-symbol-monitoring","title":"2\ufe0f\u20e3 Multi-Symbol Monitoring","text":"<p>Monitor multiple symbols for 30 seconds or until 100 ticks:</p> <pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\n\nawait foreach (var tick in svc.ReadTicks(symbols, maxEvents: 100, durationSec: 30))\n{\n    Console.WriteLine($\"{tick.Symbol} | Bid: {tick.Tick.Bid:F5} | Ask: {tick.Tick.Ask:F5} | Time: {tick.Tick.Time}\");\n}\n\nConsole.WriteLine(\"Tick sampling complete.\");\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#3-calculate-average-spread","title":"3\ufe0f\u20e3 Calculate Average Spread","text":"<p>Collect 20 ticks and calculate average spread:</p> <pre><code>var ticks = new List&lt;OnSymbolTickData&gt;();\n\nawait foreach (var tick in svc.ReadTicks(new[] { \"EURUSD\" }, maxEvents: 20, durationSec: 10))\n{\n    ticks.Add(tick);\n}\n\nvar avgSpread = ticks.Average(t =&gt; t.Tick.Ask - t.Tick.Bid);\nConsole.WriteLine($\"Average spread over {ticks.Count} ticks: {avgSpread:F5}\");\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#4-detect-price-movement","title":"4\ufe0f\u20e3 Detect Price Movement","text":"<p>Monitor ticks until price moves by 10 pips or 30 seconds pass:</p> <pre><code>double? firstBid = null;\nconst double targetMovementPips = 0.0010; // 10 pips for EURUSD\n\nawait foreach (var tick in svc.ReadTicks(new[] { \"EURUSD\" }, maxEvents: 1000, durationSec: 30))\n{\n    firstBid ??= tick.Tick.Bid;\n\n    var movement = Math.Abs(tick.Tick.Bid - firstBid.Value);\n    Console.WriteLine($\"Bid: {tick.Tick.Bid:F5}, Movement: {movement:F5}\");\n\n    if (movement &gt;= targetMovementPips)\n    {\n        Console.WriteLine($\"Target movement reached! Moved {movement:F5}\");\n        break;\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#5-early-cancellation","title":"5\ufe0f\u20e3 Early Cancellation","text":"<p>User can cancel early with custom cancellation token:</p> <pre><code>using var cts = new CancellationTokenSource();\n\n// Cancel after 3 seconds (earlier than durationSec)\ncts.CancelAfter(TimeSpan.FromSeconds(3));\n\ntry\n{\n    await foreach (var tick in svc.ReadTicks(new[] { \"EURUSD\" }, maxEvents: 100, durationSec: 10, ct: cts.Token))\n    {\n        Console.WriteLine($\"Bid: {tick.Tick.Bid:F5}\");\n    }\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Stream cancelled by user.\");\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#onsymboltickdata-structure","title":"OnSymbolTickData Structure","text":"<p>Each yielded event contains:</p> <pre><code>public class OnSymbolTickData\n{\n    public string Symbol { get; set; }           // Symbol name (e.g., \"EURUSD\")\n    public MrpcMqlTick Tick { get; set; }         // Tick data\n}\n\npublic class MrpcMqlTick\n{\n    public Google.Protobuf.WellKnownTypes.Timestamp Time { get; set; }  // Server time\n    public double Bid { get; set; }                // Current Bid price\n    public double Ask { get; set; }                // Current Ask price\n    public double Last { get; set; }               // Price of last deal (Bid)\n    public ulong Volume { get; set; }              // Volume for current Last price\n    public long TimeMs { get; set; }               // Time in milliseconds since Unix epoch\n    public uint Flags { get; set; }                // Tick flags (buy/sell)\n    public double VolumeReal { get; set; }         // Volume for current Last with more precision\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#notes-tips","title":"Notes &amp; Tips","text":"<ul> <li>Auto-termination: Stream stops automatically when limits are reached\u2014no need for manual <code>break</code> statements</li> <li>Timeout priority: If timeout is reached before <code>maxEvents</code>, stream stops early</li> <li>Thread-safe: Uses linked cancellation tokens to ensure clean shutdown</li> <li>Resource management: Automatically disposes cancellation token source via <code>using</code></li> <li>Use case: Perfect for testing, debugging, and short-term monitoring</li> <li>Production: For long-running streams, use <code>OnSymbolTickAsync</code> directly with custom logic</li> </ul>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#comparison","title":"Comparison","text":"Feature <code>ReadTicks</code> (Sugar) <code>OnSymbolTickAsync</code> (Low-level) Auto-limit by count \u2705 Built-in \u274c Manual counter needed Auto-timeout \u2705 Built-in \u274c Manual <code>CancelAfter</code> needed Simplicity \u2705 One-liner \u274c Requires setup code Flexibility \u26a0\ufe0f Limited \u2705 Full control Best for Testing, sampling Production, long-running"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#related-methods","title":"Related Methods","text":"<ul> <li>ReadTrades \u2014 Similar helper for trade event streams</li> <li><code>OnSymbolTickAsync</code> (MT5Account) \u2014 Low-level tick stream subscription</li> <li><code>OnTradeAsync</code> (MT5Account) \u2014 Low-level trade event stream</li> <li><code>SymbolInfoTickAsync</code> (MT5Account) \u2014 Get single current tick (non-streaming)</li> </ul>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTicks/#example-complete-tick-analysis","title":"Example: Complete Tick Analysis","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"GBPUSD\" };\nvar tickCounts = new Dictionary&lt;string, int&gt;();\n\nConsole.WriteLine(\"Starting tick monitoring for 15 seconds or 50 ticks...\\n\");\n\nawait foreach (var tick in svc.ReadTicks(symbols, maxEvents: 50, durationSec: 15))\n{\n    if (!tickCounts.ContainsKey(tick.Symbol))\n        tickCounts[tick.Symbol] = 0;\n\n    tickCounts[tick.Symbol]++;\n\n    var spread = tick.Tick.Ask - tick.Tick.Bid;\n    Console.WriteLine($\"{tick.Symbol,-8} | Bid: {tick.Tick.Bid:F5} | Ask: {tick.Tick.Ask:F5} | Spread: {spread:F5}\");\n}\n\nConsole.WriteLine(\"\\n--- Summary ---\");\nforeach (var (symbol, count) in tickCounts)\n{\n    Console.WriteLine($\"{symbol}: {count} ticks received\");\n}\n</code></pre> <p>Sample Output: <pre><code>Starting tick monitoring for 15 seconds or 50 ticks...\n\nEURUSD   | Bid: 1.08450 | Ask: 1.08452 | Spread: 0.00002\nGBPUSD   | Bid: 1.26320 | Ask: 1.26323 | Spread: 0.00003\nEURUSD   | Bid: 1.08451 | Ask: 1.08453 | Spread: 0.00002\n...\n\n--- Summary ---\nEURUSD: 28 ticks received\nGBPUSD: 22 ticks received\n</code></pre></p>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/","title":"\ud83d\udcc8 Reading Limited Trade Event Stream (<code>ReadTrades</code>)","text":"<p>Request: Subscribe to trade events stream and read a limited number of events or until timeout.</p>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#overview","title":"Overview","text":"<p><code>ReadTrades</code> is a convenience wrapper over <code>OnTradeAsync</code> that automatically limits the stream by: - Maximum number of events - Duration timeout</p> <p>This is useful for monitoring trade executions, fills, position changes, and order events without managing complex cancellation logic.</p>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#method-signature","title":"Method Signature","text":"<pre><code>public static async IAsyncEnumerable&lt;OnTradeData&gt; ReadTrades(\n    this MT5Service svc,\n    int maxEvents = 20,\n    int durationSec = 5,\n    [EnumeratorCancellation] CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#parameters","title":"Parameters","text":"Parameter Type Default Description <code>svc</code> <code>MT5Service</code> - Extension method target <code>maxEvents</code> <code>int</code> <code>20</code> Maximum number of trade events to read before stopping <code>durationSec</code> <code>int</code> <code>5</code> Maximum duration in seconds before timeout <code>ct</code> <code>CancellationToken</code> <code>default</code> Optional cancellation token"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#return-value","title":"Return Value","text":"<p>Type: <code>IAsyncEnumerable&lt;OnTradeData&gt;</code></p> <p>Returns an async stream of trade event data. The stream automatically stops when either:</p> <ol> <li><code>maxEvents</code> trade events have been received, OR</li> <li><code>durationSec</code> seconds have elapsed, OR</li> <li>The cancellation token is triggered</li> </ol>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#how-it-works","title":"How It Works","text":"<ol> <li>Creates a linked cancellation token source from the provided <code>ct</code></li> <li>Sets a timeout of <code>durationSec</code> seconds</li> <li>Subscribes to <code>OnTradeAsync</code> for all account trade events</li> <li>Yields each trade event until:</li> <li>Counter reaches <code>maxEvents</code>, or</li> <li>Timeout is reached, or</li> <li>Cancellation is requested</li> <li>Automatically disposes the cancellation token source</li> </ol>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#common-use-cases","title":"Common Use Cases","text":""},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#1-monitor-recent-trade-activity","title":"1\ufe0f\u20e3 Monitor Recent Trade Activity","text":"<p>Watch for next 10 trade events within 30 seconds:</p> <pre><code>Console.WriteLine(\"Monitoring trade events...\\n\");\n\nawait foreach (var trade in svc.ReadTrades(maxEvents: 10, durationSec: 30))\n{\n    Console.WriteLine($\"[{trade.EventType}] {trade.Symbol} | Volume: {trade.Volume} | Price: {trade.Price:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#2-confirm-order-execution","title":"2\ufe0f\u20e3 Confirm Order Execution","text":"<p>Wait for specific trade event after placing order:</p> <pre><code>// Place a market order\nvar orderRequest = new MrpcMqlTradeRequest\n{\n    Action = MRPC_ENUM_TRADE_REQUEST_ACTIONS.TradeActionDeal,\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Price = ask,\n    OrderType = ENUM_ORDER_TYPE_TF.OrderTypeTfBuy,\n    TypeFilling = MRPC_ENUM_ORDER_TYPE_FILLING.OrderFillingFok,\n    TypeTime = MRPC_ENUM_ORDER_TYPE_TIME.OrderTimeGtc\n};\n\nvar sendResult = await svc.OrderSendAsync(new OrderSendRequest { MqlTradeRequest = orderRequest });\n\nConsole.WriteLine($\"Order sent. Ticket: {sendResult.Deal}. Waiting for trade event...\");\n\n// Monitor for confirmation\nawait foreach (var trade in svc.ReadTrades(maxEvents: 5, durationSec: 10))\n{\n    if (trade.Deal == sendResult.Deal)\n    {\n        Console.WriteLine($\"\u2713 Trade confirmed! Deal: {trade.Deal}, Price: {trade.Price:F5}, Volume: {trade.Volume}\");\n        break;\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#3-log-trade-events-for-debugging","title":"3\ufe0f\u20e3 Log Trade Events for Debugging","text":"<p>Capture all trade events during a specific operation:</p> <pre><code>var tradeLog = new List&lt;OnTradeData&gt;();\n\nawait foreach (var trade in svc.ReadTrades(maxEvents: 50, durationSec: 60))\n{\n    tradeLog.Add(trade);\n    Console.WriteLine($\"{trade.EventType,-20} | {trade.Symbol,-8} | Deal: {trade.Deal} | Order: {trade.Order}\");\n}\n\nConsole.WriteLine($\"\\nCaptured {tradeLog.Count} trade events.\");\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#4-wait-for-position-close","title":"4\ufe0f\u20e3 Wait for Position Close","text":"<p>Monitor trades until a specific position is closed:</p> <pre><code>ulong positionTicket = 123456789; // Position ticket to monitor\n\nawait foreach (var trade in svc.ReadTrades(maxEvents: 100, durationSec: 120))\n{\n    Console.WriteLine($\"Event: {trade.EventType} | Position: {trade.Position}\");\n\n    if (trade.EventType == \"TRADE_ACTION_DEAL\" &amp;&amp; trade.Position == positionTicket)\n    {\n        Console.WriteLine($\"\u2713 Position {positionTicket} closed! Deal: {trade.Deal}, Profit: {trade.Profit:F2}\");\n        break;\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#5-count-trades-in-time-window","title":"5\ufe0f\u20e3 Count Trades in Time Window","text":"<p>Count how many trades occur in a 30-second window:</p> <pre><code>int tradeCount = 0;\n\nawait foreach (var trade in svc.ReadTrades(maxEvents: 1000, durationSec: 30))\n{\n    tradeCount++;\n    Console.WriteLine($\"Trade #{tradeCount}: {trade.EventType} on {trade.Symbol}\");\n}\n\nConsole.WriteLine($\"\\nTotal trades in 30 seconds: {tradeCount}\");\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#ontradedata-structure","title":"OnTradeData Structure","text":"<p>Each yielded event contains:</p> <pre><code>public class OnTradeData\n{\n    public string EventType { get; set; }         // Event type (e.g., \"TRADE_ACTION_DEAL\")\n    public string Symbol { get; set; }            // Symbol name\n    public ulong Deal { get; set; }               // Deal ticket\n    public ulong Order { get; set; }              // Order ticket\n    public ulong Position { get; set; }           // Position ticket\n    public double Volume { get; set; }            // Volume in lots\n    public double Price { get; set; }             // Execution price\n    public double Profit { get; set; }            // Profit/loss\n    public double Commission { get; set; }        // Commission charged\n    public double Swap { get; set; }              // Swap charged\n    public string Comment { get; set; }           // Order/deal comment\n    public Google.Protobuf.WellKnownTypes.Timestamp Time { get; set; }  // Event time\n    // ... additional fields\n}\n</code></pre>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#trade-event-types","title":"Trade Event Types","text":"<p>Common event types you'll see in <code>OnTradeData.EventType</code>:</p> Event Type Description <code>TRADE_ACTION_DEAL</code> Market order executed (position opened/closed) <code>TRADE_ACTION_PENDING</code> Pending order placed <code>TRADE_ACTION_SLTP</code> Stop Loss / Take Profit modified <code>TRADE_ACTION_MODIFY</code> Pending order modified <code>TRADE_ACTION_REMOVE</code> Pending order cancelled <code>TRADE_ACTION_CLOSE_BY</code> Position closed by opposite position"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#notes-tips","title":"Notes &amp; Tips","text":"<ul> <li>Real-time monitoring: Trade events arrive in real-time as they occur on the account</li> <li>Auto-termination: Stream stops automatically when limits are reached</li> <li>Timeout handling: If no trades occur within <code>durationSec</code>, stream terminates</li> <li>Thread-safe: Uses linked cancellation tokens for clean shutdown</li> <li>Resource management: Automatically disposes cancellation token source</li> <li>Use case: Perfect for order execution confirmation, debugging, and short-term monitoring</li> <li>Production: For long-running monitoring, use <code>OnTradeAsync</code> directly</li> </ul>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#comparison","title":"Comparison","text":"Feature <code>ReadTrades</code> (Sugar) <code>OnTradeAsync</code> (Low-level) Auto-limit by count \u2705 Built-in \u274c Manual counter needed Auto-timeout \u2705 Built-in \u274c Manual <code>CancelAfter</code> needed Simplicity \u2705 One-liner \u274c Requires setup code Flexibility \u26a0\ufe0f Limited \u2705 Full control Best for Testing, confirmation Production, continuous monitoring"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#related-methods","title":"Related Methods","text":"<ul> <li>ReadTicks \u2014 Similar helper for tick data streams</li> <li><code>OnTradeAsync</code> (MT5Account) \u2014 Low-level trade event stream subscription</li> <li><code>OnSymbolTickAsync</code> (MT5Account) \u2014 Low-level tick stream</li> <li><code>OrderSendAsync</code> (MT5Account) \u2014 Place orders that generate trade events</li> </ul>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#example-complete-trade-monitoring","title":"Example: Complete Trade Monitoring","text":"<pre><code>Console.WriteLine(\"=== Trade Event Monitor ===\");\nConsole.WriteLine(\"Monitoring for 60 seconds or 20 events...\\n\");\n\nvar eventCounts = new Dictionary&lt;string, int&gt;();\n\nawait foreach (var trade in svc.ReadTrades(maxEvents: 20, durationSec: 60))\n{\n    // Count event types\n    if (!eventCounts.ContainsKey(trade.EventType))\n        eventCounts[trade.EventType] = 0;\n\n    eventCounts[trade.EventType]++;\n\n    // Display event details\n    Console.WriteLine($\"\u250c\u2500 Trade Event #{eventCounts.Values.Sum()}\");\n    Console.WriteLine($\"\u2502  Type:     {trade.EventType}\");\n    Console.WriteLine($\"\u2502  Symbol:   {trade.Symbol}\");\n    Console.WriteLine($\"\u2502  Deal:     {trade.Deal}\");\n    Console.WriteLine($\"\u2502  Order:    {trade.Order}\");\n    Console.WriteLine($\"\u2502  Position: {trade.Position}\");\n    Console.WriteLine($\"\u2502  Volume:   {trade.Volume:F2} lots\");\n    Console.WriteLine($\"\u2502  Price:    {trade.Price:F5}\");\n    Console.WriteLine($\"\u2502  Profit:   {trade.Profit:F2}\");\n    Console.WriteLine($\"\u2502  Time:     {trade.Time}\");\n    Console.WriteLine($\"\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\\n\");\n}\n\nConsole.WriteLine(\"\\n=== Summary ===\");\nforeach (var (eventType, count) in eventCounts)\n{\n    Console.WriteLine($\"{eventType}: {count} events\");\n}\n</code></pre> <p>Sample Output: <pre><code>=== Trade Event Monitor ===\nMonitoring for 60 seconds or 20 events...\n\n\u250c\u2500 Trade Event #1\n\u2502  Type:     TRADE_ACTION_DEAL\n\u2502  Symbol:   EURUSD\n\u2502  Deal:     123456789\n\u2502  Order:    987654321\n\u2502  Position: 555555555\n\u2502  Volume:   0.10 lots\n\u2502  Price:    1.08450\n\u2502  Profit:   0.00\n\u2502  Time:     2025-01-17 10:30:45\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\u250c\u2500 Trade Event #2\n\u2502  Type:     TRADE_ACTION_SLTP\n\u2502  Symbol:   EURUSD\n\u2502  Deal:     0\n\u2502  Order:    987654321\n\u2502  Position: 555555555\n\u2502  Volume:   0.10 lots\n\u2502  Price:    1.08450\n\u2502  Profit:   0.00\n\u2502  Time:     2025-01-17 10:31:02\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n=== Summary ===\nTRADE_ACTION_DEAL: 1 events\nTRADE_ACTION_SLTP: 1 events\n</code></pre></p>"},{"location":"MT5Sugar/5.%20Streams_Helpers/ReadTrades/#advanced-pattern-order-execution-tracker","title":"Advanced Pattern: Order Execution Tracker","text":"<pre><code>public static async Task&lt;OnTradeData?&gt; WaitForOrderFill(\n    MT5Service svc,\n    ulong orderTicket,\n    int timeoutSec = 30)\n{\n    await foreach (var trade in svc.ReadTrades(maxEvents: 100, durationSec: timeoutSec))\n    {\n        if (trade.Order == orderTicket &amp;&amp; trade.EventType == \"TRADE_ACTION_DEAL\")\n        {\n            return trade; // Found the fill event\n        }\n    }\n\n    return null; // Timeout - order not filled\n}\n\n// Usage:\nvar result = await svc.OrderSendAsync(orderRequest);\nvar fillEvent = await WaitForOrderFill(svc, result.Order, timeoutSec: 10);\n\nif (fillEvent != null)\n{\n    Console.WriteLine($\"\u2713 Order filled at {fillEvent.Price:F5}\");\n}\nelse\n{\n    Console.WriteLine(\"\u26a0\ufe0f Order fill timeout\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/","title":"Close All Positions (<code>CloseAll</code>)","text":"<p>Sugar method: Closes all open orders and positions with optional filtering by symbol and direction.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CloseAll(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [06] TRADING \u2014 MARKET &amp; PENDING</li> <li>Underlying calls: <code>OpenedOrdersAsync()</code> + <code>CloseByTicket()</code> for each position</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;int&gt; CloseAll(\n    this MT5Service svc,\n    string? symbol = null,\n    bool? isBuy = null,\n    int timeoutSec = 30,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string?</code> Optional symbol filter (e.g., \"EURUSD\"). Pass null to close all symbols (default: null) <code>isBuy</code> <code>bool?</code> Optional direction filter. true = close only BUY, false = close only SELL, null = close both (default: null) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 30) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;int&gt;</code> Number of orders/positions that were successfully closed"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Bulk close operation - closes all matching positions/orders with optional filters.</li> <li>Why you need it: Emergency exits, end-of-day cleanup, symbol-specific closures without manual iteration.</li> <li>Sanity check: \u26a0\ufe0f USE WITH CAUTION! Returns count of closed positions. Always use filters to avoid closing unintended positions.</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Emergency close all - panic button to exit all positions</li> <li>Symbol cleanup - close all positions for specific symbol</li> <li>Directional close - close all BUY or all SELL positions</li> <li>End-of-day - flatten all positions before market close</li> <li>Strategy exit - close all positions when strategy stops</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get all opened orders and positions\nvar opened = await svc.OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc, deadline, ct);\n\n// Step 2: Filter by symbol and direction\nvar orders = EnumerateOrders(opened);  // Combines positions + pending orders\nint closed = 0;\n\nforeach (var order in orders)\n{\n    // Filter by symbol (if provided)\n    if (symbol != null &amp;&amp; order.Symbol != symbol)\n        continue;\n\n    // Filter by direction (if provided)\n    if (isBuy.HasValue)\n    {\n        bool orderIsBuy = IsBuyOrder(order.Type);\n        if (orderIsBuy != isBuy.Value)\n            continue;\n    }\n\n    // Step 3: Close matching orders sequentially\n    await svc.CloseByTicket(order.Ticket, null, timeoutSec, ct);\n    closed++;\n}\n\nreturn closed;\n</code></pre> <p>What it improves:</p> <ul> <li>Bulk operation - close multiple positions in one call</li> <li>Smart filtering - by symbol, direction, or both</li> <li>Count result - returns number of closed positions</li> <li>Sequential closing - ensures each close completes</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-1-close-all-positions-emergency-exit","title":"Example 1: Close ALL Positions (Emergency Exit)","text":"<pre><code>// \u26a0\ufe0f DANGER: Closes EVERYTHING!\nint closed = await svc.CloseAll();\n\nConsole.WriteLine($\"\ud83d\udea8 Emergency exit: Closed {closed} positions\");\n</code></pre> <p>\u26a0\ufe0f WARNING: This closes ALL positions and pending orders on the account!</p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-2-close-all-positions-for-specific-symbol","title":"Example 2: Close All Positions for Specific Symbol","text":"<pre><code>// Close only EURUSD positions\nint closed = await svc.CloseAll(symbol: \"EURUSD\");\n\nConsole.WriteLine($\"\u2705 Closed {closed} EURUSD positions\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-3-close-all-buy-positions","title":"Example 3: Close All BUY Positions","text":"<pre><code>// Close only BUY positions (all symbols)\nint closed = await svc.CloseAll(isBuy: true);\n\nConsole.WriteLine($\"\u2705 Closed {closed} BUY positions\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-4-close-all-sell-positions","title":"Example 4: Close All SELL Positions","text":"<pre><code>// Close only SELL positions (all symbols)\nint closed = await svc.CloseAll(isBuy: false);\n\nConsole.WriteLine($\"\u2705 Closed {closed} SELL positions\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-5-close-all-buy-positions-on-gbpusd","title":"Example 5: Close All BUY Positions on GBPUSD","text":"<pre><code>// Specific symbol + direction filter\nint closed = await svc.CloseAll(symbol: \"GBPUSD\", isBuy: true);\n\nConsole.WriteLine($\"\u2705 Closed {closed} GBPUSD BUY positions\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-6-close-all-sell-positions-on-multiple-symbols","title":"Example 6: Close All SELL Positions on Multiple Symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"USDJPY\" };\n\nforeach (var symbol in symbols)\n{\n    int closed = await svc.CloseAll(symbol: symbol, isBuy: false);\n    Console.WriteLine($\"\u2705 {symbol}: Closed {closed} SELL positions\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-7-end-of-day-flatten-with-confirmation","title":"Example 7: End-of-Day Flatten (With Confirmation)","text":"<pre><code>// Get count first\nvar opened = await svc.OpenedOrdersAsync(\n    BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc);\n\nint totalPositions = opened.PositionInfos.Count + opened.OpenedOrders.Count;\n\nConsole.WriteLine($\"\u26a0\ufe0f About to close {totalPositions} positions. Confirm? (yes/no)\");\nstring? confirm = Console.ReadLine();\n\nif (confirm?.ToLower() == \"yes\")\n{\n    int closed = await svc.CloseAll();\n    Console.WriteLine($\"\u2705 Closed {closed} positions for end-of-day\");\n}\nelse\n{\n    Console.WriteLine(\"\u274c Cancelled\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-8-strategy-specific-close","title":"Example 8: Strategy-Specific Close","text":"<pre><code>public class TradingStrategy\n{\n    private readonly MT5Service _svc;\n    private readonly string[] _symbols;\n\n    public async Task StopStrategyAsync()\n    {\n        Console.WriteLine(\"Stopping strategy - closing all positions...\");\n\n        // Close positions for strategy symbols only\n        int totalClosed = 0;\n        foreach (var symbol in _symbols)\n        {\n            int closed = await _svc.CloseAll(symbol: symbol);\n            totalClosed += closed;\n            Console.WriteLine($\"  \u2705 {symbol}: {closed} positions closed\");\n        }\n\n        Console.WriteLine($\"Strategy stopped. Total closed: {totalClosed}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-9-close-with-error-handling","title":"Example 9: Close With Error Handling","text":"<pre><code>try\n{\n    int closed = await svc.CloseAll(symbol: \"EURUSD\");\n\n    if (closed &gt; 0)\n    {\n        Console.WriteLine($\"\u2705 Successfully closed {closed} positions\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u2139\ufe0f No positions to close\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Error closing positions: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-10-conditional-close-based-on-time","title":"Example 10: Conditional Close Based on Time","text":"<pre><code>public async Task CloseBeforeWeekend(MT5Service svc)\n{\n    var now = DateTime.Now;\n\n    // Close all positions on Friday after 22:00 UTC\n    if (now.DayOfWeek == DayOfWeek.Friday &amp;&amp; now.Hour &gt;= 22)\n    {\n        Console.WriteLine(\"\u26a0\ufe0f Closing all positions before weekend...\");\n\n        int closed = await svc.CloseAll();\n\n        Console.WriteLine($\"\u2705 Weekend protection: Closed {closed} positions\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-11-smart-close-with-loss-limit","title":"Example 11: Smart Close with Loss Limit","text":"<pre><code>public async Task CloseLosingPositions(MT5Service svc)\n{\n    var opened = await svc.OpenedOrdersAsync(\n        BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc);\n\n    int closedCount = 0;\n\n    // Close only positions with loss &gt; $50\n    foreach (var position in opened.PositionInfos)\n    {\n        if (position.Profit &lt; -50.0)\n        {\n            await svc.CloseByTicket(position.Ticket);\n            closedCount++;\n            Console.WriteLine($\"\u2705 Closed losing position #{position.Ticket}, Loss: ${position.Profit:F2}\");\n        }\n    }\n\n    Console.WriteLine($\"Total losing positions closed: {closedCount}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#example-12-with-cancellation-token","title":"Example 12: With Cancellation Token","text":"<pre><code>var cts = new CancellationTokenSource();\ncts.CancelAfter(TimeSpan.FromSeconds(20));  // Max 20 seconds\n\ntry\n{\n    int closed = await svc.CloseAll(symbol: \"EURUSD\", ct: cts.Token);\n    Console.WriteLine($\"\u2705 Closed {closed} positions\");\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Close operation timed out after 20 seconds\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>OpenedOrdersAsync()</code> - Gets all current positions and orders</li> <li><code>CloseByTicket()</code> - Closes individual positions</li> </ul> <p>\ud83c\udf6c Alternative Sugar methods:</p> <ul> <li><code>CloseAllPositions()</code> - Alias for CloseAll (market positions only)</li> <li><code>CloseAllPending()</code> - Alias for CancelAll (pending orders only)</li> <li><code>CancelAll()</code> - Cancel all pending orders</li> <li><code>CloseByTicket()</code> - Close specific position by ticket</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#common-pitfalls-safety","title":"\u26a0\ufe0f Common Pitfalls &amp; Safety","text":""},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#critical-warning-read-before-using","title":"\u274c CRITICAL WARNING - Read Before Using!","text":"<pre><code>// \u274c EXTREMELY DANGEROUS - Closes EVERYTHING!\nawait svc.CloseAll();\n\n// This will close:\n// - All BUY and SELL market positions\n// - All pending orders (limits, stops)\n// - Across ALL symbols\n// - No confirmation, no undo!\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#safe-usage-patterns","title":"\u2705 SAFE USAGE PATTERNS:","text":"<ol> <li> <p>Always use filters: <pre><code>// \u2705 GOOD: Symbol-specific\nawait svc.CloseAll(symbol: \"EURUSD\");\n\n// \u2705 GOOD: Direction-specific\nawait svc.CloseAll(isBuy: true);\n\n// \u2705 GOOD: Both filters\nawait svc.CloseAll(symbol: \"GBPUSD\", isBuy: false);\n</code></pre></p> </li> <li> <p>Add confirmation in production: <pre><code>Console.WriteLine(\"\u26a0\ufe0f Confirm close all? (yes/no)\");\nif (Console.ReadLine() == \"yes\")\n{\n    await svc.CloseAll();\n}\n</code></pre></p> </li> <li> <p>Test on demo first: <pre><code>#if DEBUG\n    await svc.CloseAll();  // Only in debug mode\n#endif\n</code></pre></p> </li> <li> <p>Use specific methods for specific cases: <pre><code>// \u2705 For one position: Use CloseByTicket\nawait svc.CloseByTicket(ticket: 12345);\n\n// \u2705 For filtered close: Use CloseAll with filters\nawait svc.CloseAll(symbol: \"EURUSD\", isBuy: true);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseAll/#summary","title":"\ud83d\udca1 Summary","text":"<p>CloseAll is a powerful but dangerous bulk close tool:</p> <ul> <li>\u2705 Closes multiple positions in one call</li> <li>\u2705 Optional filters: symbol, direction, or both</li> <li>\u2705 Returns count of closed positions</li> <li>\u26a0\ufe0f USE WITH EXTREME CAUTION - can close all account positions!</li> </ul> <pre><code>// Filtered usage (safe):\nawait svc.CloseAll(symbol: \"EURUSD\");           // Close EURUSD only\nawait svc.CloseAll(isBuy: true);                // Close all BUYs\nawait svc.CloseAll(symbol: \"GBPUSD\", isBuy: false);  // Close GBPUSD SELLs\n\n// Unfiltered (DANGEROUS - use with confirmation):\nawait svc.CloseAll();  // \u26a0\ufe0f Closes EVERYTHING!\n</code></pre> <p>Power tool - use wisely! \ud83d\ude80\u26a0\ufe0f</p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/","title":"Close Position by Ticket (<code>CloseByTicket</code>)","text":"<p>Sugar method: Closes order or position by ticket number with support for partial closure.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CloseByTicket(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [06] TRADING \u2014 MARKET &amp; PENDING</li> <li>Underlying calls: <code>OrderCloseAsync()</code></li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#method-signature","title":"Method Signature","text":"<pre><code>public static Task&lt;OrderCloseData&gt; CloseByTicket(\n    this MT5Service svc,\n    ulong ticket,\n    double? volume = null,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>ticket</code> <code>ulong</code> Order or position ticket number to close <code>volume</code> <code>double?</code> Volume to close in lots. Pass null to close entire position (default: null) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderCloseData&gt;</code> Order close result with execution details"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Closes position or pending order by ticket number - full or partial closure.</li> <li>Why you need it: Simplifies position closing - no manual OrderCloseRequest building.</li> <li>Sanity check: Pass <code>volume: null</code> for full close. For partial, specify exact volume (must not exceed position size).</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Full position closure - exit entire position at market price</li> <li>Partial position closure - reduce position size (scale out)</li> <li>Pending order cancellation - cancel pending limit/stop orders</li> <li>Emergency exits - quickly close specific position</li> <li>Take partial profits - close portion while letting rest run</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Build close request\nvar req = new OrderCloseRequest\n{\n    Ticket = ticket,\n    Volume = volume ?? 0  // 0 means close entire position\n};\n\n// Send close request\nreturn await svc.OrderCloseAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto full close - null volume = close entire position</li> <li>Partial support - specify exact volume to close</li> <li>No request building - method handles it</li> <li>Simple API - just ticket + optional volume</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-1-close-entire-position","title":"Example 1: Close Entire Position","text":"<pre><code>ulong ticket = 12345;\n\n// Close entire position (volume = null)\nvar result = await svc.CloseByTicket(ticket);\n\nConsole.WriteLine($\"\u2705 Position #{ticket} closed completely\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-2-partial-close-50-of-position","title":"Example 2: Partial Close (50% of Position)","text":"<pre><code>ulong ticket = 12345;\ndouble totalVolume = 0.10;  // Current position size\n\n// Close half the position\nvar result = await svc.CloseByTicket(ticket, volume: 0.05);\n\nConsole.WriteLine($\"\u2705 Closed 0.05 lots, remaining: 0.05 lots\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-3-scale-out-in-stages","title":"Example 3: Scale Out in Stages","text":"<pre><code>ulong ticket = 12345;\ndouble totalVolume = 0.10;\n\n// Take profits in 3 stages: 25%, 50%, 25%\n\n// Stage 1: Close 25% at first target\nawait svc.CloseByTicket(ticket, volume: 0.025);\nConsole.WriteLine(\"\u2705 Stage 1: Closed 25% at TP1\");\n\n// Stage 2: Close 50% at second target\nawait svc.CloseByTicket(ticket, volume: 0.05);\nConsole.WriteLine(\"\u2705 Stage 2: Closed 50% at TP2\");\n\n// Stage 3: Close remaining 25% at third target\nawait svc.CloseByTicket(ticket);  // Close remainder\nConsole.WriteLine(\"\u2705 Stage 3: Closed remaining 25% at TP3\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-4-cancel-pending-order","title":"Example 4: Cancel Pending Order","text":"<pre><code>ulong pendingOrderTicket = 67890;\n\n// Cancel pending limit/stop order\nvar result = await svc.CloseByTicket(pendingOrderTicket);\n\nConsole.WriteLine($\"\u2705 Pending order #{pendingOrderTicket} cancelled\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-5-close-multiple-positions","title":"Example 5: Close Multiple Positions","text":"<pre><code>ulong[] tickets = { 12345, 12346, 12347 };\n\nforeach (var ticket in tickets)\n{\n    try\n    {\n        await svc.CloseByTicket(ticket);\n        Console.WriteLine($\"\u2705 Closed position #{ticket}\");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"\u274c Failed to close #{ticket}: {ex.Message}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-6-close-with-error-handling","title":"Example 6: Close With Error Handling","text":"<pre><code>ulong ticket = 12345;\n\ntry\n{\n    var result = await svc.CloseByTicket(ticket);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Position closed successfully\");\n        Console.WriteLine($\"   Deal: #{result.Deal}\");\n        Console.WriteLine($\"   Volume: {result.Volume}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Close failed: {result.Comment}\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-7-partial-close-based-on-profit","title":"Example 7: Partial Close Based on Profit","text":"<pre><code>public async Task TakePartialProfits(MT5Service svc, ulong ticket, double profitPips)\n{\n    var position = await GetPositionInfo(svc, ticket);\n\n    double currentVolume = position.Volume;\n\n    if (profitPips &gt;= 100)\n    {\n        // Close 75% at 100 pips profit\n        double closeVol = currentVolume * 0.75;\n        await svc.CloseByTicket(ticket, volume: closeVol);\n        Console.WriteLine($\"\u2705 Took 75% profit at 100 pips\");\n    }\n    else if (profitPips &gt;= 50)\n    {\n        // Close 50% at 50 pips profit\n        double closeVol = currentVolume * 0.50;\n        await svc.CloseByTicket(ticket, volume: closeVol);\n        Console.WriteLine($\"\u2705 Took 50% profit at 50 pips\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-8-emergency-close-all","title":"Example 8: Emergency Close All","text":"<pre><code>public async Task EmergencyCloseAll(MT5Service svc)\n{\n    var opened = await svc.OpenedOrdersAsync(\n        BMT5_ENUM_OPENED_ORDER_SORT_TYPE.Bmt5OpenedOrderSortByOpenTimeAsc);\n\n    // Close all positions immediately\n    foreach (var position in opened.PositionInfos)\n    {\n        await svc.CloseByTicket(position.Ticket);\n        Console.WriteLine($\"\u2705 Emergency close: #{position.Ticket}\");\n    }\n\n    // Cancel all pending orders\n    foreach (var order in opened.OpenedOrders)\n    {\n        await svc.CloseByTicket(order.Ticket);\n        Console.WriteLine($\"\u2705 Cancelled pending: #{order.Ticket}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-9-close-specific-volume","title":"Example 9: Close Specific Volume","text":"<pre><code>ulong ticket = 12345;\n\n// Close exactly 0.03 lots from position\nvar result = await svc.CloseByTicket(ticket, volume: 0.03);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Closed {result.Volume} lots\");\n    Console.WriteLine($\"   Deal price: {result.Price:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#example-10-smart-partial-close","title":"Example 10: Smart Partial Close","text":"<pre><code>public async Task SmartPartialClose(MT5Service svc, ulong ticket)\n{\n    var position = await GetPositionInfo(svc, ticket);\n\n    double currentVolume = position.Volume;\n    double minVolume = 0.01;  // Broker minimum\n\n    if (currentVolume &gt; minVolume)\n    {\n        // Close 50% but ensure remaining is &gt;= minimum\n        double halfVolume = currentVolume / 2.0;\n\n        if (currentVolume - halfVolume &gt;= minVolume)\n        {\n            await svc.CloseByTicket(ticket, volume: halfVolume);\n            Console.WriteLine($\"\u2705 Closed {halfVolume} lots, remaining: {currentVolume - halfVolume}\");\n        }\n        else\n        {\n            Console.WriteLine($\"\u26a0\ufe0f Cannot partial close - remaining would be below minimum\");\n            Console.WriteLine($\"   Closing entire position instead\");\n            await svc.CloseByTicket(ticket);\n        }\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>OrderCloseAsync()</code> - Sends close request to MT5 server</li> </ul> <p>\ud83c\udf6c Alternative Sugar methods:</p> <ul> <li><code>CloseAll()</code> - Close all positions with optional filters</li> <li><code>CloseAllPositions()</code> - Close all market positions</li> <li><code>CancelAll()</code> - Cancel all pending orders</li> <li><code>ModifySlTpAsync()</code> - Modify SL/TP instead of closing</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Partial volume exceeds position size: <pre><code>// \u274c WRONG: Trying to close 1.0 lot from 0.5 lot position\nawait svc.CloseByTicket(ticket, volume: 1.0);  // Will fail\n\n// \u2705 CORRECT: Check position volume first\nvar position = await GetPositionInfo(svc, ticket);\ndouble closeVolume = Math.Min(0.5, position.Volume);\nawait svc.CloseByTicket(ticket, volume: closeVolume);\n</code></pre></p> </li> <li> <p>Remaining volume below broker minimum: <pre><code>// \u274c WRONG: Closing 0.09 from 0.10 leaves 0.01 (may be below minimum)\nawait svc.CloseByTicket(ticket, volume: 0.09);\n\n// \u2705 CORRECT: Check broker minimum volume\ndouble minVol = await svc.GetVolumeMinAsync(symbol);\ndouble remaining = currentVolume - closeVolume;\nif (remaining &gt;= minVol)\n{\n    await svc.CloseByTicket(ticket, volume: closeVolume);\n}\n</code></pre></p> </li> <li> <p>Trying to close already closed position: <pre><code>// \u274c Will throw exception or fail\nawait svc.CloseByTicket(ticket: 99999);  // Non-existent ticket\n\n// \u2705 CORRECT: Check if position exists first\nvar opened = await svc.OpenedOrdersAsync(...);\nif (opened.PositionInfos.Any(p =&gt; p.Ticket == ticket))\n{\n    await svc.CloseByTicket(ticket);\n}\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/CloseByTicket/#summary","title":"\ud83d\udca1 Summary","text":"<p>CloseByTicket provides clean position closing:</p> <ul> <li>\u2705 Full or partial closure support</li> <li>\u2705 Works with positions and pending orders</li> <li>\u2705 No manual request building</li> <li>\u2705 Simple API - just ticket + optional volume</li> </ul> <pre><code>// Full close:\nawait svc.CloseByTicket(ticket: 12345);\n\n// Partial close:\nawait svc.CloseByTicket(ticket: 12345, volume: 0.05);\n\n// Cancel pending:\nawait svc.CloseByTicket(pendingTicket: 67890);\n</code></pre> <p>Exit positions with precision! \ud83d\ude80</p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/","title":"Modify Stop-Loss/Take-Profit (<code>ModifySlTpAsync</code>)","text":"<p>Sugar method: Modifies stop-loss and/or take-profit for existing order or position by ticket number.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.ModifySlTpAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [06] TRADING \u2014 MARKET &amp; PENDING</li> <li>Underlying calls: <code>OrderModifyAsync()</code></li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static Task&lt;OrderModifyData&gt; ModifySlTpAsync(\n    this MT5Service svc,\n    ulong ticket,\n    double? slPrice = null,\n    double? tpPrice = null,\n    int timeoutSec = 10,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>ticket</code> <code>ulong</code> Order or position ticket number <code>slPrice</code> <code>double?</code> New stop-loss price (absolute). Pass null to keep unchanged <code>tpPrice</code> <code>double?</code> New take-profit price (absolute). Pass null to keep unchanged <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderModifyData&gt;</code> Order modify result with execution details"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Updates SL/TP for existing order or position - modify one or both at once.</li> <li>Why you need it: Simpler than building OrderModifyRequest manually - just provide new prices.</li> <li>Sanity check: At least one parameter (slPrice or tpPrice) must be provided. Pass absolute price values, not points.</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Trailing stop-loss as price moves in your favor</li> <li>Moving to breakeven after initial profit</li> <li>Adjusting take-profit based on new market conditions</li> <li>Tightening stops to lock in profit</li> <li>Removing SL/TP (set to 0)</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Validation: At least one parameter required\nif (slPrice is null &amp;&amp; tpPrice is null)\n    throw new ArgumentException(\"Provide at least one: slPrice or tpPrice\");\n\n// Build modify request\nvar req = new OrderModifyRequest { Ticket = ticket };\n\n// Set only explicitly provided fields\nif (slPrice is double sl) req.StopLoss = sl;\nif (tpPrice is double tp) req.TakeProfit = tp;\n\n// Send modify request\nreturn await svc.OrderModifyAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Partial updates - modify only SL, only TP, or both</li> <li>No request building - method handles it automatically</li> <li>Null handling - only provided values are modified</li> <li>Validation - throws if both params are null</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-1-modify-only-stop-loss","title":"Example 1: Modify Only Stop-Loss","text":"<pre><code>ulong ticket = 12345;\n\n// Move stop-loss to breakeven\nvar result = await svc.ModifySlTpAsync(ticket, slPrice: 1.0900);\n\nConsole.WriteLine($\"\u2705 Stop-loss updated for ticket #{ticket}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-2-modify-only-take-profit","title":"Example 2: Modify Only Take-Profit","text":"<pre><code>ulong ticket = 12345;\n\n// Adjust take-profit to new target\nvar result = await svc.ModifySlTpAsync(ticket, tpPrice: 1.1000);\n\nConsole.WriteLine($\"\u2705 Take-profit updated for ticket #{ticket}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-3-modify-both-sl-and-tp","title":"Example 3: Modify Both SL and TP","text":"<pre><code>ulong ticket = 12345;\n\n// Update both stops at once\nvar result = await svc.ModifySlTpAsync(\n    ticket,\n    slPrice: 1.0920,\n    tpPrice: 1.1000);\n\nConsole.WriteLine($\"\u2705 Both SL and TP updated for ticket #{ticket}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-4-trailing-stop-loss","title":"Example 4: Trailing Stop-Loss","text":"<pre><code>// Position details\nulong ticket = 12345;\ndouble entryPrice = 1.0900;\ndouble currentBid = 1.0950;\ndouble trailingPoints = 30;  // 30 points trailing\n\n// Calculate new SL (trailing behind current price)\ndouble pointSize = 0.00001;  // for EURUSD\ndouble newSL = currentBid - (trailingPoints * pointSize);\n\n// Only update if new SL is better than current\nvar result = await svc.ModifySlTpAsync(ticket, slPrice: newSL);\n\nConsole.WriteLine($\"\u2705 Trailing stop updated to {newSL:F5}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-5-move-to-breakeven-after-profit","title":"Example 5: Move to Breakeven After Profit","text":"<pre><code>ulong ticket = 12345;\ndouble entryPrice = 1.0900;\ndouble currentBid = 1.0950;\nint breakevenTriggerPips = 20;\n\n// Check if price moved 20 pips in profit\ndouble pointSize = 0.00001;\ndouble profitPips = (currentBid - entryPrice) / pointSize;\n\nif (profitPips &gt;= breakevenTriggerPips)\n{\n    // Move SL to breakeven (entry price)\n    var result = await svc.ModifySlTpAsync(ticket, slPrice: entryPrice);\n    Console.WriteLine($\"\u2705 Moved to breakeven at {entryPrice:F5}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-6-remove-stop-loss-set-to-0","title":"Example 6: Remove Stop-Loss (Set to 0)","text":"<pre><code>ulong ticket = 12345;\n\n// Remove stop-loss by setting it to 0\nvar result = await svc.ModifySlTpAsync(ticket, slPrice: 0);\n\nConsole.WriteLine($\"\u26a0\ufe0f Stop-loss removed for ticket #{ticket}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-7-tighten-stops-to-lock-profit","title":"Example 7: Tighten Stops to Lock Profit","text":"<pre><code>ulong ticket = 12345;\ndouble entryPrice = 1.0900;\ndouble currentBid = 1.0970;\ndouble lockedProfitPips = 50;\n\n// Lock in 50 pips profit\ndouble pointSize = 0.00001;\ndouble newSL = entryPrice + (lockedProfitPips * pointSize);\n\nvar result = await svc.ModifySlTpAsync(ticket, slPrice: newSL);\n\nConsole.WriteLine($\"\u2705 Locked {lockedProfitPips} pips profit. New SL: {newSL:F5}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-8-update-multiple-positions","title":"Example 8: Update Multiple Positions","text":"<pre><code>// Update SL for multiple positions\nulong[] tickets = { 12345, 12346, 12347 };\ndouble newSL = 1.0920;\n\nforeach (var ticket in tickets)\n{\n    try\n    {\n        await svc.ModifySlTpAsync(ticket, slPrice: newSL);\n        Console.WriteLine($\"\u2705 Updated ticket #{ticket}\");\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"\u274c Failed to update ticket #{ticket}: {ex.Message}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-9-error-handling","title":"Example 9: Error Handling","text":"<pre><code>ulong ticket = 12345;\n\ntry\n{\n    var result = await svc.ModifySlTpAsync(ticket, slPrice: 1.0920, tpPrice: 1.1000);\n    Console.WriteLine($\"\u2705 Modified successfully\");\n}\ncatch (ArgumentException ex)\n{\n    Console.WriteLine($\"\u274c Invalid arguments: {ex.Message}\");\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Modification failed: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#example-10-conditional-modification-strategy","title":"Example 10: Conditional Modification Strategy","text":"<pre><code>public async Task ManagePosition(MT5Service svc, ulong ticket, double currentPrice)\n{\n    var position = await GetPositionInfo(svc, ticket);\n\n    double entryPrice = position.OpenPrice;\n    double currentSL = position.StopLoss;\n    double profitPoints = (currentPrice - entryPrice) / 0.00001;\n\n    // Strategy: Move to BE at 20 pips, trail at 50 pips\n    if (profitPoints &gt;= 50 &amp;&amp; currentSL &lt; entryPrice + 0.0020)\n    {\n        // Trail 20 pips behind\n        double newSL = currentPrice - 0.0020;\n        await svc.ModifySlTpAsync(ticket, slPrice: newSL);\n        Console.WriteLine($\"\u2705 Trailing stop activated: {newSL:F5}\");\n    }\n    else if (profitPoints &gt;= 20 &amp;&amp; currentSL &lt; entryPrice)\n    {\n        // Move to breakeven\n        await svc.ModifySlTpAsync(ticket, slPrice: entryPrice);\n        Console.WriteLine($\"\u2705 Moved to breakeven: {entryPrice:F5}\");\n    }\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>OrderModifyAsync()</code> - Sends modify request to MT5 server</li> </ul> <p>\ud83c\udf6c Alternative Sugar methods:</p> <ul> <li><code>PlaceMarket()</code> - Place market order with SL/TP</li> <li><code>PlacePending()</code> - Place pending order with SL/TP</li> <li><code>CloseByTicket()</code> - Close position by ticket</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Forgetting to provide at least one parameter: <pre><code>// \u274c WRONG: Both null\nawait svc.ModifySlTpAsync(ticket: 12345);\n// Throws: ArgumentException\n\n// \u2705 CORRECT: Provide at least one\nawait svc.ModifySlTpAsync(ticket: 12345, slPrice: 1.0920);\n</code></pre></p> </li> <li> <p>Using relative points instead of absolute prices: <pre><code>// \u274c WRONG: Points offset\nawait svc.ModifySlTpAsync(ticket: 12345, slPrice: 50);  // Not 50 points!\n\n// \u2705 CORRECT: Absolute price\ndouble currentBid = 1.0950;\ndouble sl = currentBid - 50 * 0.00001;  // 50 points below\nawait svc.ModifySlTpAsync(ticket: 12345, slPrice: sl);\n</code></pre></p> </li> <li> <p>Invalid SL/TP levels (too close to current price): <pre><code>// \u274c May fail if SL too close to market price\n// Check broker's minimum stop level (e.g., 10 points)\n\n// \u2705 CORRECT: Use proper distance\ndouble minStopLevel = 10 * pointSize;\ndouble newSL = currentPrice - minStopLevel;\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/ModifySlTpAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>ModifySlTpAsync provides clean stop modification:</p> <ul> <li>\u2705 Modify SL only, TP only, or both</li> <li>\u2705 No manual request building</li> <li>\u2705 Null handling for partial updates</li> <li>\u2705 Validation prevents empty modifications</li> </ul> <pre><code>// Simple modifications:\nawait svc.ModifySlTpAsync(ticket, slPrice: 1.0920);           // Update SL\nawait svc.ModifySlTpAsync(ticket, tpPrice: 1.1000);           // Update TP\nawait svc.ModifySlTpAsync(ticket, slPrice: 1.0920, tpPrice: 1.1000);  // Both\n</code></pre> <p>Manage positions like a pro! \ud83d\ude80</p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/","title":"\ud83d\ude80 Place Market Order (<code>PlaceMarket</code>)","text":"<p>Request: Place a market BUY or SELL order with sane defaults and automatic symbol selection.</p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#overview","title":"Overview","text":"<p><code>PlaceMarket</code> is a high-level convenience method that simplifies placing market orders by:</p> <ul> <li>Automatically ensuring symbol is selected and synchronized</li> <li>Using reflection to avoid hard dependency on enum names</li> <li>Providing sensible defaults for all optional parameters</li> <li>Supporting SL/TP, comments, and slippage/deviation</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; PlaceMarket(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    bool isBuy,\n    double? sl = null,\n    double? tp = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#parameters","title":"Parameters","text":"Parameter Type Default Description <code>svc</code> <code>MT5Service</code> - Extension method target <code>symbol</code> <code>string</code> - Trading symbol (e.g., <code>\"EURUSD\"</code>, <code>\"XAUUSD\"</code>) <code>volume</code> <code>double</code> - Volume in lots (e.g., <code>0.01</code>, <code>1.0</code>) <code>isBuy</code> <code>bool</code> - <code>true</code> for BUY, <code>false</code> for SELL <code>sl</code> <code>double?</code> <code>null</code> Stop Loss price (absolute price, not points) <code>tp</code> <code>double?</code> <code>null</code> Take Profit price (absolute price, not points) <code>comment</code> <code>string?</code> <code>null</code> Order comment (optional) <code>deviationPoints</code> <code>int</code> <code>0</code> Maximum allowed slippage in points <code>timeoutSec</code> <code>int</code> <code>15</code> Operation timeout in seconds <code>ct</code> <code>CancellationToken</code> <code>default</code> Cancellation token"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#return-value","title":"Return Value","text":"<p>Type: <code>OrderSendData</code></p> <p>Contains the result of the order placement:</p> <pre><code>public class OrderSendData\n{\n    public uint ReturnedCode { get; set; }        // 0 = success, other = error code\n    public ulong Deal { get; set; }               // Deal ticket (for market orders)\n    public ulong Order { get; set; }              // Order ticket\n    public double Volume { get; set; }            // Executed volume\n    public double Price { get; set; }             // Execution price\n    public double Bid { get; set; }               // Bid price at execution\n    public double Ask { get; set; }               // Ask price at execution\n    public string Comment { get; set; }           // Server comment/error description\n    // ... additional fields\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#how-it-works","title":"How It Works","text":"<ol> <li>Symbol Selection: Calls <code>EnsureSelected</code> to ensure symbol is available and synchronized</li> <li>Request Building: Creates <code>OrderSendRequest</code> with provided parameters</li> <li>Reflection Magic: Uses reflection to set <code>Operation</code> field (BUY=0, SELL=1) to avoid hard dependency on enum names</li> <li>Order Execution: Calls <code>OrderSendAsync</code> with configured timeout</li> <li>Result: Returns <code>OrderSendData</code> with execution details</li> </ol>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#common-use-cases","title":"Common Use Cases","text":""},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#1-simple-market-buy","title":"1\ufe0f\u20e3 Simple Market BUY","text":"<pre><code>var result = await svc.PlaceMarket(\"EURUSD\", volume: 0.01, isBuy: true);\n\nConsole.WriteLine($\"Order placed! Deal: {result.Deal}, Price: {result.Price:F5}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#2-market-sell-with-stop-loss","title":"2\ufe0f\u20e3 Market SELL with Stop Loss","text":"<pre><code>double currentBid = 1.08450;\ndouble stopLoss = currentBid + 0.0010; // 10 pips above (for SELL)\n\nvar result = await svc.PlaceMarket(\n    symbol: \"EURUSD\",\n    volume: 0.10,\n    isBuy: false,          // SELL\n    sl: stopLoss\n);\n\nConsole.WriteLine($\"SELL order placed with SL at {stopLoss:F5}\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#3-market-buy-with-sl-tp","title":"3\ufe0f\u20e3 Market BUY with SL &amp; TP","text":"<pre><code>double currentAsk = 1.08450;\ndouble stopLoss = currentAsk - 0.0020;    // 20 pips below\ndouble takeProfit = currentAsk + 0.0030;  // 30 pips above\n\nvar result = await svc.PlaceMarket(\n    symbol: \"EURUSD\",\n    volume: 0.05,\n    isBuy: true,\n    sl: stopLoss,\n    tp: takeProfit,\n    comment: \"My strategy v1.0\"\n);\n\nif (result.ReturnedCode == 0)\n{\n    Console.WriteLine($\"\u2713 Order executed at {result.Price:F5}\");\n    Console.WriteLine($\"  SL: {stopLoss:F5}, TP: {takeProfit:F5}\");\n}\nelse\n{\n    Console.WriteLine($\"\u2717 Order failed: {result.Comment}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#4-market-order-with-slippage-control","title":"4\ufe0f\u20e3 Market Order with Slippage Control","text":"<pre><code>var result = await svc.PlaceMarket(\n    symbol: \"XAUUSD\",\n    volume: 0.01,\n    isBuy: true,\n    deviationPoints: 50,  // Allow up to 50 points slippage\n    timeoutSec: 10\n);\n\nConsole.WriteLine($\"Executed at {result.Price:F2} (Bid: {result.Bid:F2}, Ask: {result.Ask:F2})\");\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#5-error-handling","title":"5\ufe0f\u20e3 Error Handling","text":"<pre><code>try\n{\n    var result = await svc.PlaceMarket(\"EURUSD\", 0.01, isBuy: true);\n\n    if (result.ReturnedCode == 0)\n    {\n        Console.WriteLine($\"\u2713 Success! Deal: {result.Deal}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u2717 Trade rejected: Code {result.ReturnedCode} - {result.Comment}\");\n    }\n}\ncatch (ApiExceptionMT5 ex)\n{\n    Console.WriteLine($\"MT5 Error: {ex.ErrorCode} - {ex.Message}\");\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"Error: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#notes-tips","title":"Notes &amp; Tips","text":"<ul> <li>Price not required: For market orders, the server automatically executes at current market price</li> <li>SL/TP are absolute prices: Not distances in points/pips</li> <li>Deviation: Slippage protection\u2014order rejected if execution price deviates more than specified points</li> <li>Symbol selection: Automatically handled via <code>EnsureSelected</code></li> <li>Timeout: Default 15 seconds should be sufficient for most markets</li> <li>Return code: Always check <code>ReturnedCode == 0</code> for success</li> <li>Risk-based trading: Consider using <code>BuyMarketByRisk()</code> / <code>SellMarketByRisk()</code> for automatic position sizing</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#return-codes","title":"Return Codes","text":"Code Description <code>0</code> Success - order executed <code>10004</code> Trade server is busy <code>10006</code> Request rejected <code>10013</code> Invalid request <code>10014</code> Invalid volume <code>10015</code> Invalid price <code>10016</code> Invalid stops (SL/TP) <code>10019</code> No money (insufficient margin) <code>10027</code> Trade disabled for symbol <p>Full list: Return Codes Reference</p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#comparison-with-low-level-api","title":"Comparison with Low-Level API","text":"Feature <code>PlaceMarket</code> (Sugar) <code>OrderSendAsync</code> (Low-level) Symbol selection \u2705 Automatic \u274c Manual Default parameters \u2705 Yes \u274c All required Syntax \u2705 Clean \u26a0\ufe0f Verbose Flexibility \u26a0\ufe0f Limited \u2705 Full control Best for Quick trades Complex strategies"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#related-methods","title":"Related Methods","text":"<ul> <li><code>BuyMarketByRisk()</code> \u2014 BUY with risk-based position sizing \u2b50</li> <li><code>SellMarketByRisk()</code> \u2014 SELL with risk-based position sizing \u2b50</li> <li>PlacePending \u2014 Place limit/stop pending orders</li> <li>ModifySlTpAsync \u2014 Modify SL/TP after placement</li> <li>CloseByTicket \u2014 Close position by ticket</li> <li><code>OrderSendAsync</code> (MT5Account) \u2014 Low-level order placement</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlaceMarket/#example-complete-trading-flow","title":"Example: Complete Trading Flow","text":"<pre><code>// Get current prices\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble ask = tick.Ask;\ndouble bid = tick.Bid;\n\n// Calculate SL/TP levels (20 pips SL, 30 pips TP)\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble slDistance = 20 * 10 * point; // 20 pips\ndouble tpDistance = 30 * 10 * point; // 30 pips\n\ndouble sl = ask - slDistance;  // BUY SL below ask\ndouble tp = ask + tpDistance;  // BUY TP above ask\n\nConsole.WriteLine($\"Placing BUY order...\");\nConsole.WriteLine($\"  Entry: {ask:F5}\");\nConsole.WriteLine($\"  SL:    {sl:F5} (-{slDistance / point:F1} points)\");\nConsole.WriteLine($\"  TP:    {tp:F5} (+{tpDistance / point:F1} points)\");\n\nvar result = await svc.PlaceMarket(\n    symbol: \"EURUSD\",\n    volume: 0.10,\n    isBuy: true,\n    sl: sl,\n    tp: tp,\n    comment: \"Auto trade\",\n    deviationPoints: 10\n);\n\nif (result.ReturnedCode == 0)\n{\n    Console.WriteLine($\"\\n\u2713 Order executed successfully!\");\n    Console.WriteLine($\"  Deal:   {result.Deal}\");\n    Console.WriteLine($\"  Price:  {result.Price:F5}\");\n    Console.WriteLine($\"  Volume: {result.Volume:F2} lots\");\n}\nelse\n{\n    Console.WriteLine($\"\\n\u2717 Order failed!\");\n    Console.WriteLine($\"  Code:    {result.ReturnedCode}\");\n    Console.WriteLine($\"  Comment: {result.Comment}\");\n}\n</code></pre> <p>Sample Output: <pre><code>Placing BUY order...\n  Entry: 1.08450\n  SL:    1.08250 (-200.0 points)\n  TP:    1.08750 (+300.0 points)\n\n\u2713 Order executed successfully!\n  Deal:   123456789\n  Price:  1.08451\n  Volume: 0.10 lots\n</code></pre></p>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/","title":"Place Pending Order (<code>PlacePending</code>)","text":"<p>Sugar method: Places a pending order (Buy/Sell Limit or Stop) at specified price with automatic symbol preparation.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.PlacePending(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [06] TRADING \u2014 MARKET &amp; PENDING</li> <li>Underlying calls: <code>EnsureSelected()</code> + <code>OrderSendAsync()</code></li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; PlacePending(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    ENUM_ORDER_TYPE type,\n    double price,\n    double? sl = null,\n    double? tp = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol to trade (e.g., \"EURUSD\", \"XAUUSD\") <code>volume</code> <code>double</code> Volume in lots <code>type</code> <code>ENUM_ORDER_TYPE</code> Order type (BuyLimit, SellLimit, BuyStop, SellStop) <code>price</code> <code>double</code> Entry price for pending order <code>sl</code> <code>double?</code> Optional stop-loss price (default: null) <code>tp</code> <code>double?</code> Optional take-profit price (default: null) <code>comment</code> <code>string?</code> Optional order comment (default: null) <code>deviationPoints</code> <code>int</code> Maximum price deviation in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#ordersenddata-structure","title":"<code>OrderSendData</code> Structure","text":"<p>Key fields:</p> <ul> <li><code>Order</code> (ulong) - Ticket number of created pending order</li> <li><code>ReturnedCode</code> (uint) - Execution result code (10009 = success)</li> <li><code>Comment</code> (string) - Server response message</li> <li><code>Volume</code> (double) - Actual volume executed</li> <li><code>Price</code> (double) - Order entry price</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Places pending order (Limit/Stop) at specified price with automatic symbol selection.</li> <li>Why you need it: Simplifies pending order placement - handles symbol preparation and request building automatically.</li> <li>Sanity check: Check <code>result.ReturnedCode == 10009</code> for success. Pending order activated when price reaches specified level.</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Buy Limit - Buy when price drops to specified level (expect dip before rally)</li> <li>Sell Limit - Sell when price rises to specified level (expect rise before drop)</li> <li>Buy Stop - Buy when price breaks above specified level (breakout up)</li> <li>Sell Stop - Sell when price breaks below specified level (breakdown)</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Ensure symbol is selected and synchronized\nawait svc.EnsureSelected(symbol, timeoutSec, ct);\n\n// Step 2: Build pending order request\nvar req = new OrderSendRequest\n{\n    Symbol = symbol,\n    Volume = volume,\n    Price = price,                    // Entry price\n    StopLoss = sl ?? 0,\n    TakeProfit = tp ?? 0,\n    Comment = comment ?? string.Empty,\n    Slippage = (ulong)Math.Max(0, deviationPoints),\n    Operation = type  // BuyLimit/SellLimit/BuyStop/SellStop\n};\n\n// Step 3: Send order\nreturn await svc.OrderSendAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto symbol selection - ensures symbol ready before order</li> <li>Request building - no manual OrderSendRequest construction</li> <li>Type safety - uses ENUM_ORDER_TYPE enum</li> <li>Reflection-based - sets Operation via reflection to avoid hard enum dependency</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-1-buy-limit-buy-on-dip","title":"Example 1: Buy Limit (Buy on Dip)","text":"<pre><code>// Current price: 1.0900\n// Want to buy at 1.0850 (below current price)\n\nvar result = await svc.PlacePending(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    type: ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 1.0850,\n    sl: 1.0800,      // 50 pips below entry\n    tp: 1.0950);     // 100 pips above entry\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Buy Limit placed: #{result.Order} at 1.0850\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-2-sell-limit-sell-on-rise","title":"Example 2: Sell Limit (Sell on Rise)","text":"<pre><code>// Current price: 1.2500\n// Want to sell at 1.2550 (above current price)\n\nvar result = await svc.PlacePending(\n    symbol: \"GBPUSD\",\n    volume: 0.05,\n    type: ENUM_ORDER_TYPE.OrderTypeSellLimit,\n    price: 1.2550,\n    sl: 1.2600,      // 50 pips above entry\n    tp: 1.2450);     // 100 pips below entry\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Sell Limit placed: #{result.Order} at 1.2550\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-3-buy-stop-breakout-up","title":"Example 3: Buy Stop (Breakout Up)","text":"<pre><code>// Current price: 2000.0\n// Want to buy if price breaks above 2010.0 (resistance)\n\nvar result = await svc.PlacePending(\n    symbol: \"XAUUSD\",\n    volume: 0.01,\n    type: ENUM_ORDER_TYPE.OrderTypeBuyStop,\n    price: 2010.0,\n    sl: 2000.0,      // Back to current price\n    tp: 2030.0);     // Target above breakout\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Buy Stop placed: #{result.Order} at 2010.0\");\n    Console.WriteLine(\"Will activate on breakout above resistance\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-4-sell-stop-breakdown","title":"Example 4: Sell Stop (Breakdown)","text":"<pre><code>// Current price: 150.00\n// Want to sell if price breaks below 149.50 (support)\n\nvar result = await svc.PlacePending(\n    symbol: \"USDJPY\",\n    volume: 0.1,\n    type: ENUM_ORDER_TYPE.OrderTypeSellStop,\n    price: 149.50,\n    sl: 150.50,      // Above current price\n    tp: 148.50);     // Target below breakdown\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Sell Stop placed: #{result.Order} at 149.50\");\n    Console.WriteLine(\"Will activate on breakdown below support\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-5-pending-order-without-sltp","title":"Example 5: Pending Order Without SL/TP","text":"<pre><code>// Place pending order without stop-loss or take-profit\nvar result = await svc.PlacePending(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    type: ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 1.0850);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Pending order placed: #{result.Order}\");\n    Console.WriteLine(\"No SL/TP - will manage manually\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-6-with-custom-comment","title":"Example 6: With Custom Comment","text":"<pre><code>var result = await svc.PlacePending(\n    symbol: \"BTCUSD\",\n    volume: 0.01,\n    type: ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 50000.0,\n    sl: 49000.0,\n    tp: 52000.0,\n    comment: \"Strategy: Support Bounce\");\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Order #{result.Order}: {result.Comment}\");\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#example-7-error-handling","title":"Example 7: Error Handling","text":"<pre><code>var result = await svc.PlacePending(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    type: ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 1.0850,\n    sl: 1.0800,\n    tp: 1.0950);\n\nswitch (result.ReturnedCode)\n{\n    case 10009:\n        Console.WriteLine($\"\u2705 Success! Order #{result.Order}\");\n        break;\n    case 10015:\n        Console.WriteLine($\"\u274c Invalid price: {result.Comment}\");\n        break;\n    case 10016:\n        Console.WriteLine($\"\u274c Invalid stops: {result.Comment}\");\n        break;\n    default:\n        Console.WriteLine($\"\u274c Failed: Code {result.ReturnedCode}, {result.Comment}\");\n        break;\n}\n</code></pre>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>EnsureSelected()</code> - Ensures symbol is selected before order placement</li> <li><code>OrderSendAsync()</code> - Sends the order request to MT5 server</li> </ul> <p>\ud83c\udf6c Alternative Sugar methods:</p> <ul> <li><code>BuyLimitPoints()</code> - Buy Limit by points offset (no manual price calculation)</li> <li><code>SellLimitPoints()</code> - Sell Limit by points offset</li> <li><code>BuyStopPoints()</code> - Buy Stop by points offset</li> <li><code>SellStopPoints()</code> - Sell Stop by points offset</li> <li><code>PlaceMarket()</code> - Place market order (immediate execution)</li> </ul>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Wrong price level for order type: <pre><code>// \u274c WRONG: Buy Limit above current price\n// Current: 1.0900, trying to place Buy Limit at 1.0950\n// Buy Limit must be BELOW current price!\n\n// \u2705 CORRECT:\nawait svc.PlacePending(\"EURUSD\", 0.01,\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 1.0850);  // Below current 1.0900\n</code></pre></p> </li> <li> <p>Confusing Limit vs Stop:</p> </li> <li>Limit = Price must improve (buy cheaper, sell higher)</li> <li> <p>Stop = Price breaks level (buy on breakout, sell on breakdown)</p> </li> <li> <p>SL/TP in wrong direction: <pre><code>// \u274c WRONG: Buy order with SL above entry\nawait svc.PlacePending(\"EURUSD\", 0.01,\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 1.0850,\n    sl: 1.0900);  // \u274c SL should be below for BUY!\n\n// \u2705 CORRECT:\nawait svc.PlacePending(\"EURUSD\", 0.01,\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price: 1.0850,\n    sl: 1.0800);  // \u2705 SL below entry\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#order-type-quick-reference","title":"\ud83d\udcca Order Type Quick Reference","text":"Type Direction Price Requirement When Activated Use Case BuyLimit Buy Below current Price drops to level Buy the dip SellLimit Sell Above current Price rises to level Sell at resistance BuyStop Buy Above current Price breaks up Breakout long SellStop Sell Below current Price breaks down Breakdown short"},{"location":"MT5Sugar/6.%20Trading_Market_Pending/PlacePending/#summary","title":"\ud83d\udca1 Summary","text":"<p>PlacePending simplifies pending order placement with:</p> <ul> <li>\u2705 Automatic symbol selection</li> <li>\u2705 Request building handled automatically</li> <li>\u2705 Support for all pending order types</li> <li>\u2705 Optional SL/TP configuration</li> </ul> <pre><code>// One method for all pending order types:\nawait svc.PlacePending(\"EURUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeBuyLimit, 1.0850);\nawait svc.PlacePending(\"GBPUSD\", 0.05, ENUM_ORDER_TYPE.OrderTypeSellLimit, 1.2550);\nawait svc.PlacePending(\"XAUUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeBuyStop, 2010.0);\nawait svc.PlacePending(\"USDJPY\", 0.1, ENUM_ORDER_TYPE.OrderTypeSellStop, 149.5);\n</code></pre> <p>Clean, flexible, powerful! \ud83d\ude80</p>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/","title":"Calculate Volume by Risk (<code>CalcVolumeForRiskAsync</code>) \u2b50","text":"<p>Sugar method: CORE RISK MANAGEMENT - Calculates exact position size (lots) based on risk amount and stop-loss distance.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.CalcVolumeForRiskAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [08] VOLUME &amp; PRICE UTILITIES</li> <li>Underlying calls: <code>SymbolInfoDoubleAsync()</code> + <code>GetTickValueAndSizeAsync()</code> + <code>NormalizeVolumeAsync()</code></li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;double&gt; CalcVolumeForRiskAsync(\n    this MT5Service svc,\n    string symbol,\n    double stopPoints,\n    double riskMoney,\n    int timeoutSec = 10,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>stopPoints</code> <code>double</code> Stop-loss distance in points (must be &gt; 0) <code>riskMoney</code> <code>double</code> Maximum amount to risk in account currency (must be &gt; 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;double&gt;</code> Normalized volume in lots that matches the specified risk <p>Throws:</p> <ul> <li><code>ArgumentOutOfRangeException</code> - If stopPoints or riskMoney &lt;= 0</li> <li><code>InvalidOperationException</code> - If tick size invalid or calculation fails</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: THE MOST IMPORTANT METHOD for professional trading - calculates exact lot size based on your risk tolerance.</li> <li>Why you need it: Instead of guessing volume (0.01? 0.1? 1.0?), this calculates EXACTLY how much to trade so you risk precisely $X if stop-loss hits.</li> <li>Sanity check: If you want to risk $100 with 50-point SL, this returns exact volume (e.g., 0.20 lots) that will lose exactly $100 at SL.</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#purpose-risk-management-foundation","title":"\ud83c\udfaf Purpose - Risk Management Foundation","text":"<p>Problem: Most traders fail because they use fixed lot sizes without considering risk.</p> <pre><code>// \u274c WRONG - Amateur approach:\ndouble volume = 0.01;  // Always 0.01 lots regardless of risk!\n\n// \u274c WRONG - Guessing:\ndouble volume = 0.05;  // Random guess, no risk calculation\n\n// \u2705 CORRECT - Professional risk management:\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100);\n// Returns 0.20 lots - EXACTLY $100 risk at 50-point SL\n</code></pre> <p>Use it for:</p> <ul> <li>Fixed-risk trading (risk same $ amount per trade)</li> <li>Percentage-based risk (2% of account per trade)</li> <li>Position sizing for different stop-loss distances</li> <li>Consistent risk across different symbols</li> <li>Professional money management</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#under-the-hood-the-math","title":"\ud83d\udd27 Under the Hood - The Math","text":"<pre><code>// Step 1: Get symbol point size\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint);\n\n// Step 2: Get tick value and tick size\nvar (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(symbol);\n\n// Step 3: Calculate loss per 1 lot\nvar lossPerLot = (stopPoints * point / tickSize) * tickValue;\n// Example for EURUSD: (50 * 0.00001 / 0.00001) * $1 = $50 per lot\n\n// Step 4: Calculate required volume\nvar rawVolume = riskMoney / lossPerLot;\n// Example: $100 / $50 = 2.0 lots\n\n// Step 5: Normalize to broker constraints (min/max/step)\nvar normalizedVolume = await svc.NormalizeVolumeAsync(symbol, rawVolume);\n// Example: 2.0 \u2192 2.00 (if step is 0.01)\n\nreturn normalizedVolume;\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-1-fixed-dollar-risk","title":"Example 1: Fixed Dollar Risk","text":"<pre><code>// Risk exactly $100 with 50-point stop-loss\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    symbol: \"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100);\n\nConsole.WriteLine($\"Trade {volume} lots to risk $100\");\n// Output: Trade 0.20 lots to risk $100\n\n// Now place order with calculated volume\nawait svc.BuyMarket(\"EURUSD\", volume, sl: currentBid - 50 * point);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-2-percentage-based-risk-2-rule","title":"Example 2: Percentage-Based Risk (2% Rule)","text":"<pre><code>// Risk 2% of account balance\nvar balance = await svc.GetBalanceAsync();\ndouble riskPercent = 2.0;\ndouble riskMoney = balance * (riskPercent / 100.0);\n\n// Calculate volume for 2% risk with 30-point SL\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    symbol: \"GBPUSD\",\n    stopPoints: 30,\n    riskMoney: riskMoney);\n\nConsole.WriteLine($\"Balance: ${balance:F2}\");\nConsole.WriteLine($\"Risk (2%): ${riskMoney:F2}\");\nConsole.WriteLine($\"Volume: {volume} lots\");\n\n// Place trade\nawait svc.SellMarket(\"GBPUSD\", volume, sl: currentAsk + 30 * point);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-3-different-symbols-same-risk","title":"Example 3: Different Symbols, Same Risk","text":"<pre><code>// Risk same $50 on different symbols with different stop distances\nvar symbols = new[]\n{\n    (\"EURUSD\", 40),  // 40 points SL\n    (\"XAUUSD\", 100), // 100 points SL (gold more volatile)\n    (\"USDJPY\", 20)   // 20 points SL (tight stop)\n};\n\nforeach (var (symbol, stopPoints) in symbols)\n{\n    double volume = await svc.CalcVolumeForRiskAsync(\n        symbol: symbol,\n        stopPoints: stopPoints,\n        riskMoney: 50);\n\n    Console.WriteLine($\"{symbol}: {volume} lots (SL: {stopPoints}pts, Risk: $50)\");\n}\n\n// Output:\n// EURUSD: 0.13 lots (SL: 40pts, Risk: $50)\n// XAUUSD: 0.05 lots (SL: 100pts, Risk: $50)\n// USDJPY: 0.25 lots (SL: 20pts, Risk: $50)\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-4-atr-based-stop-with-fixed-risk","title":"Example 4: ATR-Based Stop with Fixed Risk","text":"<pre><code>// Use ATR for dynamic stop-loss, fixed risk\ndouble atr = 0.0015;  // ATR value for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble stopPoints = atr / point * 1.5;  // 1.5x ATR as SL\n\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    symbol: \"EURUSD\",\n    stopPoints: stopPoints,\n    riskMoney: 75);\n\nConsole.WriteLine($\"ATR-based SL: {stopPoints:F0} points\");\nConsole.WriteLine($\"Volume for $75 risk: {volume} lots\");\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-5-complete-trading-strategy","title":"Example 5: Complete Trading Strategy","text":"<pre><code>public async Task&lt;OrderSendData&gt; OpenPositionWithRisk(\n    MT5Service svc,\n    string symbol,\n    bool isBuy,\n    double stopPoints,\n    double? takeProfitPoints = null)\n{\n    // Fixed risk per trade\n    const double RISK_MONEY = 100.0;\n\n    // Step 1: Calculate volume based on risk\n    double volume = await svc.CalcVolumeForRiskAsync(\n        symbol,\n        stopPoints,\n        RISK_MONEY);\n\n    Console.WriteLine($\"Calculated volume: {volume} lots for ${RISK_MONEY} risk\");\n\n    // Step 2: Calculate SL/TP prices\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    double sl = isBuy\n        ? tick.Bid - stopPoints * point\n        : tick.Ask + stopPoints * point;\n\n    double? tp = null;\n    if (takeProfitPoints.HasValue)\n    {\n        tp = isBuy\n            ? tick.Ask + takeProfitPoints.Value * point\n            : tick.Bid - takeProfitPoints.Value * point;\n    }\n\n    // Step 3: Place order with calculated volume\n    var result = await svc.PlaceMarket(symbol, volume, isBuy, sl, tp);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Order placed: #{result.Order}\");\n        Console.WriteLine($\"   Volume: {volume} lots\");\n        Console.WriteLine($\"   Risk: ${RISK_MONEY}\");\n    }\n\n    return result;\n}\n\n// Usage:\nawait OpenPositionWithRisk(svc, \"EURUSD\", isBuy: true,\n    stopPoints: 50, takeProfitPoints: 150);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-6-risk-calculation-before-trade","title":"Example 6: Risk Calculation Before Trade","text":"<pre><code>// Pre-calculate risk for different scenarios\nvar scenarios = new[]\n{\n    (sl: 30, label: \"Tight SL\"),\n    (sl: 50, label: \"Normal SL\"),\n    (sl: 100, label: \"Wide SL\")\n};\n\ndouble riskMoney = 50.0;\n\nConsole.WriteLine($\"Risk: ${riskMoney} on EURUSD\");\nConsole.WriteLine(\"Scenario | SL (pts) | Volume\");\nConsole.WriteLine(\"---------|----------|-------\");\n\nforeach (var (sl, label) in scenarios)\n{\n    double volume = await svc.CalcVolumeForRiskAsync(\n        \"EURUSD\",\n        stopPoints: sl,\n        riskMoney: riskMoney);\n\n    Console.WriteLine($\"{label,-9}| {sl,8} | {volume:F2}\");\n}\n\n// Output:\n// Risk: $50 on EURUSD\n// Scenario | SL (pts) | Volume\n// ---------|----------|-------\n// Tight SL |       30 | 0.17\n// Normal SL|       50 | 0.10\n// Wide SL  |      100 | 0.05\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-7-account-size-aware-risk","title":"Example 7: Account Size Aware Risk","text":"<pre><code>public async Task&lt;double&gt; CalculateSmartVolume(\n    MT5Service svc,\n    string symbol,\n    double stopPoints)\n{\n    // Get account size\n    var balance = await svc.GetBalanceAsync();\n\n    // Risk rules based on account size\n    double riskPercent;\n    if (balance &lt; 1000)\n        riskPercent = 1.0;      // 1% for small accounts\n    else if (balance &lt; 10000)\n        riskPercent = 1.5;      // 1.5% for medium accounts\n    else\n        riskPercent = 2.0;      // 2% for large accounts\n\n    double riskMoney = balance * (riskPercent / 100.0);\n\n    // Calculate volume\n    double volume = await svc.CalcVolumeForRiskAsync(\n        symbol,\n        stopPoints,\n        riskMoney);\n\n    Console.WriteLine($\"Account: ${balance:F2}\");\n    Console.WriteLine($\"Risk: {riskPercent}% = ${riskMoney:F2}\");\n    Console.WriteLine($\"Volume: {volume} lots\");\n\n    return volume;\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    double volume = await svc.CalcVolumeForRiskAsync(\n        symbol: \"EURUSD\",\n        stopPoints: 50,\n        riskMoney: 100);\n\n    Console.WriteLine($\"\u2705 Calculated volume: {volume} lots\");\n}\ncatch (ArgumentOutOfRangeException ex)\n{\n    Console.WriteLine($\"\u274c Invalid input: {ex.Message}\");\n    // stopPoints or riskMoney was &lt;= 0\n}\ncatch (InvalidOperationException ex)\n{\n    Console.WriteLine($\"\u274c Calculation error: {ex.Message}\");\n    // Tick size invalid or calculation failed\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Used internally:</p> <ul> <li><code>SymbolInfoDoubleAsync()</code> - Gets point size</li> <li><code>GetTickValueAndSizeAsync()</code> - Gets tick value/size for calculation</li> <li><code>NormalizeVolumeAsync()</code> - Normalizes result to broker constraints</li> </ul> <p>\ud83c\udf6c Methods that use this:</p> <ul> <li><code>BuyMarketByRisk()</code> - Uses this + auto-places order</li> <li><code>SellMarketByRisk()</code> - Uses this + auto-places order</li> </ul> <p>\ud83d\udcca Supporting methods:</p> <ul> <li><code>GetVolumeLimitsAsync()</code> - Get min/max/step for validation</li> <li><code>NormalizeVolumeAsync()</code> - Round volume to valid step</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points\ndouble stopPips = 50;\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\", stopPips, 100);\n// For 5-digit broker, 50 pips = 500 points!\n\n// \u2705 CORRECT: Convert pips to points\ndouble stopPips = 50;\ndouble stopPoints = stopPips * 10;  // 5-digit: 1 pip = 10 points\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\", stopPoints, 100);\n</code></pre></p> </li> <li> <p>Negative or zero risk: <pre><code>// \u274c WRONG: Invalid risk\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\", 50, 0);\n// Throws ArgumentOutOfRangeException\n\n// \u2705 CORRECT: Positive risk\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\", 50, 100);\n</code></pre></p> </li> <li> <p>Not considering broker limits: <pre><code>// \u26a0\ufe0f Calculated volume might exceed broker maximum!\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\", 10, 1000);\n// Might return 10.0 lots, but broker max could be 5.0\n\n// \u2705 BETTER: Check limits\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\", 10, 1000);\nif (volume &gt; max)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Calculated {volume} exceeds max {max}\");\n    volume = max;\n}\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/CalcVolumeForRiskAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>CalcVolumeForRiskAsync is THE foundation of professional trading:</p> <ul> <li>\u2b50 CORE METHOD for risk management</li> <li>\u2705 Calculates exact volume to risk specified $ amount</li> <li>\u2705 Works with any symbol, any stop distance</li> <li>\u2705 Auto-normalizes to broker constraints</li> <li>\u2705 Enables percentage-based risk strategies</li> </ul> <pre><code>// Professional risk management in one line:\ndouble volume = await svc.CalcVolumeForRiskAsync(\"EURUSD\",\n    stopPoints: 50,\n    riskMoney: 100);\n\n// Instead of guessing:\ndouble volume = 0.01;  // \u274c Amateur\n</code></pre> <p>This is HOW professionals trade! \ud83d\ude80\u2b50</p>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/","title":"Get Tick Value and Size (<code>GetTickValueAndSizeAsync</code>)","text":"<p>Sugar method: Retrieves tick value (monetary value per tick) and tick size (price increment) for risk/P&amp;L calculations.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetTickValueAndSizeAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [08] VOLUME &amp; PRICE UTILITIES</li> <li>Underlying calls: <code>SymbolInfoDoubleAsync()</code> (2 calls)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;(double tickValue, double tickSize)&gt; GetTickValueAndSizeAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;(double tickValue, double tickSize)&gt;</code> Tuple with tick value and tick size"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#tuple-fields","title":"Tuple Fields","text":"<ul> <li>tickValue (double) - Monetary value of one tick for 1 lot (in account currency)</li> <li>tickSize (double) - Minimum price increment (e.g., 0.00001 for EURUSD)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Gets tick value (how much $ moves per tick) and tick size (minimum price step).</li> <li>Why you need it: Essential for accurate P/L calculations and risk management formulas.</li> <li>Sanity check: Tick value = $ per tick for 1 lot. Tick size = minimum price increment (same as Point for most symbols).</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Risk calculations - Core input for <code>CalcVolumeForRiskAsync</code></li> <li>P/L estimation - Calculate potential profit/loss</li> <li>Pip value calculations - Convert pips to money</li> <li>Stop-loss sizing - Calculate SL distance in $ terms</li> <li>Trading education - Understand symbol specifications</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Fetch tick value (monetary value per tick for 1 lot)\nvar tickValue = await svc.SymbolInfoDoubleAsync(symbol,\n    SymbolInfoDoubleProperty.SymbolTradeTickValue, deadline, ct);\n\n// Fetch tick size (minimum price increment)\nvar tickSize = await svc.SymbolInfoDoubleAsync(symbol,\n    SymbolInfoDoubleProperty.SymbolTradeTickSize, deadline, ct);\n\nreturn (tickValue, tickSize);\n</code></pre> <p>What it improves:</p> <ul> <li>One call - returns both values as tuple</li> <li>Shared deadline - both calls use same timeout</li> <li>Tuple destructuring - clean code</li> <li>Type-safe - no magic numbers</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-1-basic-tick-info","title":"Example 1: Basic Tick Info","text":"<pre><code>var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\nConsole.WriteLine($\"EURUSD Tick Information:\");\nConsole.WriteLine($\"  Tick Value: ${tickValue}\");\nConsole.WriteLine($\"  Tick Size:  {tickSize}\");\n\n// Output:\n// EURUSD Tick Information:\n//   Tick Value: $1.00\n//   Tick Size:  0.00001\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-2-calculate-pl-for-price-movement","title":"Example 2: Calculate P/L for Price Movement","text":"<pre><code>var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\ndouble volume = 0.10;  // 0.10 lots\ndouble entryPrice = 1.09000;\ndouble currentPrice = 1.09050;\n\n// Calculate price movement in ticks\ndouble priceDiff = currentPrice - entryPrice;\ndouble ticks = priceDiff / tickSize;\n\n// Calculate P/L\ndouble profitLoss = ticks * tickValue * volume;\n\nConsole.WriteLine($\"Entry:       {entryPrice:F5}\");\nConsole.WriteLine($\"Current:     {currentPrice:F5}\");\nConsole.WriteLine($\"Difference:  {priceDiff:F5} ({ticks} ticks)\");\nConsole.WriteLine($\"P/L:         ${profitLoss:F2}\");\n\n// Output:\n// Entry:       1.09000\n// Current:     1.09050\n// Difference:  0.00050 (50 ticks)\n// P/L:         $5.00\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-3-calculate-pip-value","title":"Example 3: Calculate Pip Value","text":"<pre><code>var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\n// For 5-digit broker: 1 pip = 10 points = 10 ticks\ndouble pipSizeInTicks = 10;  // EURUSD: 1 pip = 0.0001 = 10 ticks\ndouble pipValue = tickValue * pipSizeInTicks;\n\nConsole.WriteLine($\"EURUSD:\");\nConsole.WriteLine($\"  Tick value:  ${tickValue} per tick\");\nConsole.WriteLine($\"  Pip value:   ${pipValue} per pip (for 1 lot)\");\n\n// For different volumes:\ndouble[] volumes = { 0.01, 0.10, 1.00 };\nConsole.WriteLine($\"\\nPip value for different volumes:\");\nforeach (var volume in volumes)\n{\n    double pipVal = pipValue * volume;\n    Console.WriteLine($\"  {volume,4} lots: ${pipVal,6:F2} per pip\");\n}\n\n// Output:\n// EURUSD:\n//   Tick value:  $1.00 per tick\n//   Pip value:   $10.00 per pip (for 1 lot)\n//\n// Pip value for different volumes:\n//   0.01 lots: $  0.10 per pip\n//   0.10 lots: $  1.00 per pip\n//   1.00 lots: $ 10.00 per pip\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-4-compare-different-symbols","title":"Example 4: Compare Different Symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"XAUUSD\", \"USDJPY\" };\n\nConsole.WriteLine(\"Symbol   | Tick Value | Tick Size\");\nConsole.WriteLine(\"---------|------------|----------\");\n\nforeach (var symbol in symbols)\n{\n    var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(symbol);\n    Console.WriteLine($\"{symbol,-8} | ${tickValue,9:F2} | {tickSize,8:F5}\");\n}\n\n// Output:\n// Symbol   | Tick Value | Tick Size\n// ---------|------------|----------\n// EURUSD   |      $1.00 |  0.00001\n// GBPUSD   |      $1.00 |  0.00001\n// XAUUSD   |      $0.01 |  0.01000\n// USDJPY   |      $0.01 |  0.00100\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-5-calculate-stop-loss-cost","title":"Example 5: Calculate Stop-Loss Cost","text":"<pre><code>var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\ndouble volume = 0.10;\ndouble stopLossPoints = 50;  // 50 points SL\n\n// Calculate number of ticks\ndouble ticks = stopLossPoints;  // For EURUSD, 1 point = 1 tick\n\n// Calculate cost if SL hits\ndouble slCost = ticks * tickValue * volume;\n\nConsole.WriteLine($\"Stop-Loss Analysis:\");\nConsole.WriteLine($\"  Symbol:     EURUSD\");\nConsole.WriteLine($\"  Volume:     {volume} lots\");\nConsole.WriteLine($\"  SL Points:  {stopLossPoints}\");\nConsole.WriteLine($\"  SL Cost:    ${slCost:F2}\");\n\n// Output:\n// Stop-Loss Analysis:\n//   Symbol:     EURUSD\n//   Volume:     0.10 lots\n//   SL Points:  50\n//   SL Cost:    $5.00\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-6-risk-calculation-manual","title":"Example 6: Risk Calculation (Manual)","text":"<pre><code>// Manual implementation of risk-based volume calculation\nvar (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\ndouble riskMoney = 100.0;      // Want to risk $100\ndouble stopLossPoints = 50;    // 50 points SL\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Calculate loss per lot\ndouble lossPerLot = (stopLossPoints * point / tickSize) * tickValue;\n\n// Calculate required volume\ndouble volume = riskMoney / lossPerLot;\n\nConsole.WriteLine($\"Risk Calculation:\");\nConsole.WriteLine($\"  Risk:       ${riskMoney}\");\nConsole.WriteLine($\"  SL Points:  {stopLossPoints}\");\nConsole.WriteLine($\"  Loss/lot:   ${lossPerLot:F2}\");\nConsole.WriteLine($\"  Volume:     {volume:F2} lots\");\n\n// Verify: If we trade 'volume' lots with 50-point SL, we risk exactly $100\ndouble actualRisk = lossPerLot * volume;\nConsole.WriteLine($\"  Actual risk: ${actualRisk:F2}\");\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-7-profit-target-calculator","title":"Example 7: Profit Target Calculator","text":"<pre><code>public async Task CalculateProfitTarget(\n    MT5Service svc,\n    string symbol,\n    double volume,\n    double targetMoney)\n{\n    var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(symbol);\n\n    // How many ticks needed to reach target profit?\n    double ticksNeeded = targetMoney / (tickValue * volume);\n\n    // Convert to price distance\n    double priceDistance = ticksNeeded * tickSize;\n\n    // Convert to pips (for display)\n    double point = await svc.GetPointAsync(symbol);\n    double pipsNeeded = priceDistance / point;\n\n    Console.WriteLine($\"Profit Target Calculator:\");\n    Console.WriteLine($\"  Symbol:        {symbol}\");\n    Console.WriteLine($\"  Volume:        {volume} lots\");\n    Console.WriteLine($\"  Target Profit: ${targetMoney}\");\n    Console.WriteLine($\"  Required:\");\n    Console.WriteLine($\"    {ticksNeeded:F0} ticks\");\n    Console.WriteLine($\"    {priceDistance:F5} price distance\");\n    Console.WriteLine($\"    {pipsNeeded:F1} points\");\n}\n\n// Usage:\nawait CalculateProfitTarget(svc, \"EURUSD\", volume: 0.10, targetMoney: 50.0);\n\n// Output:\n// Profit Target Calculator:\n//   Symbol:        EURUSD\n//   Volume:        0.10 lots\n//   Target Profit: $50\n//   Required:\n//     500 ticks\n//     0.00500 price distance\n//     500.0 points\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-8-position-pl-monitor","title":"Example 8: Position P/L Monitor","text":"<pre><code>public async Task MonitorPositionPL(\n    MT5Service svc,\n    ulong ticket)\n{\n    var opened = await svc.OpenedOrdersAsync(...);\n    var position = opened.PositionInfos.First(p =&gt; p.Ticket == ticket);\n\n    var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(position.PositionSymbol);\n\n    // Get current price\n    var tick = await svc.SymbolInfoTickAsync(position.PositionSymbol);\n    double currentPrice = position.Type == 0 ? tick.Bid : tick.Ask;  // BUY uses Bid, SELL uses Ask\n\n    // Calculate P/L\n    double priceDiff = currentPrice - position.PriceOpen;\n    if (position.Type == 1) priceDiff = -priceDiff;  // Reverse for SELL\n\n    double ticks = priceDiff / tickSize;\n    double profitLoss = ticks * tickValue * position.Volume;\n\n    Console.WriteLine($\"Position #{ticket}:\");\n    Console.WriteLine($\"  Symbol:    {position.PositionSymbol}\");\n    Console.WriteLine($\"  Type:      {(position.Type == 0 ? \"BUY\" : \"SELL\")}\");\n    Console.WriteLine($\"  Volume:    {position.Volume} lots\");\n    Console.WriteLine($\"  Open:      {position.PriceOpen:F5}\");\n    Console.WriteLine($\"  Current:   {currentPrice:F5}\");\n    Console.WriteLine($\"  P/L:       ${profitLoss:F2} ({ticks:F0} ticks)\");\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-9-educational-display","title":"Example 9: Educational Display","text":"<pre><code>public async Task DisplayTickInfo(MT5Service svc, string symbol)\n{\n    var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    Console.WriteLine($\"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\");\n    Console.WriteLine($\"\u2551  {symbol,-38} \u2551\");\n    Console.WriteLine($\"\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\");\n    Console.WriteLine($\"\");\n    Console.WriteLine($\"Tick Size:  {tickSize:F5}\");\n    Console.WriteLine($\"Tick Value: ${tickValue:F2} per tick (for 1 lot)\");\n    Console.WriteLine($\"Point Size: {point:F5}\");\n    Console.WriteLine($\"\");\n    Console.WriteLine($\"What this means:\");\n    Console.WriteLine($\"  \u2022 Each {tickSize:F5} price movement = 1 tick\");\n    Console.WriteLine($\"  \u2022 Each tick = ${tickValue:F2} for 1 lot\");\n    Console.WriteLine($\"  \u2022 10 ticks = ${tickValue * 10:F2} for 1 lot\");\n    Console.WriteLine($\"  \u2022 100 ticks = ${tickValue * 100:F2} for 1 lot\");\n    Console.WriteLine($\"\");\n    Console.WriteLine($\"Example: 0.10 lots trading\");\n    Console.WriteLine($\"  \u2022 1 tick = ${tickValue * 0.10:F2}\");\n    Console.WriteLine($\"  \u2022 50 ticks = ${tickValue * 50 * 0.10:F2}\");\n    Console.WriteLine($\"  \u2022 100 ticks = ${tickValue * 100 * 0.10:F2}\");\n}\n\n// Usage:\nawait DisplayTickInfo(svc, \"EURUSD\");\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#example-10-validate-tick-data","title":"Example 10: Validate Tick Data","text":"<pre><code>var (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\n// Validation\nif (tickValue &lt;= 0)\n{\n    Console.WriteLine($\"\u274c Invalid tick value: {tickValue}\");\n}\nelse if (tickSize &lt;= 0)\n{\n    Console.WriteLine($\"\u274c Invalid tick size: {tickSize}\");\n}\nelse\n{\n    Console.WriteLine($\"\u2705 Tick data valid:\");\n    Console.WriteLine($\"   Tick Value: ${tickValue}\");\n    Console.WriteLine($\"   Tick Size:  {tickSize}\");\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>SymbolInfoDoubleAsync(SymbolTradeTickValue)</code> - Tick value</li> <li><code>SymbolInfoDoubleAsync(SymbolTradeTickSize)</code> - Tick size</li> </ul> <p>\ud83c\udf6c Methods that use this:</p> <ul> <li><code>CalcVolumeForRiskAsync()</code> - Uses tick value/size for volume calculation</li> <li><code>BuyMarketByRisk()</code> - Indirectly uses via CalcVolumeForRiskAsync</li> <li><code>SellMarketByRisk()</code> - Indirectly uses via CalcVolumeForRiskAsync</li> </ul> <p>\ud83d\udcca Related methods:</p> <ul> <li><code>GetPointAsync()</code> - Gets point size (often same as tick size)</li> <li><code>GetDigitsAsync()</code> - Gets decimal digits for price display</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing tick size with pip size: <pre><code>// For 5-digit EURUSD:\n// Tick size = 0.00001 (1 point)\n// Pip size  = 0.0001  (10 points)\n// They are NOT the same!\n\nvar (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\ndouble pipSize = tickSize * 10;  // 1 pip = 10 ticks for 5-digit\n</code></pre></p> </li> <li> <p>Not accounting for volume in P/L: <pre><code>// \u274c WRONG: Forgetting volume multiplier\ndouble profitPerTick = tickValue;  // Only for 1 lot!\n\n// \u2705 CORRECT: Include volume\ndouble volume = 0.10;\ndouble profitPerTick = tickValue * volume;\n</code></pre></p> </li> <li> <p>Different symbols have different tick values: <pre><code>// EURUSD: $1.00 per tick\n// XAUUSD: $0.01 per tick\n// USDJPY: $0.01 per tick\n// Always query per symbol!\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetTickValueAndSizeAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>GetTickValueAndSizeAsync provides essential pricing information:</p> <ul> <li>\u2705 One call returns both tick value and size</li> <li>\u2705 Essential for P/L calculations</li> <li>\u2705 Core input for risk management</li> <li>\u2705 Tuple destructuring for clean code</li> </ul> <pre><code>// Get tick info:\nvar (tickValue, tickSize) = await svc.GetTickValueAndSizeAsync(\"EURUSD\");\n\n// Calculate P/L:\ndouble ticks = priceDifference / tickSize;\ndouble profitLoss = ticks * tickValue * volume;\n\n// Used internally by CalcVolumeForRiskAsync:\nvar volume = await svc.CalcVolumeForRiskAsync(symbol, stopPoints, riskMoney);\n</code></pre> <p>Know your ticks, calculate with precision! \ud83d\ude80</p>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/","title":"Get Volume Limits (<code>GetVolumeLimitsAsync</code>)","text":"<p>Sugar method: Retrieves volume constraints for symbol - minimum, maximum, and step size in one call.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.GetVolumeLimitsAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [08] VOLUME &amp; PRICE UTILITIES</li> <li>Underlying calls: <code>SymbolInfoDoubleAsync()</code> (3 calls)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;(double min, double max, double step)&gt; GetVolumeLimitsAsync(\n    this MT5Service svc,\n    string symbol,\n    int timeoutSec = 10,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;(double min, double max, double step)&gt;</code> Tuple with minimum volume, maximum volume, and volume step"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#tuple-fields","title":"Tuple Fields","text":"<ul> <li>min (double) - Minimum lot size allowed by broker (e.g., 0.01)</li> <li>max (double) - Maximum lot size allowed by broker (e.g., 100.0)</li> <li>step (double) - Volume increment step (e.g., 0.01)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Gets broker's volume constraints for symbol - min/max/step in one convenient call.</li> <li>Why you need it: Validate volumes before placing orders, avoid broker rejections.</li> <li>Sanity check: Step defines smallest increment (e.g., 0.01 = can use 0.01, 0.02, 0.03 but NOT 0.015).</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Volume validation - Check if requested volume is valid before order</li> <li>Volume normalization - Round volume to valid step</li> <li>UI constraints - Set min/max bounds in trading interfaces</li> <li>Risk calculations - Understand broker limits for position sizing</li> <li>Error prevention - Catch invalid volumes before broker rejects</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Fetch all three volume properties in parallel potential\nvar min = await svc.SymbolInfoDoubleAsync(symbol, SymbolVolumeMin, deadline, ct);\nvar max = await svc.SymbolInfoDoubleAsync(symbol, SymbolVolumeMax, deadline, ct);\nvar step = await svc.SymbolInfoDoubleAsync(symbol, SymbolVolumeStep, deadline, ct);\n\nreturn (min, max, step);\n</code></pre> <p>What it improves:</p> <ul> <li>One call - returns all three values as tuple</li> <li>Shared deadline - all calls use same timeout</li> <li>Tuple destructuring - easy to extract values</li> <li>Type-safe - no magic strings or manual parsing</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-1-basic-volume-limits","title":"Example 1: Basic Volume Limits","text":"<pre><code>var (min, max, step) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\n\nConsole.WriteLine($\"EURUSD Volume Constraints:\");\nConsole.WriteLine($\"  Minimum: {min} lots\");\nConsole.WriteLine($\"  Maximum: {max} lots\");\nConsole.WriteLine($\"  Step:    {step} lots\");\n\n// Output:\n// EURUSD Volume Constraints:\n//   Minimum: 0.01 lots\n//   Maximum: 100.0 lots\n//   Step:    0.01 lots\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-2-volume-validation","title":"Example 2: Volume Validation","text":"<pre><code>double requestedVolume = 0.037;  // User wants this volume\n\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\n\n// Check if within range\nif (requestedVolume &lt; min)\n{\n    Console.WriteLine($\"\u274c Volume {requestedVolume} below minimum {min}\");\n}\nelse if (requestedVolume &gt; max)\n{\n    Console.WriteLine($\"\u274c Volume {requestedVolume} above maximum {max}\");\n}\nelse if ((requestedVolume % step) != 0)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Volume {requestedVolume} not aligned with step {step}\");\n    // Need to normalize!\n}\nelse\n{\n    Console.WriteLine($\"\u2705 Volume {requestedVolume} is valid\");\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-3-manual-volume-normalization","title":"Example 3: Manual Volume Normalization","text":"<pre><code>double rawVolume = 0.037;\n\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\n\n// Normalize to nearest valid step\ndouble normalized = Math.Round((rawVolume - min) / step) * step + min;\n\n// Clamp to min/max range\nnormalized = Math.Max(min, Math.Min(max, normalized));\n\nConsole.WriteLine($\"Raw volume:        {rawVolume}\");\nConsole.WriteLine($\"Normalized volume: {normalized}\");\nConsole.WriteLine($\"Step:              {step}\");\n\n// Output:\n// Raw volume:        0.037\n// Normalized volume: 0.04\n// Step:              0.01\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-4-check-multiple-symbols","title":"Example 4: Check Multiple Symbols","text":"<pre><code>string[] symbols = { \"EURUSD\", \"GBPUSD\", \"XAUUSD\", \"BTCUSD\" };\n\nConsole.WriteLine(\"Symbol   | Min    | Max     | Step\");\nConsole.WriteLine(\"---------|--------|---------|-------\");\n\nforeach (var symbol in symbols)\n{\n    var (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\n    Console.WriteLine($\"{symbol,-8} | {min,6} | {max,7} | {step,5}\");\n}\n\n// Output:\n// Symbol   | Min    | Max     | Step\n// ---------|--------|---------|-------\n// EURUSD   |   0.01 |   100.0 |  0.01\n// GBPUSD   |   0.01 |   100.0 |  0.01\n// XAUUSD   |   0.01 |    50.0 |  0.01\n// BTCUSD   |   0.01 |     5.0 |  0.01\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-5-ui-volume-selector","title":"Example 5: UI Volume Selector","text":"<pre><code>public async Task&lt;VolumeSelector&gt; CreateVolumeSelector(MT5Service svc, string symbol)\n{\n    var (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\n\n    return new VolumeSelector\n    {\n        Symbol = symbol,\n        MinValue = min,\n        MaxValue = max,\n        StepSize = step,\n        DefaultValue = min  // Start at minimum\n    };\n}\n\n// Usage in UI:\nvar selector = await CreateVolumeSelector(svc, \"EURUSD\");\n// Configure slider/spinner: min=0.01, max=100.0, step=0.01\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-6-smart-volume-adjustment","title":"Example 6: Smart Volume Adjustment","text":"<pre><code>public async Task&lt;double&gt; AdjustVolumeToLimits(\n    MT5Service svc,\n    string symbol,\n    double desiredVolume)\n{\n    var (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\n\n    // Too small?\n    if (desiredVolume &lt; min)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Desired {desiredVolume} below min {min}, using {min}\");\n        return min;\n    }\n\n    // Too large?\n    if (desiredVolume &gt; max)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Desired {desiredVolume} above max {max}, using {max}\");\n        return max;\n    }\n\n    // Round to step\n    double rounded = Math.Round((desiredVolume - min) / step) * step + min;\n\n    if (rounded != desiredVolume)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Adjusted {desiredVolume} \u2192 {rounded} (step: {step})\");\n    }\n\n    return rounded;\n}\n\n// Usage:\ndouble adjusted = await AdjustVolumeToLimits(svc, \"EURUSD\", 0.037);\n// Output: \u26a0\ufe0f Adjusted 0.037 \u2192 0.04 (step: 0.01)\n// Returns: 0.04\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-7-calculate-available-steps","title":"Example 7: Calculate Available Steps","text":"<pre><code>var (min, max, step) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\n\n// Calculate how many valid volumes exist\nint numberOfSteps = (int)Math.Round((max - min) / step) + 1;\n\nConsole.WriteLine($\"Symbol: EURUSD\");\nConsole.WriteLine($\"Range: {min} - {max} lots\");\nConsole.WriteLine($\"Step:  {step} lots\");\nConsole.WriteLine($\"Valid volumes: {numberOfSteps} different values\");\n\n// First 10 valid volumes\nConsole.WriteLine(\"\\nFirst 10 valid volumes:\");\nfor (int i = 0; i &lt; 10; i++)\n{\n    double volume = min + (i * step);\n    Console.WriteLine($\"  {i + 1}. {volume:F2} lots\");\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-8-pre-trade-volume-check","title":"Example 8: Pre-Trade Volume Check","text":"<pre><code>public async Task&lt;bool&gt; IsVolumeValid(\n    MT5Service svc,\n    string symbol,\n    double volume)\n{\n    var (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\n\n    // Check min/max\n    if (volume &lt; min || volume &gt; max)\n    {\n        Console.WriteLine($\"\u274c Volume {volume} outside range [{min}, {max}]\");\n        return false;\n    }\n\n    // Check step alignment\n    double offset = volume - min;\n    double remainder = offset % step;\n\n    if (Math.Abs(remainder) &gt; 0.0000001)  // Floating point tolerance\n    {\n        Console.WriteLine($\"\u274c Volume {volume} not aligned with step {step}\");\n        return false;\n    }\n\n    Console.WriteLine($\"\u2705 Volume {volume} is valid\");\n    return true;\n}\n\n// Usage:\nif (await IsVolumeValid(svc, \"EURUSD\", 0.03))\n{\n    // Place order\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-9-display-volume-range","title":"Example 9: Display Volume Range","text":"<pre><code>var (min, max, step) = await svc.GetVolumeLimitsAsync(\"XAUUSD\");\n\nConsole.WriteLine($\"Gold (XAUUSD) Trading Limits:\");\nConsole.WriteLine($\"\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\");\nConsole.WriteLine($\"Minimum lot:  {min}\");\nConsole.WriteLine($\"Maximum lot:  {max}\");\nConsole.WriteLine($\"Step size:    {step}\");\nConsole.WriteLine($\"\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\");\nConsole.WriteLine($\"\\nExample valid volumes:\");\nConsole.WriteLine($\"  {min} (minimum)\");\nConsole.WriteLine($\"  {min + step}\");\nConsole.WriteLine($\"  {min + 2 * step}\");\nConsole.WriteLine($\"  ...\");\nConsole.WriteLine($\"  {max} (maximum)\");\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#example-10-compare-limits-across-symbols","title":"Example 10: Compare Limits Across Symbols","text":"<pre><code>var symbols = new[] { \"EURUSD\", \"XAUUSD\", \"BTCUSD\" };\n\nConsole.WriteLine(\"Comparing Volume Limits:\");\nConsole.WriteLine(\"\");\n\nforeach (var symbol in symbols)\n{\n    var (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\n\n    double range = max - min;\n    int steps = (int)((max - min) / step);\n\n    Console.WriteLine($\"{symbol}:\");\n    Console.WriteLine($\"  Range:     {min} - {max} ({range} lots)\");\n    Console.WriteLine($\"  Step:      {step}\");\n    Console.WriteLine($\"  # of steps: {steps}\");\n    Console.WriteLine(\"\");\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Low-level methods used internally:</p> <ul> <li><code>SymbolInfoDoubleAsync(SymbolVolumeMin)</code> - Minimum lot size</li> <li><code>SymbolInfoDoubleAsync(SymbolVolumeMax)</code> - Maximum lot size</li> <li><code>SymbolInfoDoubleAsync(SymbolVolumeStep)</code> - Volume increment</li> </ul> <p>\ud83c\udf6c Methods that use this:</p> <ul> <li><code>NormalizeVolumeAsync()</code> - Uses limits to normalize volume</li> <li><code>CalcVolumeForRiskAsync()</code> - Uses limits for final normalization</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li>Call <code>SymbolInfoDoubleAsync()</code> three times manually (more verbose)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Assuming fixed limits: <pre><code>// \u274c WRONG: Hardcoding limits\ndouble min = 0.01;  // May be different for other symbols!\ndouble max = 100.0;\n\n// \u2705 CORRECT: Query actual limits\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\n</code></pre></p> </li> <li> <p>Ignoring step size: <pre><code>// \u274c WRONG: Using volume not aligned with step\ndouble volume = 0.015;  // If step is 0.01, this is INVALID\n\n// \u2705 CORRECT: Round to step\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\ndouble volume = Math.Round(0.015 / step) * step;  // \u2192 0.02\n</code></pre></p> </li> <li> <p>Not checking maximum: <pre><code>// \u274c WRONG: Assuming large volumes allowed\ndouble volume = 500.0;  // May exceed broker max!\n\n// \u2705 CORRECT: Check against max\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(symbol);\nif (volume &gt; max)\n{\n    Console.WriteLine($\"\u26a0\ufe0f Volume {volume} exceeds max {max}\");\n    volume = max;\n}\n</code></pre></p> </li> <li> <p>Different symbols have different limits: <pre><code>// \u26a0\ufe0f EURUSD might allow 100 lots, but BTCUSD might only allow 5!\nvar (minEUR, maxEUR, stepEUR) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\nvar (minBTC, maxBTC, stepBTC) = await svc.GetVolumeLimitsAsync(\"BTCUSD\");\n\nConsole.WriteLine($\"EURUSD max: {maxEUR}\");  // \u2192 100.0\nConsole.WriteLine($\"BTCUSD max: {maxBTC}\");  // \u2192 5.0\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#typical-values-by-broker-type","title":"\ud83d\udcca Typical Values by Broker Type","text":""},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#standard-forex-brokers","title":"Standard Forex Brokers","text":"<ul> <li>Min: 0.01 lots</li> <li>Max: 100.0 - 500.0 lots</li> <li>Step: 0.01 lots</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#crypto-brokers","title":"Crypto Brokers","text":"<ul> <li>Min: 0.01 lots</li> <li>Max: 5.0 - 50.0 lots (lower due to volatility)</li> <li>Step: 0.01 lots</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#prop-firms-funded-accounts","title":"Prop Firms / Funded Accounts","text":"<ul> <li>Min: 0.01 lots</li> <li>Max: Varies (often 10-20 lots max)</li> <li>Step: 0.01 lots</li> </ul> <p>Always query actual limits - don't assume!</p>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/GetVolumeLimitsAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>GetVolumeLimitsAsync provides essential volume constraints:</p> <ul> <li>\u2705 One call returns all three limits (min/max/step)</li> <li>\u2705 Tuple destructuring for clean code</li> <li>\u2705 Essential for volume validation</li> <li>\u2705 Prevents broker rejections</li> </ul> <pre><code>// Get all limits in one call:\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(\"EURUSD\");\n\n// Validate volume:\nbool valid = volume &gt;= min &amp;&amp; volume &lt;= max &amp;&amp; (volume % step) == 0;\n\n// Or use NormalizeVolumeAsync for automatic adjustment:\ndouble normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", rawVolume);\n</code></pre> <p>Know your limits, trade smart! \ud83d\ude80</p>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/","title":"Normalize Volume (<code>NormalizeVolumeAsync</code>)","text":"<p>Sugar method: Normalizes volume to comply with broker's step size and min/max limits - auto-fix invalid volumes.</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.NormalizeVolumeAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [08] VOLUME &amp; PRICE UTILITIES</li> <li>Underlying calls: <code>GetVolumeLimitsAsync()</code> + math normalization</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;double&gt; NormalizeVolumeAsync(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    int timeoutSec = 10,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>volume</code> <code>double</code> Desired volume in lots (may be invalid) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;double&gt;</code> Normalized volume that broker will accept (valid step + within min/max)"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Auto-fix for invalid volumes - rounds to valid step and clamps to broker limits.</li> <li>Why you need it: Prevents broker rejection errors (invalid volume, invalid step, etc.).</li> <li>Sanity check: Always use before placing orders if volume comes from calculations or user input.</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>User input validation - Fix volumes entered in trading UI</li> <li>Calculation results - Round volumes from risk calculations</li> <li>Partial closes - Ensure partial volume is valid</li> <li>Volume conversions - Fix volumes from percentage calculations</li> <li>Error prevention - Catch and fix invalid volumes before broker</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get broker volume constraints\nvar (min, max, step) = await svc.GetVolumeLimitsAsync(symbol, timeoutSec, ct);\n\n// Safety: ensure step is valid\nif (step &lt;= 0) step = 0.01;\n\n// Step 2: Round to nearest valid step\ndouble offset = volume - min;\ndouble stepsCount = Math.Round(offset / step);\ndouble normalized = min + (stepsCount * step);\n\n// Step 3: Clamp to min/max range\nnormalized = Math.Max(min, Math.Min(max, normalized));\n\nreturn normalized;\n</code></pre> <p>What it improves:</p> <ul> <li>Auto-rounding - aligns to broker step size</li> <li>Auto-clamping - ensures within min/max range</li> <li>One call - gets limits + normalizes</li> <li>Error-free - guaranteed valid volume</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-1-basic-normalization","title":"Example 1: Basic Normalization","text":"<pre><code>// User enters odd volume\ndouble rawVolume = 0.037;\n\ndouble normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", rawVolume);\n\nConsole.WriteLine($\"Raw volume:        {rawVolume}\");\nConsole.WriteLine($\"Normalized volume: {normalized}\");\n\n// Output:\n// Raw volume:        0.037\n// Normalized volume: 0.04\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-2-fix-calculation-result","title":"Example 2: Fix Calculation Result","text":"<pre><code>// Volume from risk calculation might not be perfectly aligned\ndouble calculatedVolume = 0.1234567;\n\ndouble normalized = await svc.NormalizeVolumeAsync(\"GBPUSD\", calculatedVolume);\n\nConsole.WriteLine($\"Calculated: {calculatedVolume}\");\nConsole.WriteLine($\"Normalized: {normalized}\");\n\n// Output:\n// Calculated: 0.1234567\n// Normalized: 0.12\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-3-clamp-to-maximum","title":"Example 3: Clamp to Maximum","text":"<pre><code>// User wants huge volume that exceeds broker max\ndouble requestedVolume = 500.0;\n\ndouble normalized = await svc.NormalizeVolumeAsync(\"BTCUSD\", requestedVolume);\n\nConsole.WriteLine($\"Requested: {requestedVolume} lots\");\nConsole.WriteLine($\"Normalized: {normalized} lots\");\n\n// Output (if BTCUSD max is 5.0):\n// Requested: 500.0 lots\n// Normalized: 5.0 lots\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-4-clamp-to-minimum","title":"Example 4: Clamp to Minimum","text":"<pre><code>// Very small volume below broker minimum\ndouble tinyVolume = 0.001;\n\ndouble normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", tinyVolume);\n\nConsole.WriteLine($\"Tiny volume:  {tinyVolume}\");\nConsole.WriteLine($\"Normalized:   {normalized}\");\n\n// Output (if min is 0.01):\n// Tiny volume:  0.001\n// Normalized:   0.01\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-5-percentage-based-volume","title":"Example 5: Percentage-Based Volume","text":"<pre><code>// Close 33.3% of position\ndouble totalVolume = 0.15;\ndouble closePercent = 33.3;\ndouble rawCloseVolume = totalVolume * (closePercent / 100.0);\n\nConsole.WriteLine($\"Total volume: {totalVolume}\");\nConsole.WriteLine($\"33.3% of {totalVolume} = {rawCloseVolume}\");\n\ndouble normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", rawCloseVolume);\n\nConsole.WriteLine($\"Normalized close volume: {normalized}\");\n\n// Output:\n// Total volume: 0.15\n// 33.3% of 0.15 = 0.04995\n// Normalized close volume: 0.05\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-6-risk-based-volume-normalization","title":"Example 6: Risk-Based Volume Normalization","text":"<pre><code>// CalcVolumeForRiskAsync might return non-perfect value\ndouble riskBasedVolume = 0.2134;\n\ndouble normalized = await svc.NormalizeVolumeAsync(\"XAUUSD\", riskBasedVolume);\n\nConsole.WriteLine($\"Risk calculation: {riskBasedVolume}\");\nConsole.WriteLine($\"Broker-ready:     {normalized}\");\n\n// Place order with normalized volume\nawait svc.BuyMarket(\"XAUUSD\", normalized, sl: 2000.0, tp: 2050.0);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-7-multiple-volumes-batch-normalization","title":"Example 7: Multiple Volumes Batch Normalization","text":"<pre><code>double[] rawVolumes = { 0.037, 0.125, 0.003, 500.0, 0.5555 };\n\nConsole.WriteLine(\"Volume Normalization Results:\");\nConsole.WriteLine(\"Raw      | Normalized\");\nConsole.WriteLine(\"---------|----------\");\n\nforeach (var raw in rawVolumes)\n{\n    double normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", raw);\n    Console.WriteLine($\"{raw,8:F3} | {normalized,10:F2}\");\n}\n\n// Output:\n// Volume Normalization Results:\n// Raw      | Normalized\n// ---------|----------\n//    0.037 |       0.04\n//    0.125 |       0.13\n//    0.003 |       0.01\n//  500.000 |     100.00\n//    0.556 |       0.56\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-8-validation-normalization","title":"Example 8: Validation + Normalization","text":"<pre><code>public async Task&lt;double&gt; GetSafeVolume(\n    MT5Service svc,\n    string symbol,\n    double desiredVolume)\n{\n    // Normalize\n    double normalized = await svc.NormalizeVolumeAsync(symbol, desiredVolume);\n\n    // Check if normalization changed the value\n    if (Math.Abs(normalized - desiredVolume) &gt; 0.0001)\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Volume adjusted: {desiredVolume} \u2192 {normalized}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u2705 Volume valid: {normalized}\");\n    }\n\n    return normalized;\n}\n\n// Usage:\ndouble safeVolume = await GetSafeVolume(svc, \"GBPUSD\", 0.037);\n// Output: \u26a0\ufe0f Volume adjusted: 0.037 \u2192 0.04\n// Returns: 0.04\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-9-pre-trade-normalization","title":"Example 9: Pre-Trade Normalization","text":"<pre><code>public async Task&lt;OrderSendData&gt; PlaceNormalizedOrder(\n    MT5Service svc,\n    string symbol,\n    double rawVolume,\n    bool isBuy)\n{\n    // Always normalize before placing order\n    double volume = await svc.NormalizeVolumeAsync(symbol, rawVolume);\n\n    Console.WriteLine($\"Placing order:\");\n    Console.WriteLine($\"  Symbol:    {symbol}\");\n    Console.WriteLine($\"  Direction: {(isBuy ? \"BUY\" : \"SELL\")}\");\n    Console.WriteLine($\"  Volume:    {volume} lots (normalized from {rawVolume})\");\n\n    return await svc.PlaceMarket(symbol, volume, isBuy);\n}\n\n// Usage:\nawait PlaceNormalizedOrder(svc, \"EURUSD\", 0.0347, isBuy: true);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#example-10-scale-out-with-normalization","title":"Example 10: Scale Out with Normalization","text":"<pre><code>public async Task ScaleOutPosition(\n    MT5Service svc,\n    ulong ticket,\n    double[] percentages)\n{\n    // Get current position volume\n    var opened = await svc.OpenedOrdersAsync(...);\n    var position = opened.PositionInfos.First(p =&gt; p.Ticket == ticket);\n    double totalVolume = position.Volume;\n\n    Console.WriteLine($\"Scaling out position #{ticket} (Total: {totalVolume} lots)\");\n    Console.WriteLine(\"\");\n\n    foreach (var percent in percentages)\n    {\n        // Calculate raw close volume\n        double rawClose = totalVolume * (percent / 100.0);\n\n        // Normalize to broker constraints\n        double normalized = await svc.NormalizeVolumeAsync(position.PositionSymbol, rawClose);\n\n        // Close partial\n        await svc.CloseByTicket(ticket, volume: normalized);\n\n        Console.WriteLine($\"\u2705 Closed {percent}%: {rawClose:F4} \u2192 {normalized:F2} lots\");\n\n        totalVolume -= normalized;\n    }\n\n    Console.WriteLine($\"\\nRemaining: {totalVolume:F2} lots\");\n}\n\n// Usage: Scale out in 25%, 50%, 25% stages\nawait ScaleOutPosition(svc, ticket: 12345, new[] { 25.0, 50.0, 25.0 });\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>GetVolumeLimitsAsync()</code> - Retrieves min/max/step for normalization</li> </ul> <p>\ud83c\udf6c Methods that use this:</p> <ul> <li><code>CalcVolumeForRiskAsync()</code> - Auto-normalizes calculated volume</li> <li><code>BuyMarketByRisk()</code> - Uses this after volume calculation</li> <li><code>SellMarketByRisk()</code> - Uses this after volume calculation</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li>Manual normalization using GetVolumeLimitsAsync + math (more verbose)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Not normalizing calculation results: <pre><code>// \u274c WRONG: Using raw calculation result\ndouble volume = balance * 0.02 / stopLoss;  // Might be 0.0374\nawait svc.BuyMarket(\"EURUSD\", volume);  // \u274c May fail!\n\n// \u2705 CORRECT: Normalize first\ndouble rawVolume = balance * 0.02 / stopLoss;\ndouble volume = await svc.NormalizeVolumeAsync(\"EURUSD\", rawVolume);\nawait svc.BuyMarket(\"EURUSD\", volume);  // \u2705 Safe!\n</code></pre></p> </li> <li> <p>Forgetting normalization on user input: <pre><code>// \u274c WRONG: Using user input directly\ndouble volume = GetUserInput();  // User enters 0.037\nawait svc.PlaceMarket(\"EURUSD\", volume, true);  // \u274c Invalid!\n\n// \u2705 CORRECT: Normalize user input\ndouble rawVolume = GetUserInput();\ndouble volume = await svc.NormalizeVolumeAsync(\"EURUSD\", rawVolume);\nawait svc.PlaceMarket(\"EURUSD\", volume, true);  // \u2705 Valid!\n</code></pre></p> </li> <li> <p>Assuming normalization preserves exact value: <pre><code>// \u26a0\ufe0f Normalization changes value!\ndouble original = 0.037;\ndouble normalized = await svc.NormalizeVolumeAsync(\"EURUSD\", original);\n// normalized is now 0.04, NOT 0.037!\n\n// Always check if value changed\nif (normalized != original)\n{\n    Console.WriteLine($\"Volume adjusted: {original} \u2192 {normalized}\");\n}\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#normalization-examples","title":"\ud83d\udcca Normalization Examples","text":"Raw Volume Step Min Max Normalized Reason 0.037 0.01 0.01 100 0.04 Rounded to step 0.003 0.01 0.01 100 0.01 Clamped to min 500.0 0.01 0.01 100 100.0 Clamped to max 0.125 0.01 0.01 100 0.13 Rounded to step 0.0999 0.01 0.01 100 0.10 Rounded to step"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/NormalizeVolumeAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>NormalizeVolumeAsync is essential for error-free trading:</p> <ul> <li>\u2705 Auto-rounds to valid step size</li> <li>\u2705 Auto-clamps to min/max limits</li> <li>\u2705 Prevents broker rejections</li> <li>\u2705 Works with any raw volume input</li> </ul> <pre><code>// Always normalize before trading:\ndouble rawVolume = 0.037;  // From calculation or user input\ndouble volume = await svc.NormalizeVolumeAsync(\"EURUSD\", rawVolume);\n// volume is now 0.04 - guaranteed valid!\n\nawait svc.BuyMarket(\"EURUSD\", volume);  // \u2705 No rejection!\n</code></pre> <p>Normalize volumes, avoid errors! \ud83d\ude80</p>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/","title":"Price from Offset Points (<code>PriceFromOffsetPointsAsync</code>)","text":"<p>Sugar method: Calculates pending order price by offset in points from current market price - no manual calculation needed!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.PriceFromOffsetPointsAsync(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [08] VOLUME &amp; PRICE UTILITIES</li> <li>Underlying calls: <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code></li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;double&gt; PriceFromOffsetPointsAsync(\n    this MT5Service svc,\n    string symbol,\n    ENUM_ORDER_TYPE type,\n    double offsetPoints,\n    int timeoutSec = 10,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>type</code> <code>ENUM_ORDER_TYPE</code> Order type (BuyLimit, SellLimit, BuyStop, SellStop) <code>offsetPoints</code> <code>double</code> Distance in points from current price <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 10) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;double&gt;</code> Normalized price for pending order placement"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Auto-calculates pending order price from point offset - handles Bid/Ask selection and normalization.</li> <li>Why you need it: No manual price calculation! Just say \"50 points above/below\" and get exact price.</li> <li>Sanity check: BUY orders use Ask as base, SELL orders use Bid. Result is normalized to tick size.</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Pending order placement - Calculate entry price by points offset</li> <li>Point-based strategies - Work in points, not prices</li> <li>Dynamic price levels - Offset from current market, not fixed prices</li> <li>Simplified order logic - Less math, clearer intent</li> <li>Error prevention - Auto-selects correct base price (Bid/Ask)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>var deadline = DateTime.UtcNow.AddSeconds(timeoutSec);\n\n// Step 1: Get current quote\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\n\n// Step 2: Get point size\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 3: Determine base price (Ask for BUY, Bid for SELL)\nint orderTypeInt = Convert.ToInt32((object)type);\nbool isBuy = orderTypeInt == 0 || orderTypeInt == 2 || orderTypeInt == 4 || orderTypeInt == 6;\n\ndouble basePrice = isBuy ? tick.Ask : tick.Bid;\n\n// Step 4: Calculate price with offset\n// BUY orders: Add offset (above Ask)\n// SELL orders: Subtract offset (below Bid)\ndouble rawPrice = basePrice + (isBuy ? +1.0 : -1.0) * (offsetPoints * point);\n\n// Step 5: Normalize to tick size\nreturn await svc.NormalizePriceAsync(symbol, rawPrice, timeoutSec, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto Bid/Ask selection - uses correct base price for order type</li> <li>Auto direction - BUY adds, SELL subtracts</li> <li>Auto normalization - result is broker-ready</li> <li>Point-based thinking - work in points, not raw prices</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-1-buy-limit-50-points-below","title":"Example 1: Buy Limit 50 Points Below","text":"<pre><code>// Buy Limit 50 points below current Ask\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    symbol: \"EURUSD\",\n    type: ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    offsetPoints: 50);\n\nConsole.WriteLine($\"Buy Limit price: {price:F5}\");\n\n// Place order at calculated price\nawait svc.PlacePending(\"EURUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    price, sl: price - 50 * point, tp: price + 100 * point);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-2-sell-limit-30-points-above","title":"Example 2: Sell Limit 30 Points Above","text":"<pre><code>// Sell Limit 30 points above current Bid\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    symbol: \"GBPUSD\",\n    type: ENUM_ORDER_TYPE.OrderTypeSellLimit,\n    offsetPoints: 30);\n\nConsole.WriteLine($\"Sell Limit price: {price:F5}\");\n\nawait svc.PlacePending(\"GBPUSD\", 0.05, ENUM_ORDER_TYPE.OrderTypeSellLimit,\n    price, sl: price + 40 * point, tp: price - 80 * point);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-3-buy-stop-40-points-above-breakout","title":"Example 3: Buy Stop 40 Points Above (Breakout)","text":"<pre><code>// Buy Stop 40 points above current Ask (breakout long)\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    symbol: \"XAUUSD\",\n    type: ENUM_ORDER_TYPE.OrderTypeBuyStop,\n    offsetPoints: 40);\n\nConsole.WriteLine($\"Buy Stop price (breakout): {price:F2}\");\n\nawait svc.PlacePending(\"XAUUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeBuyStop,\n    price, sl: price - 30 * point, tp: price + 100 * point);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-4-sell-stop-25-points-below-breakdown","title":"Example 4: Sell Stop 25 Points Below (Breakdown)","text":"<pre><code>// Sell Stop 25 points below current Bid (breakdown short)\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    symbol: \"USDJPY\",\n    type: ENUM_ORDER_TYPE.OrderTypeSellStop,\n    offsetPoints: 25);\n\nConsole.WriteLine($\"Sell Stop price (breakdown): {price:F3}\");\n\nawait svc.PlacePending(\"USDJPY\", 0.1, ENUM_ORDER_TYPE.OrderTypeSellStop,\n    price, sl: price + 35 * point, tp: price - 75 * point);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-5-compare-manual-vs-auto-calculation","title":"Example 5: Compare Manual vs Auto Calculation","text":"<pre><code>// \u274c MANUAL WAY (error-prone):\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\nvar point = await svc.GetPointAsync(\"EURUSD\");\n\n// For Buy Limit: use Ask as base, subtract offset\ndouble manualPrice = tick.Ask - (50 * point);\n// Need to normalize manually too!\nmanualPrice = await svc.NormalizePriceAsync(\"EURUSD\", manualPrice);\n\nConsole.WriteLine($\"Manual calculation: {manualPrice:F5}\");\n\n// \u2705 AUTO WAY (clean):\ndouble autoPrice = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    50);\n\nConsole.WriteLine($\"Auto calculation:   {autoPrice:F5}\");\n\n// Both should be identical\nConsole.WriteLine($\"Match: {Math.Abs(manualPrice - autoPrice) &lt; 0.000001}\");\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-6-dynamic-pending-order-grid","title":"Example 6: Dynamic Pending Order Grid","text":"<pre><code>// Place grid of Buy Limit orders at different levels\nint[] offsets = { 20, 40, 60, 80, 100 };\n\nConsole.WriteLine(\"Buy Limit Grid:\");\nforeach (var offset in offsets)\n{\n    double price = await svc.PriceFromOffsetPointsAsync(\n        \"EURUSD\",\n        ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n        offset);\n\n    Console.WriteLine($\"  {offset}pts below: {price:F5}\");\n\n    // Place order\n    await svc.PlacePending(\"EURUSD\", 0.01,\n        ENUM_ORDER_TYPE.OrderTypeBuyLimit, price);\n}\n\n// Output:\n// Buy Limit Grid:\n//   20pts below: 1.09030\n//   40pts below: 1.09010\n//   60pts below: 1.08990\n//   80pts below: 1.08970\n//   100pts below: 1.08950\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-7-atr-based-pending-order","title":"Example 7: ATR-Based Pending Order","text":"<pre><code>// Use ATR indicator for dynamic offset\ndouble atr = 0.0015;  // ATR value\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Convert ATR to points\ndouble atrPoints = atr / point;\n\n// Place Buy Stop 1.5x ATR above (breakout)\ndouble buyStopOffset = atrPoints * 1.5;\ndouble buyStopPrice = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeBuyStop,\n    buyStopOffset);\n\n// Place Sell Stop 1.5x ATR below (breakdown)\ndouble sellStopOffset = atrPoints * 1.5;\ndouble sellStopPrice = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeSellStop,\n    sellStopOffset);\n\nConsole.WriteLine($\"ATR: {atr:F5} ({atrPoints:F0} points)\");\nConsole.WriteLine($\"Buy Stop (1.5x ATR):  {buyStopPrice:F5}\");\nConsole.WriteLine($\"Sell Stop (1.5x ATR): {sellStopPrice:F5}\");\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-8-supportresistance-offset-orders","title":"Example 8: Support/Resistance Offset Orders","text":"<pre><code>public async Task PlaceBreakoutOrders(\n    MT5Service svc,\n    string symbol,\n    double resistanceOffset,\n    double supportOffset)\n{\n    // Buy Stop above resistance\n    double buyStopPrice = await svc.PriceFromOffsetPointsAsync(\n        symbol,\n        ENUM_ORDER_TYPE.OrderTypeBuyStop,\n        resistanceOffset);\n\n    // Sell Stop below support\n    double sellStopPrice = await svc.PriceFromOffsetPointsAsync(\n        symbol,\n        ENUM_ORDER_TYPE.OrderTypeSellStop,\n        supportOffset);\n\n    Console.WriteLine($\"Breakout Orders for {symbol}:\");\n    Console.WriteLine($\"  Buy Stop:  {buyStopPrice:F5} ({resistanceOffset}pts above)\");\n    Console.WriteLine($\"  Sell Stop: {sellStopPrice:F5} ({supportOffset}pts below)\");\n\n    // Place orders\n    await svc.PlacePending(symbol, 0.01, ENUM_ORDER_TYPE.OrderTypeBuyStop, buyStopPrice);\n    await svc.PlacePending(symbol, 0.01, ENUM_ORDER_TYPE.OrderTypeSellStop, sellStopPrice);\n}\n\n// Usage:\nawait PlaceBreakoutOrders(svc, \"EURUSD\", resistanceOffset: 50, supportOffset: 50);\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-9-all-order-types-example","title":"Example 9: All Order Types Example","text":"<pre><code>string symbol = \"EURUSD\";\ndouble offset = 30;  // 30 points\n\nvar orderTypes = new[]\n{\n    (ENUM_ORDER_TYPE.OrderTypeBuyLimit, \"Buy Limit\"),\n    (ENUM_ORDER_TYPE.OrderTypeSellLimit, \"Sell Limit\"),\n    (ENUM_ORDER_TYPE.OrderTypeBuyStop, \"Buy Stop\"),\n    (ENUM_ORDER_TYPE.OrderTypeSellStop, \"Sell Stop\")\n};\n\nConsole.WriteLine($\"Prices for {offset}pt offset on {symbol}:\");\nConsole.WriteLine(\"\");\n\nforeach (var (type, label) in orderTypes)\n{\n    double price = await svc.PriceFromOffsetPointsAsync(symbol, type, offset);\n    Console.WriteLine($\"{label,-12}: {price:F5}\");\n}\n\n// Output:\n// Prices for 30pt offset on EURUSD:\n//\n// Buy Limit   : 1.09020\n// Sell Limit  : 1.09080\n// Buy Stop    : 1.09080\n// Sell Stop   : 1.08990\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#example-10-validate-calculated-price","title":"Example 10: Validate Calculated Price","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble offsetPoints = 50;\n\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    offsetPoints);\n\nConsole.WriteLine($\"Current Ask:      {tick.Ask:F5}\");\nConsole.WriteLine($\"Calculated price: {price:F5}\");\n\n// For Buy Limit, price should be BELOW Ask\nif (price &lt; tick.Ask)\n{\n    double diff = tick.Ask - price;\n    double point = await svc.GetPointAsync(\"EURUSD\");\n    double pointsDiff = diff / point;\n\n    Console.WriteLine($\"\u2705 Valid: {pointsDiff:F0} points below Ask\");\n}\nelse\n{\n    Console.WriteLine($\"\u274c Invalid: Price should be below Ask for Buy Limit!\");\n}\n</code></pre>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes calculated price</li> </ul> <p>\ud83c\udf6c Methods that use this:</p> <ul> <li><code>BuyLimitPoints()</code> - Uses this for Buy Limit price calculation</li> <li><code>SellLimitPoints()</code> - Uses this for Sell Limit price calculation</li> <li><code>BuyStopPoints()</code> - Uses this for Buy Stop price calculation</li> <li><code>SellStopPoints()</code> - Uses this for Sell Stop price calculation</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li>Manual calculation using SymbolInfoTickAsync + GetPointAsync (verbose)</li> <li>Point-based pending helpers (simpler but less flexible)</li> </ul>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing offset direction: <pre><code>// Buy Limit: BELOW current price (offset is DOWN from Ask)\n// Sell Limit: ABOVE current price (offset is UP from Bid)\n// Buy Stop: ABOVE current price (offset is UP from Ask)\n// Sell Stop: BELOW current price (offset is DOWN from Bid)\n\n// Method handles direction automatically based on order type!\n</code></pre></p> </li> <li> <p>Using wrong order type: <pre><code>// \u274c WRONG: Using market order type\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeBuy,  // \u274c Market order!\n    50);\n\n// \u2705 CORRECT: Use pending order type\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,  // \u2705 Pending order\n    50);\n</code></pre></p> </li> <li> <p>Not understanding Bid/Ask basis: <pre><code>// BUY orders (Limit/Stop): Base is ASK\n// SELL orders (Limit/Stop): Base is BID\n\n// Method automatically uses correct base!\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#price-calculation-summary","title":"\ud83d\udcca Price Calculation Summary","text":"Order Type Base Price Direction Result BuyLimit Ask Down (\u2212) Ask \u2212 (offset \u00d7 point) SellLimit Bid Up (+) Bid + (offset \u00d7 point) BuyStop Ask Up (+) Ask + (offset \u00d7 point) SellStop Bid Down (\u2212) Bid \u2212 (offset \u00d7 point)"},{"location":"MT5Sugar/8.%20Volume_Price_Utils/PriceFromOffsetPointsAsync/#summary","title":"\ud83d\udca1 Summary","text":"<p>PriceFromOffsetPointsAsync simplifies pending order pricing:</p> <ul> <li>\u2705 Auto-selects base price (Bid/Ask)</li> <li>\u2705 Auto-applies offset direction</li> <li>\u2705 Auto-normalizes result</li> <li>\u2705 Work in points, not raw prices</li> </ul> <pre><code>// Instead of manual calculation:\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\nvar point = await svc.GetPointAsync(\"EURUSD\");\ndouble price = tick.Ask - (50 * point);  // \u274c Manual, error-prone\nprice = await svc.NormalizePriceAsync(\"EURUSD\", price);\n\n// Use one clean call:\ndouble price = await svc.PriceFromOffsetPointsAsync(\n    \"EURUSD\",\n    ENUM_ORDER_TYPE.OrderTypeBuyLimit,\n    50);  // \u2705 Auto everything!\n</code></pre> <p>Think in points, get perfect prices! \ud83d\ude80</p>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/","title":"Buy Limit by Points (<code>BuyLimitPoints</code>)","text":"<p>Sugar method: Places Buy Limit pending order using point-based offset from current Ask price - no manual price calculation!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.BuyLimitPoints(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [09] PENDING HELPERS (BY POINTS)</li> <li>Underlying calls: <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code> + <code>OrderSendAsync()</code></li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; BuyLimitPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>volume</code> <code>double</code> Volume in lots (e.g., 0.01, 0.1, 1.0) <code>priceOffsetPoints</code> <code>double</code> Distance in points below current Ask (always positive) <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points below entry price <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points above entry price <code>comment</code> <code>string?</code> Optional order comment <code>deviationPoints</code> <code>int</code> Maximum price deviation in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details <p>Key fields:</p> <ul> <li><code>Order</code> - Order ticket number (ulong)</li> <li><code>ReturnedCode</code> - MT5 return code (10009 = success)</li> <li><code>Comment</code> - Server response comment</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Buy Limit helper - places order BELOW current Ask using point-based offset instead of absolute price.</li> <li>Why you need it: No manual price calculation! Just say \"50 points below\" and SL/TP in points from entry.</li> <li>Sanity check: Buy Limit = buy BELOW current price (cheaper). Offset is always positive, method subtracts from Ask automatically.</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Buy on dips - Enter long when price pulls back</li> <li>Support level entries - Place orders at support zones</li> <li>Retracement trades - Buy after pullback in uptrend</li> <li>Dollar-cost averaging - Multiple Buy Limits at different levels</li> <li>Point-based strategies - Work in points, not prices</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get current market quote\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 2: Calculate entry price (BELOW Ask for Buy Limit)\nvar rawPrice = tick.Ask - Math.Abs(priceOffsetPoints) * point;\nvar price = await svc.NormalizePriceAsync(symbol, rawPrice, timeoutSec, ct);\n\n// Step 3: Calculate SL/TP from entry price\ndouble sl = slPoints.HasValue ? price - slPoints.Value * point : 0;\ndouble tp = tpPoints.HasValue ? price + tpPoints.Value * point : 0;\n\n// Step 4: Build and send pending order request (operationCode: 2 = BuyLimit)\nvar req = BuildPendingRequest(symbol, volume, price, sl, tp, comment, deviationPoints, 2);\nreturn await svc.OrderSendAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto price calculation - converts points to absolute price</li> <li>Auto Bid/Ask selection - uses Ask as base for Buy orders</li> <li>Auto normalization - price rounded to tick size</li> <li>Point-based SL/TP - distances from entry, not from current price</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-1-basic-buy-limit-50-points-below","title":"Example 1: Basic Buy Limit 50 Points Below","text":"<pre><code>// Buy Limit 50 points below current Ask\nvar result = await svc.BuyLimitPoints(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    priceOffsetPoints: 50);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Buy Limit placed: Ticket #{result.Order}\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-2-buy-limit-with-sl-and-tp","title":"Example 2: Buy Limit with SL and TP","text":"<pre><code>// Buy Limit 30 points below with 20-point SL and 50-point TP\nvar result = await svc.BuyLimitPoints(\n    symbol: \"EURUSD\",\n    volume: 0.05,\n    priceOffsetPoints: 30,\n    slPoints: 20,   // 20 points below entry\n    tpPoints: 50);  // 50 points above entry\n\nConsole.WriteLine($\"\u2705 Order #{result.Order}\");\nConsole.WriteLine($\"   Entry offset: 30 points below Ask\");\nConsole.WriteLine($\"   SL: 20 points, TP: 50 points\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-3-multiple-buy-limits-grid-strategy","title":"Example 3: Multiple Buy Limits (Grid Strategy)","text":"<pre><code>// Place grid of Buy Limit orders at different levels\nint[] offsets = { 20, 40, 60, 80, 100 };\n\nConsole.WriteLine(\"Placing Buy Limit grid:\");\nforeach (var offset in offsets)\n{\n    var result = await svc.BuyLimitPoints(\n        \"EURUSD\",\n        0.01,\n        priceOffsetPoints: offset,\n        slPoints: 30,\n        tpPoints: 60);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"  \u2705 {offset}pts below: Ticket #{result.Order}\");\n    }\n}\n\n// Output:\n// Placing Buy Limit grid:\n//   \u2705 20pts below: Ticket #12345\n//   \u2705 40pts below: Ticket #12346\n//   \u2705 60pts below: Ticket #12347\n//   \u2705 80pts below: Ticket #12348\n//   \u2705 100pts below: Ticket #12349\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-4-atr-based-dynamic-offset","title":"Example 4: ATR-Based Dynamic Offset","text":"<pre><code>// Use ATR for dynamic offset calculation\ndouble atr = 0.0015;  // ATR value for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Convert ATR to points\ndouble atrPoints = atr / point;\n\n// Place Buy Limit at 0.5x ATR below (pullback entry)\ndouble offset = atrPoints * 0.5;\n\nvar result = await svc.BuyLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: offset,\n    slPoints: atrPoints * 1.5,   // 1.5x ATR stop\n    tpPoints: atrPoints * 3.0);  // 3x ATR target\n\nConsole.WriteLine($\"ATR-based Buy Limit: {offset:F0} points below\");\nConsole.WriteLine($\"  SL: {atrPoints * 1.5:F0}pts, TP: {atrPoints * 3.0:F0}pts\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-5-support-level-entry","title":"Example 5: Support Level Entry","text":"<pre><code>public async Task PlaceBuyAtSupport(\n    MT5Service svc,\n    string symbol,\n    double supportLevel)\n{\n    // Get current Ask\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    // Calculate offset from current Ask to support level\n    double offsetPrice = tick.Ask - supportLevel;\n    double offsetPoints = offsetPrice / point;\n\n    if (offsetPoints &gt; 0)  // Support is below current price\n    {\n        var result = await svc.BuyLimitPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: offsetPoints,\n            slPoints: 50,\n            tpPoints: 150);\n\n        Console.WriteLine($\"\u2705 Buy Limit at support {supportLevel:F5}\");\n        Console.WriteLine($\"   Offset: {offsetPoints:F0} points below Ask\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Support {supportLevel:F5} is above current Ask!\");\n    }\n}\n\n// Usage:\nawait PlaceBuyAtSupport(svc, \"EURUSD\", supportLevel: 1.0850);\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-6-with-order-comment","title":"Example 6: With Order Comment","text":"<pre><code>// Buy Limit with strategy identifier\nvar result = await svc.BuyLimitPoints(\n    symbol: \"GBPUSD\",\n    volume: 0.02,\n    priceOffsetPoints: 40,\n    slPoints: 30,\n    tpPoints: 90,\n    comment: \"BuyDip_Strategy_v2\");\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} - Comment: BuyDip_Strategy_v2\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-7-calculate-entry-price-before-placing","title":"Example 7: Calculate Entry Price Before Placing","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble offsetPoints = 50;\n\n// Calculate what the entry price will be\ndouble entryPrice = tick.Ask - offsetPoints * point;\n\nConsole.WriteLine($\"Current Ask: {tick.Ask:F5}\");\nConsole.WriteLine($\"Entry will be: {entryPrice:F5} (50 points below)\");\nConsole.WriteLine($\"Placing order...\");\n\nvar result = await svc.BuyLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: offsetPoints,\n    slPoints: 20,\n    tpPoints: 60);\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} placed at ~{entryPrice:F5}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    var result = await svc.BuyLimitPoints(\n        \"EURUSD\",\n        0.01,\n        priceOffsetPoints: 50,\n        slPoints: 20,\n        tpPoints: 60);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Success: Ticket #{result.Order}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n        Console.WriteLine($\"   Return code: {result.ReturnedCode}\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-9-risk-based-volume-with-buy-limit","title":"Example 9: Risk-Based Volume with Buy Limit","text":"<pre><code>// Calculate volume based on risk\ndouble riskMoney = 100.0;\ndouble slPoints = 30;\n\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskMoney);\n\n// Place Buy Limit with calculated volume\nvar result = await svc.BuyLimitPoints(\n    \"EURUSD\",\n    volume: volume,\n    priceOffsetPoints: 40,\n    slPoints: slPoints,\n    tpPoints: 100);\n\nConsole.WriteLine($\"\u2705 Risk-based order placed:\");\nConsole.WriteLine($\"   Volume: {volume} lots\");\nConsole.WriteLine($\"   Risk: ${riskMoney} if SL hit\");\nConsole.WriteLine($\"   Ticket: #{result.Order}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#example-10-compare-manual-vs-auto-calculation","title":"Example 10: Compare Manual vs Auto Calculation","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble offsetPoints = 50;\ndouble slPoints = 20;\ndouble tpPoints = 60;\n\n// \u274c MANUAL WAY (error-prone):\ndouble entryPriceManual = tick.Ask - offsetPoints * point;\nentryPriceManual = await svc.NormalizePriceAsync(\"EURUSD\", entryPriceManual);\ndouble slManual = entryPriceManual - slPoints * point;\ndouble tpManual = entryPriceManual + tpPoints * point;\n\nvar reqManual = new OrderSendRequest\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,\n    Price = entryPriceManual,\n    StopLoss = slManual,\n    TakeProfit = tpManual,\n    Operation = ENUM_ORDER_TYPE.OrderTypeBuyLimit\n};\nvar resultManual = await svc.OrderSendAsync(reqManual);\n\nConsole.WriteLine($\"Manual way: {resultManual.Order}\");\n\n// \u2705 AUTO WAY (clean):\nvar resultAuto = await svc.BuyLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: 50,\n    slPoints: 20,\n    tpPoints: 60);\n\nConsole.WriteLine($\"Auto way: {resultAuto.Order}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes entry price</li> <li><code>OrderSendAsync()</code> - Sends pending order request</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>SellLimitPoints()</code> - Sell Limit with point-based offset</li> <li><code>BuyStopPoints()</code> - Buy Stop with point-based offset</li> <li><code>SellStopPoints()</code> - Sell Stop with point-based offset</li> <li><code>PlacePending()</code> - Generic pending order (requires absolute price)</li> <li><code>PriceFromOffsetPointsAsync()</code> - Calculate price only (no order placement)</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>PlacePending()</code> - More flexible but requires manual price calculation</li> <li><code>PriceFromOffsetPointsAsync()</code> + <code>PlacePending()</code> - Two-step approach</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing offset direction: <pre><code>// \u274c WRONG: Thinking offset is ABOVE Ask\n// Buy Limit is ALWAYS below current Ask!\n\n// \u2705 CORRECT: Offset is distance BELOW Ask\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n// Places order 50 points BELOW current Ask\n</code></pre></p> </li> <li> <p>Negative offset (method handles it): <pre><code>// \u26a0\ufe0f Method uses Math.Abs(), so negative works but is confusing\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: -50);\n// Same as priceOffsetPoints: 50 (absolute value taken)\n\n// \u2705 BETTER: Always use positive values\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>SL/TP direction confusion: <pre><code>// \u2705 CORRECT: SL/TP are distances FROM ENTRY, not from current price\nawait svc.BuyLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: 50,\n    slPoints: 20,  // 20 points BELOW entry price\n    tpPoints: 60); // 60 points ABOVE entry price\n\n// NOT from current Ask! They're relative to calculated entry.\n</code></pre></p> </li> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// For 5-digit broker, this is 0.5 pips, not 5 pips!\n\n// \u2705 CORRECT: Convert pips to points for 5-digit brokers\ndouble pips = 5;\ndouble points = pips * 10;  // 1 pip = 10 points on 5-digit\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: points);\n</code></pre></p> </li> <li> <p>Offset too small (broker minimum distance): <pre><code>// \u274c May fail if offset violates broker's minimum stop level\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// Broker may require minimum 10 points distance\n\n// \u2705 CORRECT: Check broker requirements\n// Most brokers require 10-50 points minimum for pending orders\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyLimitPoints/#summary","title":"\ud83d\udca1 Summary","text":"<p>BuyLimitPoints simplifies Buy Limit order placement:</p> <ul> <li>\u2705 Work in points, not absolute prices</li> <li>\u2705 Auto-calculates entry price BELOW Ask</li> <li>\u2705 SL/TP as point distances from entry</li> <li>\u2705 Auto-normalizes prices to tick size</li> <li>\u2705 Perfect for buy-on-dip strategies</li> </ul> <pre><code>// Instead of manual calculation:\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble price = tick.Ask - 50 * 0.00001;  // \u274c Manual, error-prone\nawait svc.PlacePending(\"EURUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeBuyLimit, price, ...);\n\n// Use one clean call:\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);  // \u2705 Clean!\n</code></pre> <p>Buy the dip with precision! \ud83d\ude80</p>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/","title":"Buy Stop by Points (<code>BuyStopPoints</code>)","text":"<p>Sugar method: Places Buy Stop pending order using point-based offset from current Ask price - breakout entry made easy!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.BuyStopPoints(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [09] PENDING HELPERS (BY POINTS)</li> <li>Underlying calls: <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code> + <code>OrderSendAsync()</code></li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; BuyStopPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>volume</code> <code>double</code> Volume in lots (e.g., 0.01, 0.1, 1.0) <code>priceOffsetPoints</code> <code>double</code> Distance in points above current Ask (always positive) <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points below entry price <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points above entry price <code>comment</code> <code>string?</code> Optional order comment <code>deviationPoints</code> <code>int</code> Maximum price deviation in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details <p>Key fields:</p> <ul> <li><code>Order</code> - Order ticket number (ulong)</li> <li><code>ReturnedCode</code> - MT5 return code (10009 = success)</li> <li><code>Comment</code> - Server response comment</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Buy Stop helper - places order ABOVE current Ask using point-based offset. Triggers when price breaks UP.</li> <li>Why you need it: Perfect for breakout strategies! No manual price calculation - just specify distance above current price.</li> <li>Sanity check: Buy Stop = buy ABOVE current price (chase momentum). Order executes when price rises to trigger level.</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Breakout entries - Buy when price breaks resistance</li> <li>Momentum trading - Chase upward price movement</li> <li>Trend continuation - Enter long when uptrend confirmed</li> <li>Stop and reverse - Exit short + enter long simultaneously</li> <li>Triggered limit orders - Activate buy after confirmation</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get current market quote\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 2: Calculate entry price (ABOVE Ask for Buy Stop)\nvar rawPrice = tick.Ask + Math.Abs(priceOffsetPoints) * point;\nvar price = await svc.NormalizePriceAsync(symbol, rawPrice, timeoutSec, ct);\n\n// Step 3: Calculate SL/TP from entry price\ndouble sl = slPoints.HasValue ? price - slPoints.Value * point : 0;\ndouble tp = tpPoints.HasValue ? price + tpPoints.Value * point : 0;\n\n// Step 4: Build and send pending order request (operationCode: 4 = BuyStop)\nvar req = BuildPendingRequest(symbol, volume, price, sl, tp, comment, deviationPoints, 4);\nreturn await svc.OrderSendAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto price calculation - converts points to absolute price</li> <li>Auto Bid/Ask selection - uses Ask as base for Buy orders</li> <li>Auto normalization - price rounded to tick size</li> <li>Point-based SL/TP - distances from entry, not from current price</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-1-basic-buy-stop-50-points-above","title":"Example 1: Basic Buy Stop 50 Points Above","text":"<pre><code>// Buy Stop 50 points above current Ask\nvar result = await svc.BuyStopPoints(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    priceOffsetPoints: 50);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Buy Stop placed: Ticket #{result.Order}\");\n    Console.WriteLine($\"   Will trigger 50 points above current Ask\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-2-buy-stop-with-sl-and-tp","title":"Example 2: Buy Stop with SL and TP","text":"<pre><code>// Buy Stop 30 points above with 20-point SL and 60-point TP\nvar result = await svc.BuyStopPoints(\n    symbol: \"EURUSD\",\n    volume: 0.05,\n    priceOffsetPoints: 30,\n    slPoints: 20,   // 20 points below entry\n    tpPoints: 60);  // 60 points above entry\n\nConsole.WriteLine($\"\u2705 Order #{result.Order}\");\nConsole.WriteLine($\"   Trigger: 30 points above Ask\");\nConsole.WriteLine($\"   SL: 20 points, TP: 60 points\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-3-resistance-breakout-entry","title":"Example 3: Resistance Breakout Entry","text":"<pre><code>public async Task PlaceBuyStopAtResistance(\n    MT5Service svc,\n    string symbol,\n    double resistanceLevel)\n{\n    // Get current Ask\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    // Calculate offset from current Ask to resistance breakout\n    double offsetPrice = resistanceLevel - tick.Ask;\n    double offsetPoints = offsetPrice / point;\n\n    if (offsetPoints &gt; 0)  // Resistance is above current price\n    {\n        // Place Buy Stop just above resistance\n        var result = await svc.BuyStopPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: offsetPoints + 10,  // 10 points above resistance\n            slPoints: 50,\n            tpPoints: 150,\n            comment: \"ResistanceBreakout\");\n\n        Console.WriteLine($\"\u2705 Buy Stop at {resistanceLevel:F5} + 10pts\");\n        Console.WriteLine($\"   Ticket: #{result.Order}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Resistance {resistanceLevel:F5} is below current Ask!\");\n    }\n}\n\n// Usage:\nawait PlaceBuyStopAtResistance(svc, \"EURUSD\", resistanceLevel: 1.0950);\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-4-atr-based-breakout","title":"Example 4: ATR-Based Breakout","text":"<pre><code>// Use ATR for dynamic breakout threshold\ndouble atr = 0.0015;  // ATR value for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Convert ATR to points\ndouble atrPoints = atr / point;\n\n// Place Buy Stop at 1x ATR above (strong breakout)\nvar result = await svc.BuyStopPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: atrPoints * 1.0,\n    slPoints: atrPoints * 0.5,   // Tight stop (already in momentum)\n    tpPoints: atrPoints * 2.0);  // 2x ATR target\n\nConsole.WriteLine($\"ATR-based Buy Stop: {atrPoints:F0} points above\");\nConsole.WriteLine($\"  SL: {atrPoints * 0.5:F0}pts, TP: {atrPoints * 2.0:F0}pts\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-5-multiple-buy-stops-scaling-in","title":"Example 5: Multiple Buy Stops (Scaling In)","text":"<pre><code>// Place multiple Buy Stops at different levels\n// (scaling into position as momentum builds)\nint[] offsets = { 30, 60, 90 };\ndouble[] volumes = { 0.01, 0.02, 0.03 };  // Pyramid up\n\nConsole.WriteLine(\"Placing Buy Stop pyramid:\");\nfor (int i = 0; i &lt; offsets.Length; i++)\n{\n    var result = await svc.BuyStopPoints(\n        \"EURUSD\",\n        volumes[i],\n        priceOffsetPoints: offsets[i],\n        slPoints: 40,\n        tpPoints: 120);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"  \u2705 {offsets[i]}pts above: {volumes[i]} lots - Ticket #{result.Order}\");\n    }\n}\n\n// Output:\n// Placing Buy Stop pyramid:\n//   \u2705 30pts above: 0.01 lots - Ticket #12355\n//   \u2705 60pts above: 0.02 lots - Ticket #12356\n//   \u2705 90pts above: 0.03 lots - Ticket #12357\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-6-round-number-breakout","title":"Example 6: Round Number Breakout","text":"<pre><code>public async Task PlaceBuyStopAtRoundNumber(\n    MT5Service svc,\n    string symbol,\n    double roundNumber)\n{\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    // Calculate offset to round number\n    double offsetPrice = roundNumber - tick.Ask;\n    double offsetPoints = offsetPrice / point;\n\n    if (offsetPoints &gt; 5)  // Only if round number is at least 5 points away\n    {\n        var result = await svc.BuyStopPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: offsetPoints,\n            slPoints: 30,\n            tpPoints: 100,\n            comment: $\"RoundBreak_{roundNumber}\");\n\n        Console.WriteLine($\"\u2705 Buy Stop at {roundNumber:F5}\");\n        Console.WriteLine($\"   Offset: {offsetPoints:F0} points above Ask\");\n    }\n}\n\n// Usage - wait for break above 1.1000\nawait PlaceBuyStopAtRoundNumber(svc, \"EURUSD\", roundNumber: 1.1000);\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-7-with-order-comment","title":"Example 7: With Order Comment","text":"<pre><code>// Buy Stop with strategy identifier\nvar result = await svc.BuyStopPoints(\n    symbol: \"GBPUSD\",\n    volume: 0.02,\n    priceOffsetPoints: 50,\n    slPoints: 30,\n    tpPoints: 100,\n    comment: \"Breakout_Strategy_v3\");\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} - Comment: Breakout_Strategy_v3\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    var result = await svc.BuyStopPoints(\n        \"EURUSD\",\n        0.01,\n        priceOffsetPoints: 50,\n        slPoints: 20,\n        tpPoints: 80);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Success: Ticket #{result.Order}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n        Console.WriteLine($\"   Return code: {result.ReturnedCode}\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-9-risk-based-volume-with-buy-stop","title":"Example 9: Risk-Based Volume with Buy Stop","text":"<pre><code>// Calculate volume based on risk\ndouble riskMoney = 100.0;\ndouble slPoints = 30;\n\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskMoney);\n\n// Place Buy Stop with calculated volume\nvar result = await svc.BuyStopPoints(\n    \"EURUSD\",\n    volume: volume,\n    priceOffsetPoints: 40,\n    slPoints: slPoints,\n    tpPoints: 120);\n\nConsole.WriteLine($\"\u2705 Risk-based Buy Stop placed:\");\nConsole.WriteLine($\"   Volume: {volume} lots\");\nConsole.WriteLine($\"   Risk: ${riskMoney} if SL hit\");\nConsole.WriteLine($\"   Ticket: #{result.Order}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#example-10-calculate-trigger-price-before-placing","title":"Example 10: Calculate Trigger Price Before Placing","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble offsetPoints = 50;\n\n// Calculate what the trigger price will be\ndouble triggerPrice = tick.Ask + offsetPoints * point;\n\nConsole.WriteLine($\"Current Ask: {tick.Ask:F5}\");\nConsole.WriteLine($\"Trigger will be: {triggerPrice:F5} (50 points above)\");\nConsole.WriteLine($\"Placing Buy Stop...\");\n\nvar result = await svc.BuyStopPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: offsetPoints,\n    slPoints: 20,\n    tpPoints: 80);\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} - triggers at ~{triggerPrice:F5}\");\nConsole.WriteLine($\"   Waiting for breakout...\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes trigger price</li> <li><code>OrderSendAsync()</code> - Sends pending order request</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>SellStopPoints()</code> - Sell Stop with point-based offset</li> <li><code>BuyLimitPoints()</code> - Buy Limit with point-based offset</li> <li><code>SellLimitPoints()</code> - Sell Limit with point-based offset</li> <li><code>PlacePending()</code> - Generic pending order (requires absolute price)</li> <li><code>PriceFromOffsetPointsAsync()</code> - Calculate price only (no order placement)</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>PlacePending()</code> - More flexible but requires manual price calculation</li> <li><code>PriceFromOffsetPointsAsync()</code> + <code>PlacePending()</code> - Two-step approach</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing with Buy Limit: <pre><code>// \u274c CONFUSION: Buy Limit vs Buy Stop\n// Buy Limit = BELOW current price (buy cheaper)\n// Buy Stop = ABOVE current price (chase momentum)\n\n// \u2705 CORRECT usage:\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, 50);  // 50 pts BELOW (pullback)\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, 50);   // 50 pts ABOVE (breakout)\n</code></pre></p> </li> <li> <p>Negative offset (method handles it): <pre><code>// \u26a0\ufe0f Method uses Math.Abs(), so negative works but is confusing\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: -50);\n// Same as priceOffsetPoints: 50 (absolute value taken)\n\n// \u2705 BETTER: Always use positive values\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>SL/TP direction confusion: <pre><code>// \u2705 CORRECT: SL/TP are distances FROM ENTRY, not from current price\nawait svc.BuyStopPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: 50,\n    slPoints: 20,  // 20 points BELOW entry price\n    tpPoints: 80); // 80 points ABOVE entry price\n\n// Entry is 50 points above current Ask, then SL/TP from there!\n</code></pre></p> </li> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// For 5-digit broker, this is 0.5 pips, not 5 pips!\n\n// \u2705 CORRECT: Convert pips to points for 5-digit brokers\ndouble pips = 5;\ndouble points = pips * 10;  // 1 pip = 10 points on 5-digit\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: points);\n</code></pre></p> </li> <li> <p>Offset too small (broker minimum distance): <pre><code>// \u274c May fail if offset violates broker's minimum stop level\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// Broker may require minimum 10-50 points distance\n\n// \u2705 CORRECT: Check broker requirements\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>Not understanding execution: <pre><code>// \u26a0\ufe0f Buy Stop does NOT execute immediately!\nvar result = await svc.BuyStopPoints(\"EURUSD\", 0.01, 50);\n// Order is PENDING until price rises 50 points\n\n// Only executes if/when Ask reaches trigger level\n// If price never reaches, order stays pending forever\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/BuyStopPoints/#summary","title":"\ud83d\udca1 Summary","text":"<p>BuyStopPoints simplifies Buy Stop order placement:</p> <ul> <li>\u2705 Work in points, not absolute prices</li> <li>\u2705 Auto-calculates trigger price ABOVE Ask</li> <li>\u2705 SL/TP as point distances from entry</li> <li>\u2705 Auto-normalizes prices to tick size</li> <li>\u2705 Perfect for breakout strategies</li> </ul> <pre><code>// Instead of manual calculation:\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble price = tick.Ask + 50 * 0.00001;  // \u274c Manual, error-prone\nawait svc.PlacePending(\"EURUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeBuyStop, price, ...);\n\n// Use one clean call:\nawait svc.BuyStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);  // \u2705 Clean!\n</code></pre> <p>Chase the breakout with confidence! \ud83d\ude80</p>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/","title":"Sell Limit by Points (<code>SellLimitPoints</code>)","text":"<p>Sugar method: Places Sell Limit pending order using point-based offset from current Bid price - no manual price calculation!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.SellLimitPoints(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [09] PENDING HELPERS (BY POINTS)</li> <li>Underlying calls: <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code> + <code>OrderSendAsync()</code></li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SellLimitPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>volume</code> <code>double</code> Volume in lots (e.g., 0.01, 0.1, 1.0) <code>priceOffsetPoints</code> <code>double</code> Distance in points above current Bid (always positive) <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points above entry price <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points below entry price <code>comment</code> <code>string?</code> Optional order comment <code>deviationPoints</code> <code>int</code> Maximum price deviation in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details <p>Key fields:</p> <ul> <li><code>Order</code> - Order ticket number (ulong)</li> <li><code>ReturnedCode</code> - MT5 return code (10009 = success)</li> <li><code>Comment</code> - Server response comment</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Sell Limit helper - places order ABOVE current Bid using point-based offset instead of absolute price.</li> <li>Why you need it: No manual price calculation! Just say \"50 points above\" and SL/TP in points from entry.</li> <li>Sanity check: Sell Limit = sell ABOVE current price (better price). Offset is always positive, method adds to Bid automatically.</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Sell on rallies - Enter short when price bounces up</li> <li>Resistance level entries - Place orders at resistance zones</li> <li>Retracement trades - Sell after pullback in downtrend</li> <li>Mean reversion - Sell when price gets overbought</li> <li>Point-based strategies - Work in points, not prices</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get current market quote\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 2: Calculate entry price (ABOVE Bid for Sell Limit)\nvar rawPrice = tick.Bid + Math.Abs(priceOffsetPoints) * point;\nvar price = await svc.NormalizePriceAsync(symbol, rawPrice, timeoutSec, ct);\n\n// Step 3: Calculate SL/TP from entry price\ndouble sl = slPoints.HasValue ? price + slPoints.Value * point : 0;\ndouble tp = tpPoints.HasValue ? price - tpPoints.Value * point : 0;\n\n// Step 4: Build and send pending order request (operationCode: 3 = SellLimit)\nvar req = BuildPendingRequest(symbol, volume, price, sl, tp, comment, deviationPoints, 3);\nreturn await svc.OrderSendAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto price calculation - converts points to absolute price</li> <li>Auto Bid/Ask selection - uses Bid as base for Sell orders</li> <li>Auto normalization - price rounded to tick size</li> <li>Point-based SL/TP - distances from entry, not from current price</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-1-basic-sell-limit-50-points-above","title":"Example 1: Basic Sell Limit 50 Points Above","text":"<pre><code>// Sell Limit 50 points above current Bid\nvar result = await svc.SellLimitPoints(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    priceOffsetPoints: 50);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Sell Limit placed: Ticket #{result.Order}\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-2-sell-limit-with-sl-and-tp","title":"Example 2: Sell Limit with SL and TP","text":"<pre><code>// Sell Limit 30 points above with 20-point SL and 50-point TP\nvar result = await svc.SellLimitPoints(\n    symbol: \"EURUSD\",\n    volume: 0.05,\n    priceOffsetPoints: 30,\n    slPoints: 20,   // 20 points above entry\n    tpPoints: 50);  // 50 points below entry\n\nConsole.WriteLine($\"\u2705 Order #{result.Order}\");\nConsole.WriteLine($\"   Entry offset: 30 points above Bid\");\nConsole.WriteLine($\"   SL: 20 points, TP: 50 points\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-3-multiple-sell-limits-grid-strategy","title":"Example 3: Multiple Sell Limits (Grid Strategy)","text":"<pre><code>// Place grid of Sell Limit orders at different levels\nint[] offsets = { 20, 40, 60, 80, 100 };\n\nConsole.WriteLine(\"Placing Sell Limit grid:\");\nforeach (var offset in offsets)\n{\n    var result = await svc.SellLimitPoints(\n        \"EURUSD\",\n        0.01,\n        priceOffsetPoints: offset,\n        slPoints: 30,\n        tpPoints: 60);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"  \u2705 {offset}pts above: Ticket #{result.Order}\");\n    }\n}\n\n// Output:\n// Placing Sell Limit grid:\n//   \u2705 20pts above: Ticket #12350\n//   \u2705 40pts above: Ticket #12351\n//   \u2705 60pts above: Ticket #12352\n//   \u2705 80pts above: Ticket #12353\n//   \u2705 100pts above: Ticket #12354\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-4-atr-based-dynamic-offset","title":"Example 4: ATR-Based Dynamic Offset","text":"<pre><code>// Use ATR for dynamic offset calculation\ndouble atr = 0.0015;  // ATR value for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Convert ATR to points\ndouble atrPoints = atr / point;\n\n// Place Sell Limit at 0.5x ATR above (rally entry)\ndouble offset = atrPoints * 0.5;\n\nvar result = await svc.SellLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: offset,\n    slPoints: atrPoints * 1.5,   // 1.5x ATR stop\n    tpPoints: atrPoints * 3.0);  // 3x ATR target\n\nConsole.WriteLine($\"ATR-based Sell Limit: {offset:F0} points above\");\nConsole.WriteLine($\"  SL: {atrPoints * 1.5:F0}pts, TP: {atrPoints * 3.0:F0}pts\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-5-resistance-level-entry","title":"Example 5: Resistance Level Entry","text":"<pre><code>public async Task PlaceSellAtResistance(\n    MT5Service svc,\n    string symbol,\n    double resistanceLevel)\n{\n    // Get current Bid\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    // Calculate offset from current Bid to resistance level\n    double offsetPrice = resistanceLevel - tick.Bid;\n    double offsetPoints = offsetPrice / point;\n\n    if (offsetPoints &gt; 0)  // Resistance is above current price\n    {\n        var result = await svc.SellLimitPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: offsetPoints,\n            slPoints: 50,\n            tpPoints: 150);\n\n        Console.WriteLine($\"\u2705 Sell Limit at resistance {resistanceLevel:F5}\");\n        Console.WriteLine($\"   Offset: {offsetPoints:F0} points above Bid\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Resistance {resistanceLevel:F5} is below current Bid!\");\n    }\n}\n\n// Usage:\nawait PlaceSellAtResistance(svc, \"EURUSD\", resistanceLevel: 1.0950);\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-6-with-order-comment","title":"Example 6: With Order Comment","text":"<pre><code>// Sell Limit with strategy identifier\nvar result = await svc.SellLimitPoints(\n    symbol: \"GBPUSD\",\n    volume: 0.02,\n    priceOffsetPoints: 40,\n    slPoints: 30,\n    tpPoints: 90,\n    comment: \"SellRally_Strategy_v2\");\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} - Comment: SellRally_Strategy_v2\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-7-calculate-entry-price-before-placing","title":"Example 7: Calculate Entry Price Before Placing","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble offsetPoints = 50;\n\n// Calculate what the entry price will be\ndouble entryPrice = tick.Bid + offsetPoints * point;\n\nConsole.WriteLine($\"Current Bid: {tick.Bid:F5}\");\nConsole.WriteLine($\"Entry will be: {entryPrice:F5} (50 points above)\");\nConsole.WriteLine($\"Placing order...\");\n\nvar result = await svc.SellLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: offsetPoints,\n    slPoints: 20,\n    tpPoints: 60);\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} placed at ~{entryPrice:F5}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    var result = await svc.SellLimitPoints(\n        \"EURUSD\",\n        0.01,\n        priceOffsetPoints: 50,\n        slPoints: 20,\n        tpPoints: 60);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Success: Ticket #{result.Order}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n        Console.WriteLine($\"   Return code: {result.ReturnedCode}\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-9-risk-based-volume-with-sell-limit","title":"Example 9: Risk-Based Volume with Sell Limit","text":"<pre><code>// Calculate volume based on risk\ndouble riskMoney = 100.0;\ndouble slPoints = 30;\n\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskMoney);\n\n// Place Sell Limit with calculated volume\nvar result = await svc.SellLimitPoints(\n    \"EURUSD\",\n    volume: volume,\n    priceOffsetPoints: 40,\n    slPoints: slPoints,\n    tpPoints: 100);\n\nConsole.WriteLine($\"\u2705 Risk-based order placed:\");\nConsole.WriteLine($\"   Volume: {volume} lots\");\nConsole.WriteLine($\"   Risk: ${riskMoney} if SL hit\");\nConsole.WriteLine($\"   Ticket: #{result.Order}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#example-10-overbought-sell-strategy","title":"Example 10: Overbought Sell Strategy","text":"<pre><code>public async Task SellWhenOverbought(MT5Service svc, string symbol)\n{\n    // Assume we have RSI indicator showing overbought\n    double rsi = 75.0;  // Overbought threshold: 70+\n\n    if (rsi &gt; 70)\n    {\n        Console.WriteLine($\"RSI {rsi} is overbought. Placing Sell Limit above.\");\n\n        // Place Sell Limit slightly above current price\n        // to catch the rally before reversal\n        var result = await svc.SellLimitPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: 20,  // Small offset - expect reversal soon\n            slPoints: 40,           // Tight stop\n            tpPoints: 100,          // Larger target\n            comment: $\"OverboughtSell_RSI{rsi:F0}\");\n\n        if (result.ReturnedCode == 10009)\n        {\n            Console.WriteLine($\"\u2705 Sell Limit placed: #{result.Order}\");\n            Console.WriteLine($\"   Waiting for rally to {20} points above\");\n        }\n    }\n}\n\n// Usage:\nawait SellWhenOverbought(svc, \"EURUSD\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes entry price</li> <li><code>OrderSendAsync()</code> - Sends pending order request</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>BuyLimitPoints()</code> - Buy Limit with point-based offset</li> <li><code>BuyStopPoints()</code> - Buy Stop with point-based offset</li> <li><code>SellStopPoints()</code> - Sell Stop with point-based offset</li> <li><code>PlacePending()</code> - Generic pending order (requires absolute price)</li> <li><code>PriceFromOffsetPointsAsync()</code> - Calculate price only (no order placement)</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>PlacePending()</code> - More flexible but requires manual price calculation</li> <li><code>PriceFromOffsetPointsAsync()</code> + <code>PlacePending()</code> - Two-step approach</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing offset direction: <pre><code>// \u274c WRONG: Thinking offset is BELOW Bid\n// Sell Limit is ALWAYS above current Bid!\n\n// \u2705 CORRECT: Offset is distance ABOVE Bid\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n// Places order 50 points ABOVE current Bid\n</code></pre></p> </li> <li> <p>Negative offset (method handles it): <pre><code>// \u26a0\ufe0f Method uses Math.Abs(), so negative works but is confusing\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: -50);\n// Same as priceOffsetPoints: 50 (absolute value taken)\n\n// \u2705 BETTER: Always use positive values\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>SL/TP direction confusion: <pre><code>// \u2705 CORRECT: SL/TP are distances FROM ENTRY, not from current price\nawait svc.SellLimitPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: 50,\n    slPoints: 20,  // 20 points ABOVE entry price (opposite direction)\n    tpPoints: 60); // 60 points BELOW entry price (profit direction)\n\n// NOT from current Bid! They're relative to calculated entry.\n</code></pre></p> </li> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// For 5-digit broker, this is 0.5 pips, not 5 pips!\n\n// \u2705 CORRECT: Convert pips to points for 5-digit brokers\ndouble pips = 5;\ndouble points = pips * 10;  // 1 pip = 10 points on 5-digit\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: points);\n</code></pre></p> </li> <li> <p>Offset too small (broker minimum distance): <pre><code>// \u274c May fail if offset violates broker's minimum stop level\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// Broker may require minimum 10 points distance\n\n// \u2705 CORRECT: Check broker requirements\n// Most brokers require 10-50 points minimum for pending orders\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>Confusing with Buy Limit: <pre><code>// \u274c WRONG: Using Buy Limit logic for Sell\n// Buy Limit = BELOW current price\n// Sell Limit = ABOVE current price\n\n// \u2705 CORRECT: Remember the logic\nawait svc.BuyLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n// -&gt; 50 points BELOW Ask (buy cheaper)\n\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n// -&gt; 50 points ABOVE Bid (sell higher)\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellLimitPoints/#summary","title":"\ud83d\udca1 Summary","text":"<p>SellLimitPoints simplifies Sell Limit order placement:</p> <ul> <li>\u2705 Work in points, not absolute prices</li> <li>\u2705 Auto-calculates entry price ABOVE Bid</li> <li>\u2705 SL/TP as point distances from entry</li> <li>\u2705 Auto-normalizes prices to tick size</li> <li>\u2705 Perfect for sell-on-rally strategies</li> </ul> <pre><code>// Instead of manual calculation:\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble price = tick.Bid + 50 * 0.00001;  // \u274c Manual, error-prone\nawait svc.PlacePending(\"EURUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeSellLimit, price, ...);\n\n// Use one clean call:\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);  // \u2705 Clean!\n</code></pre> <p>Sell the rally with precision! \ud83d\ude80</p>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/","title":"Sell Stop by Points (<code>SellStopPoints</code>)","text":"<p>Sugar method: Places Sell Stop pending order using point-based offset from current Bid price - downside breakout made easy!</p> <p>API Information:</p> <ul> <li>Extension method: <code>MT5Service.SellStopPoints(...)</code> (from <code>MT5ServiceExtensions</code>)</li> <li>Package: Part of <code>mt5_term_api</code> library</li> <li>Region: [09] PENDING HELPERS (BY POINTS)</li> <li>Underlying calls: <code>SymbolInfoTickAsync()</code> + <code>SymbolInfoDoubleAsync()</code> + <code>NormalizePriceAsync()</code> + <code>OrderSendAsync()</code></li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#method-signature","title":"Method Signature","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SellStopPoints(\n    this MT5Service svc,\n    string symbol,\n    double volume,\n    double priceOffsetPoints,\n    double? slPoints = null,\n    double? tpPoints = null,\n    string? comment = null,\n    int deviationPoints = 0,\n    int timeoutSec = 15,\n    CancellationToken ct = default)\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#input","title":"\ud83d\udd3d Input","text":"Parameter Type Description <code>svc</code> <code>MT5Service</code> MT5Service instance (extension method) <code>symbol</code> <code>string</code> Symbol name (e.g., \"EURUSD\", \"XAUUSD\") <code>volume</code> <code>double</code> Volume in lots (e.g., 0.01, 0.1, 1.0) <code>priceOffsetPoints</code> <code>double</code> Distance in points below current Bid (always positive) <code>slPoints</code> <code>double?</code> Optional stop-loss distance in points above entry price <code>tpPoints</code> <code>double?</code> Optional take-profit distance in points below entry price <code>comment</code> <code>string?</code> Optional order comment <code>deviationPoints</code> <code>int</code> Maximum price deviation in points (default: 0) <code>timeoutSec</code> <code>int</code> RPC timeout in seconds (default: 15) <code>ct</code> <code>CancellationToken</code> Cancellation token"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#output","title":"\u2b06\ufe0f Output","text":"Type Description <code>Task&lt;OrderSendData&gt;</code> Order send result with ticket number and execution details <p>Key fields:</p> <ul> <li><code>Order</code> - Order ticket number (ulong)</li> <li><code>ReturnedCode</code> - MT5 return code (10009 = success)</li> <li><code>Comment</code> - Server response comment</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#just-the-essentials","title":"\ud83d\udcac Just the essentials","text":"<ul> <li>What it is: Sell Stop helper - places order BELOW current Bid using point-based offset. Triggers when price breaks DOWN.</li> <li>Why you need it: Perfect for breakdown strategies! No manual price calculation - just specify distance below current price.</li> <li>Sanity check: Sell Stop = sell BELOW current price (chase downside momentum). Order executes when price falls to trigger level.</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Use it for:</p> <ul> <li>Support breakdown entries - Sell when price breaks support</li> <li>Downside momentum - Chase downward price movement</li> <li>Downtrend continuation - Enter short when downtrend confirmed</li> <li>Stop and reverse - Exit long + enter short simultaneously</li> <li>Triggered limit orders - Activate sell after confirmation</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#under-the-hood","title":"\ud83d\udd27 Under the Hood","text":"<pre><code>// Step 1: Get current market quote\nvar tick = await svc.SymbolInfoTickAsync(symbol, deadline, ct);\nvar point = await svc.SymbolInfoDoubleAsync(symbol, SymbolPoint, deadline, ct);\n\n// Step 2: Calculate entry price (BELOW Bid for Sell Stop)\nvar rawPrice = tick.Bid - Math.Abs(priceOffsetPoints) * point;\nvar price = await svc.NormalizePriceAsync(symbol, rawPrice, timeoutSec, ct);\n\n// Step 3: Calculate SL/TP from entry price\ndouble sl = slPoints.HasValue ? price + slPoints.Value * point : 0;\ndouble tp = tpPoints.HasValue ? price - tpPoints.Value * point : 0;\n\n// Step 4: Build and send pending order request (operationCode: 5 = SellStop)\nvar req = BuildPendingRequest(symbol, volume, price, sl, tp, comment, deviationPoints, 5);\nreturn await svc.OrderSendAsync(req, deadline, ct);\n</code></pre> <p>What it improves:</p> <ul> <li>Auto price calculation - converts points to absolute price</li> <li>Auto Bid/Ask selection - uses Bid as base for Sell orders</li> <li>Auto normalization - price rounded to tick size</li> <li>Point-based SL/TP - distances from entry, not from current price</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#usage-examples","title":"\ud83d\udd17 Usage Examples","text":""},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-1-basic-sell-stop-50-points-below","title":"Example 1: Basic Sell Stop 50 Points Below","text":"<pre><code>// Sell Stop 50 points below current Bid\nvar result = await svc.SellStopPoints(\n    symbol: \"EURUSD\",\n    volume: 0.01,\n    priceOffsetPoints: 50);\n\nif (result.ReturnedCode == 10009)\n{\n    Console.WriteLine($\"\u2705 Sell Stop placed: Ticket #{result.Order}\");\n    Console.WriteLine($\"   Will trigger 50 points below current Bid\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-2-sell-stop-with-sl-and-tp","title":"Example 2: Sell Stop with SL and TP","text":"<pre><code>// Sell Stop 30 points below with 20-point SL and 60-point TP\nvar result = await svc.SellStopPoints(\n    symbol: \"EURUSD\",\n    volume: 0.05,\n    priceOffsetPoints: 30,\n    slPoints: 20,   // 20 points above entry\n    tpPoints: 60);  // 60 points below entry\n\nConsole.WriteLine($\"\u2705 Order #{result.Order}\");\nConsole.WriteLine($\"   Trigger: 30 points below Bid\");\nConsole.WriteLine($\"   SL: 20 points, TP: 60 points\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-3-support-breakdown-entry","title":"Example 3: Support Breakdown Entry","text":"<pre><code>public async Task PlaceSellStopAtSupport(\n    MT5Service svc,\n    string symbol,\n    double supportLevel)\n{\n    // Get current Bid\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    // Calculate offset from current Bid to support breakdown\n    double offsetPrice = tick.Bid - supportLevel;\n    double offsetPoints = offsetPrice / point;\n\n    if (offsetPoints &gt; 0)  // Support is below current price\n    {\n        // Place Sell Stop just below support\n        var result = await svc.SellStopPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: offsetPoints + 10,  // 10 points below support\n            slPoints: 50,\n            tpPoints: 150,\n            comment: \"SupportBreakdown\");\n\n        Console.WriteLine($\"\u2705 Sell Stop at {supportLevel:F5} - 10pts\");\n        Console.WriteLine($\"   Ticket: #{result.Order}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u26a0\ufe0f Support {supportLevel:F5} is above current Bid!\");\n    }\n}\n\n// Usage:\nawait PlaceSellStopAtSupport(svc, \"EURUSD\", supportLevel: 1.0850);\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-4-atr-based-breakdown","title":"Example 4: ATR-Based Breakdown","text":"<pre><code>// Use ATR for dynamic breakdown threshold\ndouble atr = 0.0015;  // ATR value for EURUSD\ndouble point = await svc.GetPointAsync(\"EURUSD\");\n\n// Convert ATR to points\ndouble atrPoints = atr / point;\n\n// Place Sell Stop at 1x ATR below (strong breakdown)\nvar result = await svc.SellStopPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: atrPoints * 1.0,\n    slPoints: atrPoints * 0.5,   // Tight stop (already in momentum)\n    tpPoints: atrPoints * 2.0);  // 2x ATR target\n\nConsole.WriteLine($\"ATR-based Sell Stop: {atrPoints:F0} points below\");\nConsole.WriteLine($\"  SL: {atrPoints * 0.5:F0}pts, TP: {atrPoints * 2.0:F0}pts\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-5-multiple-sell-stops-scaling-in","title":"Example 5: Multiple Sell Stops (Scaling In)","text":"<pre><code>// Place multiple Sell Stops at different levels\n// (scaling into position as downside momentum builds)\nint[] offsets = { 30, 60, 90 };\ndouble[] volumes = { 0.01, 0.02, 0.03 };  // Pyramid down\n\nConsole.WriteLine(\"Placing Sell Stop pyramid:\");\nfor (int i = 0; i &lt; offsets.Length; i++)\n{\n    var result = await svc.SellStopPoints(\n        \"EURUSD\",\n        volumes[i],\n        priceOffsetPoints: offsets[i],\n        slPoints: 40,\n        tpPoints: 120);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"  \u2705 {offsets[i]}pts below: {volumes[i]} lots - Ticket #{result.Order}\");\n    }\n}\n\n// Output:\n// Placing Sell Stop pyramid:\n//   \u2705 30pts below: 0.01 lots - Ticket #12358\n//   \u2705 60pts below: 0.02 lots - Ticket #12359\n//   \u2705 90pts below: 0.03 lots - Ticket #12360\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-6-round-number-breakdown","title":"Example 6: Round Number Breakdown","text":"<pre><code>public async Task PlaceSellStopAtRoundNumber(\n    MT5Service svc,\n    string symbol,\n    double roundNumber)\n{\n    var tick = await svc.SymbolInfoTickAsync(symbol);\n    double point = await svc.GetPointAsync(symbol);\n\n    // Calculate offset to round number\n    double offsetPrice = tick.Bid - roundNumber;\n    double offsetPoints = offsetPrice / point;\n\n    if (offsetPoints &gt; 5)  // Only if round number is at least 5 points away\n    {\n        var result = await svc.SellStopPoints(\n            symbol,\n            0.01,\n            priceOffsetPoints: offsetPoints,\n            slPoints: 30,\n            tpPoints: 100,\n            comment: $\"RoundBreak_{roundNumber}\");\n\n        Console.WriteLine($\"\u2705 Sell Stop at {roundNumber:F5}\");\n        Console.WriteLine($\"   Offset: {offsetPoints:F0} points below Bid\");\n    }\n}\n\n// Usage - wait for break below 1.0800\nawait PlaceSellStopAtRoundNumber(svc, \"EURUSD\", roundNumber: 1.0800);\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-7-with-order-comment","title":"Example 7: With Order Comment","text":"<pre><code>// Sell Stop with strategy identifier\nvar result = await svc.SellStopPoints(\n    symbol: \"GBPUSD\",\n    volume: 0.02,\n    priceOffsetPoints: 50,\n    slPoints: 30,\n    tpPoints: 100,\n    comment: \"Breakdown_Strategy_v3\");\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} - Comment: Breakdown_Strategy_v3\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-8-error-handling","title":"Example 8: Error Handling","text":"<pre><code>try\n{\n    var result = await svc.SellStopPoints(\n        \"EURUSD\",\n        0.01,\n        priceOffsetPoints: 50,\n        slPoints: 20,\n        tpPoints: 80);\n\n    if (result.ReturnedCode == 10009)\n    {\n        Console.WriteLine($\"\u2705 Success: Ticket #{result.Order}\");\n    }\n    else\n    {\n        Console.WriteLine($\"\u274c Order failed: {result.Comment}\");\n        Console.WriteLine($\"   Return code: {result.ReturnedCode}\");\n    }\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\u274c Exception: {ex.Message}\");\n}\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-9-risk-based-volume-with-sell-stop","title":"Example 9: Risk-Based Volume with Sell Stop","text":"<pre><code>// Calculate volume based on risk\ndouble riskMoney = 100.0;\ndouble slPoints = 30;\n\ndouble volume = await svc.CalcVolumeForRiskAsync(\n    \"EURUSD\",\n    stopPoints: slPoints,\n    riskMoney: riskMoney);\n\n// Place Sell Stop with calculated volume\nvar result = await svc.SellStopPoints(\n    \"EURUSD\",\n    volume: volume,\n    priceOffsetPoints: 40,\n    slPoints: slPoints,\n    tpPoints: 120);\n\nConsole.WriteLine($\"\u2705 Risk-based Sell Stop placed:\");\nConsole.WriteLine($\"   Volume: {volume} lots\");\nConsole.WriteLine($\"   Risk: ${riskMoney} if SL hit\");\nConsole.WriteLine($\"   Ticket: #{result.Order}\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#example-10-calculate-trigger-price-before-placing","title":"Example 10: Calculate Trigger Price Before Placing","text":"<pre><code>var tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble point = await svc.GetPointAsync(\"EURUSD\");\ndouble offsetPoints = 50;\n\n// Calculate what the trigger price will be\ndouble triggerPrice = tick.Bid - offsetPoints * point;\n\nConsole.WriteLine($\"Current Bid: {tick.Bid:F5}\");\nConsole.WriteLine($\"Trigger will be: {triggerPrice:F5} (50 points below)\");\nConsole.WriteLine($\"Placing Sell Stop...\");\n\nvar result = await svc.SellStopPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: offsetPoints,\n    slPoints: 20,\n    tpPoints: 80);\n\nConsole.WriteLine($\"\u2705 Order #{result.Order} - triggers at ~{triggerPrice:F5}\");\nConsole.WriteLine($\"   Waiting for breakdown...\");\n</code></pre>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#related-methods","title":"\ud83d\udd17 Related Methods","text":"<p>\ud83d\udce6 Methods used internally:</p> <ul> <li><code>SymbolInfoTickAsync()</code> - Gets current Bid/Ask</li> <li><code>SymbolInfoDoubleAsync(SymbolPoint)</code> - Gets point size</li> <li><code>NormalizePriceAsync()</code> - Normalizes trigger price</li> <li><code>OrderSendAsync()</code> - Sends pending order request</li> </ul> <p>\ud83c\udf6c Related Sugar methods:</p> <ul> <li><code>BuyStopPoints()</code> - Buy Stop with point-based offset</li> <li><code>BuyLimitPoints()</code> - Buy Limit with point-based offset</li> <li><code>SellLimitPoints()</code> - Sell Limit with point-based offset</li> <li><code>PlacePending()</code> - Generic pending order (requires absolute price)</li> <li><code>PriceFromOffsetPointsAsync()</code> - Calculate price only (no order placement)</li> </ul> <p>\ud83d\udcca Alternative approaches:</p> <ul> <li><code>PlacePending()</code> - More flexible but requires manual price calculation</li> <li><code>PriceFromOffsetPointsAsync()</code> + <code>PlacePending()</code> - Two-step approach</li> </ul>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#common-pitfalls","title":"\u26a0\ufe0f Common Pitfalls","text":"<ol> <li> <p>Confusing with Sell Limit: <pre><code>// \u274c CONFUSION: Sell Limit vs Sell Stop\n// Sell Limit = ABOVE current price (sell higher)\n// Sell Stop = BELOW current price (chase downside)\n\n// \u2705 CORRECT usage:\nawait svc.SellLimitPoints(\"EURUSD\", 0.01, 50);  // 50 pts ABOVE (rally)\nawait svc.SellStopPoints(\"EURUSD\", 0.01, 50);   // 50 pts BELOW (breakdown)\n</code></pre></p> </li> <li> <p>Negative offset (method handles it): <pre><code>// \u26a0\ufe0f Method uses Math.Abs(), so negative works but is confusing\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: -50);\n// Same as priceOffsetPoints: 50 (absolute value taken)\n\n// \u2705 BETTER: Always use positive values\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>SL/TP direction confusion: <pre><code>// \u2705 CORRECT: SL/TP are distances FROM ENTRY, not from current price\nawait svc.SellStopPoints(\n    \"EURUSD\",\n    0.01,\n    priceOffsetPoints: 50,\n    slPoints: 20,  // 20 points ABOVE entry price (opposite direction)\n    tpPoints: 80); // 80 points BELOW entry price (profit direction)\n\n// Entry is 50 points below current Bid, then SL/TP from there!\n</code></pre></p> </li> <li> <p>Using pips instead of points: <pre><code>// \u274c WRONG: Confusing pips with points\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// For 5-digit broker, this is 0.5 pips, not 5 pips!\n\n// \u2705 CORRECT: Convert pips to points for 5-digit brokers\ndouble pips = 5;\ndouble points = pips * 10;  // 1 pip = 10 points on 5-digit\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: points);\n</code></pre></p> </li> <li> <p>Offset too small (broker minimum distance): <pre><code>// \u274c May fail if offset violates broker's minimum stop level\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 5);\n// Broker may require minimum 10-50 points distance\n\n// \u2705 CORRECT: Check broker requirements\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);\n</code></pre></p> </li> <li> <p>Not understanding execution: <pre><code>// \u26a0\ufe0f Sell Stop does NOT execute immediately!\nvar result = await svc.SellStopPoints(\"EURUSD\", 0.01, 50);\n// Order is PENDING until price falls 50 points\n\n// Only executes if/when Bid reaches trigger level\n// If price never reaches, order stays pending forever\n</code></pre></p> </li> </ol>"},{"location":"MT5Sugar/9.%20Pending_ByPoints/SellStopPoints/#summary","title":"\ud83d\udca1 Summary","text":"<p>SellStopPoints simplifies Sell Stop order placement:</p> <ul> <li>\u2705 Work in points, not absolute prices</li> <li>\u2705 Auto-calculates trigger price BELOW Bid</li> <li>\u2705 SL/TP as point distances from entry</li> <li>\u2705 Auto-normalizes prices to tick size</li> <li>\u2705 Perfect for breakdown strategies</li> </ul> <pre><code>// Instead of manual calculation:\nvar tick = await svc.SymbolInfoTickAsync(\"EURUSD\");\ndouble price = tick.Bid - 50 * 0.00001;  // \u274c Manual, error-prone\nawait svc.PlacePending(\"EURUSD\", 0.01, ENUM_ORDER_TYPE.OrderTypeSellStop, price, ...);\n\n// Use one clean call:\nawait svc.SellStopPoints(\"EURUSD\", 0.01, priceOffsetPoints: 50);  // \u2705 Clean!\n</code></pre> <p>Catch the breakdown with confidence! \ud83d\ude80</p>"},{"location":"Strategies/Strategies.Master.Overview/","title":"Strategies - Master Overview","text":"<p>One page to orient fast: what orchestrators and presets are available, how to choose the right strategy, and jump links to every strategy spec in this docs set.</p>"},{"location":"Strategies/Strategies.Master.Overview/#important-disclaimer","title":"\u26a0\ufe0f IMPORTANT DISCLAIMER","text":"<p>\ud83c\udf93 EDUCATIONAL &amp; DEMONSTRATION PURPOSE ONLY</p> <p>All orchestrators and presets in this documentation are DEMONSTRATION EXAMPLES designed to showcase the CSharpMT5 API capabilities and serve as templates for building your own trading strategies.</p> <p>These are NOT production-ready trading systems.</p>"},{"location":"Strategies/Strategies.Master.Overview/#critical-limitations","title":"Critical Limitations:","text":"<ol> <li> <p>Simplified Market Analysis:</p> </li> <li> <p>Volatility calculation uses basic formula (<code>spread \u00d7 10</code>)</p> </li> <li>News detection uses hardcoded UTC schedule (not real economic calendar)</li> <li> <p>No advanced technical indicators or ML-based analysis</p> </li> <li> <p>No Risk Management:</p> </li> <li> <p>No account balance protection</p> </li> <li>No drawdown limits</li> <li>No position correlation analysis</li> <li> <p>No portfolio-level risk controls</p> </li> <li> <p>Basic Execution Logic:</p> </li> <li> <p>No slippage handling</p> </li> <li>No adverse market condition detection</li> <li>No dynamic parameter adjustment</li> </ol>"},{"location":"Strategies/Strategies.Master.Overview/#demo-accounts-only","title":"\u26a0\ufe0f DEMO ACCOUNTS ONLY","text":"<p>NEVER use these strategies on live accounts without:</p> <ul> <li>Complete understanding of the algorithm</li> <li>Comprehensive backtesting on historical data</li> <li>Forward testing on demo accounts for extended periods</li> <li>Proper risk management implementation</li> <li>Real-time monitoring and alerting systems</li> <li>Professional trading strategy validation</li> </ul> <p>Recommended approach:</p> <ol> <li>Study the code and understand every line</li> <li>Test on demo accounts extensively</li> <li>Modify and enhance with proper risk management</li> <li>Build your own strategies using these as templates</li> <li>Only after thorough validation, consider live trading with minimal capital</li> </ol> <p>By using these strategies, you acknowledge that:</p> <ul> <li>You are fully responsible for any trading decisions</li> <li>These are educational examples, not investment advice</li> <li>Trading involves substantial risk of loss</li> <li>Past performance does not guarantee future results</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#start-here-strategy-types","title":"\ud83d\udea6 Start here - Strategy Types","text":""},{"location":"Strategies/Strategies.Master.Overview/#orchestrators-single-strategy-execution","title":"Orchestrators - Single-Strategy Execution","text":"<p>What: Individual trading strategies that execute one specific algorithm.</p> <p>When to use:</p> <ul> <li>You know exactly which strategy fits current market conditions</li> <li>Testing or optimizing a specific trading approach</li> <li>Building custom presets with specific orchestrator combinations</li> </ul> <p>Available Orchestrators:</p> <ul> <li> <p>GridTradingOrchestrator - Grid trading for range-bound markets</p> </li> <li> <p>SimpleScalpingOrchestrator - Quick scalping trades with tight stops</p> </li> <li> <p>QuickHedgeOrchestrator - Hedging strategy for high volatility</p> </li> <li> <p>NewsStraddleOrchestrator - Breakout trading around news events</p> </li> <li> <p>PendingBreakoutOrchestrator - Pending orders for breakout trading</p> </li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#presets-multi-strategy-systems","title":"Presets - Multi-Strategy Systems","text":"<p>What: Intelligent systems that combine multiple orchestrators with automatic strategy selection based on market analysis.</p> <p>When to use:</p> <ul> <li> <p>Want automated strategy selection based on market conditions</p> </li> <li> <p>Running strategies without constant monitoring</p> </li> <li> <p>Testing complex multi-strategy systems</p> </li> <li> <p>Production trading with adaptive behavior</p> </li> </ul> <p>Available Presets:</p> <ul> <li>AdaptiveMarketModePreset - Intelligent multi-strategy system that analyzes market and selects optimal orchestrator</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#quick-strategy-selector","title":"\ud83e\udded Quick Strategy Selector","text":"<p>Range-bound / Low volatility \u2192 GridTradingOrchestrator Captures oscillations within tight range.</p> <p>Normal volatility / Trending \u2192 SimpleScalpingOrchestrator Quick entries/exits with tight risk control.</p> <p>High volatility / Choppy \u2192 QuickHedgeOrchestrator Hedged positions reduce directional risk.</p> <p>News events / Economic calendar \u2192 NewsStraddleOrchestrator Captures breakout in either direction.</p> <p>Technical breakout setup \u2192 PendingBreakoutOrchestrator Pending orders at key levels.</p> <p>Unknown / Dynamic conditions \u2192 AdaptiveMarketModePreset Automatically selects best strategy.</p>"},{"location":"Strategies/Strategies.Master.Overview/#full-index-all-strategy-specs","title":"\ud83d\udcda Full Index \u00b7 All Strategy Specs","text":""},{"location":"Strategies/Strategies.Master.Overview/#orchestrators","title":"\ud83c\udfaf Orchestrators","text":""},{"location":"Strategies/Strategies.Master.Overview/#grid-trading","title":"Grid Trading","text":"<ul> <li> <p>GridTradingOrchestrator.md - Complete specification.</p> </li> <li> <p>GridTradingOrchestrator.HOW_IT_WORKS.md - Detailed algorithm explanation.</p> </li> </ul> <p>Key Features:</p> <ul> <li>Places Buy Limit orders below price, Sell Limit orders above</li> <li>Configurable grid levels and spacing</li> <li>Automatic TP/SL for each level</li> <li>Best for: Range-bound markets (low volatility &lt; 15 points)</li> </ul> <p>Quick Start: <pre><code>dotnet run grid\n</code></pre></p> <p>Configuration Example: <pre><code>var orchestrator = new GridTradingOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    GridLevels = 3,              // 3 levels each direction\n    GridSpacingPoints = 20,      // 20 points between levels\n    VolumePerLevel = 0.01,       // 0.01 lots per level\n    StopLossPoints = 50,         // 50 points SL\n    TakeProfitPoints = 30,       // 30 points TP\n    MaxRunMinutes = 15           // Run for 15 minutes\n};\n</code></pre></p>"},{"location":"Strategies/Strategies.Master.Overview/#scalping","title":"Scalping","text":"<ul> <li> <p>SimpleScalpingOrchestrator.md - Complete specification.</p> </li> <li> <p>SimpleScalpingOrchestrator.HOW_IT_WORKS.md - Detailed algorithm explanation.</p> </li> </ul> <p>Key Features:</p> <ul> <li>Quick market entries with tight stops</li> <li>Risk-based position sizing</li> <li>Configurable hold time (seconds)</li> <li>Random or fixed direction</li> <li>Best for: Normal volatility (15-40 points)</li> </ul> <p>Quick Start: <pre><code>dotnet run scalping\n</code></pre></p> <p>Configuration Example: <pre><code>var orchestrator = new SimpleScalpingOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    RiskAmount = 20.0,           // Risk $20 per trade\n    StopLossPoints = 15,         // 15 points SL\n    TakeProfitPoints = 25,       // 25 points TP (R:R \u2248 1:1.67)\n    MaxHoldSeconds = 60,         // Hold max 60 seconds\n    IsBuy = true                 // Buy direction (or false for Sell)\n};\n</code></pre></p>"},{"location":"Strategies/Strategies.Master.Overview/#hedging","title":"Hedging","text":"<ul> <li> <p>QuickHedgeOrchestrator.md - Complete specification.</p> </li> <li> <p>QuickHedgeOrchestrator.HOW_IT_WORKS.md - Detailed algorithm explanation.</p> </li> </ul> <p>Key Features:</p> <ul> <li>Opens hedged positions (Buy + Sell simultaneously)</li> <li>Closes losing position, keeps winner</li> <li>Reduces directional risk</li> <li>Best for: High volatility (&gt; 40 points)</li> </ul> <p>Quick Start: <pre><code>dotnet run hedge\n</code></pre></p> <p>Configuration Example: <pre><code>var orchestrator = new QuickHedgeOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,               // 0.01 lots per position\n    StopLossPoints = 30,         // 30 points SL\n    TakeProfitPoints = 50,       // 50 points TP\n    MaxHoldSeconds = 120         // Hold max 2 minutes\n};\n</code></pre></p>"},{"location":"Strategies/Strategies.Master.Overview/#news-straddle","title":"News Straddle","text":"<ul> <li> <p>NewsStraddleOrchestrator.md - Complete specification.</p> </li> <li> <p>NewsStraddleOrchestrator.HOW_IT_WORKS.md - Detailed algorithm explanation.</p> </li> </ul> <p>Key Features:</p> <ul> <li>Places Buy Stop above + Sell Stop below current price</li> <li>Captures breakout in either direction</li> <li>Cancels opposite order after one triggers</li> <li>Best for: News events (UTC schedule: 08:30, 12:30, 14:00, 18:00, 19:00)</li> </ul> <p>Quick Start: <pre><code>dotnet run news\n</code></pre></p> <p>Configuration Example: <pre><code>var orchestrator = new NewsStraddleOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,               // 0.01 lots per position\n    DistancePoints = 30,         // 30 points above/below price\n    StopLossPoints = 20,         // 20 points SL\n    TakeProfitPoints = 40,       // 40 points TP\n    MaxWaitSeconds = 300         // Wait max 5 minutes\n};\n</code></pre></p>"},{"location":"Strategies/Strategies.Master.Overview/#pending-breakout","title":"Pending Breakout","text":"<ul> <li> <p>PendingBreakoutOrchestrator.md - Complete specification.</p> </li> <li> <p>PendingBreakoutOrchestrator.HOW_IT_WORKS.md - Detailed algorithm explanation.</p> </li> </ul> <p>Key Features:</p> <ul> <li>Places pending orders at technical levels</li> <li>Multiple levels with configurable spacing</li> <li>Automatic order management</li> <li>Best for: Technical breakout setups (spread &gt; 3 points)</li> </ul> <p>Quick Start: <pre><code>dotnet run breakout\n</code></pre></p> <p>Configuration Example: <pre><code>var orchestrator = new PendingBreakoutOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    Volume = 0.01,               // 0.01 lots per order\n    Levels = 3,                  // 3 pending orders\n    LevelSpacingPoints = 25,     // 25 points between levels\n    StopLossPoints = 40,         // 40 points SL\n    TakeProfitPoints = 60,       // 60 points TP\n    MaxRunMinutes = 20           // Run for 20 minutes\n};\n</code></pre></p>"},{"location":"Strategies/Strategies.Master.Overview/#presets","title":"\ud83c\udf9b\ufe0f Presets","text":""},{"location":"Strategies/Strategies.Master.Overview/#adaptive-market-mode","title":"Adaptive Market Mode","text":"<ul> <li>AdaptiveMarketModePreset.md - Complete specification with decision tree.</li> </ul> <p>Key Features:</p> <ul> <li>Analyzes market every cycle (5 minutes)</li> <li>Calculates volatility: <code>spread \u00d7 10</code> (simplified)</li> <li>Checks news schedule (hardcoded UTC times)</li> <li>Detects breakouts (spread &gt; 3 points)</li> <li>Automatically selects and executes optimal orchestrator</li> <li>Combines ALL 5 orchestrators into one adaptive system</li> </ul> <p>Decision Tree: <pre><code>1. NEWS TIME? (UTC: 08:30, 12:30, 14:00, 18:00, 19:00)\n   \u2514\u2500\u25ba YES \u2192 NewsStraddleOrchestrator (HIGHEST PRIORITY)\n\n2. SPREAD &gt; 3 points? (Breakout signal)\n   \u2514\u2500\u25ba YES \u2192 PendingBreakoutOrchestrator\n\n3. VOLATILITY &lt; 15 points? (Range-bound)\n   \u2514\u2500\u25ba YES \u2192 GridTradingOrchestrator\n\n4. VOLATILITY &lt; 40 points? (Normal)\n   \u2514\u2500\u25ba YES \u2192 SimpleScalpingOrchestrator\n\n5. DEFAULT (High volatility &gt; 40 points)\n   \u2514\u2500\u25ba QuickHedgeOrchestrator (Protection mode)\n</code></pre></p> <p>Quick Start: <pre><code>dotnet run preset\n</code></pre></p> <p>Configuration Example: <pre><code>var preset = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"EURUSD\",\n    BaseRiskAmount = 20.0,           // Base risk for scalping\n    LowVolatilityThreshold = 15.0,   // &lt; 15 pts = grid\n    HighVolatilityThreshold = 40.0,  // &gt; 40 pts = hedge\n    EnableNewsMode = true,            // Enable news detection\n    MinutesBeforeNews = 10,          // Start 10 min before news\n    CycleDurationMinutes = 5,        // 5 minutes per cycle\n    TotalRunMinutes = 60             // Run for 1 hour\n};\n</code></pre></p>"},{"location":"Strategies/Strategies.Master.Overview/#architecture-overview","title":"\ud83c\udfd7\ufe0f Architecture Overview","text":""},{"location":"Strategies/Strategies.Master.Overview/#three-layer-system","title":"Three-Layer System","text":"<pre><code>LAYER 3: PRESETS\n  Multi-strategy systems with automatic selection\n  \u2022 AdaptiveMarketModePreset\n    \u2193\nLAYER 2: ORCHESTRATORS\n  Single-strategy execution engines\n  \u2022 GridTrading  \u2022 Scalping  \u2022 Hedge\n  \u2022 NewsStraddle \u2022 PendingBreakout\n    \u2193\nLAYER 1: MT5 SERVICE\n  Core trading API (Account, Service, Sugar)\n  \u2022 MT5Account (low-level gRPC)\n  \u2022 MT5Service (simplified wrappers)\n  \u2022 MT5Sugar (high-level helpers)\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#common-features-all-orchestrators","title":"Common Features (All Orchestrators)","text":"<p>Market Analysis:</p> <ul> <li>Real-time volatility calculation</li> <li>Spread monitoring</li> <li>Price movement tracking</li> <li>Time-based conditions</li> </ul> <p>Risk Management:</p> <ul> <li>Configurable stop loss (points)</li> <li>Configurable take profit (points)</li> <li>Volume/lot size control</li> <li>Risk-based position sizing (where applicable)</li> </ul> <p>Execution Control:</p> <ul> <li>Maximum runtime limits</li> <li>Emergency stop functionality</li> <li>Position monitoring</li> <li>Automatic cleanup on exit</li> </ul> <p>Progress Reporting:</p> <ul> <li>Console output with status updates</li> <li>Performance metrics (balance, equity, profit/loss)</li> <li>Order placement confirmations</li> <li>Error handling and logging</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#usage-patterns","title":"\ud83d\udd0c Usage Patterns","text":""},{"location":"Strategies/Strategies.Master.Overview/#running-an-orchestrator","title":"Running an Orchestrator","text":"<pre><code>// 1. Create MT5 connection\nvar config = ConnectionHelper.BuildConfiguration();\nvar account = await ConnectionHelper.CreateAndConnectAccountAsync(config);\nvar service = new MT5Service(account);\n\n// 2. Configure orchestrator\nvar orchestrator = new GridTradingOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    GridLevels = 3,\n    GridSpacingPoints = 20,\n    VolumePerLevel = 0.01,\n    StopLossPoints = 50,\n    TakeProfitPoints = 30,\n    MaxRunMinutes = 15\n};\n\n// 3. Run orchestrator\nawait orchestrator.RunAsync();\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#running-a-preset","title":"Running a Preset","text":"<pre><code>// 1. Create MT5 connection (same as above)\nvar config = ConnectionHelper.BuildConfiguration();\nvar account = await ConnectionHelper.CreateAndConnectAccountAsync(config);\nvar service = new MT5Service(account);\n\n// 2. Configure preset\nvar preset = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"EURUSD\",\n    BaseRiskAmount = 20.0,\n    LowVolatilityThreshold = 15.0,\n    HighVolatilityThreshold = 40.0,\n    EnableNewsMode = true,\n    CycleDurationMinutes = 5,\n    TotalRunMinutes = 60\n};\n\n// 3. Run preset (will automatically select strategies)\nawait preset.RunAsync();\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#command-line-shortcuts","title":"Command-Line Shortcuts","text":"<p>Every orchestrator and preset has multiple command-line aliases:</p> <pre><code># Orchestrators\ndotnet run grid          # or: gridtrading, 9\ndotnet run scalping      # or: scalp, 10\ndotnet run hedge         # or: quickhedge, 11\ndotnet run news          # or: newsstraddle, 12\ndotnet run breakout      # or: pendingbreakout, 13\n\n# Presets\ndotnet run preset        # or: adaptive, adaptivemarket, 14\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#strategy-selection-guide","title":"\ud83c\udfaf Strategy Selection Guide","text":""},{"location":"Strategies/Strategies.Master.Overview/#by-market-volatility","title":"By Market Volatility","text":"<pre><code>LOW VOLATILITY (&lt; 15 points)\n\u2514\u2500\u25ba GridTradingOrchestrator\n    \u2022 Tight range\n    \u2022 Frequent oscillations\n    \u2022 Low spread\n\nMEDIUM VOLATILITY (15-40 points)\n\u2514\u2500\u25ba SimpleScalpingOrchestrator\n    \u2022 Normal movement\n    \u2022 Clear short-term trends\n    \u2022 Moderate spread\n\nHIGH VOLATILITY (&gt; 40 points)\n\u2514\u2500\u25ba QuickHedgeOrchestrator\n    \u2022 Choppy price action\n    \u2022 Wide spread\n    \u2022 Uncertain direction\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#by-market-event","title":"By Market Event","text":"<pre><code>NEWS EVENT (Economic Calendar)\n\u2514\u2500\u25ba NewsStraddleOrchestrator\n    \u2022 High-impact news release\n    \u2022 Expected volatility spike\n    \u2022 Directional breakout likely\n\nTECHNICAL BREAKOUT (Chart Pattern)\n\u2514\u2500\u25ba PendingBreakoutOrchestrator\n    \u2022 Support/resistance level\n    \u2022 Consolidation pattern\n    \u2022 Pending breakout setup\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#by-trading-style","title":"By Trading Style","text":"<pre><code>PASSIVE / HANDS-OFF\n\u2514\u2500\u25ba AdaptiveMarketModePreset\n    \u2022 Let system choose strategy\n    \u2022 Automatic market analysis\n    \u2022 Multi-hour runtime\n\nACTIVE / MANUAL CONTROL\n\u2514\u2500\u25ba Individual Orchestrators\n    \u2022 You analyze market conditions\n    \u2022 Select specific strategy\n    \u2022 Shorter runtime (5-20 minutes)\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#key-concepts","title":"\ud83d\udca1 Key Concepts","text":""},{"location":"Strategies/Strategies.Master.Overview/#volatility-calculation-simplified","title":"Volatility Calculation (Simplified)","text":"<p>All strategies use this simplified volatility metric:</p> <pre><code>var tick = await service.SymbolInfoTickAsync(symbol);\nvar point = await service.GetPointAsync(symbol);\nvar spreadPoints = (tick.Ask - tick.Bid) / point;\nvar volatility = spreadPoints * 10;  // Simplified metric\n</code></pre> <p>Real Production Note: This is a demonstration formula. In real production systems, use proper volatility indicators:</p> <ul> <li>ATR (Average True Range)</li> <li>Standard deviation of price changes</li> <li>Bollinger Band width</li> <li>Historical volatility calculations</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#news-detection-hardcoded-schedule","title":"News Detection (Hardcoded Schedule)","text":"<p>Current Implementation: Hardcoded UTC time schedule. <pre><code>int[] newsHours = { 8, 12, 14, 18, 19 };  // UTC hours\nint[] newsMinutes = { 30 };                // xx:30\n</code></pre></p> <p>Real Production Note: This is a demonstration approach. In real production systems:</p> <ul> <li>Integrate with economic calendar API (e.g., Forex Factory, Investing.com)</li> <li>Parse real news events with impact levels (high/medium/low)</li> <li>Dynamic schedule updates</li> <li>Currency-specific news filtering</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#point-based-calculations","title":"Point-Based Calculations","text":"<p>All orchestrators use points (not pips) for distance calculations:</p> <pre><code>// For EURUSD (5 digits):\n// 1 pip = 10 points\n// 20 points = 2 pips = 0.00020 price distance\n\n// Conversion:\ndouble priceDistance = points * symbolPoint;\ndouble points = priceDistance / symbolPoint;\n</code></pre> <p>Why points? Universal across all instruments (forex, metals, indices, crypto).</p>"},{"location":"Strategies/Strategies.Master.Overview/#risk-management","title":"Risk Management","text":"<p>Position Sizing Options:</p> <ol> <li> <p>Fixed Volume: <code>VolumePerLevel = 0.01</code> (Grid, Hedge, News)</p> </li> <li> <p>Risk-Based: <code>RiskAmount = 20.0</code> (Scalping) - calculates volume based on SL distance</p> </li> </ol> <p>Stop Loss / Take Profit:</p> <ul> <li>Always specified in points</li> <li>Automatically normalized to symbol precision</li> <li>Applied to every order/position</li> </ul> <p>Maximum Runtime:</p> <ul> <li><code>MaxRunMinutes</code> - hard limit on execution time</li> <li>Prevents runaway strategies</li> <li>Automatic cleanup on timeout</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#important-notes","title":"\u26a0\ufe0f Important Notes","text":""},{"location":"Strategies/Strategies.Master.Overview/#trading-environment","title":"Trading Environment","text":"<ul> <li> <p>Demo account first: Always test on demo before live trading</p> </li> <li> <p>Network stability: gRPC connection required throughout runtime</p> </li> <li> <p>Broker compatibility: Some features may not be available on all brokers</p> </li> <li> <p>Hedging support: QuickHedgeOrchestrator requires hedging-enabled account</p> </li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#execution-safety","title":"Execution Safety","text":"<ul> <li> <p>Emergency stop: Press <code>Ctrl+C</code> to stop any strategy immediately</p> </li> <li> <p>Position cleanup: All orchestrators close positions on exit</p> </li> <li> <p>Order cancellation: Pending orders are cancelled on exit</p> </li> <li> <p>Error handling: Connection errors trigger retry logic (3 attempts with exponential backoff)</p> </li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#performance-considerations","title":"Performance Considerations","text":"<ul> <li> <p>Retry logic: Built-in retry with exponential backoff (1s \u2192 2s \u2192 4s)</p> </li> <li> <p>Rate limiting: 3-second delay between order placements</p> </li> <li> <p>Connection pooling: Single gRPC connection shared across operations</p> </li> <li> <p>Progress bars: Visual feedback for long-running operations</p> </li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#best-practices","title":"\ud83d\udccb Best Practices","text":""},{"location":"Strategies/Strategies.Master.Overview/#1-strategy-selection","title":"1. Strategy Selection","text":"<pre><code>// \u274c BAD: Running grid strategy in high volatility\nvar grid = new GridTradingOrchestrator(service)\n{\n    GridLevels = 5,  // Will hit all SL levels quickly!\n    // ...\n};\n\n// \u2705 GOOD: Use preset for automatic selection\nvar preset = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"EURUSD\",\n    // Preset will detect high volatility and switch to hedge\n};\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#2-risk-configuration","title":"2. Risk Configuration","text":"<pre><code>// \u274c BAD: Excessive risk per trade\nvar scalping = new SimpleScalpingOrchestrator(service)\n{\n    RiskAmount = 500.0,  // Too high for demo account!\n    StopLossPoints = 10,  // Very tight SL\n};\n\n// \u2705 GOOD: Conservative risk settings\nvar scalping = new SimpleScalpingOrchestrator(service)\n{\n    RiskAmount = 20.0,   // 1-2% of typical demo balance\n    StopLossPoints = 15, // Reasonable SL distance\n};\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#3-runtime-limits","title":"3. Runtime Limits","text":"<pre><code>// \u274c BAD: No runtime limit\nvar orchestrator = new GridTradingOrchestrator(service)\n{\n    MaxRunMinutes = 999999,  // Runs indefinitely!\n};\n\n// \u2705 GOOD: Reasonable runtime with monitoring\nvar orchestrator = new GridTradingOrchestrator(service)\n{\n    MaxRunMinutes = 15,  // Clear exit condition\n};\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#4-error-handling","title":"4. Error Handling","text":"<pre><code>try\n{\n    await orchestrator.RunAsync();\n}\ncatch (OperationCanceledException)\n{\n    Console.WriteLine(\"Strategy stopped by user (Ctrl+C)\");\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"Strategy error: {ex.Message}\");\n    // Cleanup positions/orders here if needed\n}\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#learning-path","title":"\ud83c\udf93 Learning Path","text":""},{"location":"Strategies/Strategies.Master.Overview/#beginner-path","title":"Beginner Path","text":"<pre><code>1. Start with: GridTradingOrchestrator\n   \u2022 Simplest to understand\n   \u2022 Visual grid concept\n   \u2022 Clear entry/exit rules\n\n2. Study: Program.cs routing logic\n   \u2022 How commands map to orchestrators\n   \u2022 Configuration patterns\n\n3. Read: GridTradingOrchestrator.HOW_IT_WORKS.md\n   \u2022 Understand algorithm step-by-step\n   \u2022 Learn MT5Sugar methods used\n\n4. Experiment: Modify grid parameters\n   \u2022 Change GridLevels\n   \u2022 Adjust GridSpacingPoints\n   \u2022 Test on demo account\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#intermediate-path","title":"Intermediate Path","text":"<pre><code>1. Compare: All 5 orchestrators side-by-side\n   \u2022 Identify common patterns (MT5Service usage)\n   \u2022 See differences in algorithms\n   \u2022 Understand when to use each\n\n2. Study: AdaptiveMarketModePreset\n   \u2022 How it analyzes market conditions\n   \u2022 Decision tree logic\n   \u2022 Orchestrator instantiation\n\n3. Modify: Add custom orchestrator\n   \u2022 Copy existing orchestrator as template\n   \u2022 Implement your algorithm\n   \u2022 Add to Program.cs routing\n\n4. Test: Run preset for extended period\n   \u2022 Observe strategy switching\n   \u2022 Analyze performance across conditions\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#advanced-path","title":"Advanced Path","text":"<pre><code>1. Enhance: Market analysis algorithms\n   \u2022 Replace simplified volatility with ATR\n   \u2022 Integrate real economic calendar API\n   \u2022 Add ML-based condition detection\n\n2. Build: Custom preset with your logic\n   \u2022 Define your market conditions\n   \u2022 Create decision tree\n   \u2022 Combine orchestrators your way\n\n3. Optimize: Parameters via backtesting\n   \u2022 Historical data analysis\n   \u2022 Parameter sensitivity testing\n   \u2022 Walk-forward optimization\n\n4. Production: Deploy with monitoring\n   \u2022 Add logging and metrics\n   \u2022 Implement alerting\n   \u2022 Set up performance tracking\n</code></pre>"},{"location":"Strategies/Strategies.Master.Overview/#related-documentation","title":"\ud83d\udcd6 Related Documentation","text":"<ul> <li> <p>MT5Account - Master Overview - Low-level gRPC API reference.</p> </li> <li> <p>MT5Service Documentation - Simplified wrapper methods.</p> </li> <li> <p>MT5Sugar Documentation - High-level convenience API.</p> </li> <li> <p>GRPC_STREAM_MANAGEMENT.md - Streaming subscriptions guide.</p> </li> <li> <p>Sync_vs_Async.md - Async/sync patterns explained.</p> </li> <li> <p>UserCode_Sandbox_Guide.md - How to write custom strategies.</p> </li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#quick-jump-all-files","title":"\ud83c\udfaf Quick Jump - All Files","text":""},{"location":"Strategies/Strategies.Master.Overview/#orchestrators_1","title":"Orchestrators","text":"<ul> <li>GridTradingOrchestrator.md</li> <li>GridTradingOrchestrator.HOW_IT_WORKS.md</li> <li>SimpleScalpingOrchestrator.md</li> <li>SimpleScalpingOrchestrator.HOW_IT_WORKS.md</li> <li>QuickHedgeOrchestrator.md</li> <li>QuickHedgeOrchestrator.HOW_IT_WORKS.md</li> <li>NewsStraddleOrchestrator.md</li> <li>NewsStraddleOrchestrator.HOW_IT_WORKS.md</li> <li>PendingBreakoutOrchestrator.md</li> <li>PendingBreakoutOrchestrator.HOW_IT_WORKS.md</li> </ul>"},{"location":"Strategies/Strategies.Master.Overview/#presets_1","title":"Presets","text":"<ul> <li>AdaptiveMarketModePreset.md</li> </ul> <p>\"Trade smart, code clean, and may your orchestrators always close positions profitably.\"</p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/","title":"HOW GridTradingOrchestrator WORKS - Detailed Analysis","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#document-purpose","title":"\ud83c\udfaf Document Purpose","text":"<p>Show WHAT the orchestrator consists of and HOW EXACTLY it works at the code, methods and data level.</p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#what-the-orchestrator-is-made-of","title":"\ud83d\udce6 What the orchestrator is made of","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#1-class-structure-lines-13-28","title":"1. Class structure (lines 13-28)","text":"<pre><code>public class GridTradingOrchestrator\n{\n    // SINGLE DEPENDENCY\n    private readonly MT5Service _service;\n\n    // 7 CONFIGURABLE PARAMETERS\n    public string Symbol { get; set; } = \"EURUSD\";\n    public int GridLevels { get; set; } = 3;\n    public int GridSpacingPoints { get; set; } = 20;\n    public double VolumePerLevel { get; set; } = 0.01;\n    public int StopLossPoints { get; set; } = 50;\n    public int TakeProfitPoints { get; set; } = 30;\n    public int MaxRunMinutes { get; set; } = 15;\n\n    // DEPENDENCY INJECTION\n    public GridTradingOrchestrator(MT5Service service)\n    {\n        _service = service;  // \u2190 Get MT5Service from outside\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#dependency-visualization","title":"Dependency visualization","text":"<pre><code>GridTradingOrchestrator\n  Contains: private readonly MT5Service _service\n    \u2193\nMT5Service\n  Contains: private MT5Account _account\n    \u2193\nMT5Account\n  Contains: gRPC Client\n    \u2193\n[MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#how-executeasync-works-step-by-step","title":"\ud83d\udd04 How ExecuteAsync() works - step by step","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#phase-1-initialization-lines-32-46","title":"Phase 1: Initialization (lines 32-46)","text":"<pre><code>public async Task&lt;double&gt; ExecuteAsync(CancellationToken ct = default)\n{\n\n    // \u2502  STEP 1: Output header                              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine(\"\\n+============================================================+\");\n    Console.WriteLine(\"|  GRID TRADING ORCHESTRATOR                                |\");\n    Console.WriteLine(\"+============================================================+\\n\");\n\n\n    // \u2502  STEP 2: Get initial balance                        \n    // \u2502  Used: MT5Service.GetBalanceAsync()                 \n    // \u2502  \u2193 Calls: MT5Account.GetBalanceAsync()              \n    // \u2502    \u2193 Sends gRPC: GetAccountInfoRequest              \n    // \u2502      \u2193 Receives: AccountInfoData                    \n    // \u2502        \u2193 Returns: double balance                    \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var initialBalance = await _service.GetBalanceAsync();\n    Console.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\n\n\n    // \u2502  STEP 3: Get current price                          \n    // \u2502  Used: MT5Service.SymbolInfoTickAsync()             \n    // \u2502  \u2193 Calls: MT5Account.SymbolInfoTickAsync()          \n    // \u2502    \u2193 Sends gRPC: SymbolInfoTickRequest              \n    // \u2502      \u2193 Receives: SymbolInfoTickData                 \n    // \u2502        \u2193 Fields: Bid, Ask, Time, Volume             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await _service.SymbolInfoTickAsync(Symbol);\n    Console.WriteLine($\"  Current: Bid={tick.Bid:F5}, Ask={tick.Ask:F5}\\n\");\n\n    // \u2502  STEP 4: Create list to track orders                \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var placedOrders = new System.Collections.Generic.List&lt;ulong&gt;();\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#phase-2-placing-buy-limit-grid-lines-50-73","title":"Phase 2: Placing Buy Limit grid (lines 50-73)","text":"<pre><code>// \u2502  LOOP: Placing BUY LIMIT orders BELOW current price    \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine($\"  Placing {GridLevels} BUY LIMIT levels...\");\n\nfor (int i = 1; i &lt;= GridLevels; i++)  // i = 1, 2, 3\n{\n    // \u2502  Calculate offset in points                 \n    // \u2502  IMPORTANT: NEGATIVE value!                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var pointsBelow = -(i * GridSpacingPoints);\n\n    // Examples with GridSpacingPoints = 20:\n    // i=1 \u2192 pointsBelow = -(1 \u00d7 20) = -20\n    // i=2 \u2192 pointsBelow = -(2 \u00d7 20) = -40\n    // i=3 \u2192 pointsBelow = -(3 \u00d7 20) = -60\n\n    // \u2502  Call MT5Sugar Extension Method             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var result = await _service.BuyLimitPoints(\n        symbol: Symbol,                    // \"EURUSD\"\n        volume: VolumePerLevel,            // 0.01\n        priceOffsetPoints: pointsBelow,    // -20, -40, -60\n        slPoints: StopLossPoints,          // 50\n        tpPoints: TakeProfitPoints,        // 30\n        comment: $\"Grid-Buy-{i}\"           // \"Grid-Buy-1\"\n    );\n\n    // \u2502  Check result                               \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    if (result.ReturnedCode == 10009)  // 10009 = TRADE_RETCODE_DONE\n    {\n        placedOrders.Add(result.Order);  // Save ticket\n        Console.WriteLine($\"    \u2713 Level {i}: #{result.Order} ({pointsBelow} pts below)\");\n    }\n    else\n    {\n        Console.WriteLine($\"    \u2717 Level {i} failed: {result.Comment}\");\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#how-buylimitpoints-works-inside-mt5sugar","title":"How BuyLimitPoints() works - inside MT5Sugar","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task&lt;OrderSendData&gt; BuyLimitPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // \u2190 RECEIVES -20\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n{\n    // \u2502  STEP 1: Get current Ask price                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    var tick = await service.SymbolInfoTickAsync(symbol);\n    double askPrice = tick.Ask;  // For example: 1.10002\n\n    // \u2502  STEP 2: Get point size for symbol                  \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var symbolInfo = await service.SymbolInfoAsync(symbol);\n    double point = symbolInfo.Point;  // For EURUSD: 0.00001\n\n    // \u2502  STEP 3: Calculate order placement price            \n    // \u2502  priceOffsetPoints = -20                            \n    // \u2502  askPrice = 1.10002                                 \n    // \u2502  point = 0.00001                                    \n    // \u2502  price = 1.10002 + (-20 \u00d7 0.00001)                  \n    // \u2502       = 1.10002 - 0.00020                           \n    // \u2502       = 1.09982                                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double price = askPrice + (priceOffsetPoints * point);\n\n    // \u2502  STEP 4: Calculate SL and TP                        \n    // \u2502  slPoints = 50                                      \n    // \u2502  sl = 1.09982 - (50 \u00d7 0.00001) = 1.09932            \n    // \u2502  tpPoints = 30                                      \n    // \u2502  tp = 1.09982 + (30 \u00d7 0.00001) = 1.10012            \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double sl = slPoints &gt; 0 ? price - (slPoints * point) : 0;\n    double tp = tpPoints &gt; 0 ? price + (tpPoints * point) : 0;\n\n    // \u2502  STEP 5: Call low-level method MT5Service          \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    return await service.BuyLimitAsync(\n        symbol: symbol,      // \"EURUSD\"\n        volume: volume,      // 0.01\n        price: price,        // 1.09982\n        sl: sl,              // 1.09932\n        tp: tp,              // 1.10012\n        comment: comment     // \"Grid-Buy-1\"\n    );\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#phase-3-placing-sell-limit-grid-lines-77-100","title":"Phase 3: Placing Sell Limit grid (lines 77-100)","text":"<pre><code>// \u2502  LOOP: Placing SELL LIMIT orders ABOVE current price   \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine($\"  Placing {GridLevels} SELL LIMIT levels...\");\n\nfor (int i = 1; i &lt;= GridLevels; i++)\n{\n    // \u2502  Calculate offset in points                 \n    // \u2502  IMPORTANT: POSITIVE value!                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var pointsAbove = i * GridSpacingPoints;\n\n    // Examples with GridSpacingPoints = 20:\n    // i=1 \u2192 pointsAbove = 1 \u00d7 20 = +20\n    // i=2 \u2192 pointsAbove = 2 \u00d7 20 = +40\n    // i=3 \u2192 pointsAbove = 3 \u00d7 20 = +60\n\n    var result = await _service.SellLimitPoints(\n        symbol: Symbol,\n        volume: VolumePerLevel,\n        priceOffsetPoints: pointsAbove,    // +20, +40, +60\n        slPoints: StopLossPoints,\n        tpPoints: TakeProfitPoints,\n        comment: $\"Grid-Sell-{i}\"\n    );\n\n    if (result.ReturnedCode == 10009)\n    {\n        placedOrders.Add(result.Order);\n        Console.WriteLine($\"    \u2713 Level {i}: #{result.Order} ({pointsAbove} pts above)\");\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#how-selllimitpoints-works","title":"How SellLimitPoints() works","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task&lt;OrderSendData&gt; SellLimitPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // \u2190 RECEIVES +20\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n{\n    var tick = await service.SymbolInfoTickAsync(symbol);\n    double bidPrice = tick.Bid;  // \u2190 FOR SELL use BID, not Ask!\n\n    var symbolInfo = await service.SymbolInfoAsync(symbol);\n    double point = symbolInfo.Point;\n\n    // \u2502  For SELL: placement price = Bid + offset           \n    // \u2502  priceOffsetPoints = +20                            \n    // \u2502  bidPrice = 1.10000                                 \n    // \u2502  price = 1.10000 + (20 \u00d7 0.00001) = 1.10020         \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double price = bidPrice + (priceOffsetPoints * point);\n\n    // \u2502  For SELL: SL ABOVE entry price (protection)        \n    // \u2502  sl = 1.10020 + (50 \u00d7 0.00001) = 1.10070            \n    // \u2502  For SELL: TP BELOW entry price (profit taking)     \n    // \u2502  tp = 1.10020 - (30 \u00d7 0.00001) = 1.09990            \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double sl = slPoints &gt; 0 ? price + (slPoints * point) : 0;  // + for SELL\n    double tp = tpPoints &gt; 0 ? price - (tpPoints * point) : 0;  // - for SELL\n\n    return await service.SellLimitAsync(\n        symbol: symbol,\n        volume: volume,\n        price: price,    // 1.10020\n        sl: sl,          // 1.10070\n        tp: tp,          // 1.09990\n        comment: comment\n    );\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#result-of-placing-grid","title":"Result of placing grid","text":"<pre><code>After both loops in MT5 Terminal:\n\nPENDING ORDERS (6 orders):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Ticket \u2502    Type     \u2502  Price  \u2502   SL    \u2502   TP    \u2502 Comment \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ...789 \u2502 BUY LIMIT   \u2502 1.09982 \u2502 1.09932 \u2502 1.10012 \u2502 Grid-B-1\u2502\n\u2502 ...790 \u2502 BUY LIMIT   \u2502 1.09962 \u2502 1.09912 \u2502 1.09992 \u2502 Grid-B-2\u2502\n\u2502 ...791 \u2502 BUY LIMIT   \u2502 1.09942 \u2502 1.09892 \u2502 1.09972 \u2502 Grid-B-3\u2502\n\u2502 ...792 \u2502 SELL LIMIT  \u2502 1.10020 \u2502 1.10070 \u2502 1.09990 \u2502 Grid-S-1\u2502\n\u2502 ...793 \u2502 SELL LIMIT  \u2502 1.10040 \u2502 1.10090 \u2502 1.10010 \u2502 Grid-S-2\u2502\n\u2502 ...794 \u2502 SELL LIMIT  \u2502 1.10060 \u2502 1.10110 \u2502 1.10030 \u2502 Grid-S-3\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nplacedOrders = [789, 790, 791, 792, 793, 794]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#phase-4-monitoring-lines-105-114","title":"Phase 4: Monitoring (lines 105-114)","text":"<pre><code>Console.WriteLine($\"\\n  \u2713 Grid placed: {placedOrders.Count} pending orders\");\nConsole.WriteLine($\"  \u23f3 Running for {MaxRunMinutes} minutes...\\n\");\n\n// \u2502  Calculate end time                                     \n// \u2502  MaxRunMinutes = 15                                     \n// \u2502  endTime = 12:00 + 15 min = 12:15                       \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar endTime = DateTime.UtcNow.AddMinutes(MaxRunMinutes);\n\n\n// \u2502  MONITORING LOOP: runs until time expires               \n// \u2502  or CancellationToken triggers                          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nwhile (DateTime.UtcNow &lt; endTime &amp;&amp; !ct.IsCancellationRequested)\n{\n\n    // \u2502  Wait 5 seconds                                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await Task.Delay(5000, ct);\n\n\n    // \u2502  Get current balance                            \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var currentBalance = await _service.GetBalanceAsync();\n\n\n    // \u2502  Calculate profit/loss                          \n    // \u2502  initialBalance = 10000.00                      \n    // \u2502  currentBalance = 10012.50                      \n    // \u2502  currentProfit = 10012.50 - 10000.00 = +12.50   \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var currentProfit = currentBalance - initialBalance;\n\n    Console.WriteLine($\"  Current P/L: ${currentProfit:F2}\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#what-happens-during-monitoring","title":"What happens during monitoring","text":"<pre><code>TIME      ACTION                           BALANCE    P/L\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\n12:00:00  Grid placed                      10000.00   0.00\n12:00:05  Waiting...                       10000.00   0.00\n12:00:10  Waiting...                       10000.00   0.00\n12:00:15  Price 1.09980 \u2192 BUY-1 triggered  10000.00   0.00\n12:00:20  Position opened                  10000.00   0.00\n12:00:25  Price 1.09995                    10001.50  +1.50\n12:00:30  Price 1.10010 \u2192 TP triggered     10003.00  +3.00\n12:00:35  Position closed                  10003.00  +3.00\n...\n12:15:00  Time expired \u2192 exit loop         10012.50 +12.50\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#phase-5-closing-lines-117-128","title":"Phase 5: Closing (lines 117-128)","text":"<pre><code>// \u2502  Time expired - close all remaining orders              \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"\\n  \u23f1 Time expired - closing all remaining orders...\");\n\n\n// \u2502  Call MT5Sugar extension method: CloseAll()            \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nawait _service.CloseAll(Symbol);\n\nConsole.WriteLine(\"  \u2713 All closed\");\n\n\n// \u2502  Get final balance                                      \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar finalBalance = await _service.GetBalanceAsync();\n\n\n// \u2502  Calculate total profit                                 \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar profit = finalBalance - initialBalance;\n\nConsole.WriteLine($\"\\n  Final balance: ${finalBalance:F2}\");\nConsole.WriteLine($\"  Total Profit/Loss: ${profit:F2}\");\n\n\n// \u2502  Return profit as result of ExecuteAsync()              \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nreturn profit;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#how-closeall-works","title":"How CloseAll() works","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task CloseAll(\n    this MT5Service service,\n    string symbol\n)\n{\n\n    // \u2502  STEP 1: Get all open positions                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var positions = await service.PositionsAsync(symbol);\n\n    foreach (var position in positions)\n    {\n        // Close each position individually\n        await service.PositionCloseAsync(position.Ticket);\n    }\n\n\n    // \u2502  STEP 2: Get all pending orders                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var orders = await service.OrdersAsync(symbol);\n\n    foreach (var order in orders)\n    {\n        // Cancel each pending order\n        await service.OrderDeleteAsync(order.Ticket);\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#complete-life-cycle","title":"\ud83c\udfad Complete Life Cycle","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#execution-timeline","title":"Execution timeline","text":"<pre><code>T=0      START ExecuteAsync()\n         \u2502\n         \u251c\u2500\u25ba GetBalanceAsync()           \u2192 10000.00\n         \u251c\u2500\u25ba SymbolInfoTickAsync()       \u2192 Bid:1.10000, Ask:1.10002\n         \u2502\nT=1s     \u251c\u2500\u25ba LOOP 1: BuyLimitPoints (i=1)\n         \u2502   \u2514\u2500\u25ba Order 789: BUY LIMIT @ 1.09982\n         \u2502\nT=2s     \u251c\u2500\u25ba LOOP 1: BuyLimitPoints (i=2)\n         \u2502   \u2514\u2500\u25ba Order 790: BUY LIMIT @ 1.09962\n         \u2502\nT=3s     \u251c\u2500\u25ba LOOP 1: BuyLimitPoints (i=3)\n         \u2502   \u2514\u2500\u25ba Order 791: BUY LIMIT @ 1.09942\n         \u2502\nT=4s     \u251c\u2500\u25ba LOOP 2: SellLimitPoints (i=1)\n         \u2502   \u2514\u2500\u25ba Order 792: SELL LIMIT @ 1.10020\n         \u2502\nT=5s     \u251c\u2500\u25ba LOOP 2: SellLimitPoints (i=2)\n         \u2502   \u2514\u2500\u25ba Order 793: SELL LIMIT @ 1.10040\n         \u2502\nT=6s     \u251c\u2500\u25ba LOOP 2: SellLimitPoints (i=3)\n         \u2502   \u2514\u2500\u25ba Order 794: SELL LIMIT @ 1.10060\n         \u2502\nT=7s     \u251c\u2500\u25ba MONITORING START\n         \u2502   endTime = DateTime.Now + 15 minutes\n         \u2502\nT=12s    \u251c\u2500\u25ba Task.Delay(5000) \u2192 output P/L: $0.00\nT=17s    \u251c\u2500\u25ba Task.Delay(5000) \u2192 output P/L: $0.00\nT=22s    \u251c\u2500\u25ba Task.Delay(5000) \u2192 output P/L: $1.50\n         \u2502   (Market moved, position opened)\n         ...\n         ...\nT=15min  \u251c\u2500\u25ba MONITORING END (time expired)\n         \u2502\n         \u251c\u2500\u25ba CloseAll(\"EURUSD\")\n         \u2502   \u251c\u2500\u25ba Closed positions: 2\n         \u2502   \u2514\u2500\u25ba Canceled orders: 4\n         \u2502\n         \u251c\u2500\u25ba GetBalanceAsync()           \u2192 10012.50\n         \u251c\u2500\u25ba profit = 10012.50 - 10000.00 = +12.50\n         \u2502\n         \u2514\u2500\u25ba RETURN profit = 12.50\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#what-the-result-is-made-of","title":"\ud83d\udcca What the result is made of","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#profit-calculation","title":"Profit calculation","text":"<pre><code>INITIAL BALANCE: $10000.00\n\nTRIGGERED ORDERS:\n\n1. Order 789: BUY LIMIT @ 1.09982\n   \u2192 Price fell to 1.09980 \u2192 opened position BUY\n   \u2192 Price rose to 1.10012 \u2192 TP triggered\n   \u2192 Profit: (1.10012 - 1.09982) \u00d7 100000 \u00d7 0.01 = +$3.00\n\n2. Order 792: SELL LIMIT @ 1.10020\n   \u2192 Price rose to 1.10022 \u2192 opened position SELL\n   \u2192 Price fell to 1.09990 \u2192 TP triggered\n   \u2192 Profit: (1.10020 - 1.09990) \u00d7 100000 \u00d7 0.01 = +$3.00\n\nNOT TRIGGERED (canceled at CloseAll):\n- Order 790: BUY LIMIT @ 1.09962\n- Order 791: BUY LIMIT @ 1.09942\n- Order 793: SELL LIMIT @ 1.10040\n- Order 794: SELL LIMIT @ 1.10060\n\nFINAL RESULT:\n- Profit from positions: $3.00 + $3.00 = $6.00\n- Commissions/swap: -$0.50\n- FINAL BALANCE: $10005.50\n- PROFIT = $5.50\n\nreturn 5.50;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#components-and-their-roles","title":"\ud83e\udde9 Components and their roles","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#1-gridtradingorchestrator","title":"1. GridTradingOrchestrator","text":"<p>Role: Strategy coordinator</p> <p>Tasks:</p> <ul> <li>Stores parameters (Symbol, GridLevels, etc.)</li> <li>Manages life cycle</li> <li>Calls MT5Service methods</li> <li>Handles errors</li> <li>Returns result</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#2-mt5service","title":"2. MT5Service","text":"<p>Role: Service layer</p> <p>Tasks:</p> <ul> <li>Provides high-level methods</li> <li>Delegates calls to MT5Account</li> <li>Contains no business logic</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#3-mt5sugar-extension-methods","title":"3. MT5Sugar (extension methods)","text":"<p>Role: Simplifying layer</p> <p>Tasks:</p> <ul> <li>Converts points to prices</li> <li>Calculates SL/TP</li> <li>Makes API convenient</li> <li>Reduces code amount</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#4-mt5account","title":"4. MT5Account","text":"<p>Role: gRPC client</p> <p>Tasks:</p> <ul> <li>Direct communication with MT5 Terminal</li> <li>Serialization/deserialization</li> <li>Connection management</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#5-mt5-terminal","title":"5. MT5 Terminal","text":"<p>Role: Executor</p> <p>Tasks:</p> <ul> <li>Places orders on market</li> <li>Monitors execution</li> <li>Manages positions</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#final-dependency-diagram","title":"\ud83d\udd0d Final Dependency Diagram","text":"<pre><code>\u2502  USER CODE                                                  \n\u2502  var orchestrator = new GridTradingOrchestrator(service);   \n\u2502  var profit = await orchestrator.ExecuteAsync();            \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  GridTradingOrchestrator                                    \n\u2502    \n\u2502  \u2502  - Symbol, GridLevels, GridSpacingPoints, ...           \n\u2502  \u2502  - ExecuteAsync()                                       \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502 _service\n                           \u25bc\n\n\u2502  MT5Service                                                 \n\u2502   \n\u2502  \u2502  Methods:                                               \n\u2502  \u2502  - GetBalanceAsync()                                    \n\u2502  \u2502  - SymbolInfoTickAsync()                                \n\u2502  \u2502  - BuyLimitAsync()                                      \n\u2502  \u2502  - SellLimitAsync()                                     \n\u2502  \u2502  - PositionCloseAsync()                                 \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502 _account\n                           \u25bc\n\n\u2502  MT5Account                                                 \n\u2502    \n\u2502  \u2502  gRPC Client:                                           \n\u2502  \u2502  - OrderSendAsync(OrderSendRequest)                     \n\u2502  \u2502  - GetAccountInfoAsync(GetAccountInfoRequest)           \n\u2502  \u2502  - SymbolInfoTickAsync(SymbolInfoTickRequest)           \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502 gRPC\n                           \u25bc\n\n                    \u2502 MT5 Terminal \n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n\u2502  MT5Sugar (static extension methods)                        \n\u2502    \n\u2502  \u2502  Extension Methods on MT5Service:                       \n\u2502  \u2502  - BuyLimitPoints(priceOffsetPoints, slPoints, ...)     \n\u2502  \u2502  - SellLimitPoints(priceOffsetPoints, tpPoints, ...)    \n\u2502  \u2502  - CloseAll(symbol)                                     \n\u2502  \u2502  - BuyMarketByRisk(riskMoney, stopPoints, ...)          \n\u2502  \u2502                                                         \n\u2502  \u2502  Role: Convert points \u2192 prices                          \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502                          \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502 Calls low-level methods\n                    \u25bc\n              [MT5Service methods]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator.HOW_IT_WORKS/#summary","title":"\ud83c\udfaf Summary","text":"<p>GridTradingOrchestrator is made of:</p> <ol> <li>1 dependency: <code>MT5Service _service</code> (via DI)</li> <li>7 parameters: Symbol, GridLevels, GridSpacingPoints, Volume, SL, TP, MaxRunMinutes</li> <li>3 MT5Sugar methods: <code>BuyLimitPoints</code>, <code>SellLimitPoints</code>, <code>CloseAll</code></li> <li>5 MT5Service methods: <code>GetBalanceAsync</code>, <code>SymbolInfoTickAsync</code>, <code>BuyLimitAsync</code>, <code>SellLimitAsync</code>, <code>PositionsAsync</code></li> <li>gRPC protocol: Communication with MT5 Terminal</li> </ol> <p>Works through:</p> <ul> <li>2 loops for placing orders (Buy + Sell)</li> <li>1 monitoring loop with Task.Delay(5000)</li> <li>1 final close of all orders</li> <li>Error handling via try-catch</li> </ul> <p>Returns:</p> <ul> <li><code>double profit</code> - difference between final and initial balance</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/","title":"GridTradingOrchestrator - Grid Trading","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#description","title":"Description","text":"<p>GridTradingOrchestrator is an orchestrator for grid trading that places multiple pending orders at equal intervals above and below the current price. The strategy is designed for flat (sideways) markets where price oscillates within a range.</p> <p>Principle: A \"grid\" is created from Buy Limit orders below current price and Sell Limit orders above current price. When price moves down, buys trigger. When price moves up, sells trigger. When price returns to range, positions close with profit.</p> <p>File: <code>Examples\\Orchestrators\\GridTradingOrchestrator.cs</code></p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#architecture","title":"Architecture","text":"<pre><code>GRID TRADING ORCHESTRATOR\n    \u2193\nMT5Service Instance\n    \u2193\n  \u250c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2193     \u2193     \u2193\nBuyLimit SellLimit CloseAll\nPoints   Points   (emergency)\n(below)  (above)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#dependencies","title":"Dependencies","text":"<ul> <li>MT5Service: Service layer for MT5</li> <li>MT5Sugar Extension Methods: <code>BuyLimitPoints</code>, <code>SellLimitPoints</code>, <code>CloseAll</code></li> <li>mt5_term_api: gRPC types (<code>OrderSendData</code>, <code>SymbolInfoTickData</code>)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#configuration-parameters","title":"Configuration Parameters","text":"Parameter Type Default Description <code>Symbol</code> string <code>\"EURUSD\"</code> Trading instrument <code>GridLevels</code> int <code>3</code> Number of levels in each direction <code>GridSpacingPoints</code> int <code>20</code> Distance between levels in points <code>VolumePerLevel</code> double <code>0.01</code> Volume (lots) for each level <code>StopLossPoints</code> int <code>50</code> Stop loss in points for each order <code>TakeProfitPoints</code> int <code>30</code> Take profit in points for each order <code>MaxRunMinutes</code> int <code>15</code> Maximum running time in minutes"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#configuration-example","title":"Configuration example","text":"<pre><code>var gridOrchestrator = new GridTradingOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    GridLevels = 5,              // 5 Buy + 5 Sell = 10 orders\n    GridSpacingPoints = 30,      // Every 30 points\n    VolumePerLevel = 0.02,       // 0.02 lots per level\n    StopLossPoints = 80,         // SL 80 points\n    TakeProfitPoints = 40,       // TP 40 points\n    MaxRunMinutes = 30           // Run for 30 minutes\n};\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#how-to-run","title":"How to Run","text":"<p>You can execute this orchestrator using several command variations:</p> <pre><code># Option 1: By number\ndotnet run 9\n\n# Option 2: By short name\ndotnet run grid\n\n# Option 3: By full name\ndotnet run gridtrading\n</code></pre> <p>All three commands will launch the GridTradingOrchestrator with the default configuration or the settings you specify in the code.</p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#algorithm","title":"Algorithm","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#flowchart","title":"Flowchart","text":"<pre><code>START\n  \u2193\nGet initial balance\n  \u2193\nGet current price (Bid/Ask)\n  \u2193\nLOOP: i from 1 to GridLevels\n  \u2192 Calculate offsetPoints = -(i \u00d7 GridSpacingPoints)\n  \u2192 BuyLimitPoints(symbol, volume, offsetPoints, SL, TP)\n     \u2192 If success \u2192 add to placedOrders list\n  \u2193\nLOOP: i from 1 to GridLevels\n  \u2192 Calculate offsetPoints = +(i \u00d7 GridSpacingPoints)\n  \u2192 SellLimitPoints(symbol, volume, offsetPoints, SL, TP)\n     \u2192 If success \u2192 add to placedOrders list\n  \u2193\nMONITORING (MaxRunMinutes minutes)\n  \u2192 Every 5 seconds: display current profit\n  \u2193\nTime expired \u2192 CloseAll(Symbol)\n  \u2193\nReturn profit\nEND\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#step-by-step-description","title":"Step-by-step description","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#1-initialization-lines-36-46","title":"1. Initialization (lines 36-46)","text":"<pre><code>var initialBalance = await _service.GetBalanceAsync();\nvar tick = await _service.SymbolInfoTickAsync(Symbol);\n</code></pre> <p>What happens: - Initial balance is saved for P/L calculation - Current Bid/Ask price is obtained for visualization</p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#2-placing-buy-limit-levels-lines-50-73","title":"2. Placing Buy Limit levels (lines 50-73)","text":"<pre><code>for (int i = 1; i &lt;= GridLevels; i++)\n{\n    var pointsBelow = -(i * GridSpacingPoints);  // NEGATIVE value!\n\n    var result = await _service.BuyLimitPoints(\n        symbol: Symbol,\n        volume: VolumePerLevel,\n        priceOffsetPoints: pointsBelow,  // For example: -20, -40, -60\n        slPoints: StopLossPoints,\n        tpPoints: TakeProfitPoints,\n        comment: $\"Grid-Buy-{i}\"\n    );\n}\n</code></pre> <p>Critically important:</p> <ul> <li><code>pointsBelow</code> has NEGATIVE value (<code>-20</code>, <code>-40</code>, <code>-60</code>)</li> <li><code>BuyLimitPoints</code> uses <code>priceOffsetPoints</code> parameter which:</li> <li>With negative value \u2192 places order BELOW current price</li> <li>With positive value \u2192 places order ABOVE current price</li> </ul> <p>Example with GridLevels=3, GridSpacingPoints=20: <pre><code>Current Ask price: 1.10000\n\nLevel 1: BuyLimit @ 1.09980  (Ask - 20 pts)  \u2192 pointsBelow = -20\nLevel 2: BuyLimit @ 1.09960  (Ask - 40 pts)  \u2192 pointsBelow = -40\nLevel 3: BuyLimit @ 1.09940  (Ask - 60 pts)  \u2192 pointsBelow = -60\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#3-placing-sell-limit-levels-lines-77-100","title":"3. Placing Sell Limit levels (lines 77-100)","text":"<pre><code>for (int i = 1; i &lt;= GridLevels; i++)\n{\n    var pointsAbove = i * GridSpacingPoints;  // POSITIVE value!\n\n    var result = await _service.SellLimitPoints(\n        symbol: Symbol,\n        volume: VolumePerLevel,\n        priceOffsetPoints: pointsAbove,  // For example: +20, +40, +60\n        slPoints: StopLossPoints,\n        tpPoints: TakeProfitPoints,\n        comment: $\"Grid-Sell-{i}\"\n    );\n}\n</code></pre> <p>Example with GridLevels=3, GridSpacingPoints=20: <pre><code>Current Bid price: 1.10000\n\nLevel 1: SellLimit @ 1.10020  (Bid + 20 pts)  \u2192 pointsAbove = +20\nLevel 2: SellLimit @ 1.10040  (Bid + 40 pts)  \u2192 pointsAbove = +40\nLevel 3: SellLimit @ 1.10060  (Bid + 60 pts)  \u2192 pointsAbove = +60\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#4-monitoring-lines-105-114","title":"4. Monitoring (lines 105-114)","text":"<pre><code>var endTime = DateTime.UtcNow.AddMinutes(MaxRunMinutes);\nwhile (DateTime.UtcNow &lt; endTime &amp;&amp; !ct.IsCancellationRequested)\n{\n    await Task.Delay(5000, ct);  // Every 5 seconds\n\n    var currentBalance = await _service.GetBalanceAsync();\n    var currentProfit = currentBalance - initialBalance;\n    Console.WriteLine($\"  Current P/L: ${currentProfit:F2}\");\n}\n</code></pre> <p>What happens:</p> <ul> <li>Every 5 seconds current balance is checked</li> <li>Current profit/loss is displayed</li> <li>Runs until <code>MaxRunMinutes</code> expires or cancellation via <code>CancellationToken</code></li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#5-closing-all-orders-lines-117-119","title":"5. Closing all orders (lines 117-119)","text":"<pre><code>await _service.CloseAll(Symbol);\n</code></pre> <p>What happens:</p> <ul> <li>Closes ALL open positions for symbol</li> <li>Cancels ALL unfilled pending orders</li> <li>This guarantees no hanging orders after orchestrator completes</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#grid-visualization","title":"Grid Visualization","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#scenario-with-gridlevels3-gridspacingpoints20","title":"Scenario with GridLevels=3, GridSpacingPoints=20","text":"<pre><code>1.10060 \u2192 SELL LIMIT Level 3  (TP: 1.10030, SL: 1.10110)\n          +60 pts from current\n\n1.10040 \u2192 SELL LIMIT Level 2  (TP: 1.10010, SL: 1.10090)\n          +40 pts from current\n\n1.10020 \u2192 SELL LIMIT Level 1  (TP: 1.09990, SL: 1.10070)\n          +20 pts from current\n\n1.10000 \u2192 CURRENT PRICE (Bid/Ask middle)\n\n1.09980 \u2192 BUY LIMIT Level 1   (TP: 1.10010, SL: 1.09930)\n          -20 pts from current\n\n1.09960 \u2192 BUY LIMIT Level 2   (TP: 1.09990, SL: 1.09910)\n          -40 pts from current\n\n1.09940 \u2192 BUY LIMIT Level 3   (TP: 1.09970, SL: 1.09890)\n          -60 pts from current\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#working-scenario","title":"Working scenario","text":"<p>Scenario 1: Price falls and returns</p> <pre><code>1. Price falls to 1.09970\n   \u2192 BUY LIMIT Level 1 @ 1.09980 triggers\n   \u2192 Opens position BUY 0.01 lots\n\n2. Price continues falling to 1.09950\n   \u2192 BUY LIMIT Level 2 @ 1.09960 triggers\n   \u2192 Opens position BUY 0.01 lots\n   \u2192 Total: 2 positions of 0.01 lots in BUY\n\n3. Price returns to 1.10010\n   \u2192 TP of first position (1.10010) triggers \u2192 profit +30 points\n   \u2192 Second position in profit (+50 points, but TP not reached yet)\n\n4. Price reaches 1.09990\n   \u2192 TP of second position triggers \u2192 profit +30 points\n</code></pre> <p>Scenario 2: Price rises and returns</p> <pre><code>1. Price rises to 1.10030\n   \u2192 SELL LIMIT Level 1 @ 1.10020 triggers\n   \u2192 Opens position SELL 0.01 lots\n\n2. Price falls to 1.09990\n   \u2192 TP of position (1.09990) triggers \u2192 profit +30 points\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#used-mt5sugar-methods","title":"Used MT5Sugar Methods","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#1-buylimitpoints","title":"1. BuyLimitPoints","text":"<pre><code>public static async Task&lt;OrderSendData&gt; BuyLimitPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // NEGATIVE for below, POSITIVE for above\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n</code></pre> <p>Purpose: Places pending Buy Limit order with offset in points.</p> <p>Parameters in GridTradingOrchestrator:</p> <ul> <li><code>symbol</code>: Trading instrument (e.g., \"EURUSD\")</li> <li><code>volume</code>: <code>VolumePerLevel</code> (e.g., 0.01)</li> <li><code>priceOffsetPoints</code>: NEGATIVE value (e.g., -20, -40)</li> <li><code>slPoints</code>: <code>StopLossPoints</code> (e.g., 50)</li> <li><code>tpPoints</code>: <code>TakeProfitPoints</code> (e.g., 30)</li> <li><code>comment</code>: \"Grid-Buy-1\", \"Grid-Buy-2\", ...</li> </ul> <p>Returns: <code>OrderSendData</code> with <code>ReturnedCode</code> field:</p> <ul> <li><code>10009</code> = success</li> <li>Other = error (see <code>Comment</code>)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#2-selllimitpoints","title":"2. SellLimitPoints","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SellLimitPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // POSITIVE for above, NEGATIVE for below\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n</code></pre> <p>Purpose: Places pending Sell Limit order with offset in points.</p> <p>Parameters in GridTradingOrchestrator:</p> <ul> <li><code>priceOffsetPoints</code>: POSITIVE value (e.g., +20, +40)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#3-closeall","title":"3. CloseAll","text":"<pre><code>public static async Task CloseAll(\n    this MT5Service service,\n    string symbol\n)\n</code></pre> <p>Purpose: Closes all open positions and cancels all pending orders for symbol.</p> <p>Usage:</p> <ul> <li>At end of orchestrator (line 118)</li> <li>In <code>catch</code> block for emergency close (line 136)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#risk-management","title":"Risk Management","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#maximum-risk-calculation","title":"Maximum risk calculation","text":"<pre><code>Maximum risk per level = VolumePerLevel \u00d7 StopLossPoints \u00d7 ValueOfPoint\n\nFor EURUSD (ValueOfPoint = $10 for 1.0 lot):\n- VolumePerLevel = 0.01\n- StopLossPoints = 50\n- Risk per level = 0.01 \u00d7 50 \u00d7 $10 = $5\n\nTotal risk (if all orders trigger):\n- GridLevels = 3 Buy + 3 Sell = 6 orders\n- Maximum risk = 6 \u00d7 $5 = $30\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#recommendations","title":"Recommendations","text":"<ol> <li>SL/TP ratio:</li> <li>Default: SL=50, TP=30 (ratio 1.67:1)</li> <li>This is not classic risk/reward ratio</li> <li> <p>Strategy relies on frequency of TP triggers in flat market</p> </li> <li> <p>Grid size:</p> </li> <li>Start with small <code>GridLevels</code> values (3-5)</li> <li> <p>Increase as you understand market behavior</p> </li> <li> <p>Distance between levels:</p> </li> <li>For volatile instruments: 30-50 points</li> <li>For low volatility: 15-25 points</li> <li> <p>Consider ATR (Average True Range) of instrument</p> </li> <li> <p>Volume:</p> </li> <li>Use minimum lots (0.01) for testing</li> <li>Increase only after strategy confirmation</li> </ol>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#usage-examples","title":"Usage Examples","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#example-1-conservative-grid-on-eurusd","title":"Example 1: Conservative grid on EURUSD","text":"<pre><code>var service = new MT5Service(account);\n\nvar conservativeGrid = new GridTradingOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    GridLevels = 3,\n    GridSpacingPoints = 25,\n    VolumePerLevel = 0.01,\n    StopLossPoints = 60,\n    TakeProfitPoints = 35,\n    MaxRunMinutes = 20\n};\n\nvar profit = await conservativeGrid.ExecuteAsync();\nConsole.WriteLine($\"Grid trading completed with result: ${profit:F2}\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#example-2-aggressive-grid-on-gbpusd","title":"Example 2: Aggressive grid on GBPUSD","text":"<pre><code>var aggressiveGrid = new GridTradingOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    GridLevels = 6,              // 6 \u00d7 2 = 12 orders\n    GridSpacingPoints = 20,\n    VolumePerLevel = 0.02,\n    StopLossPoints = 80,\n    TakeProfitPoints = 40,\n    MaxRunMinutes = 30\n};\n\nvar profit = await aggressiveGrid.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#example-3-use-in-preset","title":"Example 3: Use in Preset","text":"<pre><code>public class GridPreset\n{\n    private readonly MT5Service _service;\n\n    public async Task&lt;double&gt; ExecuteAsync()\n    {\n        // Phase 1: Small grid\n        var smallGrid = new GridTradingOrchestrator(_service)\n        {\n            GridLevels = 3,\n            GridSpacingPoints = 20,\n            MaxRunMinutes = 10\n        };\n        var profit1 = await smallGrid.ExecuteAsync();\n\n        // Phase 2: If profit &gt; $10, run large grid\n        if (profit1 &gt; 10)\n        {\n            var largeGrid = new GridTradingOrchestrator(_service)\n            {\n                GridLevels = 5,\n                GridSpacingPoints = 15,\n                MaxRunMinutes = 15\n            };\n            var profit2 = await largeGrid.ExecuteAsync();\n            return profit1 + profit2;\n        }\n\n        return profit1;\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#error-handling","title":"Error Handling","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#try-catch-block-lines-43-141","title":"try-catch block (lines 43-141)","text":"<pre><code>try\n{\n    // Main logic\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"\\n  \u2717 Error: {ex.Message}\");\n\n    // EMERGENCY CLOSE\n    try\n    {\n        await _service.CloseAll(Symbol);\n    }\n    catch { }  // Ignore errors during emergency close\n\n    return 0;  // Return zero profit on error\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#possible-errors","title":"Possible errors","text":"Error Cause Solution <code>No connection</code> No connection to MT5 Check <code>MT5Account.ConnectAsync()</code> <code>Market is closed</code> Market closed Work only during trading session <code>Not enough money</code> Insufficient funds Reduce <code>VolumePerLevel</code> or <code>GridLevels</code> <code>Invalid stops</code> Incorrect SL/TP Check minimum levels for symbol <code>Freeze level</code> Price too close Increase <code>GridSpacingPoints</code>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#console-output","title":"Console Output","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#output-example","title":"Output example","text":"<pre><code>+============================================================+\n|  GRID TRADING ORCHESTRATOR                                |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Grid: 3 levels \u00d7 20 pts\n  Volume per level: 0.01 lots\n  SL: 50 pts | TP: 30 pts\n\n  Current: Bid=1.10000, Ask=1.10002\n\n  Placing 3 BUY LIMIT levels...\n    \u2713 Level 1: #123456789 (-20 pts below)\n    \u2713 Level 2: #123456790 (-40 pts below)\n    \u2713 Level 3: #123456791 (-60 pts below)\n\n  Placing 3 SELL LIMIT levels...\n    \u2713 Level 1: #123456792 (20 pts above)\n    \u2713 Level 2: #123456793 (40 pts above)\n    \u2713 Level 3: #123456794 (60 pts above)\n\n  \u2713 Grid placed: 6 pending orders\n  \u23f3 Running for 15 minutes...\n\n  Current P/L: $0.00\n  Current P/L: $3.50\n  Current P/L: $7.80\n  Current P/L: $12.30\n\n  \u23f1 Time expired - closing all remaining orders...\n  \u2713 All closed\n\n  Final balance: $10012.30\n  Total Profit/Loss: $12.30\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#when-to-use-grid-trading","title":"When to Use Grid Trading","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#suitable-conditions","title":"\u2705 Suitable Conditions","text":"<ul> <li>Flat market: Price moves in sideways range</li> <li>Low volatility: Small price oscillations</li> <li>Predictable support/resistance levels</li> <li>Asian session: Often calmer</li> <li>Forex weekends: Cryptocurrencies in narrow range</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#unsuitable-conditions","title":"\u274c Unsuitable Conditions","text":"<ul> <li>Trending market: Strong directional movement</li> <li>High volatility: News, volatile sessions</li> <li>Level breakouts: Risk of all SL triggering simultaneously</li> <li>Low liquidity: Wide spreads</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#optimization","title":"Optimization","text":""},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#possible-improvements","title":"Possible improvements","text":"<ol> <li> <p>Dynamic grid distance:    <pre><code>var atr = await GetATR(Symbol, period: 14);\nGridSpacingPoints = (int)(atr * 0.5);  // 50% of ATR\n</code></pre></p> </li> <li> <p>Adaptive Volume:    <pre><code>var balance = await _service.GetBalanceAsync();\nVolumePerLevel = balance * 0.0001;  // 0.01% of balance per level\n</code></pre></p> </li> <li> <p>Limit number of open positions:    <pre><code>var openPositions = await _service.PositionsCountAsync(Symbol);\nif (openPositions &gt;= MaxPositions) return;  // Don't open new\n</code></pre></p> </li> <li> <p>Trailing for profitable positions:    <pre><code>if (currentProfit &gt; TakeProfitPoints * 0.7)\n{\n    await _service.TrailStart(ticket, trailPoints: 15);\n}\n</code></pre></p> </li> </ol>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#related-orchestrators","title":"Related Orchestrators","text":"<ul> <li>SimpleScalpingOrchestrator: Single fast trades</li> <li>PendingBreakoutOrchestrator: Catches level breakouts</li> <li>QuickHedgeOrchestrator: Hedging on adverse movement</li> </ul>"},{"location":"Strategies/Orchestrators_EN/GridTradingOrchestrator/#summary","title":"Summary","text":"<p>GridTradingOrchestrator is a powerful tool for trading flat markets:</p> <p>\u2705 Pros:</p> <ul> <li>Automation of placing multiple orders</li> <li>Catches price movement in both directions</li> <li>Profitable in sideways markets</li> <li>Ease of configuration and testing</li> </ul> <p>\u274c Cons:</p> <ul> <li>Dangerous in trending markets (all SL may trigger)</li> <li>Requires active monitoring</li> <li>High risk with incorrect settings</li> </ul> <p>Recommendation:  Use for short-term trading (15-30 minutes) on instruments with predictable behavior. Always test on demo account before real trading.</p>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/","title":"HOW NewsStraddleOrchestrator WORKS - Detailed Analysis","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#document-purpose","title":"\ud83c\udfaf Document Purpose","text":"<p>Show WHAT the orchestrator consists of and HOW EXACTLY it works at the code, methods and data level. Special attention is paid to the timing of order placement before news and handling three breakout scenarios.</p>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#what-the-orchestrator-is-made-of","title":"\ud83d\udce6 What the orchestrator is made of","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#1-class-structure-lines-13-28","title":"1. Class structure (lines 13-28)","text":"<pre><code>public class NewsStraddleOrchestrator\n{\n\n    // \u2502  SINGLE DEPENDENCY                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    private readonly MT5Service _service;\n\n\n    // \u2502  7 CONFIGURABLE PARAMETERS              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    public string Symbol { get; set; } = \"EURUSD\";\n    public int StraddleDistancePoints { get; set; } = 15;\n    public double Volume { get; set; } = 0.02;\n    public int StopLossPoints { get; set; } = 20;\n    public int TakeProfitPoints { get; set; } = 40;\n    public int SecondsBeforeNews { get; set; } = 60;          // \u2190 Countdown timer\n    public int MaxWaitAfterNewsSeconds { get; set; } = 180;   // \u2190 Breakout timeout\n\n    public NewsStraddleOrchestrator(MT5Service service)\n    {\n        _service = service;\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#dependency-visualization","title":"Dependency visualization","text":"<pre><code>\u2502         NewsStraddleOrchestrator                           \n\u2502    \n\u2502  \u2502  private readonly MT5Service _service                  \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n        \u2502         MT5Service                  \n        \u2502    \n        \u2502  \u2502  private MT5Account _account    \n        \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n                \u2502      MT5Account         \n                \u2502    \n                \u2502  \u2502  gRPC Client        \n                \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n                    [MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#how-executeasync-works-step-by-step","title":"\ud83d\udd04 How ExecuteAsync() works - step by step","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#phase-1-initialization-lines-30-41","title":"Phase 1: Initialization (lines 30-41)","text":"<pre><code>public async Task&lt;double&gt; ExecuteAsync(CancellationToken ct = default)\n{\n    Console.WriteLine(\"\\n+============================================================+\");\n    Console.WriteLine(\"|  NEWS STRADDLE ORCHESTRATOR                               |\");\n    Console.WriteLine(\"+============================================================+\\n\");\n\n    var initialBalance = await _service.GetBalanceAsync();\n    Console.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\n    Console.WriteLine($\"  Symbol: {Symbol}\");\n    Console.WriteLine($\"  Straddle distance: {StraddleDistancePoints} pts\");\n    Console.WriteLine($\"  Volume: {Volume:F2} lots\");\n    Console.WriteLine($\"  SL: {StopLossPoints} pts | TP: {TakeProfitPoints} pts\\n\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#phase-2-countdown-until-news-lines-44-51","title":"Phase 2: Countdown until news (lines 44-51)","text":"<pre><code>try\n{\n\n    // \u2502  CRITICAL TIMING:                                   \n    // \u2502  Wait SecondsBeforeNews seconds until the event     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine($\"  \u23f2  Waiting {SecondsBeforeNews}s before news event...\\n\");\n    await Task.Delay(SecondsBeforeNews * 1000, ct);\n\n\n    // \u2502  Get current price IMMEDIATELY before               \n    // \u2502  placing orders (maximum accuracy)                  \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await _service.SymbolInfoTickAsync(Symbol);\n    Console.WriteLine($\"  \ud83d\udcf0 NEWS EVENT IMMINENT!\");\n    Console.WriteLine($\"  Current: Bid={tick.Bid:F5}, Ask={tick.Ask:F5}\\n\");\n}\n</code></pre> <p>Key timing moment:</p> <pre><code>EXAMPLE: NFP releases at 13:30:00 UTC\n\nOrchestrator launch:\n  User: await orchestrator.ExecuteAsync() @ 13:29:00\n\nCountdown:\n  SecondsBeforeNews = 60\n  Task.Delay(60000) \u2192 wait 60 seconds\n\nOrder placement:\n  @ 13:30:00 (exactly when news releases!)\n\nIMPORTANT:\n- Too early \u2192 risk triggering from noise\n- Too late \u2192 miss the beginning of movement\n- 60 seconds = optimal balance\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#phase-3-placing-the-straddle-lines-53-91","title":"Phase 3: Placing the straddle (lines 53-91)","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#31-placing-buystop-upper-order","title":"3.1. Placing BuyStop (upper order)","text":"<pre><code>// \u2502  BUY STOP: Catches upward breakout                      \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  Placing BUY STOP (upper straddle)...\");\n\nvar buyStopResult = await _service.BuyStopPoints(\n    symbol: Symbol,                         // \"EURUSD\"\n    volume: Volume,                         // 0.02\n    priceOffsetPoints: StraddleDistancePoints,  // +15 (POSITIVE!)\n    slPoints: StopLossPoints,               // 20\n    tpPoints: TakeProfitPoints,             // 40\n    comment: \"News-Buy\"\n);\n\nif (buyStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 BUY STOP failed: {buyStopResult.Comment}\\n\");\n    return 0;  // \u2190 EMERGENCY EXIT\n}\n\nConsole.WriteLine($\"  \u2713 BUY STOP: #{buyStopResult.Order}\\n\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#how-buystoppoints-works-for-straddle","title":"How BuyStopPoints() works for straddle","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task&lt;OrderSendData&gt; BuyStopPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // \u2190 RECEIVES +15\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n{\n\n    // \u2502  STEP 1: Get current Ask price                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await service.SymbolInfoTickAsync(symbol);\n    double askPrice = tick.Ask;  // For example: 1.10002\n\n\n    // \u2502  STEP 2: Get point size                             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var symbolInfo = await service.SymbolInfoAsync(symbol);\n    double point = symbolInfo.Point;  // 0.00001\n\n\n    // \u2502  STEP 3: Calculate BUY STOP price                   \n    // \u2502  BUY STOP is placed ABOVE current price             \n    // \u2502                                                     \n    // \u2502  priceOffsetPoints = +15 (POSITIVE!)                \n    // \u2502  price = askPrice + (priceOffsetPoints \u00d7 point)     \n    // \u2502       = 1.10002 + (15 \u00d7 0.00001)                    \n    // \u2502       = 1.10002 + 0.00015                           \n    // \u2502       = 1.10017                                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double price = askPrice + (priceOffsetPoints * point);\n\n\n    // \u2502  STEP 4: Calculate SL and TP for BUY STOP           \n    // \u2502                                                     \n    // \u2502  sl = price - (slPoints \u00d7 point)                    \n    // \u2502     = 1.10017 - (20 \u00d7 0.00001)                      \n    // \u2502     = 1.09997                                       \n    // \u2502                                                     \n    // \u2502  tp = price + (tpPoints \u00d7 point)                    \n    // \u2502     = 1.10017 + (40 \u00d7 0.00001)                      \n    // \u2502     = 1.10057                                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double sl = slPoints &gt; 0 ? price - (slPoints * point) : 0;\n    double tp = tpPoints &gt; 0 ? price + (tpPoints * point) : 0;\n\n\n    // \u2502  STEP 5: Call low-level BuyStopAsync                \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    return await service.BuyStopAsync(\n        symbol: symbol,\n        volume: volume,\n        price: price,    // 1.10017\n        sl: sl,          // 1.09997\n        tp: tp,          // 1.10057\n        comment: comment\n    );\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#32-placing-sellstop-lower-order","title":"3.2. Placing SellStop (lower order)","text":"<pre><code>// \u2502  SELL STOP: Catches downward breakout                   \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  Placing SELL STOP (lower straddle)...\");\n\nvar sellStopResult = await _service.SellStopPoints(\n    symbol: Symbol,\n    volume: Volume,\n    priceOffsetPoints: -StraddleDistancePoints,  // -15 (NEGATIVE!)\n    slPoints: StopLossPoints,\n    tpPoints: TakeProfitPoints,\n    comment: \"News-Sell\"\n);\n\nif (sellStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 SELL STOP failed: {sellStopResult.Comment}\");\n    Console.WriteLine(\"  Canceling BUY STOP...\");\n\n\n    // \u2502  CRITICALLY IMPORTANT:                          \n    // \u2502  If second order failed \u2192 cancel first one      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(buyStopResult.Order);\n    return 0;\n}\n\nConsole.WriteLine($\"  \u2713 SELL STOP: #{sellStopResult.Order}\\n\");\nConsole.WriteLine(\"  \u2705 STRADDLE ACTIVE - Waiting for news spike!\\n\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#sellstop-price-calculation","title":"SellStop price calculation","text":"<pre><code>Current Bid price: 1.10000\nStraddleDistancePoints: 15 (but we use -15)\npoint: 0.00001\n\nprice = bidPrice + (priceOffsetPoints \u00d7 point)\n      = 1.10000 + (-15 \u00d7 0.00001)\n      = 1.10000 - 0.00015\n      = 1.09985\n\nsl = price + (slPoints \u00d7 point)  \u2190 PLUS for SELL!\n   = 1.09985 + (20 \u00d7 0.00001)\n   = 1.10005\n\ntp = price - (tpPoints \u00d7 point)  \u2190 MINUS for SELL!\n   = 1.09985 - (40 \u00d7 0.00001)\n   = 1.09945\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#result-of-straddle-placement","title":"Result of straddle placement","text":"<pre><code>MT5 Terminal state AFTER straddle placement:\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2502  #123456789:     \u2502  (empty)                               \n\u2502  BUY STOP 0.02   \u2502                                        \n\u2502  @ 1.10017       \u2502                                        \n\u2502  SL: 1.09997     \u2502                                        \n\u2502  TP: 1.10057     \u2502                                        \n\u2502                  \u2502                                        \n\u2502  #123456790:     \u2502                                        \n\u2502  SELL STOP 0.02  \u2502                                        \n\u2502  @ 1.09985       \u2502                                        \n\u2502  SL: 1.10005     \u2502                                        \n\u2502  TP: 1.09945     \u2502                                        \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nVISUALIZATION:\n          \u2191 Price rises\n          \u2502\n  1.10057 \u251c\u2500\u2500\u2500 TP for BuyStop\n  1.10017 \u251c\u2500\u2500\u2500 BUY STOP (upward breakout)\n  1.09997 \u251c\u2500\u2500\u2500 SL for BuyStop\n          \u2502\n  1.10002 \u251c\u2500\u2500\u2500 Current Ask\n  1.10000 \u251c\u2500\u2500\u2500 Current Bid\n          \u2502\n  1.10005 \u251c\u2500\u2500\u2500 SL for SellStop\n  1.09985 \u251c\u2500\u2500\u2500 SELL STOP (downward breakout)\n  1.09945 \u251c\u2500\u2500\u2500 TP for SellStop\n          \u2502\n          \u2193 Price falls\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#phase-4-monitoring-for-breakout-lines-94-136","title":"Phase 4: Monitoring for breakout (lines 94-136)","text":"<p>This is the key phase - determining which order triggered after news release.</p> <pre><code>var monitorStart = DateTime.UtcNow;\nvar timeout = TimeSpan.FromSeconds(MaxWaitAfterNewsSeconds);\nulong? executedOrder = null;\nulong? pendingOrder = null;\nstring direction = \"\";\n\n\n// \u2502  MONITORING LOOP (every 1 sec, max 3 minutes)          \n// \u2502  FASTER than PendingBreakout (news requires speed!)    \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nwhile (DateTime.UtcNow - monitorStart &lt; timeout &amp;&amp; !ct.IsCancellationRequested)\n{\n    await Task.Delay(1000, ct);  // Every second!\n\n\n    // \u2502  Get list of PENDING ORDERS                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tickets = await _service.OpenedOrdersTicketsAsync();\n\n    bool buyStillPending = false;\n    bool sellStillPending = false;\n\n\n    // \u2502  Check if our orders are in the list            \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    foreach (var ticket in tickets.OpenedOrdersTickets)\n    {\n        if (ticket == (long)buyStopResult.Order) buyStillPending = true;\n        if (ticket == (long)sellStopResult.Order) sellStillPending = true;\n    }\n\n\n    // \u2502  BREAKOUT SCENARIO DETECTION (4 options)            \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 1: UPWARD BREAKOUT\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    if (!buyStillPending &amp;&amp; sellStillPending)\n    {\n        // BuyStop DISAPPEARED (executed) \u2192 became position\n        // SellStop STILL PENDING \u2192 not executed\n        executedOrder = buyStopResult.Order;\n        pendingOrder = sellStopResult.Order;\n        direction = \"UPWARD\";\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 2: DOWNWARD BREAKOUT\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    else if (buyStillPending &amp;&amp; !sellStillPending)\n    {\n        // SellStop DISAPPEARED (executed)\n        // BuyStop STILL PENDING\n        executedOrder = sellStopResult.Order;\n        pendingOrder = buyStopResult.Order;\n        direction = \"DOWNWARD\";\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 3: BOTH TRIGGERED (extreme volatility!)\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    else if (!buyStillPending &amp;&amp; !sellStillPending)\n    {\n        // Both orders DISAPPEARED \u2192 both became positions!\n        // Price whipsawed up AND down very quickly\n        Console.WriteLine(\"  \u26a1 BOTH ORDERS TRIGGERED - Extreme volatility!\");\n        direction = \"BOTH\";\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 4: BOTH STILL PENDING (continue waiting)\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // else: both orders still in list \u2192 news didn't cause breakout\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#detailed-breakout-detection-logic","title":"Detailed breakout detection logic","text":"<pre><code>STATE BEFORE NEWS (T=0):\n\nMT5 Terminal:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  789: BUY STOP   \u2502  (empty)                               \u2502\n\u2502  790: SELL STOP  \u2502                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nOpenedOrdersTicketsAsync() \u2192 OpenedOrdersTickets: [789, 790]\n\nbuyStillPending = true (789 found)\nsellStillPending = true (790 found)\n\n\u2192 Both pending \u2192 continue waiting\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nNEWS RELEASED (T=1s): NFP better than expected \u2192 price up!\n\nPrice: 1.10000 \u2192 1.10010 \u2192 1.10017 \u2192 1.10020...\n\nMT5 Terminal (T=2s):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  790: SELL STOP  \u2502  789: BUY 0.02 @ 1.10017               \u2502\n\u2502                  \u2502      (BuyStop triggered!)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nOpenedOrdersTicketsAsync() \u2192 OpenedOrdersTickets: [790]\n                              (BuyStop 789 DISAPPEARED!)\n\nbuyStillPending = false  \u2190 789 NOT found!\nsellStillPending = true  \u2190 790 still in list\n\nif (!buyStillPending &amp;&amp; sellStillPending) \u2192 TRUE!\n{\n    direction = \"UPWARD\";\n    executedOrder = 789;\n    pendingOrder = 790;\n    break;  \u2190 Exit monitoring\n}\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nSCENARIO 3: Extreme volatility\n\nNews released UNEXPECTEDLY \u2192 price jerked DOWN:\n1.10000 \u2192 1.09985 (SellStop triggered!)\n\nThen SHARPLY UP (correction):\n1.09985 \u2192 1.10017 (BuyStop also triggered!)\n\nMT5 Terminal:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  (empty)         \u2502  789: BUY 0.02 @ 1.10017               \u2502\n\u2502                  \u2502  790: SELL 0.02 @ 1.09985              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nOpenedOrdersTicketsAsync() \u2192 OpenedOrdersTickets: []\n                              (BOTH DISAPPEARED!)\n\nbuyStillPending = false\nsellStillPending = false\n\nif (!buyStillPending &amp;&amp; !sellStillPending) \u2192 TRUE!\n{\n    Console.WriteLine(\"\u26a1 BOTH ORDERS TRIGGERED - Extreme volatility!\");\n    direction = \"BOTH\";\n    break;\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#phase-5-handling-breakout-result-lines-138-161","title":"Phase 5: Handling breakout result (lines 138-161)","text":"<pre><code>// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// SCENARIO A: ONE ORDER TRIGGERED (normal breakout)\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nif (executedOrder.HasValue &amp;&amp; pendingOrder.HasValue)\n{\n    Console.WriteLine($\"  \ud83d\ude80 {direction} BREAKOUT DETECTED!\");\n    Console.WriteLine($\"  Position opened: #{executedOrder.Value}\");\n    Console.WriteLine($\"  Canceling opposite order #{pendingOrder.Value}...\");\n\n\n    // \u2502  OCO mechanism: cancel opposite order           \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(pendingOrder.Value);\n    Console.WriteLine(\"  \u2713 Opposite order canceled\\n\");\n\n\n    // \u2502  Hold position for 60 seconds                   \n    // \u2502  SL or TP may trigger during this time          \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine(\"  \u23f3 Holding position for 60 seconds...\");\n    await Task.Delay(60000, ct);\n}\n\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// SCENARIO B: BOTH ORDERS TRIGGERED\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nelse if (direction == \"BOTH\")\n{\n    // TWO positions opened (BUY and SELL) \u2192 this is a HEDGE!\n    // Hold for shorter time (30 sec instead of 60)\n    Console.WriteLine(\"  \u23f3 Holding both positions for 30 seconds...\");\n    await Task.Delay(30000, ct);\n}\n\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// SCENARIO C: TIMEOUT (breakout didn't happen)\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nelse\n{\n    Console.WriteLine($\"  \u23f1 No breakout after {MaxWaitAfterNewsSeconds}s\");\n    Console.WriteLine(\"  Canceling both pending orders...\");\n\n\n    // \u2502  Cancel BOTH orders                             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(buyStopResult.Order);\n    await _service.CloseByTicket(sellStopResult.Order);\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#phase-6-final-closing-lines-163-176","title":"Phase 6: Final closing (lines 163-176)","text":"<pre><code>// \u2502  Close all remaining positions                          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"\\n  Closing all remaining positions...\");\nawait _service.CloseAll(Symbol);\nConsole.WriteLine(\"  \u2713 All closed\");\n\nvar finalBalance = await _service.GetBalanceAsync();\nvar profit = finalBalance - initialBalance;\n\nConsole.WriteLine($\"\\n  Final balance: ${finalBalance:F2}\");\nConsole.WriteLine($\"  Profit/Loss: ${profit:F2}\");\nConsole.WriteLine($\"  Direction: {(string.IsNullOrEmpty(direction) ? \"None\" : direction)}\");\n\nreturn profit;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#complete-life-cycle-upward-breakout-scenario","title":"\ud83c\udfad Complete Life Cycle (Upward breakout scenario)","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#execution-timeline","title":"Execution timeline","text":"<pre><code>T=-60s   START ExecuteAsync()\n         \u2502\n         \u251c\u2500\u25ba GetBalanceAsync()           \u2192 $10000.00\n         \u2502\n         \u251c\u2500\u25ba \"Waiting 60s before news event...\"\n         \u251c\u2500\u25ba Task.Delay(60000)  \u2190 COUNTDOWN\n         \u2502\n         \u2502   USER sees countdown until news\n         \u2502\nT=0      \u251c\u2500\u25ba Task.Delay COMPLETED\n         \u2502\n         \u251c\u2500\u25ba \"NEWS EVENT IMMINENT!\"\n         \u251c\u2500\u25ba SymbolInfoTickAsync()\n         \u2502   \u2514\u2500\u25ba Bid=1.10000, Ask=1.10002\n         \u2502\nT=1s     \u251c\u2500\u25ba BuyStopPoints(+15)\n         \u2502   \u2514\u2500\u25ba Created BuyStop @ 1.10017\n         \u2502       SL: 1.09997, TP: 1.10057\n         \u2502\nT=2s     \u251c\u2500\u25ba SellStopPoints(-15)\n         \u2502   \u2514\u2500\u25ba Created SellStop @ 1.09985\n         \u2502       SL: 1.10005, TP: 1.09945\n         \u2502\n         \u2502   \"\u2705 STRADDLE ACTIVE\"\n         \u2502\n         \u2502   MT5 Terminal state:\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 PENDING ORDERS \u2502 POSITIONS    \u2502\n         \u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502 789: BUY STOP  \u2502 (empty)      \u2502\n         \u2502   \u2502 790: SELL STOP \u2502              \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\nT=3s     \u251c\u2500\u25ba MONITORING START (max 180 sec)\n         \u2502\nT=4s     \u251c\u2500\u25ba Task.Delay(1000)\n         \u2502   OpenedOrdersTicketsAsync() \u2192 [789, 790]\n         \u2502   buyStillPending = true\n         \u2502   sellStillPending = true\n         \u2502   \u2192 Both pending \u2192 continue\n         \u2502\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502  NEWS RELEASED!                \u2502\n         \u2502   \u2502  NFP: +350K jobs (forecast +200K)\u2502\n         \u2502   \u2502  Much better than expected!    \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502   MARKET: Price sharply UP!\n         \u2502   1.10000 \u2192 1.10010 \u2192 1.10017 \u2192 1.10020...\n         \u2502\nT=5s     \u251c\u2500\u25ba MT5 Terminal: Price reached 1.10017!\n         \u2502   BuyStop TRIGGERED!\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 Opened position BUY 0.02         \u2502\n         \u2502   \u2502 Entry: 1.10017                   \u2502\n         \u2502   \u2502 SL: 1.09997                      \u2502\n         \u2502   \u2502 TP: 1.10057                      \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\nT=6s     \u251c\u2500\u25ba Task.Delay(1000)\n         \u2502   OpenedOrdersTicketsAsync() \u2192 [790]\n         \u2502   buyStillPending = false  \u2190 789 DISAPPEARED!\n         \u2502   sellStillPending = true\n         \u2502\n         \u2502   if (!buy &amp;&amp; sell) \u2192 TRUE!\n         \u2502   {\n         \u2502       direction = \"UPWARD\";\n         \u2502       executedOrder = 789;\n         \u2502       pendingOrder = 790;\n         \u2502       break;  \u2190 Exit monitoring\n         \u2502   }\n         \u2502\n         \u251c\u2500\u25ba \"\ud83d\ude80 UPWARD BREAKOUT DETECTED!\"\n         \u2502\n         \u251c\u2500\u25ba CloseByTicket(790)  \u2190 Cancel SellStop\n         \u2502   \u2514\u2500\u25ba OrderDeleteAsync(790)\n         \u2502\n         \u2502   MT5 Terminal state:\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 PENDING ORDERS \u2502 POSITIONS            \u2502\n         \u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502 (empty)        \u2502 789: BUY 0.02        \u2502\n         \u2502   \u2502                \u2502      @ 1.10017       \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u251c\u2500\u25ba \"Holding position for 60 seconds...\"\n         \u251c\u2500\u25ba Task.Delay(60000)\n         \u2502\n         \u2502   MARKET: Price continues rising...\n         \u2502   1.10020 \u2192 1.10040 \u2192 1.10057...\n         \u2502\nT=35s    \u2502   MT5 Terminal: Price reached 1.10057!\n         \u2502   TP TRIGGERED!\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 Position closed automatically    \u2502\n         \u2502   \u2502 Entry: 1.10017                   \u2502\n         \u2502   \u2502 Exit:  1.10057                   \u2502\n         \u2502   \u2502 Profit: +40 pts \u00d7 0.02 = +$8.00  \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\nT=66s    \u251c\u2500\u25ba Task.Delay(60000) finished\n         \u2502\n         \u251c\u2500\u25ba CloseAll(\"EURUSD\")\n         \u2502   \u2514\u2500\u25ba Position already closed (TP triggered)\n         \u2502\nT=67s    \u251c\u2500\u25ba GetBalanceAsync()           \u2192 $10008.00\n         \u251c\u2500\u25ba profit = 10008.00 - 10000.00 = +$8.00\n         \u2502\n         \u2514\u2500\u25ba RETURN profit = 8.00\n\nTOTAL: Caught news breakout WITHOUT predicting direction!\n       Profit: +$8.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#what-the-result-is-made-of","title":"\ud83d\udcca What the result is made of","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#profit-calculation-upward-breakout-tp-triggered","title":"Profit calculation (upward breakout, TP triggered)","text":"<pre><code>INITIAL BALANCE: $10000.00\n\nSTRADDLE PLACED:\n- BuyStop @ 1.10017 (SL: 1.09997, TP: 1.10057)\n- SellStop @ 1.09985 (canceled after upward breakout)\n\nUPWARD BREAKOUT:\n- BuyStop triggered @ 1.10017\n- Opened position BUY 0.02 lots\n\nTP TRIGGERED:\n- Exit @ 1.10057\n- Pips: (1.10057 - 1.10017) / 0.00001 = 40 points\n\nPROFIT CALCULATION:\n- Profit = Pips \u00d7 Volume \u00d7 PointValue\n- PointValue for EURUSD (0.02 lots) = 0.02 \u00d7 $10 = $0.20 per point\n- Profit = 40 \u00d7 $0.20 = +$8.00\n\nFINAL BALANCE: $10008.00\nPROFIT = $8.00\n\nreturn 8.00;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#pl-calculation-scenario-both-both-orders-triggered","title":"P/L calculation (scenario \"BOTH\" - both orders triggered)","text":"<pre><code>EXTREME VOLATILITY:\n\nNews caused whipsaw (jerked both directions):\n\n1. Price fell to 1.09985 \u2192 SellStop triggered\n2. Price rose to 1.10017 \u2192 BuyStop triggered\n\nTWO POSITIONS OPENED:\n- BUY 0.02 @ 1.10017\n- SELL 0.02 @ 1.09985\n\nFINAL PRICE (after 30 sec): 1.10005\n\nCLOSING:\n\nBUY position:\n  Entry: 1.10017\n  Exit:  1.10005\n  Pips:  (1.10005 - 1.10017) / 0.00001 = -12 points\n  P/L:   -12 \u00d7 $0.20 = -$2.40\n\nSELL position:\n  Entry: 1.09985\n  Exit:  1.10005\n  Pips:  (1.09985 - 1.10005) / 0.00001 = -20 points\n  P/L:   -20 \u00d7 $0.20 = -$4.00\n\nTOTAL:\n  BUY:  -$2.40\n  SELL: -$4.00\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  TOTAL: -$6.40\n\nFINAL BALANCE: $9993.60\nPROFIT = -$6.40\n\nThis is the WORST scenario (whipsaw) - both orders triggered, both in loss.\nProbability: ~5-10% for strong news.\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#pl-calculation-timeout-breakout-didnt-happen","title":"P/L calculation (timeout - breakout didn't happen)","text":"<pre><code>WEAK NEWS:\n\nNews released, but data within forecast.\nPrice moves in narrow range:\n1.10000 \u2192 1.10005 \u2192 1.09998 \u2192 1.10003...\n\nNO ORDER TRIGGERED:\n- BuyStop @ 1.10017 (price didn't reach)\n- SellStop @ 1.09985 (price didn't reach)\n\nTIMEOUT (180 seconds):\n- Both orders STILL pending\n- direction = \"\"\n- executedOrder = null\n- pendingOrder = null\n\nCANCELING BOTH ORDERS:\n- CloseByTicket(789) \u2192 BuyStop canceled\n- CloseByTicket(790) \u2192 SellStop canceled\n\nFINAL BALANCE: $10000.00\nPROFIT = $0.00\n\nOrders didn't execute \u2192 no losses!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#components-and-their-roles","title":"\ud83e\udde9 Components and their roles","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#1-newsstraddleorchestrator","title":"1. NewsStraddleOrchestrator","text":"<p>Role: News straddle strategy coordinator</p> <p>Tasks:</p> <ul> <li>Manages timing (countdown until news)</li> <li>Places symmetric straddle (BuyStop + SellStop)</li> <li>MONITORS every SECOND (faster than regular PendingBreakout)</li> <li>Detects 3 breakout scenarios (UPWARD, DOWNWARD, BOTH)</li> <li>Cancels opposite order (OCO mechanism)</li> <li>Handles timeout</li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#2-key-timing-parameters","title":"2. Key timing parameters","text":"<pre><code>public int SecondsBeforeNews { get; set; } = 60;\n// \u2191 Countdown until news\n// Launch orchestrator 60 seconds before exact time\n\npublic int MaxWaitAfterNewsSeconds { get; set; } = 180;\n// \u2191 Maximum time waiting for breakout\n// News acts fast \u2192 3 minutes is enough\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#3-mt5sugar-extension-methods","title":"3. MT5Sugar Extension Methods","text":"<pre><code>// Straddle placement:\nBuyStopPoints(priceOffsetPoints: +15)   // Above price\nSellStopPoints(priceOffsetPoints: -15)  // Below price\n\n// Cancellation:\nCloseByTicket(ticket)  // Cancel pending order\nCloseAll(symbol)       // Close all positions\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#4-breakout-detection-logic","title":"4. Breakout detection logic","text":"<pre><code>KEY MECHANISM: Check ticket presence in pending list\n\nOpenedOrdersTicketsAsync() returns list of ONLY pending orders.\nWhen order EXECUTES \u2192 it becomes POSITION \u2192 disappears from list.\n\nif (!buyStillPending &amp;&amp; sellStillPending)\n   \u2192 BuyStop DISAPPEARED (executed) \u2192 UPWARD breakout\n\nelse if (buyStillPending &amp;&amp; !sellStillPending)\n   \u2192 SellStop DISAPPEARED (executed) \u2192 DOWNWARD breakout\n\nelse if (!buyStillPending &amp;&amp; !sellStillPending)\n   \u2192 BOTH DISAPPEARED \u2192 BOTH (extreme volatility)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#final-dependency-diagram","title":"\ud83d\udd0d Final Dependency Diagram","text":"<pre><code>\u2502  USER CODE                                                  \n\u2502  var orch = new NewsStraddleOrchestrator(service);          \n\u2502  orch.SecondsBeforeNews = 60;  \u2190 Launch 60 sec before       \n\u2502  await orch.ExecuteAsync();    \u2190 @ 13:29:00 (NFP @ 13:30)   \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  NewsStraddleOrchestrator                                   \n\u2502    \n\u2502  \u2502  ExecuteAsync() {                                       \n\u2502  \u2502    1. Task.Delay(SecondsBeforeNews \u00d7 1000)              \n\u2502  \u2502    2. SymbolInfoTickAsync() \u2192 current price            \n\u2502  \u2502    3. BuyStopPoints(+StraddleDistance)                  \n\u2502  \u2502    4. SellStopPoints(-StraddleDistance)                 \n\u2502  \u2502    5. LOOP (every 1 sec, max 3 min):                    \n\u2502  \u2502       - OpenedOrdersTicketsAsync()                      \n\u2502  \u2502       - Check: which order disappeared?                 \n\u2502  \u2502       - IF one disappeared \u2192 CloseByTicket(other)       \n\u2502  \u2502    6. Task.Delay(60000)  \u2190 Hold position                \n\u2502  \u2502    7. CloseAll()                                        \n\u2502  \u2502  }                                                      \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Sugar Extension Methods                                 \n\u2502  - BuyStopPoints(+offsetPoints)  \u2192 above Ask                \n\u2502  - SellStopPoints(-offsetPoints) \u2192 below Bid                \n\u2502  - CloseByTicket(ticket) \u2192 OCO cancellation                 \n\u2502  - CloseAll(symbol) \u2192 final closing                         \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n                    [MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator.HOW_IT_WORKS/#summary","title":"\ud83c\udfaf Summary","text":"<p>NewsStraddleOrchestrator is made of:</p> <ol> <li> <p>1 dependency: <code>MT5Service _service</code></p> </li> <li> <p>7 parameters: Symbol, StraddleDistancePoints, Volume, SL, TP, SecondsBeforeNews, MaxWaitAfterNewsSeconds</p> </li> <li> <p>Key logic:</p> </li> <li> <p>Countdown until news (Task.Delay)</p> </li> <li>Symmetric straddle (BuyStop + SellStop)</li> <li>Monitoring every second (faster than regular breakout!)</li> <li>3 scenarios: UPWARD, DOWNWARD, BOTH</li> <li>OCO mechanism (cancel opposite)</li> </ol> <p>Works through:</p> <ul> <li>Timing: launch 60 seconds before news</li> <li>Placing straddle right before news</li> <li>Fast monitoring (1 second instead of 3)</li> <li>Detecting breakout through ticket disappearance from pending list</li> <li>Automatic opposite order cancellation</li> </ul> <p>Returns: - <code>double profit</code> - difference between final and initial balance</p> <p>Key insight:</p> <p>Straddle allows catching news volatility WITHOUT predicting direction. By placing orders in both directions, we're guaranteed to catch the movement if it's strong enough. Fast monitoring (every second) is critically important for news - they act INSTANTLY!</p> <p>Success mathematics: <pre><code>R:R ratio = 1:2 (SL=20, TP=40)\n\nEven with 40% win rate on news \u2192 profitable:\n- 6 trades: 4 losses (-$32) + 2 wins (+$32) = $0\n- 7 trades: 4 losses (-$32) + 3 wins (+$48) = +$16\n\nNews often gives strong directional movements \u2192 TP achievable!\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/","title":"NewsStraddleOrchestrator - News Straddle","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#description","title":"Description","text":"<p>NewsStraddleOrchestrator is an orchestrator for news trading using the straddle method. Before important news release, it places two pending Stop orders: Buy Stop above and Sell Stop below the current price. When the news comes out and the price moves sharply in either direction, the corresponding order is triggered and the opposite is cancelled.</p> <p>Operating Principle: \"News Trading\" - catch volatility from news without predicting direction. Straddle allows catching the movement regardless of whether the price goes up or down after the news (NFP, CPI, central bank decisions, etc.).</p> <p>File: <code>Examples\\Orchestrators\\NewsStraddleOrchestrator.cs</code></p>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#architecture","title":"Architecture","text":"<pre><code>NEWS STRADDLE ORCHESTRATOR\n    \u2193\nMT5Service Instance\n    \u2193\n  \u250c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2193     \u2193     \u2193\nBuyStop SellStop CloseBy\nPoints  Points   Ticket\n(above) (below)  (cancel)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#dependencies","title":"Dependencies","text":"<ul> <li>MT5Service: Service layer for MT5</li> <li>MT5Sugar Extension Methods: <code>BuyStopPoints</code>, <code>SellStopPoints</code>, <code>CloseByTicket</code>, <code>CloseAll</code></li> <li>mt5_term_api: gRPC types (<code>OrderSendData</code>, <code>OpenedOrdersTicketsData</code>)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#configuration-parameters","title":"Configuration Parameters","text":"Parameter Type Default Description <code>Symbol</code> string <code>\"EURUSD\"</code> Trading instrument <code>StraddleDistancePoints</code> int <code>15</code> Distance of orders from current price (in points) <code>Volume</code> double <code>0.02</code> Volume of each order in lots <code>StopLossPoints</code> int <code>20</code> Stop-loss in points <code>TakeProfitPoints</code> int <code>40</code> Take-profit in points <code>SecondsBeforeNews</code> int <code>60</code> Waiting time before news (sec) <code>MaxWaitAfterNewsSeconds</code> int <code>180</code> Maximum waiting time for breakout after placing orders"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#configuration-example","title":"Configuration Example","text":"<pre><code>var newsStraddle = new NewsStraddleOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    StraddleDistancePoints = 20,    // Orders at distance of 20 points\n    Volume = 0.01,                  // Conservative volume\n    StopLossPoints = 25,            // SL = 25 points\n    TakeProfitPoints = 60,          // TP = 60 points (R:R = 1:2.4)\n    SecondsBeforeNews = 120,        // Wait 2 minutes before news\n    MaxWaitAfterNewsSeconds = 300   // Wait for breakout 5 minutes\n};\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#how-to-run","title":"How to Run","text":"<p>You can run this orchestrator using any of the following commands:</p> <pre><code>dotnet run 10\ndotnet run news\ndotnet run newsstraddle\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#algorithm","title":"Algorithm","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#flowchart","title":"Flowchart","text":"<pre><code>START\n  \u2193\nGet initial balance\n  \u2193\nTask.Delay(SecondsBeforeNews \u00d7 1000)  // Countdown\n  \u2193\n\"NEWS EVENT IMMINENT!\"\n  \u2193\nSymbolInfoTickAsync() \u2192 current price\n  \u2193\nBuyStopPoints(+StraddleDistancePoints)\n  \u2192 If error \u2192 return 0\n  \u2193\nSellStopPoints(-StraddleDistancePoints)\n  \u2192 If error \u2192 cancel BuyStop, return 0\n  \u2193\n\"STRADDLE ACTIVE\"\n  \u2193\nMONITORING (every second, max MaxWaitAfterNewsSeconds)\n  \u2192 OpenedOrdersTicketsAsync()\n  \u2192 Check: BuyStop still pending?\n  \u2192 Check: SellStop still pending?\n  \u2192 CONDITIONS:\n      If BuyStop executed, SellStop pending\n        \u2192 UPWARD breakout \u2192 cancel SellStop\n      If SellStop executed, BuyStop pending\n        \u2192 DOWNWARD breakout \u2192 cancel BuyStop\n      If both executed\n        \u2192 BOTH (extreme volatility!)\n      Timeout \u2192 cancel both\n  \u2193\nTask.Delay(60000)  // Hold position 60 sec\n  \u2193\nCloseAll(Symbol)\n  \u2193\nReturn profit\nEND\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#step-by-step-description","title":"Step-by-Step Description","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#1-initialization-and-countdown-lines-36-47","title":"1. Initialization and countdown (lines 36-47)","text":"<pre><code>var initialBalance = await _service.GetBalanceAsync();\n\nConsole.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\nConsole.WriteLine($\"  Symbol: {Symbol}\");\nConsole.WriteLine($\"  Straddle distance: {StraddleDistancePoints} pts\");\n\n\n// \u2502  COUNTDOWN TO NEWS                                      \n// \u2502  Simulating waiting before event                        \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine($\"  \u23f2  Waiting {SecondsBeforeNews}s before news event...\\n\");\nawait Task.Delay(SecondsBeforeNews * 1000, ct);\n</code></pre> <p>What happens:</p> <ul> <li>Waiting before news (default 60 seconds)</li> <li>In real trading: run orchestrator 1-2 minutes before exact news time</li> <li>Example: NFP releases at 13:30 UTC \u2192 run orchestrator at 13:29:00</li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#2-getting-current-price-before-news-lines-49-51","title":"2. Getting current price before news (lines 49-51)","text":"<pre><code>var tick = await _service.SymbolInfoTickAsync(Symbol);\n\nConsole.WriteLine($\"  \ud83d\udcf0 NEWS EVENT IMMINENT!\");\nConsole.WriteLine($\"  Current: Bid={tick.Bid:F5}, Ask={tick.Ask:F5}\\n\");\n</code></pre> <p>Critically important:</p> <ul> <li>Price is obtained IMMEDIATELY before placing orders</li> <li>Ensures straddle symmetry relative to current price</li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#3-placing-buy-stop-upper-straddle-order-lines-53-70","title":"3. Placing Buy Stop (upper straddle order) (lines 53-70)","text":"<pre><code>Console.WriteLine(\"  Placing BUY STOP (upper straddle)...\");\n\nvar buyStopResult = await _service.BuyStopPoints(\n    symbol: Symbol,                         // \"EURUSD\"\n    volume: Volume,                         // 0.02\n    priceOffsetPoints: StraddleDistancePoints,  // +15 (POSITIVE!)\n    slPoints: StopLossPoints,               // 20\n    tpPoints: TakeProfitPoints,             // 40\n    comment: \"News-Buy\"\n);\n\nif (buyStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 BUY STOP failed: {buyStopResult.Comment}\\n\");\n    return 0;\n}\n\nConsole.WriteLine($\"  \u2713 BUY STOP: #{buyStopResult.Order}\\n\");\n</code></pre> <p>Calculation example: <pre><code>Current Ask price: 1.10000\nStraddleDistancePoints: 15\npoint: 0.00001\n\nBuyStop price = 1.10000 + (15 \u00d7 0.00001) = 1.10015\n\nWhen news comes out and price shoots UP to 1.10015 \u2192 order executes\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#4-placing-sell-stop-lower-straddle-order-lines-72-91","title":"4. Placing Sell Stop (lower straddle order) (lines 72-91)","text":"<pre><code>Console.WriteLine(\"  Placing SELL STOP (lower straddle)...\");\n\nvar sellStopResult = await _service.SellStopPoints(\n    symbol: Symbol,\n    volume: Volume,\n    priceOffsetPoints: -StraddleDistancePoints,  // -15 (NEGATIVE!)\n    slPoints: StopLossPoints,\n    tpPoints: TakeProfitPoints,\n    comment: \"News-Sell\"\n);\n\nif (sellStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 SELL STOP failed: {sellStopResult.Comment}\");\n    Console.WriteLine(\"  Canceling BUY STOP...\");\n\n\n    // \u2502  IMPORTANT: Cancel first order!                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(buyStopResult.Order);\n    return 0;\n}\n\nConsole.WriteLine($\"  \u2713 SELL STOP: #{sellStopResult.Order}\\n\");\nConsole.WriteLine(\"  \u2705 STRADDLE ACTIVE - Waiting for news spike!\\n\");\n</code></pre> <p>Calculation example: <pre><code>Current Bid price: 1.10000\nStraddleDistancePoints: 15 (but use -15)\npoint: 0.00001\n\nSellStop price = 1.10000 + (-15 \u00d7 0.00001) = 1.09985\n\nWhen news comes out and price shoots DOWN to 1.09985 \u2192 order executes\n</code></pre></p> <p>Result: <pre><code>\u2502  STRADDLE PLACED:                                   \n\u2502                                                     \n\u2502  1.10015  BUY STOP  (upward breakout)               \n\u2502           SL: 1.09995, TP: 1.10055                  \n\u2502                                                     \n\u2502  1.10000  CURRENT PRICE                             \n\u2502                                                     \n\u2502  1.09985  SELL STOP (downward breakout)             \n\u2502           SL: 1.10005, TP: 1.09945                  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#5-monitoring-for-breakout-after-news-lines-94-136","title":"5. Monitoring for breakout after news (lines 94-136)","text":"<pre><code>var monitorStart = DateTime.UtcNow;\nvar timeout = TimeSpan.FromSeconds(MaxWaitAfterNewsSeconds);\nulong? executedOrder = null;\nulong? pendingOrder = null;\nstring direction = \"\";\n\n\n// \u2502  MONITORING LOOP (every 1 sec, max 3 minutes)          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nwhile (DateTime.UtcNow - monitorStart &lt; timeout &amp;&amp; !ct.IsCancellationRequested)\n{\n    await Task.Delay(1000, ct);  // Every second (faster than PendingBreakout!)\n\n    var tickets = await _service.OpenedOrdersTicketsAsync();\n    bool buyStillPending = false;\n    bool sellStillPending = false;\n\n    foreach (var ticket in tickets.OpenedOrdersTickets)\n    {\n        if (ticket == (long)buyStopResult.Order) buyStillPending = true;\n        if (ticket == (long)sellStopResult.Order) sellStillPending = true;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 1: UPWARD BREAKOUT\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    if (!buyStillPending &amp;&amp; sellStillPending)\n    {\n        executedOrder = buyStopResult.Order;\n        pendingOrder = sellStopResult.Order;\n        direction = \"UPWARD\";\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 2: DOWNWARD BREAKOUT\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    else if (buyStillPending &amp;&amp; !sellStillPending)\n    {\n        executedOrder = sellStopResult.Order;\n        pendingOrder = buyStopResult.Order;\n        direction = \"DOWNWARD\";\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 3: BOTH TRIGGERED (rare case!)\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    else if (!buyStillPending &amp;&amp; !sellStillPending)\n    {\n        Console.WriteLine(\"  \u26a1 BOTH ORDERS TRIGGERED - Extreme volatility!\");\n        direction = \"BOTH\";\n        break;\n    }\n\n    // SCENARIO 4: Both still pending \u2192 continue waiting\n}\n</code></pre> <p>Key differences from PendingBreakoutOrchestrator:</p> <ul> <li>Check every second (instead of 3 seconds) \u2192 news requires fast reaction</li> <li>Additional scenario \"BOTH\" for extreme volatility</li> <li>Short timeout (3 minutes) \u2192 news acts quickly</li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#6-breakout-handling-lines-138-161","title":"6. Breakout handling (lines 138-161)","text":"<pre><code>// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// SCENARIO A: ONE ORDER TRIGGERED (normal breakout)\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nif (executedOrder.HasValue &amp;&amp; pendingOrder.HasValue)\n{\n    Console.WriteLine($\"  \ud83d\ude80 {direction} BREAKOUT DETECTED!\");\n    Console.WriteLine($\"  Position opened: #{executedOrder.Value}\");\n    Console.WriteLine($\"  Canceling opposite order #{pendingOrder.Value}...\");\n\n    // Cancel opposite order\n    await _service.CloseByTicket(pendingOrder.Value);\n    Console.WriteLine(\"  \u2713 Opposite order canceled\\n\");\n\n\n    // \u2502  Hold position for 60 seconds                   \n    // \u2502  SL or TP may trigger during this time          \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine(\"  \u23f3 Holding position for 60 seconds...\");\n    await Task.Delay(60000, ct);\n}\n\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// SCENARIO B: BOTH ORDERS TRIGGERED (extreme volatility)\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nelse if (direction == \"BOTH\")\n{\n    // Price jerked in both directions very fast!\n    // TWO positions opened (BUY and SELL simultaneously)\n    Console.WriteLine(\"  \u23f3 Holding both positions for 30 seconds...\");\n    await Task.Delay(30000, ct);\n}\n\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n// SCENARIO C: TIMEOUT (breakout didn't happen)\n// \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nelse\n{\n    Console.WriteLine($\"  \u23f1 No breakout after {MaxWaitAfterNewsSeconds}s\");\n    Console.WriteLine(\"  Canceling both pending orders...\");\n\n    // Cancel both orders\n    await _service.CloseByTicket(buyStopResult.Order);\n    await _service.CloseByTicket(sellStopResult.Order);\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#7-final-close-lines-163-176","title":"7. Final close (lines 163-176)","text":"<pre><code>// \u2502  Close all remaining positions                          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"\\n  Closing all remaining positions...\");\nawait _service.CloseAll(Symbol);\nConsole.WriteLine(\"  \u2713 All closed\");\n\nvar finalBalance = await _service.GetBalanceAsync();\nvar profit = finalBalance - initialBalance;\n\nConsole.WriteLine($\"\\n  Final balance: ${finalBalance:F2}\");\nConsole.WriteLine($\"  Profit/Loss: ${profit:F2}\");\nConsole.WriteLine($\"  Direction: {(string.IsNullOrEmpty(direction) ? \"None\" : direction)}\");\n\nreturn profit;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#strategy-visualization","title":"Strategy Visualization","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#scenario-1-upward-breakout-typical-nfp-scenario","title":"Scenario 1: UPWARD Breakout (typical NFP scenario)","text":"<pre><code>T=0      START\n         SecondsBeforeNews = 60\n         \u2502\n         \u251c\u2500\u25ba Task.Delay(60000) \u2192 waiting for news\n         \u2502\nT=60s    \u251c\u2500\u25ba \"NEWS EVENT IMMINENT!\"\n         \u2502   Current price: Bid=1.10000, Ask=1.10002\n         \u2502\n         \u251c\u2500\u25ba BuyStopPoints(+15)  \u2192 order @ 1.10017\n         \u251c\u2500\u25ba SellStopPoints(-15) \u2192 order @ 1.09985\n         \u2502\n         \u2502   STRADDLE PLACED:\n         \u2502   \n         \u2502   \u2502 BUY STOP  @ 1.10017              \n         \u2502   \u2502 CURRENT   @ 1.10000              \n         \u2502   \u2502 SELL STOP @ 1.09985              \n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502\nT=61s    \u251c\u2500\u25ba NEWS RELEASED! (NFP better than forecast)\n         \u2502   Price shoots UP:\n         \u2502   1.10000 \u2192 1.10010 \u2192 1.10018...\n         \u2502\nT=62s    \u251c\u2500\u25ba BUY STOP TRIGGERED @ 1.10017!\n         \u2502   Opened BUY position 0.02 lots\n         \u2502   SL: 1.09997, TP: 1.10057\n         \u2502\n         \u251c\u2500\u25ba Monitoring detected:\n         \u2502   buyStillPending = false (disappeared from list)\n         \u2502   sellStillPending = true\n         \u2502\n         \u2502   \u2192 \"UPWARD BREAKOUT DETECTED!\"\n         \u2502   \u2192 Cancel SELL STOP @ 1.09985\n         \u2502\n         \u2502   STATE:\n         \u2502   \n         \u2502   \u2502 Position: BUY 0.02 @ 1.10017     \n         \u2502   \u2502 SL: 1.09997, TP: 1.10057         \n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502\n         \u2502   Price continues to rise:\n         \u2502   1.10018 \u2192 1.10035 \u2192 1.10050 \u2192 1.10057...\n         \u2502\nT=90s    \u251c\u2500\u25ba TP HIT @ 1.10057!\n         \u2502   Profit: +40 pts \u00d7 0.02 lots = +$8.00\n         \u2502\nT=120s   \u251c\u2500\u25ba Task.Delay(60000) finished\n         \u2502\n         \u251c\u2500\u25ba CloseAll(\"EURUSD\")\n         \u2502   \u2514\u2500\u25ba Position already closed (TP hit earlier)\n         \u2502\n         \u2514\u2500\u25ba Result: Profit +$8.00\n\nTOTAL: Caught movement from news WITHOUT predicting direction!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#scenario-2-downward-breakout","title":"Scenario 2: DOWNWARD Breakout","text":"<pre><code>T=60s    STRADDLE PLACED:\n         BUY STOP  @ 1.10017\n         SELL STOP @ 1.09985\n\nT=61s    NEWS: NFP worse than forecast\n         Price shoots down:\n         1.10000 \u2192 1.09995 \u2192 1.09985 \u2192 1.09980...\n\nT=62s    SELL STOP TRIGGERED @ 1.09985!\n         Opened SELL position 0.02 lots\n         SL: 1.10005, TP: 1.09945\n\n         \u2192 \"DOWNWARD BREAKOUT DETECTED!\"\n         \u2192 Cancel BUY STOP @ 1.10017\n\n         Price continues to fall:\n         1.09980 \u2192 1.09960 \u2192 1.09945...\n\nT=85s    TP HIT @ 1.09945!\n         Profit: +40 pts \u00d7 0.02 lots = +$8.00\n\nResult: Profit +$8.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#scenario-3-extreme-volatility-both-orders-triggered","title":"Scenario 3: Extreme volatility (BOTH orders triggered)","text":"<pre><code>T=60s    STRADDLE PLACED:\n         BUY STOP  @ 1.10017\n         SELL STOP @ 1.09985\n\nT=61s    NEWS: Unexpected data!\n         Price sharply DOWN:\n         1.10000 \u2192 1.09985 (SELL STOP triggered!)\n\nT=62s    Then sharply UP (correction):\n         1.09985 \u2192 1.10000 \u2192 1.10017 (BUY STOP triggered!)\n\n\n         \u2502 \u26a1 BOTH ORDERS TRIGGERED!                 \n         \u2502                                          \n         \u2502 Position 1: SELL 0.02 @ 1.09985          \n         \u2502 Position 2: BUY  0.02 @ 1.10017          \n         \u2502                                          \n         \u2502 This is HEDGE (mutually neutralize)!     \n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nT=92s    Task.Delay(30000) finished\n\n         CloseAll(\"EURUSD\")\n         \u251c\u2500\u25ba Closed SELL @ current price 1.10010\n         \u2502   P/L: (1.09985 - 1.10010) \u00d7 0.02 = -$5\n         \u2502\n         \u2514\u2500\u25ba Closed BUY @ current price 1.10010\n             P/L: (1.10010 - 1.10017) \u00d7 0.02 = -$1.40\n\n         Total: -$5 + (-$1.40) = -$6.40\n\nResult: Loss -$6.40 (spreads and commissions on whipsaw)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#scenario-4-no-breakout-weak-news","title":"Scenario 4: No breakout (weak news)","text":"<pre><code>T=60s    STRADDLE PLACED:\n         BUY STOP  @ 1.10017\n         SELL STOP @ 1.09985\n\nT=61s    NEWS: Data within forecast range\n         Price moves in narrow range:\n         1.10000 \u2192 1.10005 \u2192 1.09998 \u2192 1.10003...\n\nT=180s   NO ORDERS TRIGGERED!\n         (Price didn't reach either 1.10017 or 1.09985)\n\n         \u2192 \"No breakout after 180s\"\n         \u2192 Cancel BUY STOP\n         \u2192 Cancel SELL STOP\n\nResult: Profit $0.00 (orders not executed)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#when-to-use-news-straddle","title":"When to Use News Straddle","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#best-news-events","title":"\u2705 Best News Events","text":"<ol> <li>Non-Farm Payrolls (NFP):</li> <li>USA, first Friday of month, 13:30 UTC</li> <li>Highest volatility</li> <li> <p>Recommended parameters:      <pre><code>StraddleDistancePoints = 20\nStopLossPoints = 30\nTakeProfitPoints = 70\n</code></pre></p> </li> <li> <p>Central Bank Decisions:</p> </li> <li>Fed (FOMC), ECB, BoE</li> <li>Huge movements on rate decisions</li> <li> <p>Recommended parameters:      <pre><code>StraddleDistancePoints = 25\nStopLossPoints = 35\nTakeProfitPoints = 90\n</code></pre></p> </li> <li> <p>CPI (Inflation Data):</p> </li> <li>USA, mid-month, 13:30 UTC</li> <li>Strong movements, especially on surprises</li> <li> <p>Recommended parameters:      <pre><code>StraddleDistancePoints = 18\nStopLossPoints = 25\nTakeProfitPoints = 60\n</code></pre></p> </li> <li> <p>GDP:</p> </li> <li>Quarterly data</li> <li>Medium volatility</li> <li>Recommended parameters:      <pre><code>StraddleDistancePoints = 15\nStopLossPoints = 20\nTakeProfitPoints = 50\n</code></pre></li> </ol>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#bad-news-events","title":"\u274c Bad News Events","text":"<ul> <li> <p>Secondary data: Consumer Confidence, Housing Starts.</p> </li> <li> <p>Central bank speeches: Unpredictable volatility timing.</p> </li> <li> <p>Corporate earnings: More for stocks, not forex.</p> </li> <li> <p>Geopolitical events: Unpredictable, may cause whipsaw.</p> </li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#risk-management","title":"Risk Management","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#choosing-straddledistancepoints","title":"Choosing StraddleDistancePoints","text":"<pre><code>Too close (5-10 pts):\n  \u2717 False triggers from noise before news\n  \u2717 Both orders may trigger (whipsaw)\n\nOptimal (15-25 pts):\n  \u2713 Protection from noise\n  \u2713 Catches real breakouts\n  \u2713 Rarely both orders trigger\n\nToo far (30+ pts):\n  \u2717 Will miss weak news\n  \u2717 Late execution (less movement before TP)\n\nRecommendation:\nStraddleDistancePoints = ATR(14) \u00d7 0.3-0.5\nFor EURUSD with ATR=12: use 15-20 pts\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#rr-calculation","title":"R:R Calculation","text":"<pre><code>Default:\n- StraddleDistancePoints = 15\n- StopLossPoints = 20\n- TakeProfitPoints = 40\n\nRisk/Reward:\n- Risk: 20 pts\n- Reward: 40 pts\n- R:R = 1:2 \u2713\n\nWhy this is good:\n- Even with 40% win rate \u2192 profitable\n- News often gives strong directional movements\n- TP reachable within 1-3 minutes after news\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#maximum-risk","title":"Maximum Risk","text":"<pre><code>Worst Case: Both orders triggered (whipsaw)\n\nPosition 1: SELL 0.02 @ 1.09985, SL 1.10005\nPosition 2: BUY 0.02 @ 1.10017, SL 1.09997\n\nIf both SL trigger:\n  SELL SL: -20 pts \u00d7 0.02 = -$4.00\n  BUY SL:  -20 pts \u00d7 0.02 = -$4.00\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Maximum loss: -$8.00\n\nProbability: ~5-10% (rarely both SL trigger simultaneously)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#recommendations","title":"Recommendations","text":"<ol> <li>Position volume:</li> <li>Conservative: 0.01 lots (risk $2-4)</li> <li>Moderate: 0.02 lots (risk $4-8)</li> <li> <p>Aggressive: 0.05 lots (risk $10-20)</p> </li> <li> <p>Placement timing:</p> </li> <li>Run orchestrator 1-2 minutes before exact news time</li> <li>Too early \u2192 risk of triggering from noise</li> <li> <p>Too late \u2192 miss start of movement</p> </li> <li> <p>Calendar check:    <pre><code>// Always check economic calendar!\n// Use only HIGH IMPACT news\n</code></pre></p> </li> <li> <p>Spread:</p> </li> <li>Spread widens before news!</li> <li>EURUSD: usually 0.5-1 point, during news can be 3-5 points</li> <li>Account for this in <code>StraddleDistancePoints</code></li> </ol>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#usage-examples","title":"Usage Examples","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#example-1-nfp-trading","title":"Example 1: NFP Trading","text":"<pre><code>// Non-Farm Payrolls - first Friday of month, 13:30 UTC\n// Run at 13:29:00\n\nvar nfpStraddle = new NewsStraddleOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    StraddleDistancePoints = 20,    // Wide (strong volatility)\n    Volume = 0.01,                  // Conservative\n    StopLossPoints = 30,            // Wide SL\n    TakeProfitPoints = 70,          // Ambitious TP (R:R = 1:2.3)\n    SecondsBeforeNews = 60,         // Wait 1 minute\n    MaxWaitAfterNewsSeconds = 240   // 4 minutes for breakout\n};\n\nvar profit = await nfpStraddle.ExecuteAsync();\nConsole.WriteLine($\"NFP Trade: ${profit:F2}\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#example-2-cpi-trading","title":"Example 2: CPI Trading","text":"<pre><code>// CPI - mid-month, 13:30 UTC\n// Run at 13:29:30\n\nvar cpiStraddle = new NewsStraddleOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    StraddleDistancePoints = 18,\n    Volume = 0.02,\n    StopLossPoints = 25,\n    TakeProfitPoints = 60,          // R:R = 1:2.4\n    SecondsBeforeNews = 30,         // Short wait\n    MaxWaitAfterNewsSeconds = 180\n};\n\nvar profit = await cpiStraddle.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#example-3-fomc-decision","title":"Example 3: FOMC Decision","text":"<pre><code>// FOMC - 8 times per year, ~19:00 UTC\n// Run at 18:58:00\n\nvar fomcStraddle = new NewsStraddleOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    StraddleDistancePoints = 25,    // VERY wide\n    Volume = 0.01,\n    StopLossPoints = 40,            // Protection from whipsaw\n    TakeProfitPoints = 100,         // R:R = 1:2.5\n    SecondsBeforeNews = 120,        // 2 minutes before\n    MaxWaitAfterNewsSeconds = 300   // 5 minutes\n};\n\nvar profit = await fomcStraddle.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#optimization","title":"Optimization","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#possible-improvements","title":"Possible Improvements","text":"<ol> <li> <p>Adaptive distance based on ATR:    <pre><code>var atr = await GetATR(Symbol, period: 14);\nStraddleDistancePoints = (int)(atr * 0.4);\n</code></pre></p> </li> <li> <p>Asymmetric straddle (if there's bias):    <pre><code>// Expect upward breakout more than downward\nbuyStopDistance = 15;   // Closer\nsellStopDistance = 25;  // Further\n</code></pre></p> </li> <li> <p>Partial close on profit:    <pre><code>// After +20 pts close 50%, trail the rest\nawait Task.Delay(10000);  // 10 sec\nvar positions = await _service.PositionsAsync(Symbol);\nif (positions.Count &gt; 0)\n{\n    await _service.ClosePartial(positions[0].Ticket, percent: 50);\n    await _service.TrailStart(positions[0].Ticket, trailPoints: 10);\n}\n</code></pre></p> </li> <li> <p>Cancel orders if spread too wide:    <pre><code>var spread = tick.Ask - tick.Bid;\nif (spread &gt; 0.0005)  // 5 points for EURUSD\n{\n    Console.WriteLine(\"Spread too wide - aborting\");\n    return 0;\n}\n</code></pre></p> </li> </ol>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#related-orchestrators","title":"Related Orchestrators","text":"<ul> <li> <p>PendingBreakoutOrchestrator: General breakout (not just news).</p> </li> <li> <p>QuickHedgeOrchestrator: Protection through hedging.</p> </li> <li> <p>SimpleScalpingOrchestrator: Market entry after breakout.</p> </li> </ul>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#console-output","title":"Console Output","text":""},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#output-example-upward-breakout","title":"Output example (upward breakout)","text":"<pre><code>+============================================================+\n|  NEWS STRADDLE ORCHESTRATOR                               |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Straddle distance: 15 pts\n  Volume: 0.02 lots\n  SL: 20 pts | TP: 40 pts\n\n  \u23f2  Waiting 60s before news event...\n\n  \ud83d\udcf0 NEWS EVENT IMMINENT!\n  Current: Bid=1.10000, Ask=1.10002\n\n  Placing BUY STOP (upper straddle)...\n  \u2713 BUY STOP: #123456789\n\n  Placing SELL STOP (lower straddle)...\n  \u2713 SELL STOP: #123456790\n\n  \u2705 STRADDLE ACTIVE - Waiting for news spike!\n\n  \ud83d\ude80 UPWARD BREAKOUT DETECTED!\n  Position opened: #123456789\n  Canceling opposite order #123456790...\n  \u2713 Opposite order canceled\n\n  \u23f3 Holding position for 60 seconds...\n\n  Closing all remaining positions...\n  \u2713 All closed\n\n  Final balance: $10008.00\n  Profit/Loss: $8.00\n  Direction: UPWARD\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/NewsStraddleOrchestrator/#summary","title":"Summary","text":"<p>NewsStraddleOrchestrator is a powerful strategy for news trading:</p> <p>\u2705 Pros:</p> <ul> <li>No need to predict direction - catch movement in any direction</li> <li>Excellent R:R ratio (1:2 and better)</li> <li>Automation of news trading</li> <li>Works on most volatile events</li> <li>OCO mechanism (cancel opposite order)</li> </ul> <p>\u274c Cons:</p> <ul> <li>Whipsaw risk (both orders trigger)</li> <li>Wide spreads during news</li> <li>Requires precise timing (run 1-2 min before news)</li> <li>Not all news gives strong movements</li> <li>Stress from high volatility</li> </ul> <p>Recommendation:  Use ONLY for HIGH IMPACT news (NFP, CPI, FOMC). Always check economic calendar. Start with small lots (0.01). Test on demo account before real trading. Avoid trading all news indiscriminately - choose 2-3 most important per month.</p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/","title":"HOW PendingBreakoutOrchestrator WORKS - Detailed Analysis","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#document-purpose","title":"\ud83c\udfaf Document Purpose","text":"<p>Show WHAT the orchestrator consists of and HOW EXACTLY it works at the code, methods and data level. Special attention is paid to the breakout detection logic and OCO mechanism.</p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#what-the-orchestrator-is-made-of","title":"\ud83d\udce6 What the orchestrator is made of","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#1-class-structure-lines-13-27","title":"1. Class structure (lines 13-27)","text":"<pre><code>public class PendingBreakoutOrchestrator\n{\n\n    // \u2502  SINGLE DEPENDENCY                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    private readonly MT5Service _service;\n\n\n    // \u2502  6 CONFIGURABLE PARAMETERS              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    public string Symbol { get; set; } = \"EURUSD\";\n    public int BreakoutDistancePoints { get; set; } = 25;\n    public int StopLossPoints { get; set; } = 15;\n    public int TakeProfitPoints { get; set; } = 30;\n    public double Volume { get; set; } = 0.01;\n    public int MaxWaitMinutes { get; set; } = 30;\n\n\n    // \u2502  DEPENDENCY INJECTION                   \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    public PendingBreakoutOrchestrator(MT5Service service)\n    {\n        _service = service;\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#dependency-visualization","title":"Dependency visualization","text":"<pre><code>\u2502        PendingBreakoutOrchestrator                         \n\u2502    \n\u2502  \u2502  private readonly MT5Service _service                  \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n        \u2502         MT5Service                  \n        \u2502    \n        \u2502  \u2502  private MT5Account _account    \n        \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n                \u2502      MT5Account         \n                \u2502   \n                \u2502  \u2502  gRPC Client        \n                \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n                    [MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#how-executeasync-works-step-by-step","title":"\ud83d\udd04 How ExecuteAsync() works - step by step","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#phase-1-initialization-lines-31-46","title":"Phase 1: Initialization (lines 31-46)","text":"<pre><code>public async Task&lt;double&gt; ExecuteAsync(CancellationToken ct = default)\n{\n\n    // \u2502  STEP 1: Output header                              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine(\"\\n+============================================================+\");\n    Console.WriteLine(\"|  PENDING BREAKOUT ORCHESTRATOR                            |\");\n    Console.WriteLine(\"+============================================================+\\n\");\n\n\n    // \u2502  STEP 2: Get initial balance                        \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var initialBalance = await _service.GetBalanceAsync();\n    Console.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\n\n\n    // \u2502  STEP 3: Get current price                          \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await _service.SymbolInfoTickAsync(Symbol);\n    Console.WriteLine($\"  Current: Bid={tick.Bid:F5}, Ask={tick.Ask:F5}\\n\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#phase-2-placing-buystop-lines-48-65","title":"Phase 2: Placing BuyStop (lines 48-65)","text":"<pre><code>// \u2502  PLACING BUY STOP (upward breakout)                     \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  Placing BUY STOP order...\");\n\nvar buyStopResult = await _service.BuyStopPoints(\n    symbol: Symbol,                         // \"EURUSD\"\n    volume: Volume,                         // 0.01\n    priceOffsetPoints: BreakoutDistancePoints,  // +25 (POSITIVE!)\n    slPoints: StopLossPoints,               // 15\n    tpPoints: TakeProfitPoints,             // 30\n    comment: \"Breakout-Buy\"\n);\n\n\n// \u2502  RESULT CHECK                                           \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nif (buyStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 BUY STOP failed: {buyStopResult.Comment}\\n\");\n    return 0;  // \u2190 EMERGENCY EXIT\n}\n\nConsole.WriteLine($\"  \u2713 BUY STOP placed: #{buyStopResult.Order}\\n\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#how-buystoppoints-works-internally","title":"How BuyStopPoints() works internally","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task&lt;OrderSendData&gt; BuyStopPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // \u2190 RECEIVES +25\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n{\n\n    // \u2502  STEP 1: Get current Ask price                      \n    // \u2502  For BUY STOP use ASK (buy price)                  \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await service.SymbolInfoTickAsync(symbol);\n    double askPrice = tick.Ask;  // For example: 1.10002\n\n\n    // \u2502  STEP 2: Get point size                             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var symbolInfo = await service.SymbolInfoAsync(symbol);\n    double point = symbolInfo.Point;  // For EURUSD: 0.00001\n\n    // \u2502  STEP 3: Calculate BUY STOP price                   \n    // \u2502  IMPORTANT: priceOffsetPoints POSITIVE (+25)        \n    // \u2502  BUY STOP is placed ABOVE current price             \n    // \u2502                                                     \n    // \u2502  price = askPrice + (priceOffsetPoints \u00d7 point)     \n    // \u2502       = 1.10002 + (25 \u00d7 0.00001)                    \n    // \u2502       = 1.10002 + 0.00025                           \n    // \u2502       = 1.10027                                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double price = askPrice + (priceOffsetPoints * point);\n\n\n    // \u2502  STEP 4: Calculate SL and TP for BUY                \n    // \u2502  SL below entry price (protection from fall)        \n    // \u2502  TP above entry price (profit taking)               \n    // \u2502                                                     \n    // \u2502  sl = price - (slPoints \u00d7 point)                    \n    // \u2502     = 1.10027 - (15 \u00d7 0.00001)                      \n    // \u2502     = 1.10027 - 0.00015                             \n    // \u2502     = 1.10012                                       \n    // \u2502                                                     \n    // \u2502  tp = price + (tpPoints \u00d7 point)                    \n    // \u2502     = 1.10027 + (30 \u00d7 0.00001)                      \n    // \u2502     = 1.10027 + 0.00030                             \n    // \u2502     = 1.10057                                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double sl = slPoints &gt; 0 ? price - (slPoints * point) : 0;\n    double tp = tpPoints &gt; 0 ? price + (tpPoints * point) : 0;\n\n\n    // \u2502  STEP 5: Call low-level method                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    return await service.BuyStopAsync(\n        symbol: symbol,      // \"EURUSD\"\n        volume: volume,      // 0.01\n        price: price,        // 1.10027\n        sl: sl,              // 1.10012\n        tp: tp,              // 1.10057\n        comment: comment     // \"Breakout-Buy\"\n    );\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#complete-call-chain-for-buystop","title":"Complete call chain for BuyStop","text":"<pre><code>\u2502  USER CODE (PendingBreakoutOrchestrator.cs:50)                 \n\u2502  await _service.BuyStopPoints(                                 \n\u2502      symbol: \"EURUSD\",                                         \n\u2502      volume: 0.01,                                             \n\u2502      priceOffsetPoints: +25,  \u2190 POINTS (POSITIVE)              \n\u2502      slPoints: 15,                                             \n\u2502      tpPoints: 30,                                             \n\u2502      comment: \"Breakout-Buy\"                                   \n\u2502  )                                                             \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Sugar.BuyStopPoints() (extension method)                   \n\u2502  \n\u2502  \u2502 1. Get Ask: 1.10002                                        \n\u2502  \u2502 2. Get point: 0.00001                                     \n\u2502  \u2502 3. Calculate price: 1.10002 + (25 \u00d7 0.00001) = 1.10027    \n\u2502  \u2502 4. Calculate SL: 1.10027 - (15 \u00d7 0.00001) = 1.10012      \n\u2502  \u2502 5. Calculate TP: 1.10027 + (30 \u00d7 0.00001) = 1.10057      \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n\u2502  await service.BuyStopAsync(                                   \n\u2502      price: 1.10027,    \u2190 ABSOLUTE PRICE                       \n\u2502      sl: 1.10012,                                              \n\u2502      tp: 1.10057                                               \n\u2502  )                                                             \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Service.BuyStopAsync()                                     \n\u2502  return await _account.BuyStopAsync(...)                       \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Account.BuyStopAsync()                                     \n\u2502   \n\u2502  \u2502 var request = new OrderSendRequest {                       \n\u2502  \u2502     Symbol = \"EURUSD\",                                    \n\u2502  \u2502     Volume = 0.01,                                         \n\u2502  \u2502     Type = ORDER_TYPE_BUY_STOP,  // = 4                 \n\u2502  \u2502     Price = 1.10027,                                     \n\u2502  \u2502     Sl = 1.10012,                                          \n\u2502  \u2502     Tp = 1.10057,                                         \n\u2502  \u2502     Comment = \"Breakout-Buy\"                              \n\u2502  \u2502 }                                                         \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n\u2502  var response = await _client.OrderSendAsync(request);         \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n                    \u2502  gRPC NETWORK\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n                  \u2502   MT5 Terminal     \n                  \u2502   \n                  \u2502  \u2502 Places       \n                  \u2502  \u2502 BUY STOP       \n                  \u2502  \u2502 @ 1.10027      \n                  \u2502  \u2502 SL: 1.10012    \n                  \u2502  \u2502 TP: 1.10057   \n                  \u2502  \u2502 Ticket:        \n                  \u2502  \u2502  123456789     \n                  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n                    \u2502  RESPONSE    \n                    \u2502 OrderSendData\n                    \u2502 {            \n                    \u2502   ReturnedCode\n                    \u2502   = 10009,   \n                    \u2502   Order =    \n                    \u2502   123456789  \n                    \u2502 }            \n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#phase-3-placing-sellstop-lines-67-86","title":"Phase 3: Placing SellStop (lines 67-86)","text":"<pre><code>// \u2502  PLACING SELL STOP (downward breakout)                  \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  Placing SELL STOP order...\");\n\nvar sellStopResult = await _service.SellStopPoints(\n    symbol: Symbol,\n    volume: Volume,\n    priceOffsetPoints: -BreakoutDistancePoints,  // -25 (NEGATIVE!)\n    slPoints: StopLossPoints,\n    tpPoints: TakeProfitPoints,\n    comment: \"Breakout-Sell\"\n);\n\n\n// \u2502  CRITICALLY IMPORTANT CHECK                             \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nif (sellStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 SELL STOP failed: {sellStopResult.Comment}\");\n    Console.WriteLine(\"  Canceling BUY STOP...\");\n\n\n    // \u2502  IMPORTANT: Cancel first order!                 \n    // \u2502  Otherwise hanging BuyStop remains without pair \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(buyStopResult.Order);\n    return 0;\n}\n\nConsole.WriteLine($\"  \u2713 SELL STOP placed: #{sellStopResult.Order}\\n\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#how-sellstoppoints-works-internally","title":"How SellStopPoints() works internally","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task&lt;OrderSendData&gt; SellStopPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // \u2190 RECEIVES -25\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n{\n\n    // \u2502  STEP 1: Get current Bid price                      \n    // \u2502  For SELL STOP use BID (sell price)                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await service.SymbolInfoTickAsync(symbol);\n    double bidPrice = tick.Bid;  // For example: 1.10000\n\n    var symbolInfo = await service.SymbolInfoAsync(symbol);\n    double point = symbolInfo.Point;  // 0.00001\n\n\n    // \u2502  STEP 2: Calculate SELL STOP price                  \n    // \u2502  IMPORTANT: priceOffsetPoints NEGATIVE (-25)        \n    // \u2502  SELL STOP is placed BELOW current price            \n    // \u2502                                                     \n    // \u2502  price = bidPrice + (priceOffsetPoints \u00d7 point)     \n    // \u2502       = 1.10000 + (-25 \u00d7 0.00001)                   \n    // \u2502       = 1.10000 - 0.00025                           \n    // \u2502       = 1.09975                                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double price = bidPrice + (priceOffsetPoints * point);\n\n\n    // \u2502  STEP 3: Calculate SL and TP for SELL               \n    // \u2502  SL ABOVE entry price (protection from rise)        \n    // \u2502  TP BELOW entry price (profit taking)               \n    // \u2502                                                     \n    // \u2502  sl = price + (slPoints \u00d7 point)  \u2190 PLUS for SELL!  \n    // \u2502     = 1.09975 + (15 \u00d7 0.00001)                      \n    // \u2502     = 1.09975 + 0.00015                             \n    // \u2502     = 1.09990                                       \n    // \u2502                                                    \n    // \u2502  tp = price - (tpPoints \u00d7 point)  \u2190 MINUS for SELL! \n    // \u2502     = 1.09975 - (30 \u00d7 0.00001)                      \n    // \u2502     = 1.09975 - 0.00030                             \n    // \u2502     = 1.09945                                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double sl = slPoints &gt; 0 ? price + (slPoints * point) : 0;  // + for SELL\n    double tp = tpPoints &gt; 0 ? price - (tpPoints * point) : 0;  // - for SELL\n\n    return await service.SellStopAsync(\n        symbol: symbol,\n        volume: volume,\n        price: price,    // 1.09975\n        sl: sl,          // 1.09990\n        tp: tp,          // 1.09945\n        comment: comment\n    );\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#result-of-placing-both-orders","title":"Result of placing both orders","text":"<pre><code>After successfully placing both orders in MT5 Terminal:\n\nPENDING ORDERS (2 orders):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Ticket \u2502    Type     \u2502  Price  \u2502   SL    \u2502   TP    \u2502   Comment    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ...789 \u2502 BUY STOP    \u2502 1.10027 \u2502 1.10012 \u2502 1.10057 \u2502 Breakout-Buy \u2502\n\u2502 ...790 \u2502 SELL STOP   \u2502 1.09975 \u2502 1.09990 \u2502 1.09945 \u2502 Breakout-Sell\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nVISUALIZATION:\n          \u2191 Price rises\n          \u2502\n  1.10057 \u251c\u2500\u2500\u2500 TP for BuyStop\n  1.10027 \u251c\u2500\u2500\u2500 BUY STOP (upward breakout)\n  1.10012 \u251c\u2500\u2500\u2500 SL for BuyStop\n          \u2502\n  1.10002 \u251c\u2500\u2500\u2500 Current Ask\n  1.10000 \u251c\u2500\u2500\u2500 Current Bid\n          \u2502\n  1.09990 \u251c\u2500\u2500\u2500 SL for SellStop\n  1.09975 \u251c\u2500\u2500\u2500 SELL STOP (downward breakout)\n  1.09945 \u251c\u2500\u2500\u2500 TP for SellStop\n          \u2502\n          \u2193 Price falls\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#phase-4-breakout-monitoring-lines-89-129","title":"Phase 4: BREAKOUT MONITORING (lines 89-129)","text":"<p>This is the most important part of the orchestrator - the breakout detection logic.</p> <pre><code>Console.WriteLine($\"  \u23f3 Waiting up to {MaxWaitMinutes} minutes for breakout...\\n\");\n\n\n// \u2502  MONITORING INITIALIZATION                              \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar startTime = DateTime.UtcNow;\nvar timeout = TimeSpan.FromMinutes(MaxWaitMinutes);\n\n// Variables to track which order executed\nulong? executedOrder = null;   // Ticket of executed order\nulong? cancelOrder = null;     // Ticket of order to cancel\n\n\n// \u2502  MAIN MONITORING LOOP                                   \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nwhile (DateTime.UtcNow - startTime &lt; timeout &amp;&amp; !ct.IsCancellationRequested)\n{\n\n    // \u2502  Wait 3 seconds before next check              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await Task.Delay(3000, ct);\n\n\n    // \u2502  STEP 1: Get list of PENDING orders             \n    // \u2502  IMPORTANT: This is only PENDING orders!        \n    // \u2502  Executed orders become positions              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tickets = await _service.OpenedOrdersTicketsAsync();\n\n    bool buyStillPending = false;\n    bool sellStillPending = false;\n\n\n    // \u2502  STEP 2: Check if our orders are in the list    \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    foreach (var ticket in tickets.OpenedOrdersTickets)\n    {\n        if (ticket == (long)buyStopResult.Order) buyStillPending = true;\n        if (ticket == (long)sellStopResult.Order) sellStillPending = true;\n    }\n\n\n    // \u2502  STEP 3: BREAKOUT DETECTION (4 scenarios)           \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 1: UPWARD BREAKOUT\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    if (!buyStillPending &amp;&amp; sellStillPending)\n    {\n        // BuyStop DISAPPEARED from list \u2192 executed!\n        // SellStop STILL in list \u2192 not executed\n\n        Console.WriteLine(\"  \ud83d\ude80 BUY STOP EXECUTED! Upward breakout!\");\n        executedOrder = buyStopResult.Order;\n        cancelOrder = sellStopResult.Order;  // \u2190 Need to cancel\n        break;  // Exit loop\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 2: DOWNWARD BREAKOUT\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    else if (buyStillPending &amp;&amp; !sellStillPending)\n    {\n        // SellStop DISAPPEARED \u2192 executed!\n        // BuyStop STILL in list \u2192 not executed\n\n        Console.WriteLine(\"  \ud83d\ude80 SELL STOP EXECUTED! Downward breakout!\");\n        executedOrder = sellStopResult.Order;\n        cancelOrder = buyStopResult.Order;  // \u2190 Need to cancel\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 3: BOTH EXECUTED (rare case)\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    else if (!buyStillPending &amp;&amp; !sellStillPending)\n    {\n        // Both orders disappeared\n        // Possible causes:\n        // 1. Very strong volatility (both triggered)\n        // 2. Connection error (didn't get actual data)\n        // 3. Manual cancellation of both orders\n\n        Console.WriteLine(\"  \u2713 Both orders executed or canceled\");\n        break;\n    }\n\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 4: BOTH STILL PENDING (continue waiting)\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // else: both orders still in list \u2192 no breakout \u2192 continue loop\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#detailed-breakout-detection-logic-visualization","title":"Detailed breakout detection logic visualization","text":"<pre><code>\u2502  HOW OpenedOrdersTicketsAsync() WORKS                      \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nMT5 Terminal state:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  789: BUY STOP   \u2502  (empty)                               \u2502\n\u2502  790: SELL STOP  \u2502                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nOpenedOrdersTicketsAsync() returns:\n{\n    OpenedOrdersTickets: [789, 790],  \u2190 PENDING ORDERS\n    OpenedPositionTickets: []         \u2190 OPEN POSITIONS\n}\n\nforeach (var ticket in tickets.OpenedOrdersTickets)\n{\n    if (ticket == 789) buyStillPending = true;   // \u2713 found\n    if (ticket == 790) sellStillPending = true;  // \u2713 found\n}\n\nResult: buyStillPending = true, sellStillPending = true\n\u2192 Both orders still pending \u2192 no breakout \u2192 continue waiting\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n5 MINUTES LATER: Price rose to 1.10027\n\nMT5 Terminal state:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  790: SELL STOP  \u2502  789: BUY 0.01 EURUSD @ 1.10027        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2191\n                     BuyStop EXECUTED \u2192 became POSITION!\n\nOpenedOrdersTicketsAsync() returns:\n{\n    OpenedOrdersTickets: [790],       \u2190 only SellStop\n    OpenedPositionTickets: [789]      \u2190 BuyStop became position\n}\n\nforeach (var ticket in tickets.OpenedOrdersTickets)\n{\n    // ticket = 790\n    if (ticket == 789) buyStillPending = true;   // \u2717 NOT found!\n    if (ticket == 790) sellStillPending = true;  // \u2713 found\n}\n\nResult: buyStillPending = false, sellStillPending = true\n\nif (!buyStillPending &amp;&amp; sellStillPending)  \u2190 TRUE!\n{\n    Console.WriteLine(\"\ud83d\ude80 BUY STOP EXECUTED! Upward breakout!\");\n    cancelOrder = 790;  \u2190 Need to cancel SellStop\n    break;\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#phase-5-canceling-opposite-order-lines-131-145","title":"Phase 5: Canceling opposite order (lines 131-145)","text":"<pre><code>// \u2502  CHECK: Did breakout happen?                            \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nif (cancelOrder.HasValue)\n{\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // BREAKOUT HAPPENED \u2192 Cancel opposite order\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n    Console.WriteLine($\"  Canceling opposite order #{cancelOrder.Value}...\");\n\n\n    // \u2502  CloseByTicket - universal method:              \n    // \u2502  - If ticket = pending order \u2192 CANCEL           \n    // \u2502  - If ticket = position \u2192 CLOSE                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(cancelOrder.Value);\n\n    Console.WriteLine(\"  \u2713 Canceled\\n\");\n}\nelse\n{\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // TIMEOUT \u2192 Breakout didn't happen \u2192 Cancel BOTH orders\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n    Console.WriteLine($\"  \u23f1 Timeout after {MaxWaitMinutes} minutes - canceling both orders...\");\n\n\n    // \u2502  Cancel both orders separately                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(buyStopResult.Order);\n    await _service.CloseByTicket(sellStopResult.Order);\n\n    Console.WriteLine(\"  \u2713 Both canceled\\n\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#how-closebyticket-works","title":"How CloseByTicket() works","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task CloseByTicket(\n    this MT5Service service,\n    ulong ticket\n)\n{\n\n    // \u2502  STEP 1: Check ticket type (order or position?)    \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    // Attempt 1: Get as pending order\n    var orders = await service.OrdersAsync();\n    var order = orders.FirstOrDefault(o =&gt; o.Ticket == ticket);\n\n    if (order != null)\n    {\n\n        // \u2502  This is PENDING ORDER \u2192 CANCEL             \n        // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        await service.OrderDeleteAsync(ticket);\n        return;\n    }\n\n    // Attempt 2: Get as open position\n    var positions = await service.PositionsAsync();\n    var position = positions.FirstOrDefault(p =&gt; p.Ticket == ticket);\n\n    if (position != null)\n    {\n\n        // \u2502  This is OPEN POSITION \u2192 CLOSE              \n        // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        await service.PositionCloseAsync(ticket);\n        return;\n    }\n\n    // Ticket not found (already closed/canceled or doesn't exist)\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#detailed-order-cancellation-chain","title":"Detailed order cancellation chain","text":"<pre><code>SITUATION: Upward breakout, need to cancel SellStop #790\n\nUSER CODE:\n    await _service.CloseByTicket(790);\n        \u2502\n        \u25bc\nMT5Sugar.CloseByTicket():\n\n    \u2502 1. OrdersAsync() \u2192 check pending orders     \n    \u2502 2. Found order #790 \u2192 this is PENDING ORDER \n    \u2502 3. Call OrderDeleteAsync(790)               \n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        \u2502\n        \u25bc\nMT5Service.OrderDeleteAsync(790):\n    return await _account.OrderDeleteAsync(790);\n        \u2502\n        \u25bc\nMT5Account.OrderDeleteAsync(790):\n    var request = new OrderDeleteRequest {\n        Ticket = 790\n    };\n    var response = await _client.OrderDeleteAsync(request);\n        \u2502\n        \u25bc\n    gRPC \u2192 MT5 Terminal\n        \u2502\n        \u25bc\nMT5 Terminal:\n\n    \u2502 PENDING ORDERS                          \n    \u2502 \u2717 790: SELL STOP @ 1.09975 (DELETED)   \n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nRESULT:\nMT5 Terminal state:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  (empty)         \u2502  789: BUY 0.01 EURUSD @ 1.10027        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nNow only ONE position (BUY) is open.\nSellStop successfully canceled \u2192 OCO strategy completed.\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#phase-6-finalization-lines-147-154","title":"Phase 6: Finalization (lines 147-154)","text":"<pre><code>// \u2502  Get final balance                                      \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar finalBalance = await _service.GetBalanceAsync();\n\n\n// \u2502  Calculate profit/loss                                  \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar profit = finalBalance - initialBalance;\n\nConsole.WriteLine($\"  Final balance: ${finalBalance:F2}\");\nConsole.WriteLine($\"  Profit/Loss: ${profit:F2}\");\nConsole.WriteLine(\"\\n+============================================================+\\n\");\n\n\n// \u2502  Return profit as result of ExecuteAsync()              \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nreturn profit;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#complete-life-cycle-upward-breakout-scenario","title":"\ud83c\udfad Complete Life Cycle (Upward breakout scenario)","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#execution-timeline","title":"Execution timeline","text":"<pre><code>T=0      START ExecuteAsync()\n         \u2502\n         \u251c\u2500\u25ba GetBalanceAsync()           \u2192 $10000.00\n         \u251c\u2500\u25ba SymbolInfoTickAsync()       \u2192 Bid:1.10000, Ask:1.10002\n         \u2502\nT=1s     \u251c\u2500\u25ba BuyStopPoints(+25)\n         \u2502   \u2514\u2500\u25ba Created BuyStop #789 @ 1.10027\n         \u2502\nT=2s     \u251c\u2500\u25ba SellStopPoints(-25)\n         \u2502   \u2514\u2500\u25ba Created SellStop #790 @ 1.09975\n         \u2502\n         \u2502   MT5 Terminal state:\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 PENDING ORDERS \u2502 POSITIONS    \u2502\n         \u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502 789: BUY STOP  \u2502 (empty)      \u2502\n         \u2502   \u2502 790: SELL STOP \u2502              \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\nT=3s     \u251c\u2500\u25ba MONITORING START\n         \u2502\nT=6s     \u251c\u2500\u25ba Task.Delay(3000)\n         \u2502   \u251c\u2500\u25ba OpenedOrdersTicketsAsync() \u2192 [789, 790]\n         \u2502   \u251c\u2500\u25ba buyStillPending = true\n         \u2502   \u251c\u2500\u25ba sellStillPending = true\n         \u2502   \u2514\u2500\u25ba Both pending \u2192 continue\n         \u2502\nT=9s     \u251c\u2500\u25ba Task.Delay(3000)\n         \u2502   \u2514\u2500\u25ba [789, 790] \u2192 both pending \u2192 continue\n         \u2502\n         \u2502   MARKET: Price rises...\n         \u2502   1.10005 \u2192 1.10015 \u2192 1.10020 \u2192 1.10027...\n         \u2502\nT=12s    \u251c\u2500\u25ba Task.Delay(3000)\n         \u2502   \u2502\n         \u2502   \u2502  MT5 Terminal: Price reached 1.10027!\n         \u2502   \u2502  BuyStop #789 EXECUTED \u2192 became position\n         \u2502   \u2502\n         \u2502   \u2502  MT5 Terminal state:\n         \u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502  \u2502 PENDING ORDERS \u2502 POSITIONS            \u2502\n         \u2502   \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502  \u2502 790: SELL STOP \u2502 789: BUY 0.01        \u2502\n         \u2502   \u2502  \u2502                \u2502      @ 1.10027       \u2502\n         \u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502   \u2502\n         \u2502   \u251c\u2500\u25ba OpenedOrdersTicketsAsync() \u2192 [790]\n         \u2502   \u251c\u2500\u25ba buyStillPending = false  \u2190 NOT found!\n         \u2502   \u251c\u2500\u25ba sellStillPending = true\n         \u2502   \u2502\n         \u2502   \u2514\u2500\u25ba if (!buy &amp;&amp; sell) \u2192 TRUE!\n         \u2502       \u251c\u2500\u25ba \"\ud83d\ude80 BUY STOP EXECUTED! Upward breakout!\"\n         \u2502       \u251c\u2500\u25ba executedOrder = 789\n         \u2502       \u251c\u2500\u25ba cancelOrder = 790\n         \u2502       \u2514\u2500\u25ba break (exit loop)\n         \u2502\nT=13s    \u251c\u2500\u25ba CANCEL opposite order\n         \u2502   \u251c\u2500\u25ba CloseByTicket(790)\n         \u2502   \u2502   \u2514\u2500\u25ba OrderDeleteAsync(790)\n         \u2502   \u2502       \u2514\u2500\u25ba SellStop #790 CANCELED\n         \u2502   \u2502\n         \u2502   \u2502  MT5 Terminal state:\n         \u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502  \u2502 PENDING ORDERS \u2502 POSITIONS            \u2502\n         \u2502   \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502  \u2502 (empty)        \u2502 789: BUY 0.01        \u2502\n         \u2502   \u2502  \u2502                \u2502      @ 1.10027       \u2502\n         \u2502   \u2502  \u2502                \u2502      SL: 1.10012     \u2502\n         \u2502   \u2502  \u2502                \u2502      TP: 1.10057     \u2502\n         \u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502   OCO STRATEGY COMPLETED!\n         \u2502   Position opened, opposite order canceled.\n         \u2502\n         \u2502   MARKET: Price continues rising...\n         \u2502   1.10030 \u2192 1.10040 \u2192 1.10050 \u2192 1.10057...\n         \u2502\nT=180s   \u2502   MT5 Terminal: Price reached 1.10057!\n(3 min)  \u2502   TP triggered \u2192 position closed\n         \u2502\n         \u2502   MT5 Terminal state:\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 PENDING ORDERS \u2502 POSITIONS            \u2502\n         \u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502 (empty)        \u2502 (empty)              \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502   CLOSED POSITION:\n         \u2502   Entry: 1.10027\n         \u2502   Exit:  1.10057\n         \u2502   Profit: (1.10057 - 1.10027) \u00d7 100000 \u00d7 0.01\n         \u2502          = 0.00030 \u00d7 100000 \u00d7 0.01\n         \u2502          = 30 \u00d7 0.01\n         \u2502          = $3.00\n         \u2502\nT=183s   \u251c\u2500\u25ba GetBalanceAsync()           \u2192 $10003.00\n         \u251c\u2500\u25ba profit = 10003.00 - 10000.00 = +$3.00\n         \u2502\n         \u2514\u2500\u25ba RETURN profit = 3.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#what-the-result-is-made-of","title":"\ud83d\udcca What the result is made of","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#profit-calculation-upward-breakout","title":"Profit calculation (upward breakout)","text":"<pre><code>INITIAL BALANCE: $10000.00\n\nUPWARD BREAKOUT:\n\n1. BuyStop #789 @ 1.10027 EXECUTED\n   \u2192 Opened position BUY 0.01 lots\n   \u2192 SL: 1.10012 (protection -15 points)\n   \u2192 TP: 1.10057 (target +30 points)\n\n2. SellStop #790 CANCELED\n   \u2192 Cancellation fee: $0.00\n\nPOSITION OUTCOME (TP triggered):\n   Entry: 1.10027\n   Exit:  1.10057\n   Pips:  (1.10057 - 1.10027) / 0.00001 = 30 points\n\nPROFIT CALCULATION:\n   Profit = Pips \u00d7 Point Value \u00d7 Volume\n   Point Value for EURUSD (1.0 lot) = $10\n   Point Value for 0.01 lot = $0.10\n\n   Profit = 30 \u00d7 $0.10 = $3.00\n\nFINAL BALANCE: $10003.00\nPROFIT = $3.00\n\nreturn 3.00;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#loss-calculation-sl-triggered","title":"Loss calculation (SL triggered)","text":"<pre><code>IF SL HAD TRIGGERED:\n   Entry: 1.10027\n   Exit:  1.10012 (SL)\n   Pips:  (1.10012 - 1.10027) / 0.00001 = -15 points\n\n   Loss = -15 \u00d7 $0.10 = -$1.50\n\nFINAL BALANCE: $9998.50\nPROFIT = -$1.50\n\nR:R ratio = 1.50 / 3.00 = 1:2 \u2713\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#components-and-their-roles","title":"\ud83e\udde9 Components and their roles","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#1-pendingbreakoutorchestrator","title":"1. PendingBreakoutOrchestrator","text":"<p>Role: OCO strategy coordinator</p> <p>Tasks:</p> <ul> <li>Stores parameters (Symbol, BreakoutDistancePoints, etc.)</li> <li>Manages life cycle</li> <li>Places both orders</li> <li>Monitors breakout through OpenedOrdersTicketsAsync()</li> <li>Cancels opposite order</li> <li>Handles placement errors</li> <li>Returns result</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#2-mt5service","title":"2. MT5Service","text":"<p>Role: Service layer</p> <p>Tasks:</p> <ul> <li>Provides methods BuyStopAsync, SellStopAsync</li> <li>Delegates calls to MT5Account</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#3-mt5sugar-extension-methods","title":"3. MT5Sugar (extension methods)","text":"<p>Role: Simplifying layer</p> <p>Tasks:</p> <ul> <li><code>BuyStopPoints()</code> - converts points to prices for BuyStop</li> <li><code>SellStopPoints()</code> - converts points to prices for SellStop</li> <li><code>CloseByTicket()</code> - universal cancel/close</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#4-openedordersticketsasync","title":"4. OpenedOrdersTicketsAsync()","text":"<p>Role: CRITICAL component for breakout detection</p> <p>How it works:</p> <pre><code>// Returns TWO lists:\nOpenedOrdersTicketsData {\n    OpenedOrdersTickets: [list of pending order tickets],\n    OpenedPositionTickets: [list of open position tickets]\n}\n\n// KEY MOMENT:\n// When pending order executes \u2192 it disappears from OpenedOrdersTickets\n// and appears in OpenedPositionTickets\n\n// Check ticket presence in pending list:\nforeach (var ticket in tickets.OpenedOrdersTickets)\n{\n    if (ticket == ourBuyStopTicket) buyStillPending = true;\n}\n\n// If ticket NOT found \u2192 order executed!\nif (!buyStillPending) {\n    // BuyStop no longer pending \u2192 breakout happened!\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#final-dependency-diagram","title":"\ud83d\udd0d Final Dependency Diagram","text":"<pre><code>\u2502  USER CODE                                                   \n\u2502  var orch = new PendingBreakoutOrchestrator(service);       \n\u2502  var profit = await orch.ExecuteAsync();                    \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  PendingBreakoutOrchestrator                                \n\u2502   \n\u2502  \u2502  ExecuteAsync() {                                       \n\u2502  \u2502    1. BuyStopPoints(+25)                                \n\u2502  \u2502    2. SellStopPoints(-25)                               \n\u2502  \u2502    3. LOOP: OpenedOrdersTicketsAsync()                  \n\u2502  \u2502       \u2514\u2500\u25ba Check ticket presence                         \n\u2502  \u2502    4. CloseByTicket(opposite)                           \n\u2502  \u2502  }                                                      \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502 _service\n                           \u25bc\n\n\u2502  MT5Service                                                 \n\u2502  - OpenedOrdersTicketsAsync()  \u2190 KEY method!                \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Sugar (extension methods)                               \n\u2502  - BuyStopPoints(+offsetPoints)  \u2192 price ABOVE Ask          \n\u2502  - SellStopPoints(-offsetPoints) \u2192 price BELOW Bid          \n\u2502  - CloseByTicket(ticket)         \u2192 cancel/close             \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n                    [MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator.HOW_IT_WORKS/#summary","title":"\ud83c\udfaf Summary","text":"<p>PendingBreakoutOrchestrator is made of:</p> <ol> <li>1 dependency: <code>MT5Service _service</code></li> <li>6 parameters: Symbol, BreakoutDistancePoints, StopLoss, TakeProfit, Volume, MaxWaitMinutes</li> <li>4 MT5Sugar methods: <code>BuyStopPoints</code>, <code>SellStopPoints</code>, <code>CloseByTicket</code>, <code>OpenedOrdersTicketsAsync</code></li> <li>OCO logic: Breakout detection through checking ticket presence in pending orders list</li> </ol> <p>Works through:</p> <ul> <li>Placing 2 opposite Stop orders</li> <li>Monitoring pending orders list every 3 seconds</li> <li>Detecting breakout: if ticket disappeared from list \u2192 order executed</li> <li>Canceling opposite order</li> <li>Timeout handling</li> </ul> <p>Returns:</p> <ul> <li><code>double profit</code> - difference between final and initial balance</li> </ul> <p>Key insight:</p> <p>All the magic of breakout detection is based on a simple fact: when a pending order executes, it disappears from the OpenedOrdersTickets list. By checking for our tickets' presence in this list, we know exactly which order triggered and which is still waiting for execution.</p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/","title":"PendingBreakoutOrchestrator - Level Breakouts","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#description","title":"Description","text":"<p>PendingBreakoutOrchestrator is an orchestrator for catching breakouts in any direction. It places two pending orders simultaneously: Buy Stop above the current price and Sell Stop below the current price. When the price breaks a level in either direction, the corresponding order triggers and the opposite one is canceled.</p> <p>Principle: OCO strategy (One Cancels Other) - when one order triggers, the second is automatically canceled. This allows catching directional movements without predicting the direction in advance.</p> <p>File: <code>Examples\\Orchestrators\\PendingBreakoutOrchestrator.cs</code></p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#architecture","title":"Architecture","text":"<pre><code>PENDING BREAKOUT ORCHESTRATOR\n    \u2193\nMT5Service Instance\n    \u2193\nThree main operations:\n  \u2192 BuyStopPoints (above price)\n  \u2192 SellStopPoints (below price)\n  \u2192 CloseByTicket (cancel order)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#dependencies","title":"Dependencies","text":"<ul> <li>MT5Service: Service layer for MT5</li> <li>MT5Sugar Extension Methods: <code>BuyStopPoints</code>, <code>SellStopPoints</code>, <code>CloseByTicket</code></li> <li>mt5_term_api: gRPC types (<code>OrderSendData</code>, <code>SymbolInfoTickData</code>, <code>OpenedOrdersTicketsData</code>)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#configuration-parameters","title":"Configuration Parameters","text":"Parameter Type Default Description <code>Symbol</code> string <code>\"EURUSD\"</code> Trading instrument <code>BreakoutDistancePoints</code> int <code>25</code> Distance from current price to place orders (in points) <code>StopLossPoints</code> int <code>15</code> Stop loss in points <code>TakeProfitPoints</code> int <code>30</code> Take profit in points <code>Volume</code> double <code>0.01</code> Volume in lots <code>MaxWaitMinutes</code> int <code>30</code> Maximum waiting time for breakout"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#configuration-example","title":"Configuration example","text":"<pre><code>var breakoutOrchestrator = new PendingBreakoutOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    BreakoutDistancePoints = 30,   // Orders at 30 points distance\n    StopLossPoints = 20,            // SL = 20 points\n    TakeProfitPoints = 50,          // TP = 50 points (R:R = 1:2.5)\n    Volume = 0.02,                  // 0.02 lots\n    MaxWaitMinutes = 45             // Wait 45 minutes\n};\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#algorithm","title":"Algorithm","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#flowchart","title":"Flowchart","text":"<pre><code>START\n  \u2502\n  \u251c\u2500\u25ba Get initial balance\n  \u2502\n  \u251c\u2500\u25ba Get current price (Bid/Ask)\n  \u2502\n  \u251c\u2500\u25ba BuyStopPoints(+BreakoutDistancePoints)\n  \u2502    \u2514\u2500\u25ba If error \u2192 return 0\n  \u2502\n  \u251c\u2500\u25ba SellStopPoints(-BreakoutDistancePoints)\n  \u2502    \u2514\u2500\u25ba If error \u2192 cancel BuyStop, return 0\n  \u2502\n  \u251c\u2500\u25ba MONITORING (every 3 sec, max MaxWaitMinutes)\n  \u2502    \u2502\n  \u2502    \u251c\u2500\u25ba OpenedOrdersTicketsAsync()\n  \u2502    \u2502\n  \u2502    \u251c\u2500\u25ba Check: BuyStop still pending?\n  \u2502    \u251c\u2500\u25ba Check: SellStop still pending?\n  \u2502    \u2502\n  \u2502    \u2514\u2500\u25ba CONDITIONS:\n  \u2502         \u251c\u2500\u25ba If BuyStop executed, SellStop pending\n  \u2502         \u2502    \u2192 Upward breakout \u2192 cancel SellStop \u2192 break\n  \u2502         \u2502\n  \u2502         \u251c\u2500\u25ba If SellStop executed, BuyStop pending\n  \u2502         \u2502    \u2192 Downward breakout \u2192 cancel BuyStop \u2192 break\n  \u2502         \u2502\n  \u2502         \u251c\u2500\u25ba If both executed/canceled \u2192 break\n  \u2502         \u2502\n  \u2502         \u2514\u2500\u25ba If timeout \u2192 cancel both \u2192 break\n  \u2502\n  \u251c\u2500\u25ba Get final balance\n  \u2502\n  \u2514\u2500\u25ba Return profit\nEND\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#step-by-step-description","title":"Step-by-step description","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#1-initialization-lines-35-46","title":"1. Initialization (lines 35-46)","text":"<pre><code>var initialBalance = await _service.GetBalanceAsync();\nvar tick = await _service.SymbolInfoTickAsync(Symbol);\n\nConsole.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\nConsole.WriteLine($\"  Current: Bid={tick.Bid:F5}, Ask={tick.Ask:F5}\");\n</code></pre> <p>What happens:</p> <ul> <li>Initial balance is saved</li> <li>Current price is obtained for display</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#2-placing-buy-stop-lines-48-65","title":"2. Placing Buy Stop (lines 48-65)","text":"<pre><code>var buyStopResult = await _service.BuyStopPoints(\n    symbol: Symbol,                         // \"EURUSD\"\n    volume: Volume,                         // 0.01\n    priceOffsetPoints: BreakoutDistancePoints,  // +25 (POSITIVE!)\n    slPoints: StopLossPoints,               // 15\n    tpPoints: TakeProfitPoints,             // 30\n    comment: \"Breakout-Buy\"\n);\n\nif (buyStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 BUY STOP failed: {buyStopResult.Comment}\");\n    return 0;  // Emergency exit\n}\n</code></pre> <p>Critically important:</p> <ul> <li><code>priceOffsetPoints</code> = POSITIVE value (<code>+25</code>)</li> <li><code>BuyStopPoints</code> places order ABOVE current price</li> <li>Buy Stop = buy order on upward breakout</li> </ul> <p>Calculation example: <pre><code>Current Ask price: 1.10000\nBreakoutDistancePoints: 25\npoint: 0.00001\n\nBuyStop price = 1.10000 + (25 \u00d7 0.00001) = 1.10025\n\nWhen Ask price reaches 1.10025 \u2192 order executes \u2192 BUY position opens\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#3-placing-sell-stop-lines-67-86","title":"3. Placing Sell Stop (lines 67-86)","text":"<pre><code>var sellStopResult = await _service.SellStopPoints(\n    symbol: Symbol,\n    volume: Volume,\n    priceOffsetPoints: -BreakoutDistancePoints,  // -25 (NEGATIVE!)\n    slPoints: StopLossPoints,\n    tpPoints: TakeProfitPoints,\n    comment: \"Breakout-Sell\"\n);\n\nif (sellStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 SELL STOP failed: {sellStopResult.Comment}\");\n    Console.WriteLine(\"  Canceling BUY STOP...\");\n    await _service.CloseByTicket(buyStopResult.Order);  // \u2190 Cancel first order!\n    return 0;\n}\n</code></pre> <p>Critically important:</p> <ul> <li><code>priceOffsetPoints</code> = NEGATIVE value (<code>-25</code>)</li> <li><code>SellStopPoints</code> places order BELOW current price</li> <li>Sell Stop = sell order on downward breakout</li> <li>If placement fails \u2192 cancel BuyStop to not leave hanging order</li> </ul> <p>Calculation example: <pre><code>Current Bid price: 1.10000\nBreakoutDistancePoints: 25 (but we use -25)\npoint: 0.00001\n\nSellStop price = 1.10000 + (-25 \u00d7 0.00001) = 1.09975\n\nWhen Bid price falls to 1.09975 \u2192 order executes \u2192 SELL position opens\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#4-monitoring-for-breakout-lines-89-129","title":"4. Monitoring for breakout (lines 89-129)","text":"<pre><code>var startTime = DateTime.UtcNow;\nvar timeout = TimeSpan.FromMinutes(MaxWaitMinutes);\nulong? executedOrder = null;\nulong? cancelOrder = null;\n\nwhile (DateTime.UtcNow - startTime &lt; timeout &amp;&amp; !ct.IsCancellationRequested)\n{\n    await Task.Delay(3000, ct);  // Every 3 seconds\n\n\n    // \u2502  Get list of OPEN PENDING ORDERS                   \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tickets = await _service.OpenedOrdersTicketsAsync();\n\n    bool buyStillPending = false;\n    bool sellStillPending = false;\n\n\n    // \u2502  Check if our orders are in the list                \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    foreach (var ticket in tickets.OpenedOrdersTickets)\n    {\n        if (ticket == (long)buyStopResult.Order) buyStillPending = true;\n        if (ticket == (long)sellStopResult.Order) sellStillPending = true;\n    }\n\n\n    // \u2502  BREAKOUT DETECTION LOGIC                           \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    // CASE 1: BuyStop executed (not in list), SellStop still pending\n    if (!buyStillPending &amp;&amp; sellStillPending)\n    {\n        Console.WriteLine(\"  \ud83d\ude80 BUY STOP EXECUTED! Upward breakout!\");\n        executedOrder = buyStopResult.Order;\n        cancelOrder = sellStopResult.Order;  // \u2190 Cancel opposite\n        break;\n    }\n\n    // CASE 2: SellStop executed, BuyStop still pending\n    else if (buyStillPending &amp;&amp; !sellStillPending)\n    {\n        Console.WriteLine(\"  \ud83d\ude80 SELL STOP EXECUTED! Downward breakout!\");\n        executedOrder = sellStopResult.Order;\n        cancelOrder = buyStopResult.Order;   // \u2190 Cancel opposite\n        break;\n    }\n\n    // CASE 3: Both disappeared from list (rare case)\n    else if (!buyStillPending &amp;&amp; !sellStillPending)\n    {\n        Console.WriteLine(\"  \u2713 Both orders executed or canceled\");\n        break;\n    }\n\n    // CASE 4: Both still pending \u2192 continue waiting\n}\n</code></pre> <p>Key logic:</p> <ul> <li><code>OpenedOrdersTicketsAsync()</code> returns only PENDING orders</li> <li>If order executed \u2192 it becomes position and disappears from list</li> <li>Check for our tickets' presence in list</li> <li>If one disappeared and other still there \u2192 breakout happened!</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#5-canceling-opposite-order-lines-131-145","title":"5. Canceling opposite order (lines 131-145)","text":"<pre><code>if (cancelOrder.HasValue)\n{\n\n    // \u2502  One order executed \u2192 cancel opposite               \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine($\"  Canceling opposite order #{cancelOrder.Value}...\");\n    await _service.CloseByTicket(cancelOrder.Value);\n    Console.WriteLine(\"  \u2713 Canceled\");\n}\nelse\n{\n\n    // \u2502  Timeout \u2192 cancel BOTH orders                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine($\"  \u23f1 Timeout after {MaxWaitMinutes} minutes - canceling both orders...\");\n    await _service.CloseByTicket(buyStopResult.Order);\n    await _service.CloseByTicket(sellStopResult.Order);\n    Console.WriteLine(\"  \u2713 Both canceled\");\n}\n</code></pre> <p>Two scenarios:</p> <ol> <li>Breakout happened \u2192 cancel one opposite order</li> <li>Timeout \u2192 cancel both orders (breakout didn't occur)</li> </ol>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#strategy-visualization","title":"Strategy Visualization","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#order-placement","title":"Order placement","text":"<pre><code>Price direction: \u25b2\n\n1.10025 \u2192 BUY STOP (+25 pts from Ask)\n          TP: 1.10055 (+30 pts)\n          SL: 1.10010 (-15 pts)\n\n          If price goes UP:\n            \u2192 BuyStop triggers\n            \u2192 SellStop cancels\n\n1.10000 \u2192 CURRENT PRICE (Bid/Ask middle)\n\n          If price goes DOWN:\n            \u2192 SellStop triggers\n            \u2192 BuyStop cancels\n\n1.09975 \u2192 SELL STOP (-25 pts from Bid)\n          TP: 1.09945 (-30 pts)\n          SL: 1.09990 (+15 pts)\n\nPrice direction: \u25bc\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#scenario-1-upward-breakout","title":"Scenario 1: Upward breakout","text":"<pre><code>T=0      Placed:\n         BuyStop @ 1.10025\n         SellStop @ 1.09975\n\nT=5min   Price: 1.10015 (moving up)\n         Both orders still pending\n\nT=8min   Price: 1.10026 (breakout!)\n\n         \u2502  BuyStop @ 1.10025 EXECUTED!      \n         \u2502  Opened position: BUY 0.01 lots   \n         \u2502  Entry: 1.10025                   \n         \u2502  SL: 1.10010                      \n         \u2502  TP: 1.10055                      \n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nT=8min   Orchestrator detects:\n+3s      buyStillPending = false (disappeared from list)\n         sellStillPending = true (still in list)\n\n         \u2192 UPWARD BREAKOUT!\n         \u2192 Cancel SellStop @ 1.09975\n\nT=15min  Price: 1.10056\n         TP triggered \u2192 position closed\n         Profit: +30 points = +$3.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#scenario-2-downward-breakout","title":"Scenario 2: Downward breakout","text":"<pre><code>T=0      Placed:\n         BuyStop @ 1.10025\n         SellStop @ 1.09975\n\nT=3min   Price: 1.09990 (moving down)\n         Both orders still pending\n\nT=6min   Price: 1.09974 (breakout!)\n\n         \u2502  SellStop @ 1.09975 EXECUTED!     \n         \u2502  Opened position: SELL 0.01 lots  \n         \u2502  Entry: 1.09975                   \n         \u2502  SL: 1.09990                      \n         \u2502  TP: 1.09945                      \n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nT=6min   Orchestrator detects:\n+3s      sellStillPending = false\n         buyStillPending = true\n\n         \u2192 DOWNWARD BREAKOUT!\n         \u2192 Cancel BuyStop @ 1.10025\n\nT=10min  Price: 1.09944\n         TP triggered \u2192 position closed\n         Profit: +30 points = +$3.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#scenario-3-timeout-breakout-didnt-happen","title":"Scenario 3: Timeout (breakout didn't happen)","text":"<pre><code>T=0      Placed:\n         BuyStop @ 1.10025\n         SellStop @ 1.09975\n\nT=5min   Price: 1.10005 (flat)\nT=10min  Price: 1.09995 (flat)\nT=15min  Price: 1.10008 (flat)\n...\nT=30min  TIMEOUT!\n         Both orders still pending\n\n         \u2192 Cancel BuyStop\n         \u2192 Cancel SellStop\n         \u2192 Profit: $0.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#how-to-run","title":"How to Run","text":"<p>You can execute this orchestrator using several command variations:</p> <pre><code># Option 1: By number\ndotnet run 11\n\n# Option 2: By short name\ndotnet run breakout\n\n# Option 3: By full name\ndotnet run pendingbreakout\n</code></pre> <p>All three commands will launch the PendingBreakoutOrchestrator with the default configuration or the settings you specify in the code.</p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#used-mt5sugar-methods","title":"Used MT5Sugar Methods","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#1-buystoppoints","title":"1. BuyStopPoints","text":"<pre><code>public static async Task&lt;OrderSendData&gt; BuyStopPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // POSITIVE for above price\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n</code></pre> <p>Purpose: Places pending Buy Stop order (buy order on upward breakout).</p> <p>Parameters in PendingBreakoutOrchestrator:</p> <ul> <li><code>priceOffsetPoints</code>: POSITIVE value (<code>+25</code>)</li> <li>Placed ABOVE current Ask price</li> <li>Triggers on upward price movement</li> </ul> <p>Price calculation: <pre><code>var tick = await service.SymbolInfoTickAsync(symbol);\ndouble askPrice = tick.Ask;  // For BUY use Ask\n\ndouble price = askPrice + (priceOffsetPoints \u00d7 point);\n// 1.10000 + (25 \u00d7 0.00001) = 1.10025\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#2-sellstoppoints","title":"2. SellStopPoints","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SellStopPoints(\n    this MT5Service service,\n    string symbol,\n    double volume,\n    int priceOffsetPoints,  // NEGATIVE for below price\n    int slPoints = 0,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n</code></pre> <p>Purpose: Places pending Sell Stop order (sell order on downward breakout).</p> <p>Parameters in PendingBreakoutOrchestrator:</p> <ul> <li><code>priceOffsetPoints</code>: NEGATIVE value (<code>-25</code>)</li> <li>Placed BELOW current Bid price</li> <li>Triggers on downward price movement</li> </ul> <p>Price calculation: <pre><code>var tick = await service.SymbolInfoTickAsync(symbol);\ndouble bidPrice = tick.Bid;  // For SELL use Bid\n\ndouble price = bidPrice + (priceOffsetPoints \u00d7 point);\n// 1.10000 + (-25 \u00d7 0.00001) = 1.09975\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#3-closebyticket","title":"3. CloseByTicket","text":"<pre><code>public static async Task CloseByTicket(\n    this MT5Service service,\n    ulong ticket\n)\n</code></pre> <p>Purpose: Closes position or cancels pending order by ticket number.</p> <p>Usage in orchestrator:</p> <ul> <li>Cancel opposite order on breakout (line 135)</li> <li>Cancel both orders on timeout (lines 142-143)</li> <li>Emergency BuyStop cancellation if SellStop placement failed (line 82)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#4-openedordersticketsasync","title":"4. OpenedOrdersTicketsAsync","text":"<pre><code>public async Task&lt;OpenedOrdersTicketsData&gt; OpenedOrdersTicketsAsync()\n</code></pre> <p>Purpose: Gets list of tickets for all PENDING orders (not positions!).</p> <p>Returns: <pre><code>public class OpenedOrdersTicketsData\n{\n    public List&lt;long&gt; OpenedOrdersTickets { get; set; }  // Pending orders\n    public List&lt;long&gt; OpenedPositionTickets { get; set; } // Open positions\n}\n</code></pre></p> <p>Usage:</p> <ul> <li>Check order presence in list (lines 103-107)</li> <li>If order disappeared from list \u2192 it executed</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#risk-management","title":"Risk Management","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#maximum-risk-calculation","title":"Maximum risk calculation","text":"<pre><code>Risk per trade = Volume \u00d7 StopLossPoints \u00d7 ValueOfPoint\n\nFor EURUSD (ValueOfPoint = $10 for 1.0 lot):\n- Volume = 0.01\n- StopLossPoints = 15\n- Risk = 0.01 \u00d7 15 \u00d7 $10 = $1.50\n\nPotential profit:\n- TakeProfitPoints = 30\n- Profit = 0.01 \u00d7 30 \u00d7 $10 = $3.00\n\nRisk/Reward Ratio = 1.50 / 3.00 = 1:2\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#recommendations","title":"Recommendations","text":"<ol> <li>SL/TP ratio:</li> <li>Default: SL=15, TP=30 (R:R = 1:2)</li> <li>Excellent ratio for breakout strategies</li> <li> <p>Even 40% win rate will be profitable</p> </li> <li> <p>Breakout distance:</p> </li> <li><code>BreakoutDistancePoints</code> should account for volatility</li> <li>Too close \u2192 false breakouts (noise)</li> <li>Too far \u2192 miss real breakouts</li> <li> <p>Recommendation: 0.3-0.5 of ATR (Average True Range)</p> </li> <li> <p>Wait time:</p> </li> <li><code>MaxWaitMinutes</code> depends on timeframe</li> <li>M5-M15: 15-30 minutes</li> <li>H1: 60-120 minutes</li> <li> <p>If breakout didn't happen \u2192 cancel (flat market)</p> </li> <li> <p>Position size:</p> </li> <li>No more than 1-2% of deposit at risk</li> <li>Minimum lot (0.01) for testing</li> </ol>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#usage-examples","title":"Usage Examples","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#example-1-conservative-breakout-on-eurusd","title":"Example 1: Conservative breakout on EURUSD","text":"<pre><code>var service = new MT5Service(account);\n\nvar conservativeBreakout = new PendingBreakoutOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    BreakoutDistancePoints = 20,  // Close to price\n    StopLossPoints = 12,           // Tight SL\n    TakeProfitPoints = 24,         // R:R = 1:2\n    Volume = 0.01,\n    MaxWaitMinutes = 20\n};\n\nvar profit = await conservativeBreakout.ExecuteAsync();\nConsole.WriteLine($\"Breakout completed: ${profit:F2}\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#example-2-aggressive-breakout-on-gbpusd","title":"Example 2: Aggressive breakout on GBPUSD","text":"<pre><code>var aggressiveBreakout = new PendingBreakoutOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    BreakoutDistancePoints = 35,  // Further (volatile instrument)\n    StopLossPoints = 20,\n    TakeProfitPoints = 60,         // R:R = 1:3\n    Volume = 0.02,\n    MaxWaitMinutes = 40\n};\n\nvar profit = await aggressiveBreakout.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#example-3-news-strategy","title":"Example 3: News strategy","text":"<pre><code>// Before news release (e.g., NFP)\nvar newsBreakout = new PendingBreakoutOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    BreakoutDistancePoints = 50,  // Wide (expecting strong movement)\n    StopLossPoints = 30,\n    TakeProfitPoints = 100,        // R:R = 1:3.3\n    Volume = 0.01,\n    MaxWaitMinutes = 10            // Short time (news soon)\n};\n\nvar profit = await newsBreakout.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#error-handling","title":"Error Handling","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#critical-points","title":"Critical points","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#1-buystop-placement-error-lines-59-63","title":"1. BuyStop placement error (lines 59-63)","text":"<pre><code>if (buyStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 BUY STOP failed: {buyStopResult.Comment}\");\n    return 0;  // Emergency exit, nothing to cancel (nothing placed)\n}\n</code></pre> <p>Possible causes:</p> <ul> <li>Insufficient funds</li> <li>Market closed</li> <li>Incorrect price (too close to current)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#2-sellstop-placement-error-lines-78-84","title":"2. SellStop placement error (lines 78-84)","text":"<pre><code>if (sellStopResult.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 SELL STOP failed: {sellStopResult.Comment}\");\n    Console.WriteLine(\"  Canceling BUY STOP...\");\n    await _service.CloseByTicket(buyStopResult.Order);  // \u2190 IMPORTANT!\n    return 0;\n}\n</code></pre> <p>Critically important:</p> <ul> <li>If second order placement failed \u2192 cancel first one</li> <li>Otherwise hanging BuyStop will remain without pair</li> <li>Strategy requires BOTH orders simultaneously</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#3-exception-in-main-block-lines-156-161","title":"3. Exception in main block (lines 156-161)","text":"<pre><code>catch (Exception ex)\n{\n    Console.WriteLine($\"\\n  \u2717 Error: {ex.Message}\");\n    // NO emergency closing - orders may remain!\n    return 0;\n}\n</code></pre> <p>Improvement:</p> <pre><code>catch (Exception ex)\n{\n    Console.WriteLine($\"\\n  \u2717 Error: {ex.Message}\");\n\n    // Attempt to cancel orders\n    try\n    {\n        if (buyStopResult != null &amp;&amp; buyStopResult.ReturnedCode == 10009)\n            await _service.CloseByTicket(buyStopResult.Order);\n\n        if (sellStopResult != null &amp;&amp; sellStopResult.ReturnedCode == 10009)\n            await _service.CloseByTicket(sellStopResult.Order);\n    }\n    catch { }\n\n    return 0;\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#console-output","title":"Console Output","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#output-example-upward-breakout","title":"Output example (upward breakout)","text":"<pre><code>+============================================================+\n|  PENDING BREAKOUT ORCHESTRATOR                            |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Breakout distance: 25 pts\n  Volume: 0.01 lots\n  SL: 15 pts | TP: 30 pts\n\n  Current: Bid=1.10000, Ask=1.10002\n\n  Placing BUY STOP order...\n  \u2713 BUY STOP placed: #123456789\n\n  Placing SELL STOP order...\n  \u2713 SELL STOP placed: #123456790\n\n  \u23f3 Waiting up to 30 minutes for breakout...\n\n  \ud83d\ude80 BUY STOP EXECUTED! Upward breakout!\n  Canceling opposite order #123456790...\n  \u2713 Canceled\n\n  Final balance: $10003.00\n  Profit/Loss: $3.00\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#output-example-timeout","title":"Output example (timeout)","text":"<pre><code>+============================================================+\n|  PENDING BREAKOUT ORCHESTRATOR                            |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Breakout distance: 25 pts\n  Volume: 0.01 lots\n  SL: 15 pts | TP: 30 pts\n\n  Current: Bid=1.10000, Ask=1.10002\n\n  Placing BUY STOP order...\n  \u2713 BUY STOP placed: #123456789\n\n  Placing SELL STOP order...\n  \u2713 SELL STOP placed: #123456790\n\n  \u23f3 Waiting up to 30 minutes for breakout...\n\n  \u23f1 Timeout after 30 minutes - canceling both orders...\n  \u2713 Both canceled\n\n  Final balance: $10000.00\n  Profit/Loss: $0.00\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#when-to-use-pending-breakout","title":"When to Use Pending Breakout","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#suitable-conditions","title":"\u2705 Suitable Conditions","text":"<ul> <li>Before important news: NFP, central bank decisions, CPI</li> <li>At key levels: Support/resistance, round numbers</li> <li>Consolidation: Narrow range before breakout</li> <li>Triangles/flags: Technical breakout patterns</li> <li>Asian session \u2192 London: Expecting volatility</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#unsuitable-conditions","title":"\u274c Unsuitable Conditions","text":"<ul> <li>Strong trend: One order triggers immediately, second is useless</li> <li>High volatility: Both orders may trigger</li> <li>Wide spread: Worsens R:R ratio</li> <li>Flat market without direction: Timeout, waste of time</li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#optimization","title":"Optimization","text":""},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#possible-improvements","title":"Possible improvements","text":"<ol> <li> <p>Dynamic distance based on ATR:    <pre><code>var atr = await GetATR(Symbol, period: 14);\nBreakoutDistancePoints = (int)(atr * 0.4);  // 40% of ATR\n</code></pre></p> </li> <li> <p>Trailing after breakout:    <pre><code>if (executedOrder.HasValue)\n{\n    // Wait for movement into profit\n    await Task.Delay(5000);\n    await _service.TrailStart(executedOrder.Value, trailPoints: 10);\n}\n</code></pre></p> </li> <li> <p>Partial closing:    <pre><code>// After breakout close 50% at first TP, trail the rest\nvar positions = await _service.PositionsAsync(Symbol);\nif (positions.Count &gt; 0)\n{\n    await _service.ClosePartial(positions[0].Ticket, percent: 50);\n    await _service.TrailStart(positions[0].Ticket, trailPoints: 15);\n}\n</code></pre></p> </li> <li> <p>Time filter:    <pre><code>var hour = DateTime.UtcNow.Hour;\nif (hour &lt; 7 || hour &gt; 16)  // Only London/NY sessions\n{\n    Console.WriteLine(\"Outside trading hours\");\n    return 0;\n}\n</code></pre></p> </li> </ol>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#related-orchestrators","title":"Related Orchestrators","text":"<ul> <li> <p>GridTradingOrchestrator: For flat markets (opposite strategy).</p> </li> <li> <p>NewsStraddleOrchestrator: Specialization for news.</p> </li> <li> <p>SimpleScalpingOrchestrator: Single trades after breakout.</p> </li> </ul>"},{"location":"Strategies/Orchestrators_EN/PendingBreakoutOrchestrator/#summary","title":"Summary","text":"<p>PendingBreakoutOrchestrator is an elegant OCO strategy for breakouts:</p> <p>\u2705 Pros:</p> <ul> <li>No need to predict direction</li> <li>Excellent R:R ratio (1:2 and better)</li> <li>Automatic opposite order cancellation</li> <li>Safe error handling for placement</li> </ul> <p>\u274c Cons:</p> <ul> <li>May have many timeouts (flat market)</li> <li>False breakouts (whipsaw)</li> <li>Requires correct BreakoutDistancePoints distance</li> </ul> <p>Recommendation:  Use before important events (news, session openings) on instruments with predictable volatility. Combine with technical analysis to identify key levels.</p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/","title":"HOW QuickHedgeOrchestrator WORKS - Detailed Analysis","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#document-purpose","title":"\ud83c\udfaf Document Purpose","text":"<p>Show WHAT the orchestrator consists of and HOW EXACTLY it works at the code, methods and data level. Special attention is paid to the hedge trigger logic and the mathematics of loss locking.</p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#what-the-orchestrator-is-made-of","title":"\ud83d\udce6 What the orchestrator is made of","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#1-class-structure-lines-13-27","title":"1. Class structure (lines 13-27)","text":"<pre><code>public class QuickHedgeOrchestrator\n{\n\n    // \u2502  SINGLE DEPENDENCY                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    private readonly MT5Service _service;\n\n\n    // \u2502  6 CONFIGURABLE PARAMETERS              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    public string Symbol { get; set; } = \"EURUSD\";\n    public double RiskAmount { get; set; } = 30.0;\n    public int StopLossPoints { get; set; } = 25;\n    public int TakeProfitPoints { get; set; } = 40;\n    public bool OpenBuyFirst { get; set; } = true;\n    public int HedgeTriggerPoints { get; set; } = 15;   // \u2190 KEY parameter!\n\n    public QuickHedgeOrchestrator(MT5Service service)\n    {\n        _service = service;\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#dependency-visualization","title":"Dependency visualization","text":"<pre><code>\u2502          QuickHedgeOrchestrator                            \n\u2502    \n\u2502  \u2502  private readonly MT5Service _service                  \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n        \u2502         MT5Service                  \n        \u2502    \n        \u2502  \u2502  private MT5Account _account    \n        \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n                \u2502      MT5Account         \n                \u2502    \n                \u2502  \u2502  gRPC Client        \n                \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n                    [MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#how-executeasync-works-step-by-step","title":"\ud83d\udd04 How ExecuteAsync() works - step by step","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#phase-1-initialization-lines-35-40","title":"Phase 1: Initialization (lines 35-40)","text":"<pre><code>public async Task&lt;double&gt; ExecuteAsync(CancellationToken ct = default)\n{\n    var initialBalance = await _service.GetBalanceAsync();\n\n    Console.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\n    Console.WriteLine($\"  Symbol: {Symbol}\");\n    Console.WriteLine($\"  Initial direction: {(OpenBuyFirst ? \"BUY\" : \"SELL\")}\");\n    Console.WriteLine($\"  Risk: ${RiskAmount:F2}\");\n    Console.WriteLine($\"  Hedge trigger: {HedgeTriggerPoints} pts adverse\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#phase-2-opening-primary-position-lines-44-77","title":"Phase 2: Opening primary position (lines 44-77)","text":"<pre><code>Console.WriteLine($\"  Opening initial {(OpenBuyFirst ? \"BUY\" : \"SELL\")} position...\");\nOrderSendData initialOrder;\n\nif (OpenBuyFirst)\n{\n\n    // \u2502  PRIMARY POSITION with risk sizing                  \n    // \u2502  Has SL and TP for protection                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    initialOrder = await _service.BuyMarketByRisk(\n        symbol: Symbol,             // \"EURUSD\"\n        stopPoints: StopLossPoints, // 25 points\n        riskMoney: RiskAmount,      // $30\n        tpPoints: TakeProfitPoints, // 40 points\n        comment: \"Hedge-Primary\"\n    );\n}\nelse\n{\n    initialOrder = await _service.SellMarketByRisk(\n        symbol: Symbol,\n        stopPoints: StopLossPoints,\n        riskMoney: RiskAmount,\n        tpPoints: TakeProfitPoints,\n        comment: \"Hedge-Primary\"\n    );\n}\n\nif (initialOrder.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 Initial order failed: {initialOrder.Comment}\");\n    return 0;\n}\n\nConsole.WriteLine($\"  \u2713 Initial position: #{initialOrder.Order}\");\nConsole.WriteLine($\"  Entry price: {initialOrder.Price:F5}\");\nConsole.WriteLine($\"  Volume: {initialOrder.Volume:F2} lots\");\n\n\n// \u2502  SAVE CRITICALLY IMPORTANT DATA                         \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar entryPrice = initialOrder.Price;  // For movement calculation\nvar point = await _service.GetPointAsync(Symbol);  // Point size\n</code></pre> <p>Critically important:</p> <ul> <li>Uses BuyMarketByRisk / SellMarketByRisk with SL/TP</li> <li>Saves <code>entryPrice</code> for monitoring movement</li> <li>Saves <code>initialOrder.Volume</code> for hedging the same volume</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#phase-3-monitoring-for-hedge-trigger-lines-82-133","title":"Phase 3: Monitoring for hedge trigger (lines 82-133)","text":"<p>This is the most important part of the orchestrator - the logic for determining adverse movement and placing the hedge.</p> <pre><code>Console.WriteLine($\"  Monitoring price for hedge trigger...\");\n\nbool hedgePlaced = false;\nulong? hedgeTicket = null;\nvar monitorStart = DateTime.UtcNow;\nvar maxMonitorTime = TimeSpan.FromMinutes(5);\n\n\n// \u2502  MONITORING LOOP (every 2 sec, max 5 minutes)          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nwhile (DateTime.UtcNow - monitorStart &lt; maxMonitorTime &amp;&amp; !ct.IsCancellationRequested)\n{\n    await Task.Delay(2000, ct);  // Every 2 seconds\n\n\n    // \u2502  STEP 1: Get current price                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await _service.SymbolInfoTickAsync(Symbol);\n\n    // For BUY position watch Bid (closing price)\n    // For SELL position watch Ask (closing price)\n    var currentPrice = OpenBuyFirst ? tick.Bid : tick.Ask;\n\n\n    // \u2502  STEP 2: Calculate movement in points           \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var priceMovementPoints = Math.Abs((currentPrice - entryPrice) / point);\n\n\n    // \u2502  STEP 3: Check movement direction               \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    // For BUY: adverse = price BELOW entry (currentPrice &lt; entryPrice)\n    // For SELL: adverse = price ABOVE entry (currentPrice &gt; entryPrice)\n    var isAdverse = OpenBuyFirst ? (currentPrice &lt; entryPrice) : (currentPrice &gt; entryPrice);\n\n\n    // \u2502  STEP 4: KEY CHECK - Hedge trigger?                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    if (isAdverse &amp;&amp; priceMovementPoints &gt;= HedgeTriggerPoints)\n    {\n        Console.WriteLine($\"\\n  \u26a0\ufe0f  Price moved {priceMovementPoints:F1} pts against us!\");\n        Console.WriteLine($\"  Opening hedge {(OpenBuyFirst ? \"SELL\" : \"BUY\")} position...\");\n\n\n        // \u2502  OPENING HEDGE POSITION                     \n        // \u2502  IMPORTANT: WITHOUT SL/TP, same Volume!     \n        // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        OrderSendData hedgeOrder;\n        if (OpenBuyFirst)\n        {\n            // Primary was BUY \u2192 hedge SELL\n            hedgeOrder = await _service.SellMarketAsync(\n                symbol: Symbol,\n                volume: initialOrder.Volume,  // \u2190 SAME VOLUME!\n                comment: \"Hedge-Protection\"\n                // WITHOUT sl and tp parameters!\n            );\n        }\n        else\n        {\n            // Primary was SELL \u2192 hedge BUY\n            hedgeOrder = await _service.BuyMarketAsync(\n                symbol: Symbol,\n                volume: initialOrder.Volume,  // \u2190 SAME VOLUME!\n                comment: \"Hedge-Protection\"\n            );\n        }\n\n        if (hedgeOrder.ReturnedCode == 10009)\n        {\n            hedgeTicket = hedgeOrder.Order;\n            hedgePlaced = true;\n            Console.WriteLine($\"  \u2713 Hedge placed: #{hedgeOrder.Order}\\n\");\n            break;  // Exit monitoring\n        }\n        else\n        {\n            Console.WriteLine($\"  \u2717 Hedge failed: {hedgeOrder.Comment}\\n\");\n        }\n    }\n}\n\nif (!hedgePlaced)\n{\n    Console.WriteLine(\"  \u2713 No hedge needed - price moved favorably\\n\");\n}\n</code></pre> <p>Key logic:</p> <ol> <li> <p>Movement calculation:    <pre><code>Example for BUY:\nentryPrice = 1.10000\ncurrentPrice = 1.09985\npoint = 0.00001\n\npriceMovementPoints = |1.09985 - 1.10000| / 0.00001 = 15 points\nisAdverse = 1.09985 &lt; 1.10000 \u2192 true (price lower)\n</code></pre></p> </li> <li> <p>Hedge trigger:    <pre><code>HedgeTriggerPoints = 15\n\nif (isAdverse &amp;&amp; priceMovementPoints &gt;= 15)\n{\n    // 15 &gt;= 15 \u2192 TRUE \u2192 open hedge!\n}\n</code></pre></p> </li> <li> <p>Hedge without SL/TP:</p> </li> <li> <p>Hedge position does NOT have SL and TP</p> </li> <li>Hedge purpose is to freeze the loss, not to make profit</li> <li>Same Volume as primary position \u2192 full hedging</li> </ol>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#phase-4-holding-and-closing-lines-140-146","title":"Phase 4: Holding and closing (lines 140-146)","text":"<pre><code>// \u2502  Hold positions for 30 seconds                          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  \u23f3 Holding positions for 30 seconds...\\n\");\nawait Task.Delay(30000, ct);\n\n\n// \u2502  Close ALL positions simultaneously                     \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  Closing all positions...\");\nawait _service.CloseAll(Symbol);\nConsole.WriteLine(\"  \u2713 All closed\");\n</code></pre> <p>What happens:</p> <ul> <li>If hedge placed \u2192 closes BOTH positions (primary + hedge)</li> <li>If hedge NOT placed \u2192 closes only primary position</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator.HOW_IT_WORKS/#summary","title":"Summary","text":"<p>QuickHedgeOrchestrator is made of:</p> <ol> <li>1 dependency: <code>MT5Service _service</code></li> <li>6 parameters: Symbol, RiskAmount, StopLossPoints, TakeProfitPoints, OpenBuyFirst, HedgeTriggerPoints</li> <li> <p>Key logic:</p> </li> <li> <p>Primary position: with SL/TP, risk sizing</p> </li> <li>Hedge: SAME Volume, WITHOUT SL/TP</li> <li>Monitoring every 2 seconds</li> <li>Trigger: <code>isAdverse &amp;&amp; priceMovementPoints &gt;= HedgeTriggerPoints</code></li> </ol> <p>Works through:</p> <ul> <li>Opening primary position with BuyMarketByRisk</li> <li>Monitoring adverse movement (SymbolInfoTickAsync)</li> <li>Calculating movement in points (GetPointAsync)</li> <li>Placing opposite position on trigger</li> <li>Closing both positions simultaneously (CloseAll)</li> </ul> <p>Returns:</p> <ul> <li><code>double profit</code> - difference between final and initial balance</li> </ul> <p>Key insight:</p> <p>Hedge is NOT designed to make profit. Its purpose is to FREEZE the loss at the HedgeTriggerPoints level. After placing the hedge, the total P/L is frozen regardless of further price movement!</p> <p>Mathematical guarantee: <pre><code>Maximum loss after hedge = HedgeTriggerPoints \u00d7 Volume \u00d7 PointValue\n\nExample:\n15 pts \u00d7 0.12 lots \u00d7 $10 = $18\n\nEven if price falls -100 pts, loss stays at $18!\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/","title":"QuickHedgeOrchestrator - Protective Hedging","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#description","title":"Description","text":"<p>QuickHedgeOrchestrator is an orchestrator for protective hedging of a position when price moves unfavorably. It opens a primary position (BUY or SELL), then monitors the price. If the price moves against us by a specified number of points, it automatically opens an opposite position (hedge) of the same volume to lock in the loss.</p> <p>Operating Principle: \"Capital Protection\" - capital protection through hedging. The primary position has SL/TP. If the price moves against us by more than <code>HedgeTriggerPoints</code>, an opposite position with the same volume is opened, which locks in further losses (positions neutralize each other).</p> <p>File: <code>Examples\\Orchestrators\\QuickHedgeOrchestrator.cs</code></p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#architecture","title":"Architecture","text":"<pre><code>QUICK HEDGE ORCHESTRATOR\n    \u2193\nMT5Service Instance\n    \u2193\n  \u250c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2193     \u2193     \u2193\nBuyMarket SellMarket CloseAll\nByRisk    Async      (close)\n(primary) (hedge)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#dependencies","title":"Dependencies","text":"<ul> <li>MT5Service: Service layer for MT5</li> <li>MT5Sugar Extension Methods: <code>BuyMarketByRisk</code>, <code>SellMarketByRisk</code>, <code>BuyMarketAsync</code>, <code>SellMarketAsync</code>, <code>CloseAll</code></li> <li>mt5_term_api: gRPC types (<code>OrderSendData</code>, <code>SymbolInfoTickData</code>)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#configuration-parameters","title":"Configuration Parameters","text":"Parameter Type Default Description <code>Symbol</code> string <code>\"EURUSD\"</code> Trading instrument <code>RiskAmount</code> double <code>30.0</code> Risk in dollars for primary position <code>StopLossPoints</code> int <code>25</code> SL for primary position <code>TakeProfitPoints</code> int <code>40</code> TP for primary position <code>OpenBuyFirst</code> bool <code>true</code> Primary position direction (true=BUY, false=SELL) <code>HedgeTriggerPoints</code> int <code>15</code> Hedge trigger: adverse movement in points"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#configuration-example","title":"Configuration Example","text":"<pre><code>var hedgeOrchestrator = new QuickHedgeOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    RiskAmount = 50.0,          // Risk $50\n    StopLossPoints = 30,        // SL = 30 points\n    TakeProfitPoints = 60,      // TP = 60 points (R:R = 1:2)\n    OpenBuyFirst = true,        // Open BUY first\n    HedgeTriggerPoints = 20     // Hedge if -20 points\n};\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#how-to-run","title":"How to Run","text":"<p>You can run this orchestrator using any of the following commands:</p> <pre><code>dotnet run 12\ndotnet run hedge\ndotnet run quickhedge\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#algorithm","title":"Algorithm","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#flowchart","title":"Flowchart","text":"<pre><code>START\n  \u2193\nGet initial balance\n  \u2193\nCONDITION: OpenBuyFirst == true?\n  YES \u2192 BuyMarketByRisk(risk, SL, TP)\n  NO \u2192 SellMarketByRisk(risk, SL, TP)\n  \u2193\nSave entryPrice, Volume\n  \u2193\nMONITORING (max 5 minutes)\n  Every 2 seconds:\n    \u2192 SymbolInfoTickAsync()\n    \u2192 Calculate priceMovementPoints\n    \u2192 Check: movement against us?\n    \u2192 If against &gt;= HedgeTriggerPoints:\n         \u2192 Open opposite position (same Volume, WITHOUT SL/TP)\n         \u2192 break (exit monitoring)\n  Timeout \u2192 \"No hedge needed\"\n  \u2193\nTask.Delay(30000)  // Hold for 30 sec\n  \u2193\nCloseAll(Symbol)\n  \u2193\nReturn profit\nEND\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#step-by-step-description","title":"Step-by-Step Description","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#1-initialization-lines-35-40","title":"1. Initialization (lines 35-40)","text":"<pre><code>var initialBalance = await _service.GetBalanceAsync();\n\nConsole.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\nConsole.WriteLine($\"  Symbol: {Symbol}\");\nConsole.WriteLine($\"  Initial direction: {(OpenBuyFirst ? \"BUY\" : \"SELL\")}\");\nConsole.WriteLine($\"  Risk: ${RiskAmount:F2}\");\nConsole.WriteLine($\"  Hedge trigger: {HedgeTriggerPoints} pts adverse\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#2-opening-primary-position-lines-44-77","title":"2. Opening primary position (lines 44-77)","text":"<pre><code>Console.WriteLine($\"  Opening initial {(OpenBuyFirst ? \"BUY\" : \"SELL\")} position...\");\nOrderSendData initialOrder;\n\nif (OpenBuyFirst)\n{\n\n    // \u2502  PRIMARY POSITION with risk sizing                  \n    // \u2502  Has SL and TP for protection                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    initialOrder = await _service.BuyMarketByRisk(\n        symbol: Symbol,             // \"EURUSD\"\n        stopPoints: StopLossPoints, // 25 points\n        riskMoney: RiskAmount,      // $30\n        tpPoints: TakeProfitPoints, // 40 points\n        comment: \"Hedge-Primary\"\n    );\n}\nelse\n{\n    initialOrder = await _service.SellMarketByRisk(\n        symbol: Symbol,\n        stopPoints: StopLossPoints,\n        riskMoney: RiskAmount,\n        tpPoints: TakeProfitPoints,\n        comment: \"Hedge-Primary\"\n    );\n}\n\nif (initialOrder.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 Initial order failed: {initialOrder.Comment}\");\n    return 0;\n}\n\nConsole.WriteLine($\"  \u2713 Initial position: #{initialOrder.Order}\");\nConsole.WriteLine($\"  Entry price: {initialOrder.Price:F5}\");\nConsole.WriteLine($\"  Volume: {initialOrder.Volume:F2} lots\");\n\n\n// \u2502  SAVE CRITICALLY IMPORTANT DATA                         \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar entryPrice = initialOrder.Price;  // For movement calculation\nvar point = await _service.GetPointAsync(Symbol);  // Point size\n</code></pre> <p>Critically important: - Uses BuyMarketByRisk / SellMarketByRisk with SL/TP - Saves <code>entryPrice</code> for monitoring movement - Saves <code>initialOrder.Volume</code> for hedging the same volume</p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#3-monitoring-for-hedge-trigger-lines-82-133","title":"3. Monitoring for hedge trigger (lines 82-133)","text":"<pre><code>Console.WriteLine($\"  Monitoring price for hedge trigger...\");\n\nbool hedgePlaced = false;\nulong? hedgeTicket = null;\nvar monitorStart = DateTime.UtcNow;\nvar maxMonitorTime = TimeSpan.FromMinutes(5);\n\n\n// \u2502  MONITORING LOOP (every 2 sec, max 5 minutes)          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nwhile (DateTime.UtcNow - monitorStart &lt; maxMonitorTime &amp;&amp; !ct.IsCancellationRequested)\n{\n    await Task.Delay(2000, ct);  // Every 2 seconds\n\n\n    // \u2502  STEP 1: Get current price                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await _service.SymbolInfoTickAsync(Symbol);\n\n    // For BUY position watch Bid (closing price)\n    // For SELL position watch Ask (closing price)\n    var currentPrice = OpenBuyFirst ? tick.Bid : tick.Ask;\n\n\n    // \u2502  STEP 2: Calculate movement in points           \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var priceMovementPoints = Math.Abs((currentPrice - entryPrice) / point);\n\n\n    // \u2502  STEP 3: Check movement direction               \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    // For BUY: adverse = price BELOW entry (currentPrice &lt; entryPrice)\n    // For SELL: adverse = price ABOVE entry (currentPrice &gt; entryPrice)\n    var isAdverse = OpenBuyFirst ? (currentPrice &lt; entryPrice) : (currentPrice &gt; entryPrice);\n\n\n    // \u2502  STEP 4: KEY CHECK - Hedge trigger?                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    if (isAdverse &amp;&amp; priceMovementPoints &gt;= HedgeTriggerPoints)\n    {\n        Console.WriteLine($\"\\n  \u26a0\ufe0f  Price moved {priceMovementPoints:F1} pts against us!\");\n        Console.WriteLine($\"  Opening hedge {(OpenBuyFirst ? \"SELL\" : \"BUY\")} position...\");\n\n\n        // \u2502  OPENING HEDGE POSITION                     \n        // \u2502  IMPORTANT: WITHOUT SL/TP, same Volume!     \n        // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        OrderSendData hedgeOrder;\n        if (OpenBuyFirst)\n        {\n            // Primary was BUY \u2192 hedge SELL\n            hedgeOrder = await _service.SellMarketAsync(\n                symbol: Symbol,\n                volume: initialOrder.Volume,  // \u2190 SAME VOLUME!\n                comment: \"Hedge-Protection\"\n                // WITHOUT sl and tp parameters!\n            );\n        }\n        else\n        {\n            // Primary was SELL \u2192 hedge BUY\n            hedgeOrder = await _service.BuyMarketAsync(\n                symbol: Symbol,\n                volume: initialOrder.Volume,  // \u2190 SAME VOLUME!\n                comment: \"Hedge-Protection\"\n            );\n        }\n\n        if (hedgeOrder.ReturnedCode == 10009)\n        {\n            hedgeTicket = hedgeOrder.Order;\n            hedgePlaced = true;\n            Console.WriteLine($\"  \u2713 Hedge placed: #{hedgeOrder.Order}\\n\");\n            break;  // Exit monitoring\n        }\n        else\n        {\n            Console.WriteLine($\"  \u2717 Hedge failed: {hedgeOrder.Comment}\\n\");\n        }\n    }\n}\n\nif (!hedgePlaced)\n{\n    Console.WriteLine(\"  \u2713 No hedge needed - price moved favorably\\n\");\n}\n</code></pre> <p>Key logic:</p> <ol> <li> <p>Movement calculation:    <pre><code>Example for BUY:\nentryPrice = 1.10000\ncurrentPrice = 1.09985\npoint = 0.00001\n\npriceMovementPoints = |1.09985 - 1.10000| / 0.00001 = 15 points\nisAdverse = 1.09985 &lt; 1.10000 \u2192 true (price lower)\n</code></pre></p> </li> <li> <p>Hedge trigger:    <pre><code>HedgeTriggerPoints = 15\n\nif (isAdverse &amp;&amp; priceMovementPoints &gt;= 15)\n{\n    // 15 &gt;= 15 \u2192 TRUE \u2192 open hedge!\n}\n</code></pre></p> </li> <li> <p>Hedge without SL/TP:</p> </li> <li> <p>Hedge position does NOT have SL and TP</p> </li> <li>Hedge purpose is to freeze the loss, not to make profit</li> <li>Same Volume as primary position \u2192 full hedging</li> </ol>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#4-holding-and-closing-lines-140-146","title":"4. Holding and closing (lines 140-146)","text":"<pre><code>// \u2502  Hold positions for 30 seconds                          \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  \u23f3 Holding positions for 30 seconds...\\n\");\nawait Task.Delay(30000, ct);\n\n\n// \u2502  Close ALL positions simultaneously                     \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine(\"  Closing all positions...\");\nawait _service.CloseAll(Symbol);\nConsole.WriteLine(\"  \u2713 All closed\");\n</code></pre> <p>What happens:</p> <ul> <li>If hedge placed \u2192 closes BOTH positions (primary + hedge)</li> <li>If hedge NOT placed \u2192 closes only primary position</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#strategy-visualization","title":"Strategy Visualization","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#scenario-1-hedge-triggered-loss-limited","title":"Scenario 1: Hedge triggered (loss limited)","text":"<pre><code>T=0      BuyMarketByRisk(risk=$30, SL=25pts, TP=40pts)\n         \u2502\n         \u251c\u2500\u25ba Volume calculation: $30 / (25 \u00d7 $10) = 0.12 lots\n         \u2502\n         \u251c\u2500\u25ba Opened BUY position 0.12 lots @ 1.10000\n         \u2502   SL: 1.09975 (-25 pts)\n         \u2502   TP: 1.10040 (+40 pts)\n         \u2502   HedgeTrigger: -15 pts (@ 1.09985)\n         \u2502\n         \u2502   Price moves:\n         \u2502   1.10000 \u2192 1.09995 \u2192 1.09990 \u2192 1.09985...\n         \u2502\nT=10s    \u251c\u2500\u25ba currentPrice = 1.09985\n         \u2502   priceMovementPoints = |1.09985 - 1.10000| / 0.00001 = 15\n         \u2502   isAdverse = true (1.09985 &lt; 1.10000)\n         \u2502\n         \u2502   HEDGE TRIGGER! (15 &gt;= 15)\n         \u2502\n         \u251c\u2500\u25ba SellMarketAsync(volume=0.12, NO SL/TP)\n         \u2502   \u2514\u2500\u25ba Opened SELL 0.12 lots @ 1.09985\n         \u2502\n         \u2502   STATE:\n         \u2502   \n         \u2502   \u2502 BUY  0.12 @ 1.10000 (loss -15 pts)   \n         \u2502   \u2502 SELL 0.12 @ 1.09985                  \n         \u2502   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n         \u2502   \u2502 NET: HEDGE (positions neutralize)    \n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502\n         \u2502   Price continues to fall:\n         \u2502   1.09985 \u2192 1.09980 \u2192 1.09975 \u2192 1.09970...\n         \u2502\nT=15s    \u251c\u2500\u25ba currentPrice = 1.09970\n         \u2502\n         \u2502   BUY position:  1.10000 \u2192 1.09970 = -30 pts\n         \u2502   SELL position: 1.09985 \u2192 1.09970 = +15 pts\n         \u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502   Total: -30 + 15 = -15 pts (FROZEN!)\n         \u2502\nT=40s    \u251c\u2500\u25ba Task.Delay(30000) finished\n         \u2502\n         \u251c\u2500\u25ba CloseAll(\"EURUSD\")\n         \u2502   \u251c\u2500\u25ba Closed BUY position\n         \u2502   \u2514\u2500\u25ba Closed SELL position\n         \u2502\n         \u2502   Final P/L:\n         \u2502   BUY:  -30 pts \u00d7 0.12 = -$36\n         \u2502   SELL: +15 pts \u00d7 0.12 = +$18\n         \u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502   TOTAL: -$18\n         \u2502\n         \u2514\u2500\u25ba Result: Loss -$18 instead of -$36 WITHOUT hedge!\n\nWITHOUT HEDGE: Loss would be -30 pts \u00d7 0.12 = -$36\nWITH HEDGE:    Loss only -15 pts \u00d7 0.12 = -$18\nSAVED: $18 (50% less loss!)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#scenario-2-hedge-not-needed-price-goes-in-our-direction","title":"Scenario 2: Hedge NOT needed (price goes in our direction)","text":"<pre><code>T=0      BuyMarketByRisk(risk=$30, SL=25pts, TP=40pts)\n         \u2502\n         \u251c\u2500\u25ba Opened BUY position 0.12 lots @ 1.10000\n         \u2502   HedgeTrigger: -15 pts\n         \u2502\n         \u2502   Price moves UP:\n         \u2502   1.10000 \u2192 1.10010 \u2192 1.10025 \u2192 1.10040...\n         \u2502\nT=20s    \u251c\u2500\u25ba currentPrice = 1.10040\n         \u2502   priceMovementPoints = |1.10040 - 1.10000| / 0.00001 = 40\n         \u2502   isAdverse = false (1.10040 &gt; 1.10000) \u2190 IN OUR FAVOR!\n         \u2502\n         \u2502   Hedge does NOT trigger (favorable movement)\n         \u2502\n         \u251c\u2500\u25ba TP HIT! (1.10040)\n         \u2502   Position closed automatically\n         \u2502\nT=5min   \u251c\u2500\u25ba Monitoring finished (timeout)\n         \u2502   \u2514\u2500\u25ba \"No hedge needed - price moved favorably\"\n         \u2502\nT=5min   \u251c\u2500\u25ba Task.Delay(30000) finished\n+30s     \u2502\n         \u251c\u2500\u25ba CloseAll(\"EURUSD\")\n         \u2502   \u2514\u2500\u25ba Position already closed (TP hit earlier)\n         \u2502\n         \u2502   Final P/L:\n         \u2502   BUY: +40 pts \u00d7 0.12 = +$48\n         \u2502\n         \u2514\u2500\u25ba Result: Profit +$48\n\nHEDGE NOT NEEDED \u2192 got full profit from TP!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#scenario-3-sl-hit-before-hedge-trigger","title":"Scenario 3: SL hit BEFORE hedge trigger","text":"<pre><code>T=0      BuyMarketByRisk(risk=$30, SL=25pts, TP=40pts)\n         \u2502\n         \u251c\u2500\u25ba Opened BUY position 0.12 lots @ 1.10000\n         \u2502   SL: 1.09975 (-25 pts)\n         \u2502   HedgeTrigger: 1.09985 (-15 pts)\n         \u2502\n         \u2502   Price moves SLOWLY down:\n         \u2502   1.10000 \u2192 1.09990 (-10 pts, hedge not triggered)\n         \u2502\nT=30s    \u251c\u2500\u25ba Then SHARPLY falls:\n         \u2502   1.09990 \u2192 1.09975 (SL reached!)\n         \u2502\n         \u251c\u2500\u25ba SL HIT!\n         \u2502   Position closed automatically\n         \u2502   Loss: -25 pts \u00d7 0.12 = -$30 (exactly riskMoney!)\n         \u2502\nT=40s    \u251c\u2500\u25ba Monitoring continues...\n         \u2502   But position is gone \u2192 do nothing\n         \u2502\nT=5min   \u251c\u2500\u25ba Monitoring timeout\n+30s     \u2502\n         \u251c\u2500\u25ba CloseAll(\"EURUSD\")\n         \u2502   \u2514\u2500\u25ba Position already closed\n         \u2502\n         \u2514\u2500\u25ba Result: Loss -$30 (as planned)\n\nHEDGE NOT TRIGGERED \u2192 SL closed position faster than trigger reached\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#used-mt5sugar-methods","title":"Used MT5Sugar Methods","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#1-buymarketbyrisk-sellmarketbyrisk","title":"1. BuyMarketByRisk / SellMarketByRisk","text":"<p>Usage: Opening primary position with SL and TP.</p> <pre><code>initialOrder = await _service.BuyMarketByRisk(\n    symbol: Symbol,\n    stopPoints: StopLossPoints,  // 25 points\n    riskMoney: RiskAmount,       // $30\n    tpPoints: TakeProfitPoints,  // 40 points\n    comment: \"Hedge-Primary\"\n);\n</code></pre> <p>Why this method:</p> <ul> <li>Automatically calculates Volume based on risk</li> <li>Sets SL and TP for protection</li> <li>Returns <code>initialOrder.Volume</code> for hedge</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#2-buymarketasync-sellmarketasync","title":"2. BuyMarketAsync / SellMarketAsync","text":"<p>Usage: Opening hedge position WITHOUT SL/TP.</p> <pre><code>hedgeOrder = await _service.SellMarketAsync(\n    symbol: Symbol,\n    volume: initialOrder.Volume,  // \u2190 SAME volume as primary\n    comment: \"Hedge-Protection\"\n    // WITHOUT sl and tp!\n);\n</code></pre> <p>Why WITHOUT SL/TP:</p> <ul> <li>Hedge is designed to lock in the loss, not to make profit</li> <li>SL on hedge could close it prematurely</li> <li>Both positions closed simultaneously via <code>CloseAll()</code></li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#3-getpointasync","title":"3. GetPointAsync","text":"<pre><code>var point = await _service.GetPointAsync(Symbol);\n</code></pre> <p>Purpose: Get point size for the symbol.</p> <p>Usage:</p> <ul> <li>Calculate price movement in points (line 95)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#4-symbolinfotickasync","title":"4. SymbolInfoTickAsync","text":"<pre><code>var tick = await _service.SymbolInfoTickAsync(Symbol);\nvar currentPrice = OpenBuyFirst ? tick.Bid : tick.Ask;\n</code></pre> <p>Usage:</p> <ul> <li>Monitor current price every 2 seconds</li> <li>For BUY use Bid (BUY closing price)</li> <li>For SELL use Ask (SELL closing price)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#5-closeall","title":"5. CloseAll","text":"<pre><code>await _service.CloseAll(Symbol);\n</code></pre> <p>Usage:</p> <ul> <li>Close all positions for the symbol simultaneously</li> <li>Closes both primary and hedge position</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#hedging-mathematics","title":"Hedging Mathematics","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#full-hedging-same-volume","title":"Full hedging (same Volume)","text":"<pre><code>Primary position: BUY 0.12 lots @ 1.10000\nHedge:            SELL 0.12 lots @ 1.09985\n\nWhen price moves:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2502 Price     \u2502 BUY P/L      \u2502 SELL P/L     \u2502 Total      \n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2502 1.10000   \u2502 0 pts        \u2502 +15 pts      \u2502 +15 pts    \n\u2502 1.09995   \u2502 -5 pts       \u2502 +10 pts      \u2502 +5 pts     \n\u2502 1.09990   \u2502 -10 pts      \u2502 +5 pts       \u2502 -5 pts     \n\u2502 1.09985   \u2502 -15 pts      \u2502 0 pts        \u2502 -15 pts     \u2190 Hedge point\n\u2502 1.09980   \u2502 -20 pts      \u2502 -5 pts       \u2502 -15 pts     \u2190 FROZEN!\n\u2502 1.09975   \u2502 -25 pts      \u2502 -10 pts      \u2502 -15 pts     \u2190 FROZEN!\n\u2502 1.09970   \u2502 -30 pts      \u2502 -15 pts      \u2502 -15 pts     \u2190 FROZEN!\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nCONCLUSION: After hedge placement, total P/L FROZEN at -15 pts!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#partial-hedging-smaller-volume","title":"Partial hedging (smaller Volume)","text":"<pre><code>Primary position: BUY 0.12 lots @ 1.10000\nHedge:            SELL 0.06 lots @ 1.09985 (50% hedge)\n\nWhen price moves:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2502 Price     \u2502 BUY P/L      \u2502 SELL P/L     \u2502 Total      \n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2502 1.09985   \u2502 -15 pts      \u2502 0 pts        \u2502 -15 pts    \n\u2502 1.09980   \u2502 -20 pts      \u2502 -2.5 pts     \u2502 -22.5 pts   \u2190 Continues to grow!\n\u2502 1.09975   \u2502 -25 pts      \u2502 -5 pts       \u2502 -30 pts    \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nCONCLUSION: Partial hedge only SLOWS loss, but doesn't freeze it!\n</code></pre> <p>QuickHedgeOrchestrator uses FULL hedging (100%).</p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#risk-management","title":"Risk Management","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#choosing-hedgetriggerpoints","title":"Choosing HedgeTriggerPoints","text":"<pre><code>Rule: HedgeTriggerPoints should be LESS than StopLossPoints\n\nExample:\n- StopLossPoints = 25\n- HedgeTriggerPoints = 15  \u2713 (less than SL)\n\nIf HedgeTriggerPoints &gt;= StopLossPoints:\n- Hedge will never trigger (SL closes position first)\n\nRecommendation:\nHedgeTriggerPoints = StopLossPoints \u00d7 0.5 - 0.7\n25 pts SL \u2192 12-18 pts hedge trigger\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#savings-through-hedging","title":"Savings through hedging","text":"<pre><code>Scenario WITHOUT hedge:\n- Price goes against us -30 pts\n- Loss: -30 pts \u00d7 0.12 = -$36\n\nScenario WITH hedge (trigger 15 pts):\n- Price -15 pts \u2192 hedge opened\n- Price continues to fall to -30 pts\n- Loss: -15 pts \u00d7 0.12 = -$18\n\nSAVED: $36 - $18 = $18 (50%!)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#recommendations","title":"Recommendations","text":"<ol> <li>HedgeTriggerPoints:</li> <li>Not too close (avoid false triggers from noise)</li> <li>Not too far (otherwise lose too much before hedge)</li> <li> <p>Optimal: 50-70% of StopLossPoints</p> </li> <li> <p>MaxMonitorTime:</p> </li> <li>Default 5 minutes is enough</li> <li>For volatile instruments: 2-3 minutes</li> <li> <p>For low volatility: 10 minutes</p> </li> <li> <p>When to use:</p> </li> <li>Before important news (high volatility)</li> <li>When uncertain about direction</li> <li> <p>For capital protection in aggressive strategies</p> </li> <li> <p>When NOT to use:</p> </li> <li>On trending markets (hedge prevents profit)</li> <li>With low spreads and commissions (hedging cost)</li> <li>For long-term positions (swap accumulates on both sides)</li> </ol>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#usage-examples","title":"Usage Examples","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#example-1-conservative-hedging","title":"Example 1: Conservative hedging","text":"<pre><code>var conservativeHedge = new QuickHedgeOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    RiskAmount = 20.0,\n    StopLossPoints = 20,\n    TakeProfitPoints = 40,    // R:R = 1:2\n    OpenBuyFirst = true,\n    HedgeTriggerPoints = 10   // Quick hedge (50% of SL)\n};\n\nvar profit = await conservativeHedge.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#example-2-aggressive-hedging","title":"Example 2: Aggressive hedging","text":"<pre><code>var aggressiveHedge = new QuickHedgeOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    RiskAmount = 50.0,\n    StopLossPoints = 30,\n    TakeProfitPoints = 90,    // R:R = 1:3\n    OpenBuyFirst = false,     // SELL\n    HedgeTriggerPoints = 20   // Late hedge (67% of SL)\n};\n\nvar profit = await aggressiveHedge.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#example-3-news-hedging","title":"Example 3: News hedging","text":"<pre><code>// Before NFP or other volatile news release\nvar newsHedge = new QuickHedgeOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    RiskAmount = 30.0,\n    StopLossPoints = 40,      // Wide SL (volatility)\n    TakeProfitPoints = 80,\n    OpenBuyFirst = true,\n    HedgeTriggerPoints = 25   // Medium trigger\n};\n\nvar profit = await newsHedge.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#error-handling","title":"Error Handling","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#exception-with-emergency-close-lines-158-168","title":"Exception with emergency close (lines 158-168)","text":"<pre><code>catch (Exception ex)\n{\n    Console.WriteLine($\"\\n  \u2717 Error: {ex.Message}\");\n\n\n    // \u2502  EMERGENCY CLOSE ALL POSITIONS                  \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    try\n    {\n        await _service.CloseAll(Symbol);\n    }\n    catch { }  // Ignore errors during emergency close\n\n    return 0;\n}\n</code></pre> <p>Correct approach: - On any error \u2192 try to close all positions - Closes both primary and hedge (if any)</p>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#console-output","title":"Console Output","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#output-example-hedge-triggered","title":"Output example (hedge triggered)","text":"<pre><code>+============================================================+\n|  QUICK HEDGE ORCHESTRATOR                                 |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Initial direction: BUY\n  Risk: $30.00\n  Hedge trigger: 15 pts adverse\n\n  Opening initial BUY position...\n  \u2713 Initial position: #123456789\n  Entry price: 1.10000\n  Volume: 0.12 lots\n\n  Monitoring price for hedge trigger...\n\n  \u26a0\ufe0f  Price moved 15.2 pts against us!\n  Opening hedge SELL position...\n  \u2713 Hedge placed: #123456790\n\n  \u23f3 Holding positions for 30 seconds...\n\n  Closing all positions...\n  \u2713 All closed\n\n  Final balance: $9982.00\n  Net Profit/Loss: -$18.00\n  Hedged trade\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#output-example-hedge-not-needed","title":"Output example (hedge NOT needed)","text":"<pre><code>+============================================================+\n|  QUICK HEDGE ORCHESTRATOR                                 |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Initial direction: BUY\n  Risk: $30.00\n  Hedge trigger: 15 pts adverse\n\n  Opening initial BUY position...\n  \u2713 Initial position: #123456789\n  Entry price: 1.10000\n  Volume: 0.12 lots\n\n  Monitoring price for hedge trigger...\n  \u2713 No hedge needed - price moved favorably\n\n  \u23f3 Holding positions for 30 seconds...\n\n  Closing all positions...\n  \u2713 All closed\n\n  Final balance: $10048.00\n  Net Profit/Loss: $48.00\n  Unhedged trade\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#when-to-use-quick-hedge","title":"When to Use Quick Hedge","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#suitable-conditions","title":"\u2705 Suitable Conditions","text":"<ul> <li>Before important news: NFP, central bank decisions, CPI</li> <li>High uncertainty: Unclear market direction</li> <li>Capital protection: Priority is not to lose, not to earn</li> <li>Volatile sessions: London/New York open</li> <li>Learning: Stress reduction for beginners</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#unsuitable-conditions","title":"\u274c Unsuitable Conditions","text":"<ul> <li>Strong trend: Hedge prevents full profit</li> <li>Low volatility: Hedge unlikely to be needed</li> <li>High commissions: Double positions = double costs</li> <li>Long-term trading: Swap accumulates on both sides</li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#optimization","title":"Optimization","text":""},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#possible-improvements","title":"Possible improvements","text":"<ol> <li> <p>Partial hedging:    <pre><code>hedgeOrder = await _service.SellMarketAsync(\n    symbol: Symbol,\n    volume: initialOrder.Volume * 0.5,  // 50% hedge\n    comment: \"Hedge-Partial\"\n);\n</code></pre></p> </li> <li> <p>Close hedge on recovery:    <pre><code>// If price returns to entry point\nif (!isAdverse &amp;&amp; priceMovementPoints &lt; 5 &amp;&amp; hedgePlaced)\n{\n    await _service.CloseByTicket(hedgeTicket.Value);\n    hedgePlaced = false;\n}\n</code></pre></p> </li> <li> <p>Dynamic trigger based on ATR:    <pre><code>var atr = await GetATR(Symbol, period: 14);\nHedgeTriggerPoints = (int)(atr * 0.4);\n</code></pre></p> </li> </ol>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#related-orchestrators","title":"Related Orchestrators","text":"<ul> <li> <p>SimpleScalpingOrchestrator: Without hedging.</p> </li> <li> <p>PendingBreakoutOrchestrator: OCO instead of hedge.</p> </li> <li> <p>NewsStraddleOrchestrator: Two-sided pending orders.</p> </li> </ul>"},{"location":"Strategies/Orchestrators_EN/QuickHedgeOrchestrator/#summary","title":"Summary","text":"<p>QuickHedgeOrchestrator is a capital protection strategy through hedging:</p> <p>\u2705 Pros:</p> <ul> <li>Protection from strong adverse movements</li> <li>Freezes loss at trigger level</li> <li>Psychological comfort (less stress)</li> <li>Suitable for news trading</li> </ul> <p>\u274c Cons:</p> <ul> <li>Double commissions and spread</li> <li>May limit profit on reversal</li> <li>Swap accumulates on both positions</li> <li>More complex for beginners to understand</li> </ul> <p>Recommendation:  Use during periods of high uncertainty or before important events. Don't use on trending markets. Hedge is protection, not a way to earn.</p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/","title":"HOW SimpleScalpingOrchestrator WORKS - Detailed Analysis","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#document-purpose","title":"\ud83c\udfaf Document Purpose","text":"<p>Show WHAT the orchestrator consists of and HOW EXACTLY it works at the code, methods and data level. Special attention is paid to risk-sizing and automatic position size calculation.</p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#what-the-orchestrator-is-made-of","title":"\ud83d\udce6 What the orchestrator is made of","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#1-class-structure-lines-13-27","title":"1. Class structure (lines 13-27)","text":"<pre><code>public class SimpleScalpingOrchestrator\n{\n\n    // \u2502  SINGLE DEPENDENCY                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    private readonly MT5Service _service;\n\n\n    // \u2502  6 CONFIGURABLE PARAMETERS              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    public string Symbol { get; set; } = \"EURUSD\";\n    public double RiskAmount { get; set; } = 20.0;      // $20 risk\n    public int StopLossPoints { get; set; } = 10;\n    public int TakeProfitPoints { get; set; } = 20;\n    public bool IsBuy { get; set; } = true;\n    public int MaxHoldSeconds { get; set; } = 60;       // 60 seconds\n\n\n    // \u2502  DEPENDENCY INJECTION                   \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    public SimpleScalpingOrchestrator(MT5Service service)\n    {\n        _service = service;  // \u2190 Get MT5Service from outside\n    }\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#dependency-visualization","title":"Dependency visualization","text":"<pre><code>\u2502        SimpleScalpingOrchestrator                          \n\u2502    \n\u2502  \u2502  private readonly MT5Service _service                  \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n        \u2502         MT5Service                  \n        \u2502    \n        \u2502  \u2502  private MT5Account _account    \n        \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n\n                \u2502      MT5Account         \n                \u2502    \n                \u2502  \u2502  gRPC Client        \n                \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                          \u2502\n                          \u25bc\n                    [MT5 Terminal]\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#how-executeasync-works-step-by-step","title":"\ud83d\udd04 How ExecuteAsync() works - step by step","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#phase-1-initialization-lines-30-41","title":"Phase 1: Initialization (lines 30-41)","text":"<pre><code>public async Task&lt;double&gt; ExecuteAsync(CancellationToken ct = default)\n{\n\n    // \u2502  STEP 1: Output header                              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine(\"\\n+============================================================+\");\n    Console.WriteLine(\"|  SIMPLE SCALPING ORCHESTRATOR                             |\");\n    Console.WriteLine(\"+============================================================+\\n\");\n\n\n    // \u2502  STEP 2: Get initial balance                        \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var initialBalance = await _service.GetBalanceAsync();\n\n\n    // \u2502  STEP 3: Output strategy parameters                 \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\n    Console.WriteLine($\"  Symbol: {Symbol}\");\n    Console.WriteLine($\"  Direction: {(IsBuy ? \"BUY\" : \"SELL\")}\");\n    Console.WriteLine($\"  Risk: ${RiskAmount:F2}\");\n    Console.WriteLine($\"  SL: {StopLossPoints} pts | TP: {TakeProfitPoints} pts\");\n    Console.WriteLine($\"  Max hold: {MaxHoldSeconds}s\\n\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#phase-2-opening-position-with-risk-sizing-lines-43-77","title":"Phase 2: Opening position with risk-sizing (lines 43-77)","text":"<pre><code>try\n{\n\n    // \u2502  Opening market position                            \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    Console.WriteLine(\"  Opening position...\");\n    OrderSendData result;\n\n\n    // \u2502  DIRECTION CHOICE: BUY or SELL                      \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    if (IsBuy)\n    {\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // BUY: Use BuyMarketByRisk\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        result = await _service.BuyMarketByRisk(\n            symbol: Symbol,             // \"EURUSD\"\n            stopPoints: StopLossPoints, // 10 points\n            riskMoney: RiskAmount,      // $20\n            tpPoints: TakeProfitPoints, // 20 points\n            comment: \"Scalper\"\n        );\n    }\n    else\n    {\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        // SELL: Use SellMarketByRisk\n        // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n        result = await _service.SellMarketByRisk(\n            symbol: Symbol,\n            stopPoints: StopLossPoints,\n            riskMoney: RiskAmount,\n            tpPoints: TakeProfitPoints,\n            comment: \"Scalper\"\n        );\n    }\n\n\n    // \u2502  RESULT CHECK                                       \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    if (result.ReturnedCode != 10009)  // 10009 = TRADE_RETCODE_DONE\n    {\n        Console.WriteLine($\"  \u2717 Order failed: {result.Comment}\");\n        return 0;  // \u2190 EMERGENCY EXIT\n    }\n\n    Console.WriteLine($\"  \u2713 Position opened: #{result.Order}\");\n    Console.WriteLine($\"  Volume: {result.Volume:F2} lots\\n\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#how-buymarketbyrisk-works-internally","title":"How BuyMarketByRisk() works internally","text":"<pre><code>// MT5Sugar.cs (extension method)\npublic static async Task&lt;OrderSendData&gt; BuyMarketByRisk(\n    this MT5Service service,\n    string symbol,\n    int stopPoints,      // \u2190 RECEIVES 10\n    double riskMoney,    // \u2190 RECEIVES $20\n    int tpPoints = 0,\n    string comment = \"\"\n)\n{\n\n    // \u2502  STEP 1: Get symbol information                     \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var symbolInfo = await service.SymbolInfoAsync(symbol);\n\n    // EURUSD SymbolInfo:\n    // - Point = 0.00001 (point size)\n    // - Trade_Contract_Size = 100000 (contract size)\n    // - Digits = 5 (decimal places)\n\n\n    // \u2502  STEP 2: Calculate value of ONE point              \n    // \u2502  for standard lot (1.0)                             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double pointValue = symbolInfo.Trade_Contract_Size * symbolInfo.Point;\n\n    // For EURUSD:\n    // pointValue = 100000 \u00d7 0.00001 = 1.0\n\n    // BUT! This is for base currency (EUR).\n    // Need to convert to USD (account currency).\n\n\n    // \u2502  STEP 3: Get current price for conversion          \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    var tick = await service.SymbolInfoTickAsync(symbol);\n    double currentPrice = tick.Ask;  // For BUY use Ask\n\n    // EURUSD @ 1.10000:\n    // 1 point for 1.0 lot = 1 EUR = 1.10000 USD \u2248 $1.10\n    // (in reality MT5 uses special conversion tables)\n\n    // For simplicity, for major pairs:\n    // EURUSD, GBPUSD, AUDUSD, NZDUSD: ~$10 per point for 1.0 lot\n    double pointValueUSD = 10.0;  // Simplified for example\n\n\n    // \u2502  STEP 4: KEY CALCULATION - Position size           \n    // \u2502                                                     \n    // \u2502  Risk-sizing formula:                               \n    // \u2502  Volume = RiskMoney / (StopPoints \u00d7 PointValueUSD)  \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double volume = riskMoney / (stopPoints * pointValueUSD);\n\n    // For our parameters:\n    // riskMoney = $20\n    // stopPoints = 10\n    // pointValueUSD = $10\n    //\n    // volume = $20 / (10 \u00d7 $10)\n    //        = $20 / $100\n    //        = 0.2 lots\n\n\n    // \u2502  STEP 5: Round to allowed volume step              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double volumeStep = symbolInfo.Volume_Step;  // Usually 0.01\n    volume = Math.Round(volume / volumeStep) * volumeStep;\n\n    // 0.2 \u2192 round to 0.01 step \u2192 0.20\n\n\n    // \u2502  STEP 6: Check minimum/maximum volume              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double minVolume = symbolInfo.Volume_Min;  // Usually 0.01\n    double maxVolume = symbolInfo.Volume_Max;  // Usually 100.0\n\n    if (volume &lt; minVolume) volume = minVolume;\n    if (volume &gt; maxVolume) volume = maxVolume;\n\n\n    // \u2502  STEP 7: Calculate SL and TP in absolute prices    \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    double point = symbolInfo.Point;\n\n    double sl = stopPoints &gt; 0\n        ? currentPrice - (stopPoints * point)  // For BUY: SL below\n        : 0;\n\n    double tp = tpPoints &gt; 0\n        ? currentPrice + (tpPoints * point)    // For BUY: TP above\n        : 0;\n\n    // For BUY @ 1.10000:\n    // sl = 1.10000 - (10 \u00d7 0.00001) = 1.09990\n    // tp = 1.10000 + (20 \u00d7 0.00001) = 1.10020\n\n\n    // \u2502  STEP 8: Call low-level BuyMarketAsync              \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    return await service.BuyMarketAsync(\n        symbol: symbol,      // \"EURUSD\"\n        volume: volume,      // 0.20 (CALCULATED!)\n        sl: sl,              // 1.09990\n        tp: tp,              // 1.10020\n        comment: comment     // \"Scalper\"\n    );\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#complete-call-chain-for-buymarketbyrisk","title":"Complete call chain for BuyMarketByRisk","text":"<pre><code>\u2502  USER CODE (SimpleScalpingOrchestrator.cs:51)                  \n\u2502  await _service.BuyMarketByRisk(                               \n\u2502      symbol: \"EURUSD\",                                         \n\u2502      stopPoints: 10,         \u2190 SL POINTS                       \n\u2502      riskMoney: 20.0,        \u2190 RISK IN DOLLARS                 \n\u2502      tpPoints: 20,           \u2190 TP POINTS                       \n\u2502      comment: \"Scalper\"                                        \n\u2502  )                                                             \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n   MT5Sugar.BuyMarketByRisk() (extension method)                 \n\u2502    \n\u2502  \u2502 1. SymbolInfoAsync() \u2192 get symbol info                    \n\u2502  \u2502    - Point = 0.00001                                       \n\u2502  \u2502    - Trade_Contract_Size = 100000                          \n\u2502  \u2502    - Volume_Step = 0.01                                    \n\u2502  \u2502                                                            \n\u2502  \u2502 2. SymbolInfoTickAsync() \u2192 get Ask price                  \n\u2502  \u2502    - Ask = 1.10000                                         \n\u2502  \u2502                                                            \n\u2502  \u2502 3. CALCULATE PointValue:                                   \n\u2502  \u2502    pointValue = 100000 \u00d7 0.00001 = 1.0 (base currency)     \n\u2502  \u2502    pointValueUSD \u2248 $10 (for major pairs)                   \n\u2502  \u2502                                                            \n\u2502  \u2502 4. KEY CALCULATION Volume:                                 \n\u2502  \u2502    volume = riskMoney / (stopPoints \u00d7 pointValueUSD)       \n\u2502  \u2502           = $20 / (10 \u00d7 $10)                               \n\u2502  \u2502           = $20 / $100                                     \n\u2502  \u2502           = 0.2 lots                                       \n\u2502  \u2502                                                            \n\u2502  \u2502 5. Rounding: 0.2 \u2192 0.20 (step 0.01)                       \n\u2502  \u2502                                                            \n\u2502  \u2502 6. Calculate SL/TP:                                        \n\u2502  \u2502    sl = 1.10000 - (10 \u00d7 0.00001) = 1.09990                 \n\u2502  \u2502    tp = 1.10000 + (20 \u00d7 0.00001) = 1.10020                 \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2502  await service.BuyMarketAsync(                                 \n\u2502      symbol: \"EURUSD\",                                         \n\u2502      volume: 0.20,        \u2190 AUTOMATICALLY CALCULATED!          \n\u2502      sl: 1.09990,                                              \n\u2502      tp: 1.10020,                                              \n\u2502      comment: \"Scalper\"                                        \n\u2502  )                                                             \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Service.BuyMarketAsync()                                   \n\u2502  return await _account.BuyMarketAsync(...)                     \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n\u2502  MT5Account.BuyMarketAsync()                                   \n\u2502    \n\u2502  \u2502 var request = new OrderSendRequest {                       \n\u2502  \u2502     Symbol = \"EURUSD\",                                     \n\u2502  \u2502     Volume = 0.20,        \u2190 CALCULATED volume              \n\u2502  \u2502     Type = ORDER_TYPE_BUY,  // = 0                        \n\u2502  \u2502     Price = 0,  // Market order (no price specified)      \n\u2502  \u2502     Sl = 1.09990,                                          \n\u2502  \u2502     Tp = 1.10020,                                          \n\u2502  \u2502     Comment = \"Scalper\"                                    \n\u2502  \u2502 }                                                          \n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n\u2502  var response = await _client.OrderSendAsync(request);         \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n                    \u2502  gRPC NETWORK\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n                  \u2502   MT5 Terminal     \n                  \u2502    \n                  \u2502  \u2502 Opens          \n                  \u2502  \u2502 BUY 0.20       \n                  \u2502  \u2502 @ 1.10000      \n                  \u2502  \u2502 SL: 1.09990    \n                  \u2502  \u2502 TP: 1.10020    \n                  \u2502  \u2502 Ticket:        \n                  \u2502  \u2502  123456789     \n                  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n                    \u2502  RESPONSE    \n                    \u2502 OrderSendData\n                    \u2502 {            \n                    \u2502   ReturnedCode\n                    \u2502   = 10009,   \n                    \u2502   Order =    \n                    \u2502   123456789, \n                    \u2502   Volume =   \n                    \u2502   0.20        \u2190 CALCULATED!\n                    \u2502   Price =    \n                    \u2502   1.10000    \n                    \u2502 }            \n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n                           \u2502\n                           \u25bc\n\n         \u2502  BACK to SimpleScalpingOrchestrator \n         \u2502  var result = OrderSendData {       \n         \u2502      ReturnedCode = 10009           \n         \u2502      Order = 123456789              \n         \u2502      Volume = 0.20                   \u2190 See calculated volume!\n         \u2502  }                                  \n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#phase-3-holding-position-lines-79-81","title":"Phase 3: Holding position (lines 79-81)","text":"<pre><code>// \u2502  Wait MaxHoldSeconds (default 60 seconds)               \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConsole.WriteLine($\"  \u23f3 Holding for {MaxHoldSeconds}s...\\n\");\n\nawait Task.Delay(MaxHoldSeconds * 1000, ct);\n\n// MaxHoldSeconds = 60 \u2192 Task.Delay(60000 ms) = 60 seconds\n</code></pre> <p>What happens during these 60 seconds:</p> <pre><code>T=0      Position opened BUY 0.20 @ 1.10000\n         SL: 1.09990, TP: 1.10020\n         \u2502\n         \u251c\u2500\u25ba MT5 Terminal AUTOMATICALLY monitors price\n         \u2502\nT=5s     Price: 1.10005 (+5 pts in profit)\nT=10s    Price: 1.10012 (+12 pts in profit)\nT=15s    Price: 1.10020 (TP REACHED!)\n         \u2502\n         \u2514\u2500\u25ba MT5 Terminal AUTOMATICALLY closes position\n             Profit: +20 pts \u00d7 0.20 = +$40\n\nOR\n\nT=5s     Price: 1.09995 (-5 pts in loss)\nT=8s     Price: 1.09990 (SL REACHED!)\n         \u2502\n         \u2514\u2500\u25ba MT5 Terminal AUTOMATICALLY closes position\n             Loss: -10 pts \u00d7 0.20 = -$20 (exactly riskMoney!)\n\nOR\n\nT=60s    Price: 1.10008 (+8 pts in profit)\n         Neither SL nor TP triggered\n         \u2192 Proceed to next phase (status check)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#phase-4-checking-position-status-lines-83-104","title":"Phase 4: Checking position status (lines 83-104)","text":"<pre><code>// \u2502  Get list of OPEN POSITIONS                             \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar tickets = await _service.OpenedOrdersTicketsAsync();\n\nbool stillOpen = false;\n\n\n// \u2502  Check: is our position in the list?                    \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nforeach (var ticket in tickets.OpenedPositionTickets)  // \u2190 POSITIONS, not ORDERS!\n{\n    if (ticket == (long)result.Order)  // Compare ticket\n    {\n        stillOpen = true;\n        break;\n    }\n}\n\n\n// \u2502  CONDITION: Position still open?                        \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nif (stillOpen)\n{\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 1: Position NOT closed after 60 seconds\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    Console.WriteLine($\"  Position still open after {MaxHoldSeconds}s - closing manually...\");\n\n\n    // \u2502  Manual close at current market price           \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    await _service.CloseByTicket(result.Order);\n\n    Console.WriteLine(\"  \u2713 Position closed\");\n}\nelse\n{\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    // SCENARIO 2: Position ALREADY closed\n    // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    Console.WriteLine(\"  \u2713 Position closed automatically (SL/TP hit)\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#visualization-of-status-check","title":"Visualization of status check","text":"<pre><code>AFTER Task.Delay(60 seconds):\n\nMT5 Terminal state \u2014 SCENARIO 1 (position still open):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  (empty)         \u2502  123456789: BUY 0.20 EURUSD @ 1.10000  \u2502\n\u2502                  \u2502             (in profit +8 pts)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nOpenedOrdersTicketsAsync() returns:\n{\n    OpenedOrdersTickets: [],\n    OpenedPositionTickets: [123456789]  \u2190 OUR POSITION FOUND!\n}\n\nforeach (var ticket in tickets.OpenedPositionTickets)\n{\n    // ticket = 123456789\n    if (ticket == 123456789) stillOpen = true;  \u2190 TRUE!\n}\n\nif (stillOpen)  \u2190 TRUE \u2192 Manual close\n{\n    CloseByTicket(123456789);\n}\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nMT5 Terminal state \u2014 SCENARIO 2 (position already closed):\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PENDING ORDERS  \u2502  OPEN POSITIONS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  (empty)         \u2502  (empty)                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2191\n                     Position closed (TP triggered @ T=15s)\n\nOpenedOrdersTicketsAsync() returns:\n{\n    OpenedOrdersTickets: [],\n    OpenedPositionTickets: []  \u2190 POSITION NOT FOUND!\n}\n\nforeach (var ticket in tickets.OpenedPositionTickets)\n{\n    // Empty list \u2192 loop doesn't execute\n}\n\nstillOpen = false;  \u2190 Remains false\n\nif (stillOpen)  \u2190 FALSE \u2192 Skip manual close\nelse\n{\n    Console.WriteLine(\"Position closed automatically (SL/TP hit)\");\n}\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#phase-5-finalization-lines-106-113","title":"Phase 5: Finalization (lines 106-113)","text":"<pre><code>// \u2502  Get final balance                                      \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar finalBalance = await _service.GetBalanceAsync();\n\n\n// \u2502  Calculate profit/loss                                  \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar profit = finalBalance - initialBalance;\n\nConsole.WriteLine($\"\\n  Final balance: ${finalBalance:F2}\");\nConsole.WriteLine($\"  Profit/Loss: ${profit:F2}\");\n\n\n// \u2502  Return profit as result of ExecuteAsync()              \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nreturn profit;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#complete-life-cycle-tp-triggered-scenario","title":"\ud83c\udfad Complete Life Cycle (TP triggered scenario)","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#execution-timeline","title":"Execution timeline","text":"<pre><code>T=0      START ExecuteAsync()\n         \u2502\n         \u251c\u2500\u25ba GetBalanceAsync()           \u2192 $10000.00\n         \u2502\nT=1s     \u251c\u2500\u25ba BuyMarketByRisk(risk=$20, SL=10pts, TP=20pts)\n         \u2502   \u2502\n         \u2502   \u251c\u2500\u25ba SymbolInfoAsync(\"EURUSD\")\n         \u2502   \u2502   \u2514\u2500\u25ba Point=0.00001, ContractSize=100000\n         \u2502   \u2502\n         \u2502   \u251c\u2500\u25ba SymbolInfoTickAsync(\"EURUSD\")\n         \u2502   \u2502   \u2514\u2500\u25ba Ask=1.10000\n         \u2502   \u2502\n         \u2502   \u251c\u2500\u25ba CALCULATE Volume:\n         \u2502   \u2502   volume = $20 / (10 \u00d7 $10) = 0.2 lots\n         \u2502   \u2502\n         \u2502   \u251c\u2500\u25ba CALCULATE SL/TP:\n         \u2502   \u2502   sl = 1.10000 - (10 \u00d7 0.00001) = 1.09990\n         \u2502   \u2502   tp = 1.10000 + (20 \u00d7 0.00001) = 1.10020\n         \u2502   \u2502\n         \u2502   \u2514\u2500\u25ba BuyMarketAsync(volume=0.2, sl=1.09990, tp=1.10020)\n         \u2502       \u2514\u2500\u25ba gRPC \u2192 MT5 Terminal\n         \u2502\nT=2s     \u251c\u2500\u25ba MT5 Terminal: Position opened!\n         \u2502   \n         \u2502   \u2502 BUY 0.20 EURUSD @ 1.10000        \n         \u2502   \u2502 SL: 1.09990                      \n         \u2502   \u2502 TP: 1.10020                      \n         \u2502   \u2502 Ticket: 123456789                \n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502\n         \u2502   result.ReturnedCode = 10009 \u2713\n         \u2502   result.Order = 123456789\n         \u2502   result.Volume = 0.20\n         \u2502\nT=3s     \u251c\u2500\u25ba Task.Delay(60000) START\n         \u2502   \"Holding for 60s...\"\n         \u2502\n         \u2502   MARKET: Price moves...\n         \u2502   1.10000 \u2192 1.10005 \u2192 1.10012 \u2192 1.10020...\n         \u2502\nT=15s    \u2502   MT5 Terminal: Price reached 1.10020!\n         \u2502   TP TRIGGERED!\n         \u2502   \n         \u2502   \u2502 Position closed automatically    \n         \u2502   \u2502 Entry: 1.10000                   \n         \u2502   \u2502 Exit:  1.10020                   \n         \u2502   \u2502 Profit: +20 pts \u00d7 0.20 = +$40    \n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n         \u2502\n         \u2502   MT5 Terminal state:\n         \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   \u2502 PENDING ORDERS   \u2502 POSITIONS    \u2502\n         \u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n         \u2502   \u2502 (empty)          \u2502 (empty)      \u2502\n         \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\nT=63s    \u251c\u2500\u25ba Task.Delay(60000) END\n         \u2502\n         \u251c\u2500\u25ba OpenedOrdersTicketsAsync()\n         \u2502   \u2514\u2500\u25ba OpenedPositionTickets = []\n         \u2502\n         \u251c\u2500\u25ba foreach (var ticket in [])  \u2190 Empty list\n         \u2502   \u2514\u2500\u25ba stillOpen = false\n         \u2502\n         \u251c\u2500\u25ba if (stillOpen) \u2192 FALSE\n         \u2502   else \u2192 \"Position closed automatically (SL/TP hit)\"\n         \u2502\nT=64s    \u251c\u2500\u25ba GetBalanceAsync()           \u2192 $10040.00\n         \u251c\u2500\u25ba profit = 10040.00 - 10000.00 = +$40.00\n         \u2502\n         \u2514\u2500\u25ba RETURN profit = 40.00\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#what-the-result-is-made-of","title":"\ud83d\udcca What the result is made of","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#profit-calculation-tp-triggered","title":"Profit calculation (TP triggered)","text":"<pre><code>INITIAL BALANCE: $10000.00\n\nPOSITION:\n- Direction: BUY\n- Volume: 0.20 lots (AUTOMATICALLY CALCULATED!)\n- Entry: 1.10000\n- SL: 1.09990 (-10 pts)\n- TP: 1.10020 (+20 pts)\n\nTP TRIGGERED @ T=15s:\n- Exit: 1.10020\n- Pips: (1.10020 - 1.10000) / 0.00001 = 20 points\n\nPROFIT CALCULATION:\n- Profit = Pips \u00d7 Point Value \u00d7 Volume\n- Point Value for EURUSD (0.20 lots) = 0.20 \u00d7 $10 = $2 per point\n- Profit = 20 \u00d7 $2 = +$40\n\nFINAL BALANCE: $10040.00\nPROFIT = $40.00\n\nreturn 40.00;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#loss-calculation-sl-triggered","title":"Loss calculation (SL triggered)","text":"<pre><code>SL TRIGGERED @ T=8s:\n- Exit: 1.09990\n- Pips: (1.09990 - 1.10000) / 0.00001 = -10 points\n\nLOSS CALCULATION:\n- Loss = -10 \u00d7 $2 = -$20\n\nFINAL BALANCE: $9980.00\nPROFIT = -$20.00\n\nCRITICALLY IMPORTANT:\nLoss EXACTLY = riskMoney ($20)!\nThis proves correctness of Volume calculation through risk-sizing!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#components-and-their-roles","title":"\ud83e\udde9 Components and their roles","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#1-simplescalpingorchestrator","title":"1. SimpleScalpingOrchestrator","text":"<p>Role: Scalping strategy coordinator</p> <p>Tasks:</p> <ul> <li>Stores parameters (Symbol, RiskAmount, SL, TP, IsBuy, MaxHoldSeconds)</li> <li>Manages life cycle</li> <li>Chooses direction (BUY/SELL)</li> <li>Does NOT calculate Volume (delegates to BuyMarketByRisk)</li> <li>Monitors holding time</li> <li>Checks position status</li> <li>Closes manually if needed</li> <li>Returns result</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#2-mt5sugar-extension-methods","title":"2. MT5Sugar (extension methods)","text":"<p>Role: KEY component for risk-sizing</p> <p>Tasks:</p> <ul> <li><code>BuyMarketByRisk()</code> - AUTOMATICALLY calculates Volume</li> <li><code>SellMarketByRisk()</code> - AUTOMATICALLY calculates Volume</li> <li><code>CloseByTicket()</code> - universal close</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#3-risk-sizing-formula","title":"3. Risk-sizing formula","text":"<pre><code>\u2502  VOLUME CALCULATION FORMULA:                                \n\u2502                                                             \n\u2502  Volume = RiskMoney / (StopPoints \u00d7 PointValueUSD)          \n\u2502                                                             \n\u2502  Where:                                                     \n\u2502  - RiskMoney: Maximum risk in dollars ($20)                 \n\u2502  - StopPoints: SL size in points (10)                    \n\u2502  - PointValueUSD: Value of 1 point for 1.0 lot ($10)        \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nEXAMPLES:\n\nExample 1: Tight SL\n  RiskMoney = $20\n  StopPoints = 5  \u2190 Very close SL\n  PointValueUSD = $10\n\n  Volume = $20 / (5 \u00d7 $10) = $20 / $50 = 0.4 lots\n  \u2191 LARGER volume to compensate small SL!\n\nExample 2: Wide SL\n  RiskMoney = $20\n  StopPoints = 20  \u2190 Wide SL\n  PointValueUSD = $10\n\n  Volume = $20 / (20 \u00d7 $10) = $20 / $200 = 0.1 lots\n  \u2191 SMALLER volume to keep risk at $20!\n\nExample 3: High risk\n  RiskMoney = $50  \u2190 Increased risk\n  StopPoints = 10\n  PointValueUSD = $10\n\n  Volume = $50 / (10 \u00d7 $10) = $50 / $100 = 0.5 lots\n  \u2191 Proportionally larger volume!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator.HOW_IT_WORKS/#summary","title":"\ud83c\udfaf Summary","text":"<p>SimpleScalpingOrchestrator is made of:</p> <ol> <li>1 dependency: <code>MT5Service _service</code></li> <li>6 parameters: Symbol, RiskAmount, StopLossPoints, TakeProfitPoints, IsBuy, MaxHoldSeconds</li> <li>3 key methods:</li> <li><code>BuyMarketByRisk</code> / <code>SellMarketByRisk</code> \u2190 AUTOMATIC Volume calculation!</li> <li><code>OpenedOrdersTicketsAsync</code> \u2190 Position status check</li> <li><code>CloseByTicket</code> \u2190 Manual close</li> </ol> <p>Works through:</p> <ul> <li>Market entry with automatic risk-sizing</li> <li>Holding position for MaxHoldSeconds seconds</li> <li>Check: did position close automatically (SL/TP)?</li> <li>Manual close if position still open</li> </ul> <p>Returns:</p> <ul> <li><code>double profit</code> - difference between final and initial balance</li> </ul> <p>Key insight:</p> <p>All the magic of the orchestrator is in delegating Volume calculation to BuyMarketByRisk method. Orchestrator only specifies RISK ($20), and position volume is calculated automatically based on StopLoss size. This ensures constant risk regardless of SL parameter changes!</p> <p>Success formula: <pre><code>CONSTANT RISK = RiskMoney\nVARIABLE VOLUME = f(RiskMoney, StopPoints)\n\nIf SL increases \u2192 Volume decreases\nIf SL decreases \u2192 Volume increases\nRisk ALWAYS remains = $20!\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/","title":"SimpleScalpingOrchestrator - Fast Scalping","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#description","title":"Description","text":"<p>SimpleScalpingOrchestrator is an orchestrator for fast scalping with automatic position sizing based on risk. It opens a market position (BUY or SELL), holds it for maximum 60 seconds, then closes manually if SL/TP didn't trigger.</p> <p>Principle: \"Quick in, quick out\" - fast market entry, tight stops (10 points SL), doubled profit (20 points TP), short holding time. Position size is calculated automatically based on specified risk in money.</p> <p>File: <code>Examples\\Orchestrators\\SimpleScalpingOrchestrator.cs</code></p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#architecture","title":"Architecture","text":"<pre><code>SIMPLE SCALPING ORCHESTRATOR\n    \u2193\nMT5Service Instance\n    \u2193\n  \u250c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2193     \u2193     \u2193\nBuyMarket SellMarket CloseBy\nByRisk    ByRisk     Ticket\n(risk)    (risk)     (manual)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#dependencies","title":"Dependencies","text":"<ul> <li>MT5Service: Service layer for MT5</li> <li>MT5Sugar Extension Methods: <code>BuyMarketByRisk</code>, <code>SellMarketByRisk</code>, <code>CloseByTicket</code></li> <li>mt5_term_api: gRPC types (<code>OrderSendData</code>, <code>OpenedOrdersTicketsData</code>)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#configuration-parameters","title":"Configuration Parameters","text":"Parameter Type Default Description <code>Symbol</code> string <code>\"EURUSD\"</code> Trading instrument <code>RiskAmount</code> double <code>20.0</code> Maximum risk in dollars ($20) <code>StopLossPoints</code> int <code>10</code> Stop loss in points <code>TakeProfitPoints</code> int <code>20</code> Take profit in points <code>IsBuy</code> bool <code>true</code> Direction: <code>true</code> = BUY, <code>false</code> = SELL <code>MaxHoldSeconds</code> int <code>60</code> Maximum position holding time (sec)"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#configuration-example","title":"Configuration example","text":"<pre><code>var scalpingOrchestrator = new SimpleScalpingOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    RiskAmount = 30.0,      // Risk $30 per trade\n    StopLossPoints = 15,    // SL = 15 points\n    TakeProfitPoints = 30,  // TP = 30 points (R:R = 1:2)\n    IsBuy = false,          // SELL direction\n    MaxHoldSeconds = 90     // Hold up to 90 seconds\n};\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#how-to-run","title":"How to Run","text":"<p>You can execute this orchestrator using several command variations:</p> <pre><code># Option 1: By number\ndotnet run 13\n\n# Option 2: By short name\ndotnet run scalping\n\n# Option 3: By full name\ndotnet run simplescalping\n</code></pre> <p>All three commands will launch the SimpleScalpingOrchestrator with the default configuration or the settings you specify in the code.</p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#algorithm","title":"Algorithm","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#flowchart","title":"Flowchart","text":"<pre><code>START\n  \u2193\nGet initial balance\n  \u2193\nCONDITION: IsBuy == true?\n  YES \u2192 BuyMarketByRisk(riskMoney, stopPoints, tpPoints)\n  NO \u2192 SellMarketByRisk(riskMoney, stopPoints, tpPoints)\n  \u2193\nIf error \u2192 return 0\n  \u2193\nTask.Delay(MaxHoldSeconds \u00d7 1000)  // Wait 60 sec\n  \u2193\nOpenedOrdersTicketsAsync()\n  \u2193\nCHECK: Position still open?\n  YES \u2192 CloseByTicket(ticket)  // Manual close\n  NO \u2192 \"SL/TP already triggered\"\n  \u2193\nGet final balance\n  \u2193\nReturn profit\nEND\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#step-by-step-description","title":"Step-by-step description","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#1-initialization-lines-35-41","title":"1. Initialization (lines 35-41)","text":"<pre><code>var initialBalance = await _service.GetBalanceAsync();\n\nConsole.WriteLine($\"  Starting balance: ${initialBalance:F2}\");\nConsole.WriteLine($\"  Symbol: {Symbol}\");\nConsole.WriteLine($\"  Direction: {(IsBuy ? \"BUY\" : \"SELL\")}\");\nConsole.WriteLine($\"  Risk: ${RiskAmount:F2}\");\nConsole.WriteLine($\"  SL: {StopLossPoints} pts | TP: {TakeProfitPoints} pts\");\nConsole.WriteLine($\"  Max hold: {MaxHoldSeconds}s\");\n</code></pre> <p>What happens:</p> <ul> <li>Initial balance is obtained to calculate P/L</li> <li>Strategy parameters are displayed</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#2-opening-position-with-risk-sizing-lines-45-77","title":"2. Opening position with risk-sizing (lines 45-77)","text":"<pre><code>OrderSendData result;\n\nif (IsBuy)\n{\n\n    // \u2502  BUY: Use BuyMarketByRisk                           \n    // \u2502  Position size calculated AUTOMATICALLY             \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    result = await _service.BuyMarketByRisk(\n        symbol: Symbol,             // \"EURUSD\"\n        stopPoints: StopLossPoints, // 10 points\n        riskMoney: RiskAmount,      // $20\n        tpPoints: TakeProfitPoints, // 20 points\n        comment: \"Scalper\"\n    );\n}\nelse\n{\n\n    // \u2502  SELL: Use SellMarketByRisk                         \n    // \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    result = await _service.SellMarketByRisk(\n        symbol: Symbol,\n        stopPoints: StopLossPoints,\n        riskMoney: RiskAmount,\n        tpPoints: TakeProfitPoints,\n        comment: \"Scalper\"\n    );\n}\n\n\n// \u2502  RESULT CHECK                                           \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nif (result.ReturnedCode != 10009)  // 10009 = TRADE_RETCODE_DONE\n{\n    Console.WriteLine($\"  \u2717 Order failed: {result.Comment}\");\n    return 0;  // Emergency exit\n}\n\nConsole.WriteLine($\"  \u2713 Position opened: #{result.Order}\");\nConsole.WriteLine($\"  Volume: {result.Volume:F2} lots\");\n</code></pre> <p>Critically important:</p> <ul> <li> <p>Uses BuyMarketByRisk / SellMarketByRisk instead of fixed volume</p> </li> <li> <p>Method automatically calculates position size based on:</p> </li> <li> <p><code>riskMoney</code> = $20</p> </li> <li><code>stopPoints</code> = 10 points</li> <li>Current symbol price</li> <li>Result contains calculated Volume in <code>result.Volume</code> field</li> </ul> <p>Calculation example: <pre><code>Given:\n- riskMoney = $20\n- stopPoints = 10\n- Symbol = EURUSD\n- Point value for EURUSD (1.0 lot) = $10\n\nCalculation:\nriskPerPoint = riskMoney / stopPoints = $20 / 10 = $2 per point\nVolume = riskPerPoint / pointValue = $2 / $10 = 0.2 lots\n\nResult:\nresult.Volume = 0.20 lots\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#3-holding-position-lines-79-81","title":"3. Holding position (lines 79-81)","text":"<pre><code>Console.WriteLine($\"  \u23f3 Holding for {MaxHoldSeconds}s...\\n\");\n\n\n// \u2502  Wait MaxHoldSeconds (default 60 seconds)              \n// \u2502  SL or TP may trigger during this time                  \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nawait Task.Delay(MaxHoldSeconds * 1000, ct);\n\n// MaxHoldSeconds = 60 \u2192 Task.Delay(60000 ms) = 60 seconds\n</code></pre> <p>What happens:</p> <ul> <li>Orchestrator \"sleeps\" for 60 seconds</li> <li>During this time MT5 Terminal monitors the position</li> <li>If price reaches SL or TP \u2192 position automatically closes</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#4-checking-position-status-lines-83-104","title":"4. Checking position status (lines 83-104)","text":"<pre><code>// \u2502  Get list of OPEN POSITIONS                             \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nvar tickets = await _service.OpenedOrdersTicketsAsync();\n\nbool stillOpen = false;\n\n\n// \u2502  Check: is our position in the list?                    \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nforeach (var ticket in tickets.OpenedPositionTickets)\n{\n    if (ticket == (long)result.Order)  // Compare ticket\n    {\n        stillOpen = true;\n        break;\n    }\n}\n\n\n// \u2502  CONDITION: Position still open?                        \n// \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nif (stillOpen)\n{\n    // SCENARIO 1: Position NOT closed after 60 seconds\n    // SL/TP didn't trigger \u2192 close manually\n    Console.WriteLine($\"  Position still open after {MaxHoldSeconds}s - closing manually...\");\n    await _service.CloseByTicket(result.Order);\n    Console.WriteLine(\"  \u2713 Position closed\");\n}\nelse\n{\n    // SCENARIO 2: Position ALREADY closed\n    // SL or TP triggered automatically\n    Console.WriteLine(\"  \u2713 Position closed automatically (SL/TP hit)\");\n}\n</code></pre> <p>Key logic:</p> <ul> <li><code>OpenedOrdersTicketsAsync()</code> returns list of OPEN positions</li> <li>If our ticket is in the list \u2192 position still open \u2192 close manually</li> <li>If ticket not in the list \u2192 position already closed \u2192 do nothing</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#5-finalization-lines-106-113","title":"5. Finalization (lines 106-113)","text":"<pre><code>var finalBalance = await _service.GetBalanceAsync();\nvar profit = finalBalance - initialBalance;\n\nConsole.WriteLine($\"\\n  Final balance: ${finalBalance:F2}\");\nConsole.WriteLine($\"  Profit/Loss: ${profit:F2}\");\n\nreturn profit;\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#strategy-visualization","title":"Strategy Visualization","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#scenario-1-tp-triggered-profit","title":"Scenario 1: TP triggered (profit)","text":"<pre><code>T=0      BuyMarketByRisk(risk=$20, SL=10pts, TP=20pts)\n         \u2502\n         \u251c\u2500\u25ba Calculate Volume:\n         \u2502   riskPerPoint = $20 / 10 = $2\n         \u2502   Volume = $2 / $10 = 0.2 lots\n         \u2502\n         \u251c\u2500\u25ba Opened position BUY 0.2 lots @ 1.10000\n         \u2502   SL: 1.09990 (-10 pts)\n         \u2502   TP: 1.10020 (+20 pts)\n         \u2502\n         \u2502   Price moves:\n         \u2502   1.10000 \u2192 1.10005 \u2192 1.10012 \u2192 1.10020...\n         \u2502\nT=15s    \u251c\u2500\u25ba Price reached 1.10020\n         \u2502   TP TRIGGERED!\n         \u2502   Position closed automatically\n         \u2502   Profit: 20 pts \u00d7 0.2 lots = +$40\n         \u2502\nT=60s    \u251c\u2500\u25ba Task.Delay finished\n         \u2502\n         \u251c\u2500\u25ba OpenedOrdersTicketsAsync()\n         \u2502   \u2192 ticket not found (position closed)\n         \u2502\n         \u251c\u2500\u25ba stillOpen = false\n         \u2502\n         \u2514\u2500\u25ba \"Position closed automatically (SL/TP hit)\"\n\nResult: Profit +$40\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#scenario-2-sl-triggered-loss","title":"Scenario 2: SL triggered (loss)","text":"<pre><code>T=0      BuyMarketByRisk(risk=$20, SL=10pts, TP=20pts)\n         \u2502\n         \u251c\u2500\u25ba Opened position BUY 0.2 lots @ 1.10000\n         \u2502   SL: 1.09990 (-10 pts)\n         \u2502\n         \u2502   Price moves:\n         \u2502   1.10000 \u2192 1.09998 \u2192 1.09993 \u2192 1.09990...\n         \u2502\nT=8s     \u251c\u2500\u25ba Price reached 1.09990\n         \u2502   SL TRIGGERED!\n         \u2502   Position closed automatically\n         \u2502   Loss: -10 pts \u00d7 0.2 lots = -$20\n         \u2502\nT=60s    \u251c\u2500\u25ba Task.Delay finished\n         \u2502\n         \u251c\u2500\u25ba OpenedOrdersTicketsAsync()\n         \u2502   \u2192 ticket not found (position closed)\n         \u2502\n         \u251c\u2500\u25ba stillOpen = false\n         \u2502\n         \u2514\u2500\u25ba \"Position closed automatically (SL/TP hit)\"\n\nResult: Loss -$20 (exactly riskMoney!)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#scenario-3-manual-close-position-in-flat","title":"Scenario 3: Manual close (position in flat)","text":"<pre><code>T=0      BuyMarketByRisk(risk=$20, SL=10pts, TP=20pts)\n         \u2502\n         \u251c\u2500\u25ba Opened position BUY 0.2 lots @ 1.10000\n         \u2502   SL: 1.09990\n         \u2502   TP: 1.10020\n         \u2502\n         \u2502   Price moves in range:\n         \u2502   1.10000 \u2192 1.10003 \u2192 1.09998 \u2192 1.10005 \u2192 1.10002...\n         \u2502\nT=60s    \u251c\u2500\u25ba Task.Delay finished\n         \u2502   Neither SL nor TP triggered\n         \u2502   Current price: 1.10005 (+5 pts in profit)\n         \u2502\n         \u251c\u2500\u25ba OpenedOrdersTicketsAsync()\n         \u2502   \u2192 ticket FOUND (position still open)\n         \u2502\n         \u251c\u2500\u25ba stillOpen = true\n         \u2502\n         \u251c\u2500\u25ba CloseByTicket(result.Order)\n         \u2502   \u2192 Close position at current price 1.10005\n         \u2502   Profit: +5 pts \u00d7 0.2 lots = +$10\n         \u2502\n         \u2514\u2500\u25ba \"Position still open after 60s - closing manually\"\n\nResult: Profit +$10 (less than TP, but still in profit)\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#used-mt5sugar-methods","title":"Used MT5Sugar Methods","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#1-buymarketbyrisk","title":"1. BuyMarketByRisk","text":"<pre><code>public static async Task&lt;OrderSendData&gt; BuyMarketByRisk(\n    this MT5Service service,\n    string symbol,\n    int stopPoints,      // SL in points\n    double riskMoney,    // Risk in dollars\n    int tpPoints = 0,\n    string comment = \"\"\n)\n</code></pre> <p>Purpose: Opens market BUY position with automatic size calculation based on risk.</p> <p>Calculation algorithm: <pre><code>// 1. Get point value for symbol\nvar symbolInfo = await service.SymbolInfoAsync(symbol);\ndouble pointValue = symbolInfo.Trade_Contract_Size * symbolInfo.Point;\n// For EURUSD: 100000 \u00d7 0.00001 = $1 per point for 1.0 lot\n\n// 2. Calculate risk per point\ndouble riskPerPoint = riskMoney / stopPoints;\n// $20 / 10 = $2 per point\n\n// 3. Calculate Volume\ndouble volume = riskPerPoint / pointValue;\n// $2 / $1 = 2.0 lots (for 1.0 base lot)\n// But for EURUSD with base $10 per point: $2 / $10 = 0.2 lots\n\n// 4. Get current Ask price\nvar tick = await service.SymbolInfoTickAsync(symbol);\ndouble askPrice = tick.Ask;\n\n// 5. Calculate SL and TP\ndouble sl = askPrice - (stopPoints \u00d7 symbolInfo.Point);\ndouble tp = tpPoints &gt; 0 ? askPrice + (tpPoints \u00d7 symbolInfo.Point) : 0;\n\n// 6. Open position\nreturn await service.BuyMarketAsync(symbol, volume, sl, tp, comment);\n</code></pre></p> <p>Parameters in SimpleScalpingOrchestrator: - <code>symbol</code>: \"EURUSD\" - <code>stopPoints</code>: 10 (SL = 10 points from entry price) - <code>riskMoney</code>: $20 (maximum loss if SL triggers) - <code>tpPoints</code>: 20 (TP = 20 points from entry price) - <code>comment</code>: \"Scalper\"</p> <p>Returns: <pre><code>OrderSendData {\n    ReturnedCode = 10009,  // Success\n    Order = 123456789,     // Position ticket\n    Volume = 0.2,          // CALCULATED volume\n    Price = 1.10000,       // Execution price\n    Comment = \"Request completed\"\n}\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#2-sellmarketbyrisk","title":"2. SellMarketByRisk","text":"<pre><code>public static async Task&lt;OrderSendData&gt; SellMarketByRisk(\n    this MT5Service service,\n    string symbol,\n    int stopPoints,\n    double riskMoney,\n    int tpPoints = 0,\n    string comment = \"\"\n)\n</code></pre> <p>Purpose: Opens market SELL position with automatic size calculation.</p> <p>Differences from BuyMarketByRisk:</p> <ul> <li>Uses Bid price instead of Ask</li> <li>SL above entry price (for SELL)</li> <li>TP below entry price (for SELL)</li> </ul> <p>SL/TP calculation for SELL: <pre><code>double bidPrice = tick.Bid;\ndouble sl = bidPrice + (stopPoints \u00d7 point);  // ABOVE for SELL\ndouble tp = tpPoints &gt; 0 ? bidPrice - (tpPoints \u00d7 point) : 0;  // BELOW for SELL\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#3-closebyticket","title":"3. CloseByTicket","text":"<pre><code>public static async Task CloseByTicket(\n    this MT5Service service,\n    ulong ticket\n)\n</code></pre> <p>Purpose: Closes position by ticket number.</p> <p>Usage in orchestrator:</p> <ul> <li>Manual position close after <code>MaxHoldSeconds</code> expires (line 98)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#4-openedordersticketsasync","title":"4. OpenedOrdersTicketsAsync","text":"<pre><code>public async Task&lt;OpenedOrdersTicketsData&gt; OpenedOrdersTicketsAsync()\n</code></pre> <p>Purpose: Gets list of tickets for open positions and pending orders.</p> <p>Returns:</p> <pre><code>OpenedOrdersTicketsData {\n    OpenedOrdersTickets: [list of pending orders],\n    OpenedPositionTickets: [list of open positions]  \u2190 USED IN ORCHESTRATOR\n}\n</code></pre> <p>Usage:</p> <ul> <li>Check position presence in open list (lines 84-93)</li> <li>If ticket found \u2192 position still open</li> <li>If ticket not found \u2192 position closed (SL/TP triggered)</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#risk-management","title":"Risk Management","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#main-advantage-constant-risk","title":"Main advantage: Constant risk","text":"<pre><code>TRADITIONAL APPROACH (fixed Volume):\nPosition 1: 0.1 lots, SL=10pts \u2192 risk = 0.1 \u00d7 10 \u00d7 $10 = $10\nPosition 2: 0.1 lots, SL=20pts \u2192 risk = 0.1 \u00d7 20 \u00d7 $10 = $20\nPosition 3: 0.1 lots, SL=5pts  \u2192 risk = 0.1 \u00d7 5 \u00d7 $10 = $5\n\nPROBLEM: Risk changes depending on SL size!\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nRISK-SIZING APPROACH (BuyMarketByRisk):\nPosition 1: riskMoney=$20, SL=10pts \u2192 Volume = $20/(10\u00d7$10) = 0.2 lots\nPosition 2: riskMoney=$20, SL=20pts \u2192 Volume = $20/(20\u00d7$10) = 0.1 lots\nPosition 3: riskMoney=$20, SL=5pts  \u2192 Volume = $20/(5\u00d7$10) = 0.4 lots\n\nRESULT: Risk ALWAYS $20, regardless of SL size!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#rr-ratio-calculation","title":"R:R ratio calculation","text":"<pre><code>Default:\n- StopLossPoints = 10\n- TakeProfitPoints = 20\n- RiskAmount = $20\n\nRisk/Reward Ratio:\nRisk = $20 (if SL triggers)\nReward = $40 (if TP triggers)\nR:R = 1:2 \u2713\n\nWith 40% win rate:\n- 6 trades: 4 losses (-$80) + 2 wins (+$80) = $0 (break-even)\n- 7 trades: 4 losses (-$80) + 3 wins (+$120) = +$40 (profit)\n\nConclusion: 43% win rate sufficient for profitability!\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#recommendations","title":"Recommendations","text":"<ol> <li>Risk size:</li> <li>No more than 1-2% of deposit per trade</li> <li>For $10000 deposit: recommended risk $100-200</li> <li> <p>Default $20 suitable for $1000-2000 deposit</p> </li> <li> <p>SL/TP ratio:</p> </li> <li>Minimum 1:2 (as default)</li> <li>Optimal 1:2.5 or 1:3</li> <li> <p>Never use 1:1 or worse</p> </li> <li> <p>Holding time:</p> </li> <li><code>MaxHoldSeconds = 60</code> for M1 scalping</li> <li><code>MaxHoldSeconds = 180</code> for M5 trading</li> <li> <p><code>MaxHoldSeconds = 300</code> for M15 trading</p> </li> <li> <p>Direction selection:</p> </li> <li>Use technical analysis to determine <code>IsBuy</code></li> <li>Don't trade against strong trend</li> <li>Combine with indicators (MA, RSI, Stochastic)</li> </ol>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#usage-examples","title":"Usage Examples","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#example-1-conservative-scalping","title":"Example 1: Conservative scalping","text":"<pre><code>var service = new MT5Service(account);\n\nvar conservativeScalp = new SimpleScalpingOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    RiskAmount = 15.0,      // Low risk\n    StopLossPoints = 8,     // Very tight SL\n    TakeProfitPoints = 20,  // R:R = 1:2.5\n    IsBuy = true,\n    MaxHoldSeconds = 45     // Short time\n};\n\nvar profit = await conservativeScalp.ExecuteAsync();\nConsole.WriteLine($\"Scalping completed: ${profit:F2}\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#example-2-aggressive-scalping","title":"Example 2: Aggressive scalping","text":"<pre><code>var aggressiveScalp = new SimpleScalpingOrchestrator(service)\n{\n    Symbol = \"GBPUSD\",\n    RiskAmount = 50.0,      // High risk\n    StopLossPoints = 12,\n    TakeProfitPoints = 36,  // R:R = 1:3\n    IsBuy = false,          // SELL\n    MaxHoldSeconds = 90\n};\n\nvar profit = await aggressiveScalp.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#example-3-use-in-loop-multiple-trades","title":"Example 3: Use in loop (multiple trades)","text":"<pre><code>var totalProfit = 0.0;\nvar trades = 0;\n\nfor (int i = 0; i &lt; 10; i++)\n{\n    // Determine direction (e.g., by indicator)\n    bool direction = await GetTrendDirection(\"EURUSD\");\n\n    var scalper = new SimpleScalpingOrchestrator(service)\n    {\n        Symbol = \"EURUSD\",\n        RiskAmount = 20.0,\n        StopLossPoints = 10,\n        TakeProfitPoints = 20,\n        IsBuy = direction,\n        MaxHoldSeconds = 60\n    };\n\n    var profit = await scalper.ExecuteAsync();\n    totalProfit += profit;\n    trades++;\n\n    Console.WriteLine($\"Trade {trades}: ${profit:F2}\");\n\n    // Pause between trades\n    await Task.Delay(30000);  // 30 seconds\n}\n\nConsole.WriteLine($\"\\nTotal: {trades} trades, ${totalProfit:F2} profit\");\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#example-4-adaptive-risk-based-on-balance","title":"Example 4: Adaptive risk based on balance","text":"<pre><code>var balance = await service.GetBalanceAsync();\nvar dynamicRisk = balance * 0.01;  // 1% of balance\n\nvar adaptiveScalp = new SimpleScalpingOrchestrator(service)\n{\n    Symbol = \"EURUSD\",\n    RiskAmount = dynamicRisk,  // Automatically adapts to balance\n    StopLossPoints = 10,\n    TakeProfitPoints = 20,\n    IsBuy = true,\n    MaxHoldSeconds = 60\n};\n\nvar profit = await adaptiveScalp.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#error-handling","title":"Error Handling","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#position-opening-error-lines-70-74","title":"Position opening error (lines 70-74)","text":"<pre><code>if (result.ReturnedCode != 10009)\n{\n    Console.WriteLine($\"  \u2717 Order failed: {result.Comment}\");\n    return 0;  // Emergency exit\n}\n</code></pre> <p>Possible causes:</p> <ul> <li>Insufficient funds (even after Volume calculation)</li> <li>Market closed</li> <li>Incorrect symbol</li> <li>Minimum/maximum lot exceeded</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#exception-in-main-block-lines-115-120","title":"Exception in main block (lines 115-120)","text":"<pre><code>catch (Exception ex)\n{\n    Console.WriteLine($\"\\n  \u2717 Error: {ex.Message}\");\n    return 0;\n}\n</code></pre> <p>Problem: No emergency position close!</p> <p>Improvement: <pre><code>catch (Exception ex)\n{\n    Console.WriteLine($\"\\n  \u2717 Error: {ex.Message}\");\n\n    // Attempt to close position on error\n    if (result != null &amp;&amp; result.ReturnedCode == 10009)\n    {\n        try\n        {\n            await _service.CloseByTicket(result.Order);\n            Console.WriteLine(\"  Emergency close executed\");\n        }\n        catch { }\n    }\n\n    return 0;\n}\n</code></pre></p>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#console-output","title":"Console Output","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#output-example-tp-triggered","title":"Output example (TP triggered)","text":"<pre><code>+============================================================+\n|  SIMPLE SCALPING ORCHESTRATOR                             |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Direction: BUY\n  Risk: $20.00\n  SL: 10 pts | TP: 20 pts\n  Max hold: 60s\n\n  Opening position...\n  \u2713 Position opened: #123456789\n  Volume: 0.20 lots\n\n  \u23f3 Holding for 60s...\n\n  \u2713 Position closed automatically (SL/TP hit)\n\n  Final balance: $10040.00\n  Profit/Loss: $40.00\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#output-example-manual-close","title":"Output example (manual close)","text":"<pre><code>+============================================================+\n|  SIMPLE SCALPING ORCHESTRATOR                             |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Direction: SELL\n  Risk: $20.00\n  SL: 10 pts | TP: 20 pts\n  Max hold: 60s\n\n  Opening position...\n  \u2713 Position opened: #123456790\n  Volume: 0.20 lots\n\n  \u23f3 Holding for 60s...\n\n  Position still open after 60s - closing manually...\n  \u2713 Position closed\n\n  Final balance: $10010.00\n  Profit/Loss: $10.00\n\n+============================================================+\n</code></pre>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#when-to-use-simple-scalping","title":"When to Use Simple Scalping","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#suitable-conditions","title":"\u2705 Suitable Conditions","text":"<ul> <li>M1-M5 timeframes: Very short-term trading</li> <li>High liquidity: London/New York sessions</li> <li>Narrow spreads: EURUSD, GBPUSD, USDJPY in active hours</li> <li>Clear signals: Level breakout, support/resistance bounce</li> <li>Low volatility: Avoid news</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#unsuitable-conditions","title":"\u274c Unsuitable Conditions","text":"<ul> <li>Asian session: Low volatility, wide spreads</li> <li>Before/after news: Unpredictable movements</li> <li>Exotic pairs: High commissions, low liquidity</li> <li>H1+ timeframes: Too long holding for scalping</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#optimization","title":"Optimization","text":""},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#possible-improvements","title":"Possible improvements","text":"<ol> <li> <p>Dynamic SL based on ATR:    <pre><code>var atr = await GetATR(Symbol, period: 14);\nStopLossPoints = (int)(atr * 0.5);  // 50% of ATR\nTakeProfitPoints = StopLossPoints * 2;  // Preserve R:R 1:2\n</code></pre></p> </li> <li> <p>Partial closing:    <pre><code>// After reaching 50% of TP\nawait Task.Delay(30000);  // 30 sec\nvar positions = await _service.PositionsAsync(Symbol);\nif (positions.Count &gt; 0)\n{\n    await _service.ClosePartial(positions[0].Ticket, percent: 50);\n    await _service.MoveToBreakeven(positions[0].Ticket);\n}\n</code></pre></p> </li> <li> <p>Trailing stop:    <pre><code>await Task.Delay(30000);\n// If position in profit &gt; 10 points\nawait _service.TrailStart(result.Order, trailPoints: 5);\n</code></pre></p> </li> <li> <p>Time filter:    <pre><code>var hour = DateTime.UtcNow.Hour;\nif (hour &gt;= 7 &amp;&amp; hour &lt;= 16)  // London/NY sessions\n{\n    await ExecuteAsync();\n}\n</code></pre></p> </li> </ol>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#related-orchestrators","title":"Related Orchestrators","text":"<ul> <li>GridTradingOrchestrator: Multiple levels instead of single trade.</li> <li>PendingBreakoutOrchestrator: Pending orders instead of market entry.</li> <li>QuickHedgeOrchestrator: Adds hedging on adverse movement.</li> </ul>"},{"location":"Strategies/Orchestrators_EN/SimpleScalpingOrchestrator/#summary","title":"Summary","text":"<p>SimpleScalpingOrchestrator is a basic fast scalping strategy with risk management:</p> <p>\u2705 Pros:</p> <ul> <li>Automatic risk-sizing - position size always matches specified risk</li> <li>Excellent R:R ratio (1:2 by default)</li> <li>Ease of use and configuration</li> <li>Short holding time (minimize exposure)</li> <li>Suitable for automation</li> </ul> <p>\u274c Cons:</p> <ul> <li>Requires active market (narrow spreads)</li> <li>High frequency trades \u2192 commission accumulation</li> <li>Dependence on entry accuracy</li> <li>Not suitable for trending markets (better to use trailing)</li> </ul> <p>Recommendation:  Use as a basic building block for more complex strategies. Combine with technical analysis for direction selection. Always test on demo account before real trading.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/","title":"AdaptiveMarketModePreset - Intelligent Multi-Strategy System","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#description","title":"Description","text":"<p>AdaptiveMarketModePreset is an intelligent trading system that automatically selects and executes the most appropriate orchestrator based on real-time market condition analysis. It combines ALL 5 orchestrators into one adaptive system that switches strategies dynamically every cycle.</p> <p>Principle: \"The right strategy for the right conditions\" - the preset analyzes current market volatility, time, spread, and news schedule, then selects the optimal orchestrator (Grid, Scalping, Hedge, News Straddle, or Breakout) and executes it with preset-optimized parameters.</p> <p>File: <code>Examples\\Presets\\AdaptiveMarketModePreset.cs</code></p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#architecture","title":"Architecture","text":"<pre><code>ADAPTIVE MARKET MODE PRESET\n    \u2193\nMarket Analysis Engine\n  \u2022 Volatility (spread\u00d710)\n  \u2022 Time-based news check\n  \u2022 Breakout detection\n    \u2193\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2193         \u2193         \u2193\nLow Vol   Medium    High Vol\n(&lt;15 pts) (15-40)   (&gt;40 pts)\n  \u2193         \u2193         \u2193\nGrid      Scalping   Hedge\nTrading   Orchestr.  Orchestr.\nOrchestr.\n          \u2193\n    \u250c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2193           \u2193\n  News        Spread&gt;3\n  Time        (Breakout)\n    \u2193           \u2193\n  News        Pending\n  Straddle    Breakout\n  Orchestr.   Orchestr.\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#dependencies","title":"Dependencies","text":"<p>MT5Service: Service layer for MT5</p> <ul> <li>All 5 Orchestrators:</li> <li>GridTradingOrchestrator</li> <li>SimpleScalpingOrchestrator</li> <li>QuickHedgeOrchestrator</li> <li>NewsStraddleOrchestrator</li> <li>PendingBreakoutOrchestrator</li> <li>mt5_term_api: gRPC types</li> </ul>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#market-conditions-orchestrator-selection","title":"Market Conditions &amp; Orchestrator Selection","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#condition-1-low-volatility-15-points","title":"\ud83d\udcca CONDITION 1: LOW VOLATILITY (&lt; 15 points)","text":"<p>Selected Orchestrator: GridTradingOrchestrator</p> <p>Why: Range-bound markets are perfect for grid strategies. When price moves in a narrow range, grid levels capture small movements in both directions.</p> <p>Parameters: <pre><code>GridLevels = 3              // Fewer levels for safety\nGridSpacingPoints = 20      // 20 points between levels\nVolumePerLevel = 0.01       // 0.01 lots per level\nStopLossPoints = 30         // 30 points SL\nTakeProfitPoints = 50       // 50 points TP\nMaxRunMinutes = 5           // Run for 5 minutes\n</code></pre></p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#condition-2-medium-volatility-15-40-points","title":"\ud83d\udcca CONDITION 2: MEDIUM VOLATILITY (15-40 points)","text":"<p>Selected Orchestrator: SimpleScalpingOrchestrator</p> <p>Why: Normal market conditions suit quick scalping trades with tight stops and risk-based position sizing.</p> <p>Parameters: <pre><code>RiskAmount = BaseRiskAmount  // Uses preset's base risk ($20)\nStopLossPoints = 15          // 15 points SL\nTakeProfitPoints = 25        // 25 points TP (R:R \u2248 1:1.67)\nIsBuy = Random               // Randomly selected direction\nMaxHoldSeconds = 60          // Hold maximum 60 seconds\n</code></pre></p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#condition-3-high-volatility-40-points","title":"\ud83d\udcca CONDITION 3: HIGH VOLATILITY (&gt; 40 points)","text":"<p>Selected Orchestrator: QuickHedgeOrchestrator</p> <p>Why: Volatile markets need hedging protection. Opens position, then hedges if price moves adversely, limiting downside risk.</p> <p>Parameters: <pre><code>RiskAmount = BaseRiskAmount \u00d7 0.7  // REDUCED RISK (70%)\nStopLossPoints = 25                // 25 points SL\nTakeProfitPoints = 40              // 40 points TP\nHedgeTriggerPoints = 15            // Hedge after 15 points adverse move\nOpenBuyFirst = Random              // Randomly selected direction\n</code></pre></p> <p>Key Feature: Risk is reduced to 70% of base amount in high volatility for capital preservation.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#condition-4-news-event-detected","title":"\ud83d\udcca CONDITION 4: NEWS EVENT DETECTED","text":"<p>Selected Orchestrator: NewsStraddleOrchestrator</p> <p>Why: Capture explosive volatility from high-impact news releases with symmetrical pending orders.</p> <p>News Schedule (UTC):</p> <ul> <li>08:30 - Economic data releases (NFP, CPI, Retail Sales)</li> <li>12:30 - Midday economic reports</li> <li>14:00 - FOMC statements, GDP releases</li> <li>18:00 - ECB announcements</li> <li>19:00 - Evening economic data</li> </ul> <p>Detection: Preset checks if current time is within 5 minutes before any scheduled news event.</p> <p>Parameters: <pre><code>StraddleDistancePoints = 15     // 15 points from current price\nVolume = 0.02                    // 0.02 lots (fixed)\nStopLossPoints = 20              // 20 points SL\nTakeProfitPoints = 40            // 40 points TP\nSecondsBeforeNews = 30           // 30 sec countdown (shortened for demo)\nMaxWaitAfterNewsSeconds = 120    // Wait 2 minutes for breakout\n</code></pre></p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#condition-5-breakout-signal-spread-3-points","title":"\ud83d\udcca CONDITION 5: BREAKOUT SIGNAL (Spread &gt; 3 points)","text":"<p>Selected Orchestrator: PendingBreakoutOrchestrator</p> <p>Why: Large spread indicates potential breakout movement. Places BUY STOP above and SELL STOP below to catch momentum.</p> <p>Detection: Current spread exceeds 3.0 points (unusual width suggests imminent volatility).</p> <p>Parameters: <pre><code>BreakoutDistancePoints = 20  // 20 points from current price\nVolume = 0.01                 // 0.01 lots (fixed)\nStopLossPoints = 20           // 20 points SL\nTakeProfitPoints = 40         // 40 points TP\nMaxWaitMinutes = 3            // Wait 3 minutes for breakout\n</code></pre></p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#configuration-parameters","title":"Configuration Parameters","text":"Parameter Type Default Description <code>Symbol</code> string <code>\"EURUSD\"</code> Trading instrument <code>BaseRiskAmount</code> double <code>20.0</code> Base risk per trade in dollars <code>LowVolatilityThreshold</code> double <code>15.0</code> Max volatility for grid mode (points) <code>HighVolatilityThreshold</code> double <code>40.0</code> Min volatility for hedge mode (points) <code>EnableNewsMode</code> bool <code>true</code> Enable news event detection <code>MinutesBeforeNews</code> int <code>5</code> Switch to news mode N minutes early"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#configuration-example","title":"Configuration Example","text":"<pre><code>var preset = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"GBPUSD\",\n    BaseRiskAmount = 50.0,          // Higher risk for larger account\n    LowVolatilityThreshold = 20.0,  // More opportunities for grid\n    HighVolatilityThreshold = 30.0, // Trigger hedge earlier\n    EnableNewsMode = true\n};\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#how-to-run","title":"How to Run","text":"<p>You can execute this preset using several command variations:</p> <pre><code># Option 1: By number\ndotnet run 14\n\n# Option 2: By short name\ndotnet run adaptive\n\n# Option 3: By full name\ndotnet run preset\n</code></pre> <p>All three commands will launch the AdaptiveMarketModePreset with the default configuration or the settings you specify in the code.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#algorithm","title":"Algorithm","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#main-cycle-flowchart","title":"Main Cycle Flowchart","text":"<pre><code>START PRESET\n  \u2193\nInitialize (get starting balance, maxCycles=100)\n  \u2193\n\u250c\u2500\u2500\u2500\u2500 CYCLE LOOP (repeat up to maxCycles) \n\u2502                                             \n\u2502 STEP 1: Analyze Market Conditions           \n\u2502   \u2192 Get current tick (bid/ask/spread)       \n\u2502   \u2192 Calculate volatility (spread \u00d7 10)      \n\u2502   \u2192 Check UTC time for news                 \n\u2502   \u2192 Check spread for breakout signal        \n\u2502   \u2192 Determine MarketCondition enum          \n\u2502                                             \n\u2502 STEP 2: Select Orchestrator                 \n\u2502   \u2192 News mode? \u2192 NewsStraddleOrchestrator   \n\u2502   \u2192 Breakout? \u2192 PendingBreakoutOrchestrator \n\u2502   \u2192 Low vol? \u2192 GridTradingOrchestrator      \n\u2502   \u2192 Med vol? \u2192 SimpleScalpingOrchestrator   \n\u2502   \u2192 High vol? \u2192 QuickHedgeOrchestrator      \n\u2502                                             \n\u2502 STEP 3: Execute Selected Orchestrator       \n\u2502   \u2192 await selectedOrchestrator.ExecuteAsync()\n\u2502                                             \n\u2502 STEP 4: Track Results                       \n\u2502   \u2192 Add cycle P/L to totalProfit            \n\u2502   \u2192 Increment cyclesRun counter             \n\u2502   \u2192 Display cycle summary                   \n\u2502                                             \n\u2502 STEP 5: Safety Check                        \n\u2502   \u2192 If totalProfit &lt; -BaseRiskAmount \u00d7 5    \n\u2502   \u2192 STOP (max loss exceeded)                \n\u2502                                             \n\u2502 STEP 6: Pause Between Cycles                \n\u2502   \u2192 Wait 30 seconds (prevent overtrading)   \n\u2502                                             \n\u2502 If cyclesRun &lt; maxCycles \u2192 Loop back        \n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  \u2193\nDisplay Final Results &amp; Exit\nEND PRESET\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#market-analysis-algorithm","title":"Market Analysis Algorithm","text":"<pre><code>private async Task&lt;MarketCondition&gt; AnalyzeMarketConditions()\n{\n    // STEP 1: Get current market data\n    var tick = await _service.SymbolInfoTickAsync(Symbol);\n    var point = await _service.GetPointAsync(Symbol);\n\n    // STEP 2: Calculate spread in points\n    var spreadPoints = (tick.Ask - tick.Bid) / point;\n\n    // STEP 3: Estimate volatility (simplified demo formula)\n    var avgRangePoints = spreadPoints * 10;  // \u26a0\ufe0f Production: use ATR\n\n    // STEP 4: Priority 1 - Check news time\n    if (EnableNewsMode &amp;&amp; IsNewsTime())\n        return MarketCondition.News;\n\n    // STEP 5: Priority 2 - Check breakout signal\n    if (spreadPoints &gt; 3.0)\n        return MarketCondition.Breakout;\n\n    // STEP 6: Classify by volatility\n    if (avgRangePoints &lt; LowVolatilityThreshold)\n        return MarketCondition.Grid;\n    else if (avgRangePoints &lt; HighVolatilityThreshold)\n        return MarketCondition.Scalping;\n    else\n        return MarketCondition.HighVolatility;\n}\n</code></pre> <p>Priority Order:</p> <ol> <li>News - Highest priority (scheduled events)</li> <li>Breakout - High priority (unusual spread)</li> <li>Volatility - Normal priority (Grid \u2192 Scalping \u2192 Hedge)</li> </ol>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#strategy-visualization","title":"Strategy Visualization","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-cycle-1-medium-volatility-scalping","title":"Example Cycle 1: Medium Volatility \u2192 Scalping","text":"<pre><code>T=0  Cycle #1 starts\n       \u2193\n     Analyze Market:\n       Spread: 0.00015 (1.5 pts)\n       Volatility: 1.5 \u00d7 10 = 15 pts\n       Time: 10:00 UTC (no news)\n       Spread: 1.5 pts (no breakout)\n       \u2193\n     Condition: MEDIUM VOLATILITY (15 pts)\n       \u2193\n     Selected: SimpleScalpingOrchestrator\n       Parameters:\n         - RiskAmount: $20\n         - SL: 15 pts, TP: 25 pts\n         - Direction: BUY (random)\n       \u2193\nT=1  Execute SimpleScalpingOrchestrator\n       \u2192 Open BUY position\n       \u2192 Hold 60 seconds\n       \u2192 TP triggered at +17s\n       \u2192 Profit: +$25\n       \u2193\nT=2  Cycle complete\n       Total profit: $25\n       Cycles run: 1\n       \u2193\n     Wait 30 seconds\n       \u2193\nT=3  Start Cycle #2...\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-cycle-2-news-time-news-straddle","title":"Example Cycle 2: News Time \u2192 News Straddle","text":"<pre><code>T=0    Cycle #2 starts\n         \u2193\n       Analyze Market:\n         Time: 08:28 UTC\n         News at 08:30 UTC (2 min away)\n         EnableNewsMode: true\n         MinutesBeforeNews: 5\n         \u2193\n       Condition: NEWS EVENT\n         \u2193\n       Selected: NewsStraddleOrchestrator\n         Parameters:\n           - StraddleDistance: 15 pts\n           - Volume: 0.02 lots\n           - SecondsBeforeNews: 30s\n         \u2193\nT=0.5  Execute NewsStraddleOrchestrator\n         \u2192 Wait 30 seconds countdown\n         \u2192 Place BUY STOP above\n         \u2192 Place SELL STOP below\n         \u2192 Wait for breakout\n         \u2192 BUY STOP triggered\n         \u2192 Cancel SELL STOP\n         \u2192 TP hit at +45s\n         \u2192 Profit: +$40\n         \u2193\nT=3    Cycle complete\n         Total profit: $65 ($25 + $40)\n         Cycles run: 2\n         \u2193\n       Wait 30 seconds...\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-cycle-3-high-volatility-hedge","title":"Example Cycle 3: High Volatility \u2192 Hedge","text":"<pre><code>T=0    Cycle #3 starts\n         \u2193\n       Analyze Market:\n         Spread: 0.00045 (4.5 pts)\n         Volatility: 4.5 \u00d7 10 = 45 pts\n         \u2193\n       Condition: HIGH VOLATILITY (45 pts &gt; 40)\n         \u2193\n       Selected: QuickHedgeOrchestrator\n         Parameters:\n           - RiskAmount: $20 \u00d7 0.7 = $14 (reduced!)\n           - SL: 25 pts, TP: 40 pts\n           - HedgeTrigger: 15 pts\n         \u2193\nT=0.5  Execute QuickHedgeOrchestrator\n         \u2192 Open SELL position\n         \u2192 Monitor price movement\n         \u2192 Price moves -18 pts (adverse)\n         \u2192 Hedge triggered! Open BUY\n         \u2192 Hold both 30 seconds\n         \u2192 Close all\n         \u2192 Profit: -$12 (limited loss)\n         \u2193\nT=2    Cycle complete\n         Total profit: $53 ($65 - $12)\n         Cycles run: 3\n         \u2193\n       Continue...\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#volatility-analysis-method","title":"Volatility Analysis Method","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#demo-formula-simplified","title":"Demo Formula (Simplified)","text":"<pre><code>var spreadPoints = (tick.Ask - tick.Bid) / point;\nvar avgRangePoints = spreadPoints * 10;  // Simple multiplier\n\nif (avgRangePoints &lt; 15)\n    return \"Low Volatility\";\nelse if (avgRangePoints &lt; 40)\n    return \"Medium Volatility\";\nelse\n    return \"High Volatility\";\n</code></pre> <p>Why this works:</p> <ul> <li>Spread widens when volatility increases.</li> <li>Multiplier (10\u00d7) amplifies small spread changes into meaningful volatility estimates.</li> <li>Fast calculation without historical data.</li> </ul> <p>Limitations:</p> <ul> <li>\u26a0\ufe0f Not suitable for production - too simplistic.</li> <li>Doesn't account for recent price movements.</li> <li>Sensitive to broker spread changes.</li> </ul>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#production-recommendation","title":"Production Recommendation","text":"<pre><code>// Use ATR (Average True Range) for real volatility\nvar bars = await _service.GetBarsAsync(Symbol, Timeframe.M5, count: 20);\nvar atr = CalculateATR(bars, period: 14);\nvar avgRangePoints = atr / point;\n\n// Now classify based on ATR\nif (avgRangePoints &lt; 15)\n    return MarketCondition.Grid;\n// ...\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#news-detection-schedule","title":"News Detection Schedule","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#default-utc-schedule","title":"Default UTC Schedule","text":"Time (UTC) Event Types 08:30 NFP, CPI, Retail Sales, Jobless Claims 12:30 Midday economic reports, Fed speeches 14:00 FOMC statements, GDP, Consumer Confidence 18:00 ECB press conferences, Eurozone data 19:00 Evening economic indicators"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#detection-logic","title":"Detection Logic","text":"<pre><code>private bool IsNewsTime()\n{\n    var now = DateTime.UtcNow;\n    var currentHourMinute = now.Hour * 60 + now.Minute;\n\n    int[] newsMinutes = {\n        8 * 60 + 30,   // 08:30\n        12 * 60 + 30,  // 12:30\n        14 * 60,       // 14:00\n        18 * 60,       // 18:00\n        19 * 60        // 19:00\n    };\n\n    foreach (var newsMin in newsMinutes)\n    {\n        var diff = Math.Abs(currentHourMinute - newsMin);\n        if (diff &lt;= MinutesBeforeNews)  // Default: 5 minutes\n            return true;\n    }\n\n    return false;\n}\n</code></pre> <p>Trigger Window: 5 minutes before scheduled time - Example: For 08:30 news, triggers from 08:25 to 08:30.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#safety-features","title":"Safety Features","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#1-stop-loss-protection","title":"1. Stop-Loss Protection","text":"<pre><code>if (totalProfit &lt; -BaseRiskAmount * 5)\n{\n    Console.WriteLine($\"\ud83d\uded1 STOP: Total loss exceeds ${BaseRiskAmount * 5:F2}\");\n    break;  // Exit preset\n}\n</code></pre> <p>Default: Halts if total loss exceeds $100 (5 \u00d7 $20 base risk).</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#2-cycle-limit","title":"2. Cycle Limit","text":"<pre><code>int maxCycles = 100;  // Maximum 100 cycles per run\n\nfor (int cycle = 1; cycle &lt;= maxCycles; cycle++)\n{\n    // Execute cycle...\n}\n</code></pre> <p>Purpose: Prevents infinite loops, ensures eventual termination.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#3-inter-cycle-pause","title":"3. Inter-Cycle Pause","text":"<pre><code>await Task.Delay(30000, ct);  // 30 seconds between cycles\n</code></pre> <p>Purpose:</p> <ul> <li>Prevents overtrading</li> <li>Gives market time to develop</li> <li>Reduces commission costs</li> </ul>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#4-emergency-close","title":"4. Emergency Close","text":"<pre><code>catch (Exception ex)\n{\n    Console.WriteLine($\"\u2717 Error in cycle {cycle}: {ex.Message}\");\n\n    try {\n        await _service.CloseAll(Symbol);  // Close all positions\n    } catch { }\n\n    // Continue to next cycle\n}\n</code></pre> <p>Purpose: Closes all positions on unexpected error, then continues.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#risk-management","title":"Risk Management","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#adaptive-risk-sizing","title":"Adaptive Risk Sizing","text":"<pre><code>CONDITION          BASE RISK    ACTUAL RISK    REASON\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nGrid               $20          $20 (100%)     Normal risk\nScalping           $20          $20 (100%)     Normal risk\nHigh Volatility    $20          $14 (70%)      \u26a0\ufe0f REDUCED!\nNews Straddle      $20          $20 (100%)     Controlled breakout\nBreakout           $20          $20 (100%)     Pending orders\n</code></pre> <p>Key Feature: Risk automatically reduced in high volatility to preserve capital.</p>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#maximum-loss-calculation","title":"Maximum Loss Calculation","text":"<pre><code>Given:\n- BaseRiskAmount: $20\n- Safety multiplier: 5\u00d7\n- Max cycles: 100\n\nWorst-case scenarios:\n\n1. All cycles lose (impossible but theoretical):\n   100 cycles \u00d7 $20 = $2000 max loss\n\n2. Safety stop triggers:\n   5 cycles \u00d7 $20 = $100 max loss (realistic limit)\n\n3. High volatility cycles:\n   5 cycles \u00d7 $14 = $70 max loss (reduced risk)\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#win-rate-analysis","title":"Win Rate Analysis","text":"<pre><code>Assume:\n- 40% win rate\n- 100 cycles\n- Average win: +$30\n- Average loss: -$20\n\nResults:\nWins: 40 \u00d7 $30 = +$1200\nLosses: 60 \u00d7 -$20 = -$1200\nNet: $0 (break-even)\n\nWith 45% win rate:\nWins: 45 \u00d7 $30 = +$1350\nLosses: 55 \u00d7 -$20 = -$1100\nNet: +$250 profit\n\nConclusion: 45% win rate = profitable!\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#console-output","title":"Console Output","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-full-cycle-output","title":"Example Full Cycle Output","text":"<pre><code>+============================================================+\n|  ADAPTIVE MARKET MODE PRESET                              |\n+============================================================+\n\n  Symbol: EURUSD\n  Base Risk: $20.00 per cycle\n  Starting Balance: $10000.00\n  Running up to 100 cycles...\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  CYCLE #1\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  \ud83d\udcca Market Analysis:\n  Spread: 1.5 points\n  Estimated Volatility: 15 points\n  Condition: MEDIUM VOLATILITY \u2192 SimpleScalpingOrchestrator\n\n+============================================================+\n|  SIMPLE SCALPING ORCHESTRATOR                             |\n+============================================================+\n\n  Starting balance: $10000.00\n  Symbol: EURUSD\n  Direction: BUY\n  Risk: $20.00\n  SL: 15 pts | TP: 25 pts\n  Max hold: 60s\n\n  Opening position...\n  \u2713 Position opened: #123456789\n  Volume: 0.18 lots\n\n  \u23f3 Holding for 60s...\n\n  \u2713 Position closed automatically (SL/TP hit)\n\n  Final balance: $10025.00\n  Profit/Loss: $25.00\n\n+============================================================+\n\n  \u2705 Cycle #1 complete\n  Cycle P/L: $25.00\n  Total Profit: $25.00\n  Cycles Run: 1 / 100\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  \u23f8 Waiting 30 seconds before next cycle...\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  CYCLE #2\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  \ud83d\udcca Market Analysis:\n  Time: 08:28 UTC\n  News detected at 08:30 UTC\n  Condition: NEWS EVENT \u2192 NewsStraddleOrchestrator\n\n[... NewsStraddleOrchestrator output ...]\n\n  \u2705 Cycle #2 complete\n  Cycle P/L: $40.00\n  Total Profit: $65.00\n  Cycles Run: 2 / 100\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n[... more cycles ...]\n\n+============================================================+\n|  FINAL RESULTS                                            |\n+============================================================+\n  Initial Balance: $10000.00\n  Final Balance: $10350.00\n  Total Profit: $350.00\n  Cycles Run: 15 / 100\n  Stopped: User cancelled (or max cycles/safety stop)\n+============================================================+\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#usage-examples","title":"Usage Examples","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-1-conservative-profile","title":"Example 1: Conservative Profile","text":"<pre><code>var service = new MT5Service(account);\n\nvar conservative = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"EURUSD\",\n    BaseRiskAmount = 10.0,          // Lower risk\n    LowVolatilityThreshold = 12.0,  // Stricter grid entry\n    HighVolatilityThreshold = 45.0, // Stay in scalping longer\n    EnableNewsMode = false          // Disable news trading\n};\n\nawait conservative.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-2-aggressive-profile","title":"Example 2: Aggressive Profile","text":"<pre><code>var aggressive = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"GBPUSD\",\n    BaseRiskAmount = 50.0,          // Higher risk\n    LowVolatilityThreshold = 20.0,  // More grid opportunities\n    HighVolatilityThreshold = 30.0, // Trigger hedge earlier\n    EnableNewsMode = true\n};\n\nawait aggressive.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#example-3-news-only-mode","title":"Example 3: News-Only Mode","text":"<pre><code>var newsOnly = new AdaptiveMarketModePreset(service)\n{\n    Symbol = \"EURUSD\",\n    BaseRiskAmount = 30.0,\n    LowVolatilityThreshold = 1.0,   // Never trigger grid\n    HighVolatilityThreshold = 1000.0, // Never trigger hedge\n    EnableNewsMode = true,\n    MinutesBeforeNews = 10          // Earlier news detection\n};\n\n// This will primarily trade NewsStraddleOrchestrator\nawait newsOnly.ExecuteAsync();\n</code></pre>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#when-to-use-adaptive-preset","title":"When to Use Adaptive Preset","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#suitable-conditions","title":"\u2705 Suitable Conditions","text":"<ul> <li>24/7 automated trading: Set and forget</li> <li>Uncertain market conditions: Don't know which strategy to use</li> <li>Learning/backtesting: Test multiple strategies simultaneously</li> <li>Diversification: Spread risk across different approaches</li> <li>Medium-term trading: Run for days/weeks</li> </ul>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#unsuitable-conditions","title":"\u274c Unsuitable Conditions","text":"<ul> <li>Strong trending markets: Better to use single directional strategy</li> <li>Expert trader with clear setup: Use specific orchestrator directly</li> <li>Very small account: Risk management may be challenging</li> <li>Need for manual control: Preset is fully automated</li> </ul>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#optimization","title":"Optimization","text":""},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#possible-improvements","title":"Possible Improvements","text":"<ol> <li> <p>Replace volatility formula with ATR:    <pre><code>var bars = await _service.GetBarsAsync(Symbol, Timeframe.M5, 20);\nvar atr = CalculateATR(bars, period: 14);\nvar avgRangePoints = atr / point;\n</code></pre></p> </li> <li> <p>Add machine learning for strategy selection:    <pre><code>var prediction = await MLModel.Predict(marketFeatures);\nreturn prediction.BestStrategy;\n</code></pre></p> </li> <li> <p>Dynamic risk adjustment based on performance:    <pre><code>if (winRate &gt; 0.60)\n    BaseRiskAmount *= 1.2;  // Increase risk\nelse if (winRate &lt; 0.40)\n    BaseRiskAmount *= 0.8;  // Decrease risk\n</code></pre></p> </li> <li> <p>Add custom news calendar API:    <pre><code>var upcomingNews = await NewsAPI.GetUpcoming(Symbol);\nif (upcomingNews.Any(n =&gt; n.Impact == \"High\"))\n    return MarketCondition.News;\n</code></pre></p> </li> </ol>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#related-strategies","title":"Related Strategies","text":"<ul> <li>GridTradingOrchestrator: Used in low volatility.</li> <li>SimpleScalpingOrchestrator: Used in medium volatility.</li> <li>QuickHedgeOrchestrator: Used in high volatility.</li> <li>NewsStraddleOrchestrator: Used during news events.</li> <li>PendingBreakoutOrchestrator: Used on breakout signals.</li> </ul>"},{"location":"Strategies/Presets/AdaptiveMarketModePreset/#summary","title":"Summary","text":"<p>AdaptiveMarketModePreset is an intelligent multi-strategy system:</p> <p>\u2705 Pros:</p> <ul> <li>Fully automated - no manual strategy selection needed</li> <li>Adaptive - automatically adjusts to market conditions</li> <li>Diversified - uses 5 different approaches</li> <li>Risk-managed - reduced risk in high volatility, safety stops</li> <li>24/7 capable - designed for continuous operation</li> <li>Educational - demonstrates strategy coordination</li> </ul> <p>\u274c Cons:</p> <ul> <li>Simplified volatility - demo formula not production-ready</li> <li>Static news schedule - doesn't use real-time news feed</li> <li>No machine learning - simple rule-based logic</li> <li>Commission costs - frequent trading in some conditions</li> <li>Requires monitoring - safety stops may trigger unexpectedly</li> </ul> <p>Recommendation: </p> <p>Excellent for learning how to combine multiple strategies into one system. The preset demonstrates intelligent orchestrator coordination and adaptive strategy selection. For production use, replace volatility calculation with ATR and integrate real-time news API.</p> <p>\u26a0\ufe0f DEMO WARNING:</p> <p>This preset uses simplified market analysis (<code>spread \u00d7 10</code>) for educational purposes. For real trading, implement proper volatility measurement (ATR) and use live news calendar API.</p>"}]}